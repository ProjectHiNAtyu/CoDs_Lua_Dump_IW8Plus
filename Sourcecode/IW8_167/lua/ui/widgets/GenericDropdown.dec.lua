-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:52
module( ..., package.seeall )
local f0_local0 = 9
local f0_local1 = 4
local f0_local2 = 7
local f0_local3 = _1080p * 10
local f0_local4 = function ( f33_arg0, f33_arg1, f33_arg2 )
	f33_arg0._dropdownState = false
	local f33_local0 = LUI.FlowManager.GetScopedData( f33_arg0 )
	f33_local0._dropdownPreviousFocusedPosition = nil
	if f33_arg2.parent.dropdownButtonList and f33_arg2.parent.listBackground and f33_arg2.parent.closingBackground then
		f33_arg2.parent.dropdownButtonList:dispatchEventToParent( {
			name = "redirect_button_event_to_target"
		} )
		f33_arg2.parent.dropdownButtonList:closeTree()
		f33_arg2.parent.dropdownButtonList = nil
		f33_arg2.parent.listBackground:closeTree()
		f33_arg2.parent.listBackground = nil
		f33_arg2.parent.closingBackground:closeTree()
		f33_arg2.parent.closingBackground = nil
		f33_arg2.parent.buttonListVScrollbar:closeTree()
		f33_arg2.parent.buttonListVScrollbar = nil
	end
end

local f0_local5 = function ( f32_arg0, f32_arg1, f32_arg2 )
	f32_arg2.action( f32_arg0, {
		index = f32_arg0.defaultValue
	}, f32_arg1 )
end

local f0_local6 = function ( f31_arg0, f31_arg1, f31_arg2, f31_arg3 )
	f0_local0( f31_arg0, f31_arg1, f31_arg2 )
	f31_arg0:dispatchEventToParent( {
		name = "dropdown_closed",
		target = f31_arg0
	} )
	if not f31_arg2.mouse then
		local f31_local0 = f31_arg0:getParent()
		f31_local0:processEvent( {
			name = "gain_focus",
			controller = f31_arg1
		} )
	end
	if f31_arg0.onRefresh then
		f31_arg0:onRefresh( f31_arg1, f31_arg0.defaultValue, f31_arg3 )
	end
end

local f0_local7 = function ( f30_arg0, f30_arg1 )
	local f30_local0, f30_local1, f30_local2, f30_local3 = f30_arg0.dropdownButton:getCurrentGlobalRect()
	local f30_local4, f30_local5, f30_local6, f30_local7 = f30_arg1.parent:getCurrentGlobalRect()
	local f30_local8 = f30_arg0.dropdownButton:getHeight() * math.min( f30_arg0._maxVisibleRows, #f30_arg0.labels ) + f0_local0
	if f30_local7 < f30_local3 + f30_local8 then
		f30_local3 = f30_local1
		f30_local1 = f30_local1 - f30_local8
		f30_arg0._isOpenTop = true
	else
		f30_local1 = f30_local1 + f30_arg0.dropdownButton:getHeight()
		f30_local3 = f30_local3 + f30_local8
		f30_arg0._isOpenTop = false
	end
	return f30_local0 - f30_local4, f30_local2 + f0_local0 - f30_local4, f30_local1 - f30_local5, f30_local3 - f30_local5
end

local f0_local8 = function ( f29_arg0, f29_arg1, f29_arg2, f29_arg3 )
	if not f29_arg0.applyable == true then
		f29_arg3.action( f29_arg0, {
			index = f29_arg1.row
		}, f29_arg2 )
	end
	f29_arg0.defaultValue = f29_arg1.value
	f29_arg0.dropdownButton.Text:setText( f29_arg1.Text:getText() )
	f0_local0( f29_arg0, f29_arg2, f29_arg3, true )
end

local f0_local9 = function ( f28_arg0, f28_arg1, f28_arg2, f28_arg3, f28_arg4, f28_arg5 )
	local f28_local0, f28_local1, f28_local2, f28_local3 = nil
	if f28_arg2 == "up" then
		f28_local2 = LUI.DIRECTION.vertical
		f28_local3 = -1
	elseif f28_arg2 == "down" then
		f28_local2 = LUI.DIRECTION.vertical
		f28_local3 = 1
	elseif f28_arg2 == "left" then
		f28_local2 = LUI.DIRECTION.horizontal
		f28_local3 = -1
	elseif f28_arg2 == "right" then
		f28_local2 = LUI.DIRECTION.horizontal
		f28_local3 = 1
	end
	if f28_local2 and f28_local3 then
		f28_local0, f28_local1 = f28_arg0:GetNextFocusablePosition( f28_local2, f28_local3 )
	end
	if f28_local0 then
		f28_arg0:AdjustFocusedTargetPosition( f28_local0, f28_arg2, f28_local1 )
		local f28_local4 = f28_arg0._alwaysSnap
		if not f28_local4 then
			if f28_local1 then
				f28_local4 = f28_local1
			else
				f28_local4 = f28_arg0._snapOnWrap
			end
		end
		f28_arg0:SetFocusedPosition( f28_local0, f28_local4 == true, nil, f28_local1 )
		f28_arg0:FocusMoved( f28_arg2 )
		f28_arg0:saveState()
		return true
	else
		return false
	end
end

local f0_local10 = function ( f27_arg0, f27_arg1 )
	if f27_arg1.down and f27_arg1.qualifier ~= "mousewheel" then
		local f27_local0
		if f27_arg1.button ~= "up" and f27_arg1.button ~= "down" and f27_arg1.button ~= "left" and f27_arg1.button ~= "right" then
			f27_local0 = false
		else
			f27_local0 = true
		end
		if f27_local0 and not f27_arg0._childInFocus then
			local f27_local1 = LUI.FlowManager.GetScopedData( f27_arg0 )
			f27_arg0:SetFocusedPosition( f27_local1._dropdownPreviousFocusedPosition or {
				x = 0,
				y = 0
			}, f27_arg0._alwaysSnap, nil, false )
		end
	end
	return true
end

local f0_local11 = function ( f25_arg0, f25_arg1 )
	local f25_local0 = f25_arg0
	local f25_local1 = f25_arg1
	return function ( f26_arg0, f26_arg1 )
		local f26_local0, f26_local1 = nil
		f26_local0 = f25_arg0( f26_arg0, f26_arg1 )
		f26_local1 = f25_arg0( f26_arg0, f26_arg1 )
		local f26_local2
		if not f26_local0 then
			f26_local2 = f26_local0
		else
			f26_local2 = f26_local1
		end
		return f26_local2
	end
	
end

local f0_local12 = function ( f18_arg0, f18_arg1, f18_arg2 )
	if CONDITIONS.IsSplitscreen() then
		f18_arg0._maxVisibleRows = 4
	else
		f18_arg0._maxVisibleRows = 5
	end
	local self = LUI.UIGrid.new( {
		adjustSizeToContent = true,
		maxVisibleColumns = 1,
		wrapY = false,
		maxRows = -28,
		maxVisibleRows = f18_arg0._maxVisibleRows,
		controllerIndex = f18_arg1
	} )
	self.FocusNextElement = f0_local0
	local f18_local1 = self.m_eventHandlers.gamepad_button
	if f18_local1 then
		self:registerEventHandler( "gamepad_button", f0_local0( f0_local0, f18_local1 ) )
	else
		self:registerEventHandler( "gamepad_button", f0_local0 )
	end
	local f18_local2, f18_local3, f18_local4, f18_local5 = f0_local0( f18_arg0, f18_arg2 )
	if IsLanguageArabic() then
		f18_local2 = f18_local2 - _1080p * 11
		f18_local3 = f18_local3 - _1080p * 11
	end
	for f18_local6 = 1, #f18_arg0.labels, 1 do
		local f18_local9 = MenuBuilder.BuildRegisteredType( f18_arg2.buttonListType, {
			controllerIndex = f18_arg1
		} )
		f18_local9.id = "DropdownButton" .. f18_local6
		f18_local9.Text:setText( f18_arg0.labels[f18_local6] )
		f18_local9.row = f18_local6
		f18_local9.value = f18_local6
		f18_local9.Text:SetAlignment( LUI.Alignment.Left )
		f18_local9:SetLeft( f18_local2 + f0_local0 )
		f18_local9:SetRight( f18_local3 - f0_local0 )
		f18_local9:SetBottom( f18_arg0.dropdownButton:getHeight() )
		if f18_local6 == f18_arg0.defaultValue then
			self:SetDefaultFocus( {
				x = 0,
				y = f18_local6 - 1
			} )
			f18_local9._selected = true
			if not IsLanguageArabic() then
				ACTIONS.AnimateSequence( f18_local9, "Selected" )
			else
				ACTIONS.AnimateSequence( f18_local9, "SelectedAR" )
			end
			if f18_arg0.alwaysShowDefault then
				ACTIONS.AnimateSequence( f18_local9, "NotificationOff" )
			end
		else
			f18_local9._selected = false
			ACTIONS.AnimateSequence( f18_local9, "NotSelected" )
			if f18_arg0.alwaysShowDefault and f18_local6 == f18_arg0.defaultOptionValue then
				if not IsLanguageArabic() then
					ACTIONS.AnimateSequence( f18_local9, "NotificationOn" )
				else
					ACTIONS.AnimateSequence( f18_local9, "NotificationOnAR" )
				end
			end
		end
		f18_local9:addEventHandler( "button_action", function ( f24_arg0, f24_arg1 )
			f18_arg0( f18_arg0, f24_arg0, f18_arg0, f18_arg0 )
			return true
		end )
		f18_local9:addEventHandler( "button_up", function ( f23_arg0, f23_arg1 )
			f18_arg0:RemoveFocusFromChild( f18_arg0._alwaysSnap )
			if f23_arg0._selected then
				ACTIONS.AnimateSequence( f23_arg0, "ButtonUpSelected" )
			else
				ACTIONS.AnimateSequence( f23_arg0, "ButtonUp" )
			end
		end )
		f18_local9:addEventHandler( "button_over", function ( f22_arg0, f22_arg1 )
			local f22_local0 = LUI.FlowManager.GetScopedData( f22_arg0 )
			local f22_local1 = {
				x = 0,
				y = f22_arg0.row - 1
			}
			f22_local0._dropdownPreviousFocusedPosition = f22_local1
			f18_arg0:SetFocusedPosition( f22_local1, f18_arg0._alwaysSnap, false, false )
			if f18_arg0.onRefresh then
				f18_arg0:onRefresh( f18_arg0, f22_arg0.row )
			end
		end )
		self:AddElement( f18_local9 )
	end
	local f18_local6 = MenuBuilder.BuildRegisteredType( "GenericButton", {
		controllerIndex = f18_arg1
	} )
	f18_local6.id = "closingBackground"
	f18_local6:SetAlpha( 0 )
	f18_local6:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	ACTIONS.ScaleFullscreen( f18_local6 )
	f18_arg2.parent:addElement( f18_local6 )
	f18_arg2.parent.closingBackground = f18_local6
	f18_arg2.parent.closingBackground:addEventHandler( "button_action", function ( f21_arg0, f21_arg1 )
		f18_arg0( f18_arg0, f18_arg0, f18_arg0 )
		return true
	end )
	local f18_local7 = nil
	f18_local7 = MenuBuilder.BuildRegisteredType( "GenericDropdownBackground", {
		controllerIndex = f18_arg1
	} )
	f18_local7.id = "ListBackground"
	f18_local7:SetAnchorsAndPosition( 0, 1, 0, 1, f18_local2, f18_local3, f18_local4, f18_local5 )
	f18_arg2.parent:addElement( f18_local7 )
	f18_arg2.parent.listBackground = f18_local7
	self.id = "DropdownButtonList"
	self:setUseStencil( true )
	self:SetAnchorsAndPosition( 0, 1, 0, 1, f18_local2 + f0_local0, f18_local3 - f0_local0, f18_local4 + f0_local0 / 2, f18_local5 - f0_local0 / 2 )
	f18_arg2.parent:addElement( self )
	f18_arg2.parent.dropdownButtonList = self
	f18_arg2.parent.dropdownButtonList:SetActiveParentBehavior()
	self:SetHandleMouse( true )
	self:dispatchEventToParent( {
		name = "redirect_button_event_to_target",
		target = self
	} )
	self:registerEventHandler( "button_secondary", function ( self, event )
		f18_arg0( f18_arg0, f18_arg0, f18_arg0 )
		return true
	end )
	self:addEventHandler( "gamepad_button", function ( f19_arg0, f19_arg1 )
		if f19_arg1.button == "shoulderl" or f19_arg1.button == "shoulderr" then
			f18_arg0( f18_arg0, f18_arg0, f18_arg0 )
		elseif f19_arg1.button == "secondary" then
			f18_arg0( f18_arg0, f18_arg0, f18_arg0 )
			return true
		end
	end )
	local f18_local8 = nil
	f18_local8 = MenuBuilder.BuildRegisteredType( "VerticalMinimalScrollbar", {
		controllerIndex = f18_arg1
	} )
	f18_local8.id = "buttonListDropdownVScrollbar"
	f18_local8:SetAnchorsAndPosition( 0, 1, 0, 1, f18_local3 - f0_local0, f18_local3, f18_local4, f18_local5 )
	f18_arg2.parent:addElement( f18_local8 )
	f18_arg2.parent.buttonListVScrollbar = f18_local8
	local f18_local10 = LUI.UIScrollbar.new
	local f18_local11 = {
		direction = LUI.DIRECTION.vertical,
		eventListener = f18_local8,
		startCap = f18_local8.startCap,
		endCap = f18_local8.endCap,
		sliderArea = f18_local8.sliderArea
	}
	local f18_local12 = f18_local8.sliderArea
	if f18_local12 then
		f18_local12 = f18_local8.sliderArea.slider
	end
	f18_local11.slider = f18_local12
	f18_local12 = f18_local8.sliderArea
	if f18_local12 then
		f18_local12 = f18_local8.sliderArea.fixedSizeSlider
	end
	f18_local11.fixedSizeSlider = f18_local12
	f18_local11.mouseWheelTarget = f18_arg2.parent.dropdownButtonList
	f18_arg2.parent.dropdownButtonList:AddScrollbar( f18_local10( f18_local11 ) )
end

local f0_local13 = function ( f17_arg0, f17_arg1, f17_arg2 )
	f17_arg0._dropdownState = true
	f17_arg0:dispatchEventToParent( {
		name = "dropdown_opened",
		target = f17_arg0
	} )
	if f17_arg0.onRefresh then
		f17_arg0:onRefresh( f17_arg1, f17_arg0.defaultValue, addToModified )
	end
	f0_local0( f17_arg0, f17_arg1, f17_arg2 )
	if not f17_arg2.mouse then
		local f17_local0 = f17_arg0:getParent()
		f17_local0:processEvent( {
			name = "lose_focus",
			controller = f17_arg1
		} )
		f17_arg2.parent.dropdownButtonList:processEvent( {
			name = "gain_focus",
			controller = f17_arg1
		} )
	end
end

local f0_local14 = function ( f16_arg0, f16_arg1, f16_arg2 )
	if not f16_arg0._dropdownState then
		f0_local0( f16_arg0, f16_arg1, f16_arg2 )
	else
		f0_local0( f16_arg0, f16_arg1, f16_arg2 )
	end
end

local f0_local15 = function ( f15_arg0, f15_arg1 )
	f15_arg0.labels = f15_arg1
	local f15_local0 = f15_arg0:GetCurrentMenu()
	for f15_local1 = 1, #f15_arg0.labels, 1 do
		if f15_local1 == f15_arg0.defaultValue then
			f15_arg0.dropdownButton.Text:setText( f15_arg0.labels[f15_local1] )
		end
		if f15_local0.dropdownButtonList then
			local f15_local4 = f15_local0.dropdownButtonList:GetElementAtPosition( 0, f15_local1 - 1 )
			if f15_local4 then
				f15_local4.Text:setText( f15_arg0.labels[f15_local1] )
			end
		end
	end
end

local f0_local16 = function ( f14_arg0, f14_arg1 )
	f14_arg0.labels = f14_arg1
end

local f0_local17 = function ( f3_arg0, f3_arg1, f3_arg2 )
	local dropdownButton = MenuBuilder.BuildRegisteredType( f3_arg2.buttonType, {
		controllerIndex = f3_arg1
	} )
	dropdownButton.id = "DropdownButton"
	f3_arg0.defaultValueGetter = f3_arg2.defaultValueGetter
	f3_arg0.valueGetter = f3_arg2.valueGetter
	f3_arg0.onRefresh = f3_arg2.onRefresh
	f3_arg0.onReset = f3_arg2.onReset
	f3_arg0.labels = f3_arg2.labels
	f3_arg0.defaultValue = f3_arg2.defaultValue
	f3_arg0.onDependencyParentRefresh = f3_arg2.onDependencyParentRefresh
	f3_arg0.alwaysShowDefault = f3_arg2.alwaysShowDefault
	f3_arg0.applyable = f3_arg2.applyable == true
	if f3_arg0.alwaysShowDefault then
		f3_arg0.defaultOptionValue = f3_arg0.defaultValueGetter( f3_arg1 )
	end
	local f3_local1 = ""
	for f3_local2 = 1, #f3_arg0.labels, 1 do
		if f3_local2 == f3_arg0.defaultValue then
			f3_local1 = f3_arg0.labels[f3_local2]
			break
		end
	end
	dropdownButton.Text:setText( f3_local1 )
	if IsLanguageArabic() then
		dropdownButton.Text:SetLeft( _1080p * 40 )
		dropdownButton.Text:SetRight( _1080p * -10 )
	else
		dropdownButton.Text:SetLeft( _1080p * 10 )
		dropdownButton.Text:SetRight( _1080p * -35 )
	end
	dropdownButton.Text:SetAlignment( LUI.Alignment.Left )
	dropdownButton:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	f3_arg0:addElement( dropdownButton )
	f3_arg0.dropdownButton = dropdownButton
	
	f3_arg0.dropdownButton:addEventHandler( "button_action", function ( f13_arg0, f13_arg1 )
		if f13_arg1.mouse == true then
			f3_arg0.mouse = true
		else
			f3_arg0.mouse = false
		end
		f3_arg0( f3_arg0, f3_arg0, f3_arg0 )
	end )
	f3_arg0.SetCurrentValue = function ( f12_arg0, f12_arg1, f12_arg2, f12_arg3, f12_arg4 )
		for f12_local0 = 1, #f12_arg0.labels, 1 do
			if f12_local0 == f12_arg2 then
				f12_arg0.dropdownButton.Text:setText( f12_arg0.labels[f12_arg2] )
				if f12_arg0.applyable == false or f12_arg4 then
				
				else
					f12_arg0.defaultValue = f12_local0
					if f12_arg0.onRefresh then
						f12_arg0:onRefresh( f12_arg1, f12_local0, f12_arg3 )
						break
					end
				end
				f3_arg0.action( f12_arg0, {
					index = f12_local0
				}, f12_arg1 )
			end
		end
	end
	
	f3_arg0:addEventHandler( "refresh_values", function ( f11_arg0, f11_arg1 )
		f11_arg0:SetCurrentValue( f11_arg1.controller, f11_arg0.defaultValue )
		return true
	end )
	f3_arg0:addEventHandler( "seek_value", function ( f10_arg0, f10_arg1 )
		if f10_arg0.valueGetter then
			f10_arg0:SetCurrentValue( f10_arg1.controllerIndex or f3_arg0, f10_arg0.valueGetter( f10_arg1.controllerIndex or f3_arg0 ) )
		end
	end )
	f3_arg0:addEventHandler( "reset_value", function ( f9_arg0, f9_arg1 )
		if f9_arg0.defaultValueGetter and not f9_arg0.dropdownButton.disabled then
			f9_arg0:SetCurrentValue( f9_arg1.controllerIndex or f3_arg0, f9_arg0.defaultValueGetter( f9_arg1.controllerIndex or f3_arg0 ), nil, true )
			f9_arg0:onReset( f9_arg1.controllerIndex )
		end
	end )
	f3_arg0:addEventHandler( "apply_value", function ( f8_arg0, f8_arg1 )
		if f8_arg0.applyable then
			f3_arg0( f3_arg0, f8_arg1.controllerIndex or f3_arg0, f3_arg0 )
		end
	end )
	f3_arg0:addEventHandler( "parent_value_changed", function ( f7_arg0, f7_arg1 )
		if f7_arg0.onDependencyParentRefresh then
			local f7_local0 = f7_arg0:onDependencyParentRefresh( f7_arg1.controllerIndex or f3_arg0, f3_arg0.defaultValue, f7_arg1.parentId, f7_arg1.parentValue )
			if f7_local0 == true then
				f7_arg0:onRefresh( f7_arg1.controllerIndex, f3_arg0.defaultValue )
			elseif f7_local0 ~= nil then
				f7_arg0:SetCurrentValue( f7_arg1.controllerIndex or f3_arg0, f7_local0 )
			end
		end
	end )
	f3_arg0:addEventHandler( "refresh_option", function ( f6_arg0, f6_arg1 )
		f6_arg0:onRefresh( f6_arg1.controllerIndex, f3_arg0.defaultValue )
	end )
	f3_arg0:addEventHandler( "remove_overlays", function ( f5_arg0, f5_arg1 )
		f3_arg0( f5_arg0, f3_arg0, f3_arg0 )
	end )
	f3_arg0:addEventHandler( "update_value", function ( f4_arg0, f4_arg1 )
		if f4_arg1.value then
			f4_arg0:SetCurrentValue( f4_arg1.controller, f4_arg1.value )
			return true
		else
			
		end
	end )
	dropdownButton.Pip:SetAlpha( 0 )
	f3_arg0:dispatchEventToParent( {
		name = "setup_button_data_completed"
	} )
end

local f0_local18 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.labels = {}
	f2_arg0._dropdownState = false
	f2_arg0.SetupButtonData = f0_local0
	f2_arg0.UpdateCurrentTextDropdown = f0_local0
	f2_arg0.UpdateLabels = f0_local0
end

function GenericDropdown( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 201 * _1080p, 0, 150 * _1080p )
	self.id = "GenericDropdown"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "GenericDropdown", GenericDropdown )
LockTable( _M )
