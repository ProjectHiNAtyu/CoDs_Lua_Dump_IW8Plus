-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:51
module( ..., package.seeall )
FenceMLGAccount = LUI.Class( LUI.Fence )
FenceMLGAccount.init = function ( f8_arg0 )
	LUI.Fence.init( f8_arg0 )
end

FenceMLGAccount.Start = function ( f7_arg0 )
	local f7_local0 = Engine.IJEBHJIJF()
	if MLG.BIHFEHBCFB( f7_local0 ) == GAMEBATTLES.INVALID_MATCH_ID then
		MLG.DEEAEDDFCA( f7_local0 )
	end
end

FenceMLGAccount.Stop = function ( f6_arg0 )
	LUI.FlowManager.RequestLeaveMenuByName( "popup_getting_mlg_account", true )
	f6_arg0._openedWaitPopup = false
end

FenceMLGAccount.OpenPopup = function ( f4_arg0 )
	local f4_local0 = f4_arg0
	LUI.FlowManager.RequestPopupMenu( nil, "popup_getting_mlg_account", false, nil, false, {
		onCancel = function ( f5_arg0, f5_arg1 )
			f4_arg0._state = LUI.Fence.STATE.fail
		end
	}, nil, true, true )
	f4_arg0._openedWaitPopup = true
end

FenceMLGAccount.PostFail = function ( f3_arg0 )
	local f3_local0 = Engine.IJEBHJIJF()
	if f3_arg0._state == LUI.Fence.STATE.fail then
		if f3_arg0._errorCode == GAMEBATTLES.MLG_ERR_CODE.CANNOT_CONNECT then
			LUI.FlowManager.RequestPopupMenu( f3_arg0, "MLGGamebattlesCannotConnectPopup", false, f3_local0, false, {
				controllerIndex = f3_local0
			} )
		elseif f3_arg0._errorCode == GAMEBATTLES.MLG_ERR_CODE.NO_SOCIAL_PRIVILEGES then
			LUI.FlowManager.RequestPopupMenu( f3_arg0, "MLGGamebattlesNoSocialNetworkPrivilegesPopup", false, f3_local0, false, {
				controllerIndex = f3_local0
			} )
		elseif f3_arg0._errorCode == GAMEBATTLES.MLG_ERR_CODE.USER_NOT_REGISTERED then
			LUI.FlowManager.RequestPopupMenu( f3_arg0, "MLGGamebattlesUnregisteredPopup", false, f3_local0, false, {
				controllerIndex = f3_local0
			} )
		elseif f3_arg0._errorCode == GAMEBATTLES.MLG_ERR_CODE.FIRST_TIME_ENTRY then
			LUI.FlowManager.RequestPopupMenu( f3_arg0, "MLGGamebattlesFirstTimePopup", false, f3_local0, false, {
				controllerIndex = f3_local0
			} )
		end
	end
end

FenceMLGAccount.UpdateState = function ( f2_arg0 )
	assert( f2_arg0._state ~= LUI.Fence.STATE.fail )
	f2_arg0._state = LUI.Fence.STATE.pass
	local f2_local0 = Engine.IJEBHJIJF()
	local f2_local1 = MLG.CGJCACCIDH( f2_local0 )
	if Engine.BAHIIBFDDG() and not Engine.CDCBBGFHJA( f2_local0 ) then
		f2_arg0._state = LUI.Fence.STATE.fail
		f2_arg0._errorCode = GAMEBATTLES.MLG_ERR_CODE.NO_SOCIAL_PRIVILEGES
	elseif f2_local1 == GAMEBATTLES.MLG_ACCOUNT_STATE.RETRIEVING then
		f2_arg0._state = LUI.Fence.STATE.block
	elseif f2_local1 == GAMEBATTLES.MLG_ACCOUNT_STATE.UNAVAILABLE then
		f2_arg0._state = LUI.Fence.STATE.block
		MLG.DEEAEDDFCA( f2_local0 )
	elseif f2_local1 == GAMEBATTLES.MLG_ACCOUNT_STATE.NO_ACCOUNT then
		f2_arg0._state = LUI.Fence.STATE.fail
		f2_arg0._errorCode = GAMEBATTLES.MLG_ERR_CODE.USER_NOT_REGISTERED
	elseif f2_local1 == GAMEBATTLES.MLG_ACCOUNT_STATE.ACCOUNT_ERROR then
		f2_arg0._state = LUI.Fence.STATE.fail
		f2_arg0._errorCode = GAMEBATTLES.MLG_ERR_CODE.CANNOT_CONNECT
	elseif f2_local1 == GAMEBATTLES.MLG_ACCOUNT_STATE.HAS_ACCOUNT then
		local f2_local2 = PlayerData.BFFBGAJGD( f2_local0, CoD.StatsGroup.Common )
		if not f2_local2.registeredToGamebattles:get() then
			f2_arg0._state = LUI.Fence.STATE.fail
			f2_arg0._errorCode = GAMEBATTLES.MLG_ERR_CODE.FIRST_TIME_ENTRY
		end
	end
	if f2_arg0._state == LUI.Fence.STATE.block and not f2_arg0._openedWaitPopup then
		f2_arg0:OpenPopup()
	end
end

function PopupGettingMLGAccount( f1_arg0, f1_arg1 )
	local f1_local0 = assert
	local f1_local1
	if f1_arg1 then
		f1_local1 = f1_arg1
	else
		f1_local1 = f1_arg1.onCancel
	end
	f1_local0( f1_local1 )
	local f1_local2 = MenuBuilder.BuildRegisteredType( "live_dialog_text_box_with_cancel", {
		message = Engine.CBBHFCGDIC( "MLG_GAMEBATTLES/FENCE_MLGACCOUNT" ),
		cancel_func = f1_arg1.onCancel
	} )
	f1_local2.id = "popup_getting_mlg_account"
	return f1_local2
end

MenuBuilder.registerType( "popup_getting_mlg_account", PopupGettingMLGAccount )
LUI.Fence.Register( "mlgAccount", FenceMLGAccount )
LockTable( _M )
