-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:02
module( ..., package.seeall )
local f0_local0 = 100
local f0_local1 = function ( f18_arg0, f18_arg1 )
	local detailWidget = MenuBuilder.BuildRegisteredType( "LobbyCharacterDetails", {
		controllerIndex = f18_arg1
	} )
	detailWidget:SetAlpha( 0 )
	detailWidget:SetupAnchoredElement( {
		maxScale = 1,
		roundScreenPosition = true,
		minScale = 1
	} )
	f18_arg0:addElement( detailWidget )
	f18_arg0.detailWidget = detailWidget
	
end

local f0_local2 = function ( f17_arg0, f17_arg1, f17_arg2 )
	if f17_arg0.detailWidget and ClientCharacter[0xA6309027523469F]( f17_arg2 ) and ClientCharacter[0x735D43355F4981F]( f17_arg2 ) and Engine[0x283B38F2501D924]() then
		local f17_local0 = ClientCharacter[0xAB49E1B2150A83B]( f17_arg2 )
		f17_arg0.detailWidget:Setup( f17_arg1, {
			gamerTag = f17_arg0._characterDataSources.gamertag:GetValue( f17_arg1 ),
			missingGamertag = f17_arg0._characterDataSources.missingGamertag:GetValue( f17_arg1 ),
			micAlphaDataSource = f17_arg0._characterDataSources.microphoneAlpha,
			micIconDataSource = f17_arg0._characterDataSources.microphoneIcon,
			presencePlatform = f17_arg0._characterDataSources.presencePlatform:GetValue( f17_arg1 ),
			isMyPlayer = f17_arg0._characterDataSources.isMyPlayer:GetValue( f17_arg1 ),
			isPrivatePartyHost = f17_arg0._characterDataSources.isPrivatePartyHost:GetValue( f17_arg1 ),
			displayRank = f17_arg0._characterDataSources.displayRank:GetValue( f17_arg1 ),
			rankIcon = f17_arg0._characterDataSources.rankIcon:GetValue( f17_arg1 ),
			usingGamepad = f17_arg0._characterDataSources.usingGamepad:GetValue( f17_arg1 )
		} )
		f17_arg0.detailWidget:SetEntityNum( f17_local0 )
		f17_arg0.detailWidget:SetEntityTag( "j_head" )
		f17_arg0.detailWidget:SetAlpha( 1 )
		local f17_local1 = {
			x = 0,
			y = 0
		}
		local f17_local2 = f17_arg2 + 1
		if f17_local2 <= #Lobby.CharacterDetailsWidgetOffsets then
			f17_local1 = Lobby.CharacterDetailsWidgetOffsets[f17_local2]
			f17_arg0.detailWidget:SetWorldSpacePosition( f17_local1.x, 0, f17_local1.y )
		end
	end
end

local f0_local3 = function ( f16_arg0, f16_arg1 )
	FrontEndScene.SetCharacterVisible( f16_arg0._characterIndex, f16_arg1, false )
	ClientCharacter[0x813BDB5DDDF1A24]( f16_arg0._characterIndex, f16_arg1 )
	local f16_local0 = Lobby.GetPetIndexForCharacter( f16_arg0._characterIndex )
	if f16_local0 then
		FrontEndScene.SetCharacterVisible( f16_local0, f16_arg1, false )
	end
	if f16_arg0.detailWidget then
		local f16_local1 = f16_arg0.detailWidget
		local f16_local2 = f16_local1
		f16_local1 = f16_local1.SetAlpha
		local f16_local3
		if f16_arg1 then
			f16_local3 = 1
		else
			f16_local3 = 0
		end
		f16_local1( f16_local2, f16_local3 )
	end
end

local f0_local4 = function ( f15_arg0, f15_arg1, f15_arg2, f15_arg3, f15_arg4, f15_arg5 )
	ClientCharacter[0xFB5C3935C674824]( f15_arg0._characterIndex, f15_arg2, f15_arg1 )
	if f15_arg0._animation then
		ClientCharacter[0xAA614EB46957F3B]( f15_arg0._characterIndex, f15_arg0._animation )
	elseif not Engine[0xCBCF315DE9B8AC6]() then
		local f15_local0 = f15_arg0:getParent()
		local f15_local1, f15_local2 = OPERATOR.GetMatchMakingAnimations( f15_arg0._characterIndex, f15_local0:GetActiveCharacterNum(), f15_arg0._controllerIndex )
		if f15_local1 and 0 < #f15_local1 then
			ClientCharacter[0xAA614EB46957F3B]( f15_arg0._characterIndex, f15_local1, 0 )
			if f15_local2 and 0 < #f15_local2 then
				ClientCharacter[0x524D4D5B140E36E]( f15_arg0._characterIndex, f15_local2 )
			end
		elseif f15_local2 and 0 < #f15_local2 then
			ClientCharacter[0xAA614EB46957F3B]( f15_arg0._characterIndex, f15_local2, 0 )
		end
	end
	if f15_arg4 then
		f15_arg4 = OPERATOR.TryOverrideStowedWeapon( f15_arg0._characterIndex, f15_arg4 )
	end
	if f15_arg3 then
		ClientCharacter[0x1AEA65ACE3F1203]( f15_arg0._characterIndex, f15_arg3, f15_arg4, f15_arg5 )
	end
	f15_arg0._currentPrimaryWeaponModel = f15_arg3
end

local f0_local5 = function ( f13_arg0 )
	local f13_local0 = nil
	local f13_local1 = function ()
		if ClientCharacter[0xA6309027523469F]( f13_arg0._characterIndex ) and ClientCharacter[0x735D43355F4981F]( f13_arg0._characterIndex ) then
			FrontEndScene.SetCharacterVisible( f13_arg0._characterIndex, true, false )
			local f14_local0
			if not WEAPON.IsWeaponNoneValue( f13_arg0._currentPrimaryWeaponModel ) then
				f14_local0 = not WEAPON.IsWeaponFists( f13_arg0._currentPrimaryWeaponModel )
			else
				f14_local0 = false
			end
			ClientCharacter[0x813BDB5DDDF1A24]( f13_arg0._characterIndex, f14_local0 )
		else
			local f14_local0 = f13_arg0._loadTimerElement:Wait( f13_arg0, true )
			if f14_local0 then
				f14_local0.onComplete = f13_arg0
			end
		end
	end
	
	f13_local1()
end

local f0_local6 = function ( f11_arg0 )
	local f11_local0 = nil
	local f11_local1 = function ()
		if ClientCharacter[0xA6309027523469F]( f11_arg0._characterIndex ) and ClientCharacter[0x735D43355F4981F]( f11_arg0._characterIndex ) and Engine[0x283B38F2501D924]() then
			if (Dvar[0x9E5BE3B4BBA4E0E]( 0x2454BD5628C8708 ) or f11_arg0._characterData.isMyPlayer) and f11_arg0._active then
				f11_arg0( f11_arg0, f11_arg0._characterIndex, f11_arg0._characterIndex )
			end
		elseif f11_arg0.detailWidget ~= nil then
			local f12_local0 = f11_arg0.detailWidget:Wait( f11_arg0, true )
			if f12_local0 then
				f12_local0.onComplete = f11_arg0
			end
		end
	end
	
	f11_local1()
end

local f0_local7 = function ( f10_arg0, f10_arg1 )
	f10_arg0._characterData = CLIENTCHARACTER.GetData( f10_arg1, f10_arg0._characterIndex, f10_arg0._characterDataSources, f10_arg0._forceSuperfactionBasedOnTeam )
	STREAMING.RequestModels( f10_arg1, {
		menuName = f10_arg0._menu.id,
		modelType = STREAMING.ModelTypes.Head,
		models = {
			f10_arg0._characterData.headModel
		}
	} )
	STREAMING.RequestModels( f10_arg1, {
		menuName = f10_arg0._menu.id,
		modelType = STREAMING.ModelTypes.Body,
		models = {
			f10_arg0._characterData.bodyModel,
			f10_arg0._characterData.petModel
		}
	} )
	STREAMING.RequestModels( f10_arg1, {
		menuName = f10_arg0._menu.id,
		modelType = STREAMING.ModelTypes.WeaponWorld,
		models = {
			f10_arg0._characterData.primaryWeaponModel,
			f10_arg0._characterData.secondaryWeaponModel,
			f10_arg0._characterData.accessoryModel
		}
	} )
	ClientCharacter[0xB6D1A33AC2622D0]( f10_arg0._characterIndex, 0, 0, 0 )
	f0_local0( f10_arg0, false )
	f0_local0( f10_arg0, f10_arg0._characterData.headModel, f10_arg0._characterData.bodyModel, f10_arg0._characterData.primaryWeaponModel, f10_arg0._characterData.secondaryWeaponModel, f10_arg0._characterData.accessoryModel )
	f0_local0( f10_arg0 )
	if f10_arg0.detailWidget then
		f0_local0( f10_arg0 )
	end
	local f10_local0 = Lobby.GetPetIndexForCharacter( f10_arg0._characterIndex )
	if f10_local0 and f10_arg0._characterData.petRef then
		FrontEndScene.SetCharacterVisible( f10_local0, false, true )
		ClientCharacter[0xFB5C3935C674824]( f10_local0, f10_arg0._characterData.petModel )
		ClientCharacter[0xAA614EB46957F3B]( f10_local0, OPERATOR.GetPetWalk( f10_arg1, StringTable[0x8073B436CDE1BF]( CSV.pets.file, CSV.pets.cols.ref, f10_arg0._characterData.petRef ), f10_local0 ) )
		f10_arg0.PetLoadTimerContainer = LUI.UIElement.new()
		f10_arg0.PetLoadTimerContainer.id = "PetLoadTimerContainer"
		f10_arg0:addElement( f10_arg0.PetLoadTimerContainer )
		OPERATOR.InternalShowCharacterAndWeaponWhenLoaded( f10_arg0.PetLoadTimerContainer, f10_local0, {
			isPet = true
		} )
	end
end

local f0_local8 = function ( f8_arg0, f8_arg1, f8_arg2 )
	local f8_local0 = function ()
		f8_arg0( f8_arg0, f8_arg0 )
	end
	
	f8_arg0:SubscribeToModel( f8_arg2.bodyWest:GetModel( f8_arg1 ), f8_local0, true )
	f8_arg0:SubscribeToModel( f8_arg2.bodyEast:GetModel( f8_arg1 ), f8_local0, true )
	f8_arg0:SubscribeToModel( f8_arg2.headWest:GetModel( f8_arg1 ), f8_local0, true )
	f8_arg0:SubscribeToModel( f8_arg2.headEast:GetModel( f8_arg1 ), f8_local0, true )
	f8_arg0:SubscribeToModel( f8_arg2.execWest:GetModel( f8_arg1 ), f8_local0, true )
	f8_arg0:SubscribeToModel( f8_arg2.execEast:GetModel( f8_arg1 ), f8_local0, true )
	f8_arg0:SubscribeToModel( f8_arg2.selectedOperatorIndex:GetModel( f8_arg1 ), f8_local0, true )
	for f8_local1 = 0, WEAPON.maxLoadoutWeapons - 1, 1 do
		local f8_local4 = f8_arg2.weapons:GetDataSourceAtIndex( f8_local1, f8_arg1 )
		f8_arg0:SubscribeToModel( f8_local4.weaponLootID:GetModel( f8_arg1 ), f8_local0, true )
		f8_arg0:SubscribeToModel( f8_local4.cosmeticAttachment:GetModel( f8_arg1 ), f8_local0, true )
		f8_arg0:SubscribeToModel( f8_local4.weaponCamo:GetModel( f8_arg1 ), f8_local0, true )
		for f8_local5 = 0, WEAPON.maxStickersPerWeapon - 1, 1 do
			local f8_local8 = f8_local4.stickers:GetDataSourceAtIndex( f8_local5, f8_arg1 )
			f8_arg0:SubscribeToModel( f8_local8.stickerID:GetModel( f8_arg1 ), f8_local0, true )
		end
		for f8_local5 = 0, WEAPON.maxAttachmentsPerWeapon - 1, 1 do
			local f8_local8 = f8_local4.attachments:GetDataSourceAtIndex( f8_local5, f8_arg1 )
			f8_arg0:SubscribeToModel( f8_local8.variantID:GetModel( f8_arg1 ), f8_local0, true )
			f8_arg0:SubscribeToModel( f8_local8.attachment:GetModel( f8_arg1 ), f8_local0, true )
		end
	end
end

local f0_local9 = function ( f7_arg0, f7_arg1, f7_arg2 )
	f7_arg0:UnsubscribeFromModel( f7_arg2.bodyWest:GetModel( f7_arg1 ) )
	f7_arg0:UnsubscribeFromModel( f7_arg2.bodyEast:GetModel( f7_arg1 ) )
	f7_arg0:UnsubscribeFromModel( f7_arg2.headWest:GetModel( f7_arg1 ) )
	f7_arg0:UnsubscribeFromModel( f7_arg2.headEast:GetModel( f7_arg1 ) )
	f7_arg0:UnsubscribeFromModel( f7_arg2.execWest:GetModel( f7_arg1 ) )
	f7_arg0:UnsubscribeFromModel( f7_arg2.execEast:GetModel( f7_arg1 ) )
	for f7_local0 = 0, WEAPON.maxLoadoutWeapons - 1, 1 do
		local f7_local3 = f7_arg2.weapons:GetDataSourceAtIndex( f7_local0, f7_arg1 )
		f7_arg0:UnsubscribeFromModel( f7_local3.weaponLootID:GetModel( f7_arg1 ) )
		f7_arg0:UnsubscribeFromModel( f7_local3.cosmeticAttachment:GetModel( f7_arg1 ) )
		f7_arg0:UnsubscribeFromModel( f7_local3.weaponCamo:GetModel( f7_arg1 ) )
		for f7_local4 = 0, WEAPON.maxStickersPerWeapon - 1, 1 do
			local f7_local7 = f7_local3.stickers:GetDataSourceAtIndex( f7_local4, f7_arg1 )
			f7_arg0:UnsubscribeFromModel( f7_local7.stickerID:GetModel( f7_arg1 ) )
		end
		for f7_local4 = 0, WEAPON.maxAttachmentsPerWeapon - 1, 1 do
			local f7_local7 = f7_local3.attachments:GetDataSourceAtIndex( f7_local4, f7_arg1 )
			f7_arg0:UnsubscribeFromModel( f7_local7.variantID:GetModel( f7_arg1 ) )
			f7_arg0:UnsubscribeFromModel( f7_local7.attachment:GetModel( f7_arg1 ) )
		end
	end
end

local f0_local10 = function ( f6_arg0, f6_arg1, f6_arg2 )
	assert( f6_arg2 ~= nil )
	if f6_arg0._active == f6_arg2 then
		return 
	end
	f6_arg0._active = f6_arg2
	if f6_arg2 then
		if not f6_arg0._characterDataSources then
			f6_arg0._characterDataSources = CLIENTCHARACTER.GetCharacterDataSources( f6_arg1, f6_arg0._characterIndex, f6_arg0._dataSourcePath )
		end
		f0_local0( f6_arg0, f6_arg1, f6_arg0._characterDataSources )
		f0_local0( f6_arg0, f6_arg1 )
	else
		if f6_arg0._characterDataSources then
			f0_local0( f6_arg0, f6_arg1, f6_arg0._characterDataSources )
		end
		f0_local0( f6_arg0, false )
	end
end

local f0_local11 = function ( f5_arg0, f5_arg1, f5_arg2 )
	if f5_arg0._characterDataSources then
		f0_local0( f5_arg0, f5_arg1, f5_arg0._characterDataSources )
	end
	f5_arg0._characterDataSources = f5_arg2
end

local f0_local12 = function ( f4_arg0, f4_arg1 )
	assert( f4_arg1 )
	f4_arg0._animation = f4_arg1
	ClientCharacter[0xAA614EB46957F3B]( f4_arg0._characterIndex, f4_arg1 )
end

local f0_local13 = function ( f2_arg0, f2_arg1, f2_arg2 )
	assert( f2_arg2.menu )
	assert( f2_arg2.characterIndex )
	f2_arg0._characterIndex = f2_arg2.characterIndex
	f2_arg0._controllerIndex = f2_arg1
	f2_arg0._menu = f2_arg2.menu
	local f2_local0 = f2_arg2.dataSourcePath
	if not f2_local0 then
		f2_local0 = CLIENTCHARACTER.AllMembersPath
	end
	f2_arg0._dataSourcePath = f2_local0
	f2_arg0._forceSuperfactionBasedOnTeam = f2_arg2.forceSuperfactionBasedOnTeam
	f2_arg0._active = false
	f2_arg0.SetActive = f0_local0
	f2_arg0.SetAnimation = f0_local0
	f2_arg0.SetCharacterDataSources = f0_local0
	f2_arg0._loadTimerElement = LUI.UIElement.new()
	f2_arg0:addElement( f2_arg0._loadTimerElement )
	f2_arg0:registerEventHandler( "on_close", function ()
		f2_arg0( f2_arg0, false )
	end )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0x2454BD5628C8708 ) and f2_arg2.showDetailWidget and not f2_arg0.detailWidget then
		f0_local0( f2_arg0, f2_arg1 )
	end
end

function ClientCharacterWidget( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "ClientCharacterWidget"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "ClientCharacterWidget", ClientCharacterWidget )
LockTable( _M )
