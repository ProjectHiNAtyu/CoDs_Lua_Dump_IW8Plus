-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
module( ..., package.seeall )
local f0_local0 = function ( f14_arg0 )
	if f14_arg0._statusSub then
		f14_arg0:UnsubscribeFromModel( f14_arg0._statusSub )
		f14_arg0._statusSub = nil
	end
end

local f0_local1 = function ( f13_arg0 )
	if f13_arg0._countSub then
		f13_arg0:UnsubscribeFromModel( f13_arg0._countSub )
		f13_arg0._countSub = nil
	end
end

local f0_local2 = function ( f11_arg0, f11_arg1, f11_arg2, f11_arg3 )
	f11_arg0.currentWeaponClass = nil
	local f11_local0 = function ( f12_arg0 )
		local f12_local0 = nil
		if f11_arg0 then
			f12_local0 = WEAPON.GetWeaponClass( WEAPON.StripSuffix( f11_arg0, "_mp" ) )
			if not f12_local0 or f12_local0 == "" then
				local f12_local1 = LUI.Split( f11_arg0, "+" )
				local f12_local2 = f12_local1[1]
				local f12_local3 = nil
				f12_local3 = LUI.FindLast( f12_local2, "_mp" )
				if f12_local3 then
					local f12_local4 = WEAPON.GetWeaponDataForAssetRef( string.sub( f12_local2, 0, f12_local3 + 2 ) )
					if f12_local4 then
						local f12_local5 = f12_local4[0x11655952FCBAB9F]
						if not f12_local5 then
							f12_local0 = f12_local5
						end
					end
					f12_local0 = ""
				end
			end
		else
			f12_local0 = DataModel[0x614D394F6F9A18D]( f12_arg0 )
		end
		if f11_arg0.currentWeaponClass ~= f12_local0 then
			f11_arg0.currentWeaponClass = f12_local0
			local f12_local6 = BRLOOT.weaponClassData[f12_local0]
			if f12_local6 then
				f12_local6 = BRLOOT.weaponClassData[f12_local0].ammoData
			end
			if f12_local6 then
				f11_arg0.AmmoImage:setImage( RegisterMaterial( f12_local6.ammoImage ) )
				local f12_local1 = DataSources.alwaysLoaded.player.currentWeapon.isDualWielding
				local f12_local2 = DataSources.alwaysLoaded.player.currentWeapon.ammoWarningStateLeft
				local f12_local3 = DataSources.alwaysLoaded.player.currentWeapon.ammoWarningStateRight
				local f12_local4 = f12_local3:GetValue( f11_arg0 )
				local f12_local5 = f12_local2:GetValue( f11_arg0 )
				local f12_local7 = nil
				if not f12_local1:GetValue( f11_arg0 ) then
					f12_local7 = f12_local3
				end
				if f12_local5 and f12_local4 then
					if math.min( f12_local5, f12_local4 ) == f12_local5 and not f12_local2 then
						f12_local7 = f12_local2
					else
						f12_local7 = f12_local3
					end
				end
				if f12_local7 then
					f11_arg0:SetAmmoCountDS( f12_local7:GetModel( f11_arg0 ), f11_arg0 )
				end
			else
				f11_arg0:ClearAmmoCountDS()
				ACTIONS.AnimateSequence( f11_arg0, "NoWeapon" )
			end
		end
	end
	
	f11_arg0:ClearAmmoStatusDS()
	f11_arg0._statusSub = f11_arg0:SubscribeToModel( f11_arg1, f11_local0 )
end

local f0_local3 = function ( f9_arg0, f9_arg1, f9_arg2 )
	local f9_local0 = function ( f10_arg0 )
		local f10_local0 = DataModel[0x614D394F6F9A18D]( f10_arg0 )
		local f10_local1 = "NoAmmo"
		if f10_local0 == AmmoWarningState.OK then
			if 0 < DataSources.alwaysLoaded.player.currentWeapon.ammoNotInClip:GetValue( f9_arg0 ) then
				f10_local1 = "HasAmmo"
			end
		elseif f10_local0 ~= AmmoWarningState.NO_AMMO then
			f10_local1 = "HasAmmo"
		end
		ACTIONS.AnimateSequence( f9_arg0, f10_local1 )
	end
	
	f9_arg0:ClearAmmoCountDS()
	f9_arg0._countSub = f9_arg0:SubscribeToModel( f9_arg1, f9_local0 )
end

local f0_local4 = function ( f8_arg0, f8_arg1, f8_arg2 )
	f8_arg0.ClearAmmoCountDS = f0_local0
	f8_arg0.ClearAmmoStatusDS = f0_local0
	f8_arg0.SetAmmoCountDS = f0_local0
	f8_arg0.SetAmmoStatusDS = f0_local0
end

States = {
	[0xAD14C6E7156B923] = function ( f2_arg0, f2_arg1 )
		f2_arg0.AmmoImage:RegisterAnimationSequence( "DefaultSequence", {
			{
				duration = 0,
				property = TWEEN_PROPERTY.RGB,
				value = SWATCHES.HUD.bradleyAmmo
			},
			{
				value = 0,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
		local f2_local0 = function ( f7_arg0, f7_arg1 )
			f7_arg0.AmmoImage:AnimateSequence( "DefaultSequence" )
		end
		
		f2_arg0.AmmoImage:RegisterAnimationSequence( "HasAmmo", {
			{
				duration = 0,
				property = TWEEN_PROPERTY.RGB,
				value = SWATCHES.HUD.HUDMain
			},
			{
				value = 1,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
		local f2_local1 = function ( f6_arg0, f6_arg1 )
			f6_arg0.AmmoImage:AnimateSequence( "HasAmmo" )
		end
		
		f2_arg0.AmmoImage:RegisterAnimationSequence( "NoAmmo", {
			{
				duration = 0,
				property = TWEEN_PROPERTY.RGB,
				value = SWATCHES.HUD.warning
			},
			{
				value = 1,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
		local f2_local2 = function ( f5_arg0, f5_arg1 )
			f5_arg0.AmmoImage:AnimateSequence( "NoAmmo" )
		end
		
		f2_arg0.AmmoImage:RegisterAnimationSequence( "NoWeapon", {
			{
				value = 0,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
		local f2_local3 = function ( f4_arg0, f4_arg1 )
			f4_arg0.AmmoImage:AnimateSequence( "NoWeapon" )
		end
		
		f2_arg0.AmmoImage:RegisterAnimationSequence( "MaxAmmo", {
			{
				duration = 0,
				property = TWEEN_PROPERTY.RGB,
				value = SWATCHES.HUD.overcharged
			},
			{
				value = 1,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
		f2_arg0._sequences = {
			DefaultSequence = f2_local0,
			HasAmmo = f2_local1,
			NoAmmo = f2_local2,
			NoWeapon = f2_local3,
			MaxAmmo = function ( f3_arg0, f3_arg1 )
				f3_arg0.AmmoImage:AnimateSequence( "MaxAmmo" )
			end
		}
		f2_arg0._sequenceLengths = {
			HasAmmo = 0,
			MaxAmmo = 0,
			NoWeapon = 0,
			NoAmmo = 0,
			DefaultSequence = 0
		}
	end
}
function BRAmmoTypeNoCount( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 64 * _1080p, 0, 64 * _1080p )
	self.id = "BRAmmoTypeNoCount"
	self.__states = States
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local AmmoImage = nil
	
	AmmoImage = LUI.UIImage.new()
	AmmoImage.id = "AmmoImage"
	AmmoImage:setImage( RegisterMaterial( 0x37F30E01A30644E ), 0 )
	AmmoImage:SetAnchorsAndPosition( 0, 0, 0, 0, _1080p * 2, _1080p * -2, _1080p * 2, _1080p * -2 )
	self:addElement( AmmoImage )
	self.AmmoImage = AmmoImage
	
	f0_local0( self, f1_local1, controller )
	ACTIONS.AnimateSequence( self, "DefaultSequence" )
	return self
end

MenuBuilder.registerType( "BRAmmoTypeNoCount", BRAmmoTypeNoCount )
LockTable( _M )
