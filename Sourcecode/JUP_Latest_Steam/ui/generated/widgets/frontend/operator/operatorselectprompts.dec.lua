-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.unlockcount" )
local f0_local0 = 16
local f0_local1 = 2
local f0_local2 = function ( f12_arg0 )
	for f12_local0 = 1, #f12_arg0._pooledPrompts, 1 do
		if not f12_arg0._pooledPrompts[f12_local0].isUsed then
			local f12_local3 = f12_arg0._pooledPrompts[f12_local0].widget
			f12_arg0._pooledPrompts[f12_local0].isUsed = true
			f12_arg0.Prompts:addElement( f12_local3 )
			return f12_local3
		end
	end
	local f12_local0 = MenuBuilder.BuildRegisteredType( "MenuButtonPrompt", {
		controllerIndex = f12_arg0._controllerIndex
	} )
	f12_local0.id = "Prompt_" .. #f12_arg0._pooledPrompts
	f12_local0:SetAnchorsAndPosition( 0, 1, 0.5, 0.5, 0, 0, -16, 16 )
	f12_arg0.Prompts:addElement( f12_local0 )
	table.insert( f12_arg0._pooledPrompts, {
		isUsed = true,
		widget = f12_local0
	} )
	return f12_local0
end

local f0_local3 = function ( f11_arg0, f11_arg1 )
	local f11_local0 = -1
	for f11_local1 = 1, #f11_arg0._pooledPrompts, 1 do
		if f11_arg0._pooledPrompts[f11_local1].widget.id == f11_arg1.id then
			f11_local0 = f11_local1
			break
		end
	end
	if f11_local0 ~= -1 then
		f11_arg0._pooledPrompts[f11_local0].isUsed = false
		f11_arg0.Prompts:RemoveElement( f11_arg1 )
		f11_arg1:ClearPromptHandlers()
		f11_arg1:HideAndDisablePrompt()
	end
end

local f0_local4 = function ( f10_arg0, f10_arg1, f10_arg2, f10_arg3 )
	f10_arg0._menu = f10_arg0:getParent()
	if f10_arg0._availablePrompts and 0 < #f10_arg0._availablePrompts then
		for f10_local0 = 1, #f10_arg0._availablePrompts, 1 do
			f0_local0( f10_arg0, f10_arg0._availablePrompts[f10_local0].widget )
		end
	end
	f10_arg0._availablePrompts = {}
	if f10_arg3 then
		if f10_arg2 == LOOT.itemTypes.OPERATOR then
			local f10_local0 = f10_arg1.ref
			if CONDITIONS.IsPerpetualInventoryEnabled() then
				if not f10_arg0._menu._forShowcase and OPERATOR.IsUnlocked( f10_arg0._controllerIndex, f10_local0 ) then
					if not CONDITIONS.IsDMZOrOutbreak() or CONDITIONS.IsDMZOrOutbreak() and DMZ.IsOperatorEquippedToAnyPersistentOperatorSlot( f10_arg0._controllerIndex, f10_arg1.ref ) < 0 then
						table.insert( f10_arg0._availablePrompts, f10_arg0._promptData.CUSTOMIZE )
					end
					table.insert( f10_arg0._availablePrompts, f10_arg0._promptData.EXECUTION )
					local f10_local1 = false
					if CONDITIONS.IsOutbreakGametype() then
						f10_local1 = -1 < DMZ.IsOperatorEquippedToAnyPersistentOperatorSlot( f10_arg0._controllerIndex, f10_arg1.ref )
					elseif not CONDITIONS.IsMagmaGameMode() then
						f10_local1 = OPERATOR.IsEquipped( f10_arg0._controllerIndex, f10_arg1 )
					else
						f10_local1 = OPERATOR.GetSoloOperatorSelectEquippedOperatorRef( f10_arg0._controllerIndex, f10_arg0._menu._forShowcase ) == f10_local0
					end
					local f10_local2
					if f10_local1 then
						f10_local2 = f10_arg0._promptData.EQUIPPED
						if not f10_local2 then
						
						else
							table.insert( f10_arg0._availablePrompts, f10_local2 )
						end
					end
					f10_local2 = f10_arg0._promptData.EQUIP
				end
			elseif not f10_arg0._menu._forShowcase and CONDITIONS.IsOperatorCustomizationEnabled() and OPERATOR.IsOperatorSubMenuAvailable( f10_arg0._menu, f10_arg0._controllerIndex, OPERATOR.CustomizationMenuRef ) and OPERATOR.OperatorHasUsableLoot( f10_arg0._menu, f10_local0 ) then
				local f10_local1 = {
					LOOT.itemTypes.OPERATOR_SKIN,
					LOOT.itemTypes.QUIP,
					LOOT.itemTypes.OPERATOR_EXECUTION
				}
				for f10_local2 = 1, #f10_local1, 1 do
					if 0 < #OPERATOR.GetNewLootsByOperatorAndType( f10_arg0._controllerIndex, f10_local0, f10_local1[f10_local2] ) then
						f10_arg0._promptData.EXECUTION.hasNew = true
						break
					end
				end
				table.insert( f10_arg0._availablePrompts, f10_arg0._promptData.SKINS )
				if not CONDITIONS.IsJupPublicBetaBuildEnabled() then
					table.insert( f10_arg0._availablePrompts, f10_arg0._promptData.EXECUTION )
				end
				table.insert( f10_arg0._availablePrompts, f10_arg0._promptData.EQUIP )
			end
			if OPERATOR.IsOperatorSubMenuAvailable( f10_arg0._menu, f10_arg0._controllerIndex, OPERATOR.PreviewMenuRef ) and not CONDITIONS.IsCIABuildEnabled() then
				table.insert( f10_arg0._availablePrompts, f10_arg0._promptData.PREVIEW_OPERATOR )
			end
			if OPERATOR.IsOperatorBioAvailable( f10_arg1 ) and not CONDITIONS.IsJupPublicBetaBuildEnabled() then
				table.insert( f10_arg0._availablePrompts, f10_arg0._menu.OperatorBio:IsVisible() and f10_arg0._promptData.HIDE_BIO or f10_arg0._promptData.BIO )
			elseif f10_arg0._menu.ToggleOperatorBio then
				f10_arg0._menu:ToggleOperatorBio( false )
			else
				f10_arg0._menu.OperatorBio:SetVisible( false )
				f10_arg0._menu.OperatorBio.MouseButtonArea:Deactivate()
			end
		elseif f10_arg2 == LOOT.itemTypes.OPERATOR_SKIN then
			table.insert( f10_arg0._availablePrompts, f10_arg0._promptData.ROTATE_OPERATOR )
		elseif f10_arg2 == LOOT.itemTypes.OPERATOR_TAUNT then
			table.insert( f10_arg0._availablePrompts, f10_arg0._promptData.PREVIEW_ITEM )
		end
	end
	local f10_local0 = f10_arg0.UnlockCount:GetWidgetSize() + f0_local0
	local f10_local1 = f10_local0
	for f10_local2 = 1, #f10_arg0._availablePrompts, 1 do
		local f10_local5 = f0_local0( f10_arg0 )
		f10_local5:SetupPrompt( f10_arg0._availablePrompts[f10_local2] )
		f10_arg0._availablePrompts[f10_local2].widget = f10_local5
		f10_local1 = f10_local1 + f10_local5:GetPromptWidth() + f0_local0
	end
	local f10_local2 = f10_arg0:GetAnchorsAndPosition()
	local f10_local4 = f10_local2.right - f10_local2.left - f10_local1
	f10_arg0.Connector:SetLeft( f10_local0 )
	f10_arg0.Connector:SetRight( f10_local0 + f10_local4 )
	f10_arg0.Prompts:SetLeft( f10_local0 + f10_local4 + f0_local0 )
end

local f0_local5 = function ( f9_arg0, f9_arg1 )
	local f9_local0 = ACTIONS.AnimateSequence
	local f9_local1 = f9_arg0
	local f9_local2
	if f9_arg1 then
		f9_local2 = "Active"
	else
		f9_local2 = "Inactive"
	end
	f9_local0( f9_local1, f9_local2 )
	if f9_arg0.UnlockCount then
		f9_local0 = ACTIONS.AnimateSequence
		f9_local1 = f9_arg0.UnlockCount
		if f9_arg1 then
			f9_local2 = "Active"
		else
			f9_local2 = "Inactive"
		end
		f9_local0( f9_local1, f9_local2 )
	end
end

local f0_local6 = function ( f8_arg0 )
	if f8_arg0._menu and f8_arg0._menu.OperatorBio and f8_arg0._menu.OperatorBio:IsVisible() and f8_arg0._promptData.HIDE_BIO then
		f8_arg0._promptData.HIDE_BIO.action()
	end
end

local f0_local7 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.SetupPrompts = f0_local0
	f2_arg0.SetActive = f0_local0
	f2_arg0.HideBio = f0_local0
	f2_arg0._controllerIndex = f2_arg1
	f2_arg0._pooledPrompts = {}
	local f2_local0 = function ( f7_arg0, f7_arg1 )
		if f7_arg0 and f7_arg1 and f2_arg0._menu and f2_arg0._menu.operatorInfo then
			local f7_local0 = OPERATOR.GetSelectSound( f2_arg0._menu.operatorInfo.ref )
			if not String.IsNilOrEmpty( f7_local0 ) then
				if f7_arg1.name == "button_action" then
					Engine[0xC4146BA76D0F982]( f7_local0 )
				elseif f7_arg1.name == "gamepad_button" then
					f7_arg0:setActionSFX( f7_local0 )
				end
			end
		end
		OPERATOR.OpenCustomizeSubMenu( f2_arg0, f2_arg0._menu, {
			useLastSelectedOperator = true,
			shouldCreateSkinGrid = true
		} )
	end
	
	f2_arg0._promptData = {
		CUSTOMIZE = {
			text = 0x51511087A1E6608,
			buttonPrompt = ButtonMap.button_primary,
			action = f2_local0,
			actionSFX = SOUND_SETS.default.action
		},
		EQUIPPED = {
			animState = 0x35F3A3E30C35450,
			text = 0x3FDB70668AFDB5E,
			promptUseIcon = true,
			buttonPrompt = {
				ui_button = "icon_generic_checkmark"
			}
		},
		EQUIP = {
			text = 0xCA07A93FADF9E95,
			buttonPrompt = ButtonMap.button_alt1,
			action = function ()
				if f2_arg0._menu.UpdateOperatorEquipped then
					f2_arg0._menu:UpdateOperatorEquipped( f2_arg0._menu.OperatorGrid:GetFocusPositionIndex() )
				else
					OPERATOR.SetEquippedOperatorRef( f2_arg0._controllerIndex, f2_arg0._menu.operatorInfo.superfaction, f2_arg0._menu.operatorInfo.ref )
				end
				if f2_arg0._menu.OnOperatorEquipped then
					f2_arg0._menu:OnOperatorEquipped()
				end
				f2_arg0:SetupPrompts( f2_arg0._menu.operatorInfo, LOOT.itemTypes.OPERATOR, OPERATOR.IsUnlocked( f2_arg0._controllerIndex, f2_arg0._menu.operatorInfo.ref ) )
			end,
			actionSFX = SOUND_SETS.default.action
		},
		SKINS = {
			text = "LUA_MENU/SKINS",
			buttonPrompt = ButtonMap.button_primary,
			action = f2_local0,
			actionSFX = SOUND_SETS.default.action
		},
		PREVIEW_OPERATOR = {
			text = "LUA_MENU/PREVIEW",
			buttonPrompt = ButtonMap.button_l3,
			action = function ()
				OPERATOR.OpenPreviewSubMenu( f2_arg0, f2_arg0._menu )
			end,
			actionSFX = SOUND_SETS.default.action
		},
		BIO = {
			text = "OPERATORS/OPERATOR_BIO",
			buttonPrompt = ButtonMap.button_select,
			action = function ()
				if f2_arg0._menu.ToggleOperatorBio then
					f2_arg0._menu:ToggleOperatorBio( true )
				else
					f2_arg0._menu.OperatorBio:SetVisible( true )
					f2_arg0._menu.OperatorBio.MouseButtonArea:Activate()
				end
				if f2_arg0._menu.OperatorGearInformation then
					f2_arg0._menu.OperatorGearInformation:SetVisible( false )
				end
				f2_arg0:SetupPrompts( f2_arg0._menu.operatorInfo, LOOT.itemTypes.OPERATOR, OPERATOR.IsUnlocked( f2_arg0._controllerIndex, f2_arg0._menu.operatorInfo.ref ) )
			end,
			actionSFX = SOUND_SETS.default.popup
		},
		HIDE_BIO = {
			text = "OPERATORS/OPERATOR_HIDE_BIO",
			buttonPrompt = ButtonMap.button_select,
			action = function ()
				if f2_arg0._menu.ToggleOperatorBio then
					f2_arg0._menu:ToggleOperatorBio( false )
				else
					f2_arg0._menu.OperatorBio:SetVisible( false )
					f2_arg0._menu.OperatorBio.MouseButtonArea:Deactivate()
				end
				if f2_arg0._menu.OperatorGearInformation then
					f2_arg0._menu.OperatorGearInformation:SetVisible( true )
				end
				f2_arg0:SetupPrompts( f2_arg0._menu.operatorInfo, LOOT.itemTypes.OPERATOR, OPERATOR.IsUnlocked( f2_arg0._controllerIndex, f2_arg0._menu.operatorInfo.ref ) )
			end
		},
		ROTATE_OPERATOR = {
			kbmPrompt = "icn_mouse_leftclick_rotate",
			kbmPromptUseIcon = "true",
			text = "LUA_MENU/ROTATE",
			buttonPrompt = ButtonMap.button_right_stick
		},
		PREVIEW_ITEM = {
			text = "LUA_MENU/PREVIEW",
			buttonPrompt = ButtonMap.button_alt1
		}
	}
	f2_arg0.Prompts:SetSpacing( f0_local0 )
end

function OperatorSelectPrompts( f1_arg0, f1_arg1 )
	local f1_local0 = LUI
	local f1_local1 = MenuBuilder
	local f1_local2 = f1_local0.UIElement.new()
	f1_local2:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 776, 0, 32 )
	f1_local2.id = "OperatorSelectPrompts"
	local f1_local3
	if f1_arg1 then
		f1_local3 = f1_arg1
	else
		f1_local3 = f1_arg1.controllerIndex
	end
	f1_local3 = f1_local0.ValidateControllerIndex( f1_local2, f1_local3 )
	local f1_local4 = nil
	f1_local4 = f1_local0.UIHorizontalList.new( {
		controller = f1_local3,
		direction = f1_local0.DIRECTION.horizontal,
		horizontalAlignment = f1_local0.Alignment.Left
	} )
	f1_local4[0x8B72E07B55C3AC0] = "Prompts"
	f1_local4:SetAnchorsAndPosition( 0, 1, 0.5, 0.5, 378, 776, -16, 16 )
	f1_local2:addElement( f1_local4 )
	f1_local2[0x66147563DF41A98] = f1_local4
	local f1_local5 = nil
	f1_local5 = f1_local1.BuildRegisteredType( 0x28D1614C4D4CFE4, {
		controllerIndex = f1_local3
	} )
	f1_local5[0x8B72E07B55C3AC0] = "UnlockCount"
	f1_local5:SetAnchorsAndPosition( 0, 1, 0.5, 0.5, 7, 107, -15, 17 )
	f1_local2:addElement( f1_local5 )
	f1_local2[0x28D1614C4D4CFE4] = f1_local5
	local f1_local6 = nil
	f1_local6 = f1_local0.UIImage.new()
	f1_local6[0x8B72E07B55C3AC0] = "Connector"
	f1_local6:SetRGB( SWATCHES[0xEAF2060ABE5269B][0x25ECBAC112DDB60], 0 )
	f1_local6:SetAlpha( 0.3, 0 )
	f1_local6:SetScale( -2, 0 )
	f1_local6:setImage( RegisterMaterial( 0xBF4A9614FEFEA76 ), 0 )
	f1_local6:SetBlendMode( BLEND_MODE.addWithAlpha )
	f1_local6:SetAnchorsAndPosition( 0, 1, 0.5, 0.5, 102, 362, -1, 1 )
	f1_local2:addElement( f1_local6 )
	f1_local2[0x3B269441091B70] = f1_local6
	f0_local0( f1_local2, f1_local3, f1_arg1 )
	return f1_local2
end

MenuBuilder.registerType( 0xBEC25A728E3C448, OperatorSelectPrompts )
LockTable( _M )
