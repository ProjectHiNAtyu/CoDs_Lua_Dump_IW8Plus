-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:51
module( ..., package.seeall )
local f0_local0 = 3000
local f0_local1 = true
local f0_local2 = function ( f79_arg0, f79_arg1, f79_arg2 )
	local f79_local0 = {}
	local f79_local1 = f79_arg2.items[1] or {}
	local f79_local2 = nil
	if f79_arg2.isFirstPartyCategory then
		local f79_local3 = {
			name = "MENU/FETCHING_STORE_DATA",
			isPlaceholder = true
		}
		local f79_local4
		if CONDITIONS.IsMagmaGameMode() then
			f79_local4 = "wz_store_billboard_placeholder"
		else
			f79_local4 = "mw_store_billboard_placeholder"
		end
		f79_local3.asset = f79_local4
		f79_local3.buttonAction = function ( f80_arg0, f80_arg1 )
			if f79_arg0._catalogStatus ~= nil and f79_arg0._catalogStatus ~= InGameStoreCatalogStatus.READY then
				LUI.FlowManager.RequestPopupMenu( nil, "generic_error_popup", false, nil, false, {
					message = f79_arg0._catalogFetchErrorMessage
				}, nil, false, true )
			end
		end
		
		table.insert( f79_local0, f79_local3 )
	elseif f79_arg2.idPubVar and f79_local1.layoutOnlyItem then
		local f79_local3 = STORE.GetCategoryItemIDs( f79_arg1, f79_arg2 )
		if f79_arg2.justForYou and f79_arg0._recommendations then
			f79_arg0.recommendationData = {
				items = f79_arg0._recommendations,
				isEnabled = true
			}
		end
		local f79_local4 = 0
		f79_arg2.hasFirstPartyBundle = false
		for f79_local5 = 1, #f79_local3, 1 do
			local f79_local8 = f79_local3[f79_local5]
			local f79_local9 = STORE.BundleAvailable( f79_arg1, f79_local8 )
			local f79_local10 = StringTable.BJJBBCJGEJ( CSV.bundleIDs.file, CSV.bundleIDs.cols.id, f79_local8 )
			local f79_local11 = 0 <= f79_local10
			if f79_local9 and not f79_local11 then
				DebugPrint( "Error: Bundle ID not found in " .. CSV.bundleIDs.file .. ": " .. f79_local8 )
			end
			if f79_local9 and f79_local11 then
				local f79_local12 = LUI.DeepCopy( f79_local1 )
				f79_local12.emptyCategory = false
				f79_local12.id = f79_local8
				local f79_local13 = CSV.ReadRow( {
					file = CSV.bundleIDs.file,
					cols = CSV.bundleIDs.cols
				}, f79_local10 )
				local f79_local14 = Dvar.IBEGCHEFE( "NPQPKPKRTL" )
				f79_local12.name = f79_local13.name
				f79_local12.asset = f79_local13.image
				f79_local12.description = STORE.GetBundleDescription( f79_local12.id, f79_arg0._totalCP )
				f79_local12.rarity = f79_local13.rarity
				f79_local12.bundleType = f79_local13.bundleType
				f79_local12.titleImage = f79_local13.titleImage
				f79_local12.currencyID = tonumber( f79_local13.currencyID )
				f79_local12.currencyAmount = tonumber( f79_local13.currencyAmount )
				local f79_local15
				if f79_local13.discountPercent ~= "" then
					f79_local15 = f79_local13.discountPercent
				else
					f79_local15 = false
				end
				f79_local12.discountPercent = f79_local15
				if 0 < #f79_local13.firstPartyProductID then
					f79_local15 = f79_local13.firstPartyProductID
					if not f79_local15 then
					
					else
						f79_local12.firstPartyProductID = f79_local15
						if f79_local13.purchaseEnd == "" or not f79_local13.purchaseEnd then
							if STORE.IsItemOnSale( f79_local12.id ) then
								local f79_local16 = STORE.GetSaleTimer()
								local f79_local17 = STORE.GetSaleTimer()
							end
							local f79_local18 = nil
						end
						f79_local12.purchaseEnd = f79_local16 and f79_local17 or f79_local18
						f79_local12.gameSourceID = f79_local13.game
						f79_local15 = f79_local13.hasOperatorMissions and tonumber( f79_local13.hasOperatorMissions ) or 0
						local f79_local19 = f79_local15 == 1
						f79_local12.hasOperatorMissions = f79_local15
						if f79_local2 then
							if f79_local2 ~= f79_local12.gameSourceID then
								f79_local2 = "mixed"
							end
						else
							f79_local2 = f79_local12.gameSourceID
						end
						if not f79_local14 then
							f79_local12.purchaseEnd = nil
						end
						if f79_local12.purchaseEnd and STORE.SeasonTimestampMapping[f79_local12.purchaseEnd] then
							f79_local12.purchaseEnd = STORE.SeasonTimestampMapping[f79_local12.purchaseEnd]
						end
						if f79_local8 == tonumber( BATTLEPASS.GetTierSkipGiftID() ) and BATTLEPASS.IsTierSkipGiftActive( f79_arg1 ) then
							f79_local12.purchaseEnd = BATTLEPASS.GetTierSkipGiftTimer()
						end
						local f79_local15, f79_local20, f79_local21 = STORE.GetCategoryTimeLeft( nil, f79_local12.purchaseEnd )
						if not f79_local12.purchaseEnd or 0 < f79_local15 then
							table.insert( f79_local0, f79_local12 )
							f79_local4 = f79_local4 + 1
						end
						if f79_local12.firstPartyProductID then
							f79_arg2.hasFirstPartyBundle = true
						end
					end
				end
				f79_local15 = nil
			end
			if f79_local4 == f79_arg2.numItemsShown then
				break
			end
		end
	end
	if #f79_local0 == 0 then
		local f79_local3 = LUI.DeepCopy( f79_local1 )
		f79_local3.emptyCategory = true
		f79_local3.titleImage = nil
		f79_local3.purchaseEnd = nil
		local f79_local4
		if CONDITIONS.IsMagmaGameMode() then
			f79_local4 = "wz_store_billboard_placeholder"
		else
			f79_local4 = "mw_store_billboard_placeholder"
		end
		f79_local3.asset = f79_local4
		f79_local3.name = "LUA_MENU/EMPTY"
		table.insert( f79_local0, f79_local3 )
	end
	f79_arg2.rowGameSourceIDOrMixed = f79_local2
	f79_arg2.items = f79_local0
end

local f0_local3 = function ( f78_arg0 )
	if f78_arg0._allCategoryData == nil then
		return 
	end
	local f78_local0 = nil
	for f78_local1 = 1, #f78_arg0._allCategoryData, 1 do
		if f78_arg0._allCategoryData[f78_local1].id == "cortez_preorder" then
			f78_arg0._allCategoryData[f78_local1].categoryIndex = 1
		end
	end
	f78_arg0._allCategoryData = {
		f78_local0
	}
end

local f0_local4 = function ( f77_arg0, f77_arg1 )
	LUI.FlowManager.RequestPopupMenu( f77_arg0, "CreatorCodePopup", true, controllerIndex, false, {
		controllerIndex = f77_arg1
	} )
	Engine.BJDBIAGIDA( SOUND_SETS.default.selectAlt )
end

local f0_local5 = function ( f76_arg0, f76_arg1, f76_arg2, f76_arg3 )
	local f76_local0, f76_local1 = STORE.GetIndexForBundle( f76_arg1, f76_arg0._controllerIndex )
	if f76_local0 and f76_local1 and f76_arg0.BundlesGrid then
		local f76_local2 = f76_arg0._allCategoryData[f76_local0]
		local f76_local3 = LUI.FlowManager.GetPerControllerPersistentData( f76_arg0._controllerIndex )
		f76_arg0._selectedCategory = f76_local0
		f76_local3._selectedCategory = f76_local2.categoryIndex
		f76_arg0._selectedBundle = f76_local1
		f76_arg0.BundlesGrid:SetFocusedPosition( {
			x = 0,
			y = f76_local0 - 1
		}, true )
		local f76_local4 = LUI.FlowManager.GetScopedData( f76_arg0 )
		f76_local4.focusForGifting = f76_arg3
		f76_arg0:BillboardCategoryButtonAction( element, event, f76_local2 )
		f76_local4.focusForGifting = nil
	else
		if f76_arg3 and STORE.IsBundleOwned( f76_arg0._controllerIndex, f76_arg1 ) then
			LUI.FlowManager.RequestAddMenu( "BundleLockerMenu", true, f76_arg0._controllerIndex, false, {
				bundleIdForGifting = f76_arg1
			} )
			return 
		end
		LUI.FlowManager.RequestPopupMenu( f76_arg0, "PopupOK", true, f76_arg0._controllerIndex, false, {
			message = Engine.CBBHFCGDIC( "LUA_MENU/BUNDLE_NOT_AVAILABLE" )
		} )
	end
end

local f0_local6 = function ( f75_arg0, f75_arg1 )
	local f75_local0 = STORE.GetCategoryIndex( f75_arg0._controllerIndex, f75_arg1 )
	if f75_local0 and f75_arg0.BundlesGrid then
		local f75_local1 = f75_arg0._allCategoryData[f75_local0]
		local f75_local2 = LUI.FlowManager.GetPerControllerPersistentData( f75_arg0._controllerIndex )
		f75_arg0._selectedCategory = f75_local0
		f75_local2._selectedCategory = f75_local1.categoryIndex
		f75_arg0.BundlesGrid:SetFocusedPosition( {
			x = 0,
			y = f75_local0 - 1
		}, true )
	end
end

local f0_local7 = function ( f74_arg0, f74_arg1, f74_arg2, f74_arg3 )
	local f74_local0 = f74_arg0._selectedBundle or 1
	local f74_local1 = f74_arg3.items[f74_local0]
	local f74_local2 = f74_local1.id
	if f74_local1.emptyCategory then
		f74_arg0._startPurchaseImmediately = false
		return 
	end
	local f74_local3 = LUI.FlowManager.GetScopedData( f74_arg0 )
	f74_local3.selectedBundleIndex = f74_local0
	if f74_arg3.isFirstPartyCategory then
		f74_local3.firstPartyColumnIndex = f74_local0
		if f74_local1.buttonAction then
			f74_arg0._startPurchaseImmediately = false
			f74_local1.buttonAction( f74_arg1, f74_arg2 )
			return 
		end
	else
		f74_local3.firstPartyColumnIndex = nil
	end
	if not f74_arg0._storeEnterComplete then
		QUARTERMASTER.RecordStoreEnterEvent( f74_arg0._controllerIndex, f74_arg0._storeLayout, f74_arg0.recommendationData, f74_arg0._sourceMenu, f74_arg0._allCategoryData )
		QUARTERMASTER.BeginMenuBrowseEvent( f74_arg0._controllerIndex, f74_arg3, f74_arg3.items[1], f74_arg0._storeLayout, f74_arg0.recommendationData )
		f74_arg0._storeEnterComplete = true
	end
	QUARTERMASTER.RecordMenuBrowseEvent( f74_arg0._controllerIndex, true )
	STORE.MarkItemSeen( f74_arg0._controllerIndex, f74_local2 )
	f74_arg0.BundlesGrid:RefreshContent()
	if f74_local1.firstPartyProductID then
		local f74_local4 = f74_local1.firstPartyProductID
		if STORE.IsGameUpsellBundle( f74_local2 ) then
			LUI.FlowManager.RequestPopupMenu( f74_arg0, "StoreGameUpsellPopup", true, f74_arg0._controllerIndex, false, {
				defaultProductId = f74_local4
			} )
		elseif STORE.IsZeusBundle( f74_local2 ) then
			LUI.FlowManager.RequestPopupMenu( f74_arg0, "StoreGameUpsellPopup", true, f74_arg0._controllerIndex, false, {
				isZeus = true,
				defaultProductId = f74_local4
			} )
		elseif STORE.IsVanguardBundle( f74_local2 ) then
			LUI.FlowManager.RequestPopupMenu( f74_arg0, "VGPreOrderPopup", true, f74_arg0._controllerIndex, false, {
				allowWeaponPreview = true,
				defaultProductId = f74_local4
			} )
		elseif STORE.IsCortezBundle( f74_local2 ) then
			LUI.FlowManager.RequestPopupMenu( f74_arg0, "CortezPreorderPopup", true, f74_arg0._controllerIndex, false, {
				defaultProductId = f74_local4,
				cortezEntryPointMenu = STORE.CortezEntryPointMenu.FirstPartyBundle
			} )
		elseif f74_arg0._catalogStatus == InGameStoreCatalogStatus.READY then
			if 0 < STORE.GetNumItemsInBundle( f74_local2 ) then
				local f74_local5 = STORE.GetFirstPartyBundleData( f74_arg0._controllerIndex, f74_local2, f74_local4 )
				f74_local5.bundleIndex = f74_local0
				f74_local5.openGiftingPopup = f74_local3.focusForGifting
				LUI.FlowManager.RequestAddMenu( "StoreBundlePreview", true, f74_arg0._controllerIndex, false, f74_local5 )
			else
				InGameStore.SelectProduct( f74_arg0._controllerIndex, f74_local4, InGameStorePurchaseType.BROWSE )
			end
		else
			LUI.FlowManager.RequestPopupMenu( nil, "generic_error_popup", false, nil, false, {
				message = f74_arg0._catalogFetchErrorMessage
			}, nil, false, true )
		end
		return 
	end
	local f74_local4 = {
		bundleID = f74_local1.id,
		rarity = f74_local1.rarity,
		description = f74_local1.description,
		bundleType = f74_local1.bundleType,
		titleImage = f74_local1.titleImage,
		currencyID = f74_local1.currencyID,
		currencyAmount = f74_local1.currencyAmount,
		startPurchaseImmediately = f74_arg0._startPurchaseImmediately,
		timerValue = f74_local1.purchaseEnd,
		bundleIndex = f74_local0,
		positionInGrid = f74_arg0._positionInGrid,
		categoryIndex = f74_arg3.categoryIndex,
		categoryName = f74_arg3.id,
		storeLayout = f74_arg0._storeLayout,
		sourceMenu = f74_arg0._sourceMenu,
		recommendationData = f74_arg0.recommendationData,
		openGiftingPopup = f74_local3.focusForGifting
	}
	f74_arg0._startPurchaseImmediately = false
	if not f74_arg3.justForYou then
		f74_local4.timerPubVar = f74_arg3.timerPubVar
	end
	if Dvar.IBEGCHEFE( "SKLSORKTK" ) and not BATTLEPASS.IsOwned( f74_arg0._controllerIndex ) and STORE.BundleContainsBattlePass( f74_local1.id ) then
		LUI.FlowManager.RequestAddMenu( "BattlePassMenuPopup", true, f74_arg0._controllerIndex, false, {
			purchaseBattlePassInStore = true
		} )
	else
		LUI.FlowManager.RequestAddMenu( "StoreBundlePreview", true, f74_arg0._controllerIndex, false, f74_local4 )
	end
end

local f0_local8 = function ( f72_arg0, f72_arg1, f72_arg2 )
	local f72_local0 = nil
	local f72_local1 = InGameStore.GetProduct( f72_arg1, f72_arg2 )
	if f72_local1 ~= nil and f72_local1.status == InGameStoreProductStatus.NOT_OWNED then
		local f72_local2 = StringTable.DIFCHIGDFB( CSV.bundleIDs.file, CSV.bundleIDs.cols.firstPartyProductID, f72_local1.productId, CSV.bundleIDs.cols.image )
		local f72_local3 = StringTable.DIFCHIGDFB( CSV.bundleIDs.file, CSV.bundleIDs.cols.firstPartyProductID, f72_local1.productId, CSV.bundleIDs.cols.titleImage )
		if #f72_local2 == 0 or #f72_local3 == 0 then
			local f72_local4 = f72_local1.productId
			local f72_local5
			if Engine.CIEGIACHAE() then
				f72_local5 = "_ps4"
			elseif Engine.BAHIIBFDDG() then
				f72_local5 = "_xb3"
			else
				f72_local5 = "_pc"
			end
			f72_local4 = f72_local4 .. f72_local5
			f72_local2 = StringTable.DIFCHIGDFB( CSV.bundleIDs.file, CSV.bundleIDs.cols.firstPartyProductID, f72_local4, CSV.bundleIDs.cols.image )
			f72_local3 = StringTable.DIFCHIGDFB( CSV.bundleIDs.file, CSV.bundleIDs.cols.firstPartyProductID, f72_local4, CSV.bundleIDs.cols.titleImage )
		end
		if 0 < #f72_local2 and 0 < #f72_local3 then
			f72_local0 = {
				titleImage = f72_local3,
				asset = f72_local2,
				name = f72_local1.title,
				buttonAction = function ( f73_arg0, f73_arg1 )
					local f73_local0 = STORE.GoToStore
					local f73_local1 = f72_arg0
					local f73_local2 = f72_arg0:GetCurrentMenu()
					f73_local0( f73_local1, f73_local2.id, f73_arg0.id, f72_arg0.productId )
				end
			}
		end
	end
	return f72_local0
end

local f0_local9 = function ( f69_arg0, f69_arg1 )
	f69_arg0._allCategoryData[#f69_arg0._allCategoryData].items = {}
	local f69_local0 = InGameStore.GetCategoryProducts( f69_arg1, STORE.GetActiveCODPointsCategory() )
	table.insert( f69_arg0._allCategoryData[#f69_arg0._allCategoryData].items, {
		asset = "mw_store_billboard_cod_points",
		name = "INGAMESTORE/CATEGORY_CODPOINTS",
		titleImage = "mw_store_title_cod_points",
		buttonAction = function ( f71_arg0, f71_arg1 )
			local f71_local0 = STORE.GoToStore
			local f71_local1 = f69_arg0
			local f71_local2 = f69_arg0:GetCurrentMenu()
			f71_local0( f71_local1, f71_local2.id, f71_arg0.id, f69_arg0[1].productId )
		end
	} )
	local f69_local1 = split( Dvar.DHEEJCCJBH( "LPNPSRNSMQ" ) or "", "," )
	for f69_local2 = 1, #f69_local1, 1 do
		local f69_local5 = f0_local0( f69_arg0, f69_arg1, f69_local1[f69_local2] )
		if f69_local5 ~= nil then
			table.insert( f69_arg0._allCategoryData[#f69_arg0._allCategoryData].items, f69_local5 )
			if 4 <= #f69_arg0._allCategoryData[#f69_arg0._allCategoryData].items then
				break
			end
		end
	end
	local f69_local6 = f0_local0( f69_arg0, f69_arg1, STORE.CortezStandardID )
	if f69_local6 == nil then
		f69_local6 = f0_local0( f69_arg0, f69_arg1, STORE.VanguardStandardID )
	end
	if f69_local6 == nil then
		f69_local6 = f0_local0( f69_arg0, f69_arg1, STORE.ZeusStandardID )
	end
	if f69_local6 ~= nil then
		if #f69_arg0._allCategoryData[#f69_arg0._allCategoryData].items < 4 then
			table.insert( f69_arg0._allCategoryData[#f69_arg0._allCategoryData].items, f69_local6 )
		else
			f69_arg0._allCategoryData[#f69_arg0._allCategoryData].items[4] = f69_local6
		end
	end
	table.insert( f69_arg0._allCategoryData[#f69_arg0._allCategoryData].items, {
		asset = "mw_store_billboard_franchise_store",
		name = "MENU/STORE_CAT_FRANCHISE",
		titleImage = "mw_store_title_franchise_store",
		buttonAction = function ( f70_arg0, f70_arg1 )
			local f70_local0 = STORE.GoToStore
			local f70_local1 = f69_arg0
			local f70_local2 = f69_arg0:GetCurrentMenu()
			f70_local0( f70_local1, f70_local2.id, f70_arg0.id )
		end
	} )
	f69_arg0:dispatchEventToChildren( {
		name = "categoryTimerUpdate"
	} )
	if f69_arg0._allCategoryData[#f69_arg0._allCategoryData].isFirstPartyCategory and f69_arg0._selectedCategory == f69_arg0._allCategoryData[#f69_arg0._allCategoryData].categoryIndex then
		local f69_local2 = f69_arg0.BundlesGrid:GetElementAtPosition( 0, f69_arg0._selectedCategory - 1 )
		if f69_local2 then
			local f69_local3 = LUI.FlowManager.GetScopedData( f69_arg0 )
			local f69_local4 = f69_local2.RowGrid
			if not f69_local3.firstPartyColumnIndex or f69_local3.firstPartyColumnIndex == 1 then
				local f69_local7 = f69_local4:GetElementAtPosition( 0, 0 )
				f69_local7:processEvent( {
					name = "button_over"
				} )
			else
				f69_local4:SetFocusedPosition( {
					y = 0,
					x = f69_local3.firstPartyColumnIndex - 1
				}, true )
			end
		end
	end
end

local f0_local10 = function ( f68_arg0, f68_arg1 )
	if STORE.IsCatalogReady( f68_arg1 ) then
		return 
	elseif Dvar.IBEGCHEFE( "TNMTRNOQT" ) then
		f68_arg0._allCategoryData[STORE.GetZeusCategoryIndex()] = {
			isFirstPartyCategory = true,
			name = "INGAMESTORE/CATEGORY_ZEUS",
			placeholderCategoryID = STORE.ZeusCategoryID
		}
	end
	if Dvar.IBEGCHEFE( "online_store_x2_category_enabled" ) then
		f68_arg0._allCategoryData[STORE.GetX2CategoryIndex()] = {
			isFirstPartyCategory = true,
			name = "MENU/STORE_CAT_X2",
			placeholderCategoryID = STORE.X2CategoryID
		}
	end
	if Dvar.IBEGCHEFE( "LMMPLKNTMP" ) then
		f68_arg0._allCategoryData[STORE.GetCortezCategoryIndex()] = {
			isFirstPartyCategory = true,
			name = "STORE_FLAVOR_WZ335/CATEGORY_CORTEZ",
			placeholderCategoryID = STORE.CortezCategoryID
		}
	end
end

local f0_local11 = function ( f67_arg0, f67_arg1 )
	for f67_local0 = 1, #f67_arg0._allCategoryData, 1 do
		local f67_local3 = f67_arg0._allCategoryData[f67_local0]
		if f67_local3.placeholderCategoryID and f67_local3.placeholderCategoryID == f67_arg1 then
			table.remove( f67_arg0._allCategoryData, f67_local0 )
			return 
		end
	end
end

local f0_local12 = function ( f65_arg0, f65_arg1 )
	local f65_local0 = STORE.GetCategoryIndexWithFanchiseItems( f65_arg0._allCategoryData, STORE.ZeusCategoryID )
	local f65_local1 = f65_arg0._allCategoryData[f65_local0]
	if f65_local1 then
		f65_local1 = f65_arg0._allCategoryData[f65_local0].id
	end
	if not f65_local1 or STORE.CategoryType[f65_local1] ~= STORE.CategoryType.zeus_preorder then
		DebugPrint( "Zeus category missing from allCategoryData" )
	end
	f65_arg0._allCategoryData[f65_local0].items = STORE.GetZeusCategoryData( f65_arg1 )
	if #f65_arg0._allCategoryData[f65_local0].items == 0 then
		DebugPrint( "Zeus category contains no items" )
	end
	f65_arg0:ClearPlaceholderFromCategory( STORE.ZeusCategoryID )
	local f65_local2 = LUI.FlowManager.GetScopedData( f65_arg0 )
	for f65_local3 = 1, #f65_arg0._allCategoryData[f65_local0].items, 1 do
		f65_arg0._allCategoryData[f65_local0].items[f65_local3].buttonAction = function ( f66_arg0, f66_arg1 )
			f65_arg0.openedZeusUpsell = true
			LUI.FlowManager.RequestAddMenu( "StoreGameUpsellPopup", true, f65_arg0, false, {
				preFetched = true,
				isZeus = true,
				defaultProductId = f65_arg0._allCategoryData[f65_arg0].items[f65_arg0].productId
			}, true )
		end
		
	end
	local f65_local3 = f65_arg0._selectedCategory
	if f65_local3 then
		f65_local3 = f65_arg0._selectedCategory - f65_arg0._allCategoryData[f65_local0].categoryIndex
	end
	if f65_local3 == 1 then
		f65_arg0.BundlesGrid:RefreshContent()
	else
		f65_arg0:dispatchEventToChildren( {
			name = "categoryTimerUpdate"
		} )
	end
	if f65_arg0._allCategoryData[f65_local0].isFirstPartyCategory and f65_arg0._selectedCategory == f65_arg0._allCategoryData[f65_local0].categoryIndex then
		local f65_local4 = f65_arg0.BundlesGrid:GetElementAtPosition( 0, f65_arg0._selectedCategory - 1 )
		if f65_local4 then
			local f65_local5 = LUI.FlowManager.GetScopedData( f65_arg0 )
			local f65_local6 = f65_local4.RowGrid
			if not f65_local5.firstPartyColumnIndex or f65_local5.firstPartyColumnIndex == 1 then
				local f65_local7 = f65_local6:GetElementAtPosition( 0, 0 )
				f65_local7:processEvent( {
					name = "button_over"
				} )
			else
				f65_local6:SetFocusedPosition( {
					y = 0,
					x = f65_local5.firstPartyColumnIndex - 1
				}, true )
			end
		end
	end
end

local f0_local13 = function ( f63_arg0, f63_arg1 )
	local f63_local0 = STORE.GetCategoryIndexWithFanchiseItems( f63_arg0._allCategoryData, STORE.X2CategoryID )
	local f63_local1 = f63_arg0._allCategoryData
	local f63_local2 = f63_arg0._allCategoryData[f63_local0]
	if f63_local2 then
		f63_local2 = f63_arg0._allCategoryData[f63_local0].id
	end
	if not f63_local2 or STORE.CategoryType[f63_local2] ~= STORE.CategoryType.x2_preorder then
		DebugPrint( "X2 category missing from allCategoryData" )
	end
	f63_arg0._allCategoryData[f63_local0].items = {}
	for f63_local6, f63_local7 in ipairs( STORE.GetVanguardCategoryData( f63_arg1 ) ) do
		if not f63_local7.owned then
			table.insert( f63_arg0._allCategoryData[f63_local0].items, f63_local7 )
		end
	end
	if #f63_arg0._allCategoryData[f63_local0].items == 0 then
		DebugPrint( "Vanguard category contains no items" )
	end
	f63_arg0:ClearPlaceholderFromCategory( STORE.X2CategoryID )
	f63_local3 = LUI.FlowManager.GetScopedData( f63_arg0 )
	for f63_local4 = 1, #f63_arg0._allCategoryData[f63_local0].items, 1 do
		f63_arg0._allCategoryData[f63_local0].items[f63_local4].buttonAction = function ( f64_arg0, f64_arg1 )
			f63_arg0.openedX2Upsell = true
			local f64_local0 = f63_arg0._allCategoryData[f63_arg0].items[f63_arg0]
			if f64_local0.productId == STORE.VanguardTrialID then
				if Engine.DBFCJBDJEC() then
					STORE.GoToX2InBattleNet( f63_arg0 )
				elseif f64_local0.uri ~= nil then
					Engine.CBEBCGFAIE( f63_arg0, f64_local0.uri )
				else
					InGameStore.SelectProduct( f63_arg0, f64_local0.productId, InGameStorePurchaseType.BROWSE )
				end
			else
				LUI.FlowManager.RequestPopupMenu( f63_arg0, "VGPreOrderPopup", true, f63_arg0._controllerIndex, false, {
					allowWeaponPreview = true,
					defaultProductId = f64_local0.productId
				} )
			end
		end
		
	end
	f63_local4 = f63_arg0._selectedCategory
	if f63_local4 then
		f63_local4 = f63_arg0._selectedCategory - f63_arg0._allCategoryData[f63_local0].categoryIndex
	end
	if f63_local4 == 1 then
		f63_arg0.BundlesGrid:RefreshContent()
	else
		f63_arg0:dispatchEventToChildren( {
			name = "categoryTimerUpdate"
		} )
	end
	if f63_arg0._allCategoryData[f63_local0].isFirstPartyCategory and f63_arg0._selectedCategory == f63_arg0._allCategoryData[f63_local0].categoryIndex then
		f63_local5 = f63_arg0.BundlesGrid:GetElementAtPosition( 0, f63_arg0._selectedCategory - 1 )
		if f63_local5 then
			f63_local6 = LUI.FlowManager.GetScopedData( f63_arg0 )
			f63_local7 = f63_local5.RowGrid
			if not f63_local6.firstPartyColumnIndex or f63_local6.firstPartyColumnIndex == 1 then
				local f63_local8 = f63_local7:GetElementAtPosition( 0, 0 )
				f63_local8:processEvent( {
					name = "button_over"
				} )
			else
				f63_local7:SetFocusedPosition( {
					y = 0,
					x = f63_local6.firstPartyColumnIndex - 1
				}, true )
			end
		end
	end
end

local f0_local14 = function ( f61_arg0, f61_arg1 )
	if f61_arg0._allCategoryData == nil then
		
	else
		
	end
	local f61_local0 = STORE.GetCategoryIndexWithFanchiseItems( f61_arg0._allCategoryData, STORE.CortezCategoryID )
	local f61_local1 = f61_arg0._allCategoryData
	local f61_local2 = f61_arg0._allCategoryData[f61_local0]
	if f61_local2 then
		f61_local2 = f61_arg0._allCategoryData[f61_local0].id
	end
	if not f61_local2 or STORE.CategoryType[f61_local2] ~= STORE.CategoryType.cortez_preorder then
		DebugPrint( "Cortez category missing from allCategoryData" )
	end
	f61_arg0._allCategoryData[f61_local0].items = {}
	for f61_local6, f61_local7 in ipairs( STORE.GetCortezCategoryData( f61_arg1 ) ) do
		table.insert( f61_arg0._allCategoryData[f61_local0].items, f61_local7 )
	end
	f61_arg0:ClearPlaceholderFromCategory( STORE.CortezCategoryID )
	f61_local3 = LUI.FlowManager.GetScopedData( f61_arg0 )
	for f61_local4 = 1, #f61_arg0._allCategoryData[f61_local0].items, 1 do
		f61_arg0._allCategoryData[f61_local0].items[f61_local4].buttonAction = function ( f62_arg0, f62_arg1 )
			f61_arg0.openedCortezUpsell = true
			local f62_local0 = f61_arg0._allCategoryData[f61_arg0].items[f61_arg0]
			if f62_local0.productId == STORE.CortezTrialID then
				if Engine.DBFCJBDJEC() then
					STORE.GoToCortezInBattleNet( f61_arg0 )
				elseif f62_local0.uri ~= nil then
					Engine.CBEBCGFAIE( f61_arg0, f62_local0.uri )
				else
					InGameStore.SelectProduct( f61_arg0, f62_local0.productId, InGameStorePurchaseType.BROWSE )
				end
			else
				LUI.FlowManager.RequestPopupMenu( f61_arg0, "CortezPreOrderPopup", true, f61_arg0._controllerIndex, false, {
					allowWeaponPreview = true,
					defaultProductId = f62_local0.productId,
					cortezEntryPointMenu = STORE.CortezEntryPointMenu.InGameStore
				} )
			end
		end
		
	end
	f61_local4 = f61_arg0._selectedCategory
	if f61_local4 then
		f61_local4 = f61_arg0._selectedCategory - f61_arg0._allCategoryData[f61_local0].categoryIndex
	end
	if f61_local4 == 1 then
		f61_arg0.BundlesGrid:RefreshContent()
	else
		f61_arg0:dispatchEventToChildren( {
			name = "categoryTimerUpdate"
		} )
	end
	if f61_arg0._allCategoryData[f61_local0].isFirstPartyCategory and f61_arg0._selectedCategory == f61_arg0._allCategoryData[f61_local0].categoryIndex then
		f61_local5 = f61_arg0.BundlesGrid:GetElementAtPosition( 0, f61_arg0._selectedCategory - 1 )
		if f61_local5 then
			f61_local6 = LUI.FlowManager.GetScopedData( f61_arg0 )
			f61_local7 = f61_local5.RowGrid
			if not f61_local6.firstPartyColumnIndex or f61_local6.firstPartyColumnIndex == 1 then
				local f61_local8 = f61_local7:GetElementAtPosition( 0, 0 )
				f61_local8:processEvent( {
					name = "button_over"
				} )
			else
				f61_local7:SetFocusedPosition( {
					y = 0,
					x = f61_local6.firstPartyColumnIndex - 1
				}, true )
			end
		end
	end
end

local f0_local15 = function ( f60_arg0, f60_arg1 )
	if f60_arg0._allCategoryData == nil or #f60_arg0._allCategoryData == 0 then
		if f60_arg0._refreshEmptyTimer == nil then
			ACTIONS.AnimateSequence( f60_arg0, "EmptyStore" )
			local self = LUI.UITimer.new( {
				interval = 1000,
				event = {
					name = "refresh_timer",
					controllerIndex = f60_arg1
				}
			} )
			self.id = "refreshTimer"
			f60_arg0:addElement( self )
			f60_arg0._refreshEmptyTimer = self
		end
		return false
	elseif f60_arg0._refreshEmptyTimer ~= nil then
		f60_arg0._refreshEmptyTimer:closeTree()
		f60_arg0._refreshEmptyTimer = nil
		return true
	else
		return true
	end
end

local f0_local16 = function ( f59_arg0, f59_arg1 )
	f59_arg0._allCategoryData = STORE.GetCategoryData( f59_arg1, f59_arg0._allCategoryData )
	if CONDITIONS.IsPostSeasonAndMagma() then
		f0_local0( f59_arg0 )
	end
	f0_local0( f59_arg0, f59_arg1 )
	local f59_local0 = CONDITIONS.IsWZStoreDisabled()
	if f59_local0 then
		f59_local0 = CONDITIONS.IsMagmaGameMode()
	end
	f59_local0 = f59_local0 ~= true
	if f59_local0 then
		for f59_local1 = 1, #f59_arg0._allCategoryData, 1 do
			f59_arg0._allCategoryData[f59_local1].categoryIndex = f59_local1
		end
	else
		f0_local0( f59_arg0 )
		if f0_local0( f59_arg0, f59_arg1 ) == false then
			return 
		end
	end
	if f59_local0 then
		f0_local0( f59_arg0, f59_arg1 )
		f0_local0( f59_arg0, f59_arg1 )
		f0_local0( f59_arg0, f59_arg1 )
	end
	f0_local0( f59_arg0, f59_arg1 )
	f59_arg0.BundlesGrid:SetNumRows( f59_arg0._allCategoryData and #f59_arg0._allCategoryData or 0 )
	f59_arg0.BundlesGrid:RefreshContent()
	local f59_local1 = LUI.FlowManager.GetPerControllerPersistentData( f59_arg1 )
	if not f59_local1._hasEnteredStore and f59_arg0._allCategoryData ~= nil and 1 <= #f59_arg0._allCategoryData then
		f59_local1._hasEnteredStore = true
		local f59_local2 = f59_arg0._allCategoryData[1]
		local f59_local3 = f59_local2.items
		if f59_local3 and 0 < #f59_local3 then
			f59_arg0.BillboardItem:UpdateBillboard( f59_local3[1], f59_local2.isFirstPartyCategory )
			f59_arg0.BillboardItem:SetGiftPromtButtonActive( GIFT.IsItemGiftable( f59_local2.id ) )
			f59_arg0._selectedCategory = f59_local2.categoryIndex
			f59_local1._selectedCategory = f59_local2.categoryIndex
			f59_arg0._selectedBundle = 1
		end
	end
	f59_arg0:dispatchEventToChildren( {
		name = "categoryTimerUpdate"
	} )
end

local f0_local17 = function ( f57_arg0, f57_arg1 )
	InGameStore.FetchCatalog( f57_arg1, false, true )
	f57_arg0._catalogStatus = InGameStore.GetCatalogStatus( f57_arg1 )
	f57_arg0._catalogFetchErrorMessage = Engine.CBBHFCGDIC( "MP_FRONTEND_ONLY/STORE_UNAVAILABLE" )
	
	local _refreshTimer = LUI.UITimer.new( {
		interval = -28,
		event = {
			name = "refresh_timer",
			controllerIndex = f57_arg1
		}
	} )
	_refreshTimer.id = "refreshTimer"
	f57_arg0:addElement( _refreshTimer )
	f57_arg0._refreshTimer = _refreshTimer
	
	f57_arg0:registerEventHandler( "refresh_timer", function ( element, event )
		local f58_local0 = nil
		if Dvar.CFHDGABACF( "ui_test_getcatalogstatus" ) == 1 then
			f58_local0 = InGameStoreCatalogStatus.ERROR
		elseif Dvar.CFHDGABACF( "ui_test_getcatalogstatus" ) == 2 then
			f58_local0 = InGameStoreCatalogStatus.NOTREADY
		elseif Dvar.CFHDGABACF( "ui_test_getcatalogstatus" ) == 3 then
			f58_local0 = InGameStoreCatalogStatus.FETCHING
		else
			f58_local0 = InGameStore.GetCatalogStatus( event.controllerIndex )
		end
		local f58_local1 = false
		if f57_arg0._catalogStatus == InGameStoreCatalogStatus.FETCHING and f58_local0 == InGameStoreCatalogStatus.READY then
			f57_arg0:dispatchEventToChildren( {
				catalogFetched = true,
				name = "categoryTimerUpdate"
			} )
		end
		f57_arg0._catalogStatus = f58_local0
		if f57_arg0._catalogStatus == InGameStoreCatalogStatus.READY then
			f57_arg0( f57_arg0, f57_arg0 )
			f58_local1 = true
		elseif f57_arg0._catalogStatus == InGameStoreCatalogStatus.ERROR then
			f58_local1 = true
			if Engine.DBFCJBDJEC() then
				local f58_local2 = Engine.BIAFEJHHDD()
				if f58_local2 ~= nil then
					f57_arg0._catalogFetchErrorMessage = Engine.CBBHFCGDIC( "MP_FRONTEND_ONLY/STORE_UNAVAILABLE_ERROR", Engine.JCBDICCAH( f58_local2 ) )
					Engine.DCFIDJGACA()
				else
					f57_arg0._catalogFetchErrorMessage = Engine.CBBHFCGDIC( "MP_FRONTEND_ONLY/STORE_UNAVAILABLE_PC" )
				end
			else
				f57_arg0._catalogFetchErrorMessage = Engine.CBBHFCGDIC( "MP_FRONTEND_ONLY/STORE_UNAVAILABLE", Engine.JCBDICCAH( Engine.CIHDHDCIBE() ) )
			end
			Engine.DHCGHHBHCH()
			local f58_local2 = CONDITIONS.IsWZStoreDisabled()
			if f58_local2 then
				f58_local2 = CONDITIONS.IsMagmaGameMode()
			end
			f58_local2 = f58_local2 ~= true
			if Commerce.CCIEAECGHB() then
				if f58_local2 then
					f57_arg0( f57_arg0, f57_arg0 )
					f57_arg0( f57_arg0, f57_arg0 )
					f57_arg0( f57_arg0, f57_arg0 )
				end
				f57_arg0( f57_arg0, f57_arg0 )
			elseif CONDITIONS.IsPostSeasonAndMagma() ~= true then
				f57_arg0._allCategoryData[#f57_arg0._allCategoryData].items[1].fetchingDataFailed = true
				f57_arg0:dispatchEventToChildren( {
					name = "categoryTimerUpdate"
				} )
			else
				f57_arg0( f57_arg0, f57_arg0 )
				f57_arg0( f57_arg0 )
				f57_arg0( f57_arg0, f57_arg0 )
			end
		end
		if f58_local1 and element._refreshTimer ~= nil then
			element._refreshTimer:closeTree()
			element._refreshTimer = nil
		end
	end )
end

local f0_local18 = function ( f56_arg0 )
	local f56_local0 = {}
	local f56_local1 = "DefaultSequence"
	local f56_local2 = "DefaultSequence"
	if 1 < f56_arg0._selectedCategory then
		for f56_local3 = f56_arg0._selectedCategory - 1, 1, -1 do
			table.insert( f56_local0, f56_arg0._allCategoryData[f56_local3] )
		end
	end
	if f56_arg0._selectedCategory < #f56_arg0._allCategoryData then
		for f56_local3 = f56_arg0._selectedCategory + 1, #f56_arg0._allCategoryData, 1 do
			table.insert( f56_local0, f56_arg0._allCategoryData[f56_local3] )
		end
	end
	for f56_local3 = 1, #f56_local0, 1 do
		local f56_local6 = f56_local0[f56_local3]
		f56_local6.hasNewItems = false
		f56_local6.hasFreeItems = false
		if f0_local0 and Dvar.IBEGCHEFE( "LSOLLKOPQT" ) then
			f56_local6.hasFreeItems = STORE.CategoryHasFreeItems( f56_arg0._controllerIndex, f56_local6 )
		end
		for f56_local7 = 1, #f56_local6.items, 1 do
			local f56_local10 = f56_local6.items[f56_local7]
			if f56_local10.id and not STORE.HasSeenItem( f56_arg0._controllerIndex, f56_local10.id ) then
				f56_local6.hasNewItems = true
				break
			end
		end
		if f56_local6.categoryIndex < f56_arg0._selectedCategory then
			if f56_local6.hasFreeItems then
				f56_local1 = "Free"
			end
			if f56_local1 ~= "Free" and f56_local6.hasNewItems then
				f56_local1 = "New"
			end
		end
		if f56_arg0._selectedCategory < f56_local6.categoryIndex then
			if f56_local6.hasFreeItems then
				f56_local2 = "Free"
			end
			if f56_local2 ~= "Free" and f56_local6.hasNewItems then
				f56_local2 = "New"
			end
		end
	end
	if f56_local1 == "Free" then
		f56_arg0.ArrowUp:SetFreeState()
	else
		f56_arg0.ArrowUp:ClearState()
		ACTIONS.AnimateSequence( f56_arg0.ArrowUp, f56_local1 )
	end
	if f56_local2 == "Free" then
		f56_arg0.ArrowDown:SetFreeState()
	else
		f56_arg0.ArrowDown:ClearState()
		ACTIONS.AnimateSequence( f56_arg0.ArrowDown, f56_local2 )
	end
end

local f0_local19 = function ( f6_arg0, f6_arg1, f6_arg2 )
	f6_arg0.BillboardCategoryButtonAction = f0_local0
	f6_arg0.InjectPlaceholdersForFirstPartyCategories = f0_local0
	f6_arg0.ClearPlaceholderFromCategory = f0_local0
	f6_arg0._gridChildMouseFocusCount = 0
	f6_arg0.FocusBundleByID = function ( f55_arg0, f55_arg1, f55_arg2, f55_arg3 )
		f6_arg0( f6_arg0, f55_arg1, f55_arg2, f55_arg3 )
	end
	
	f6_arg0.FocusButtonByName = function ( f54_arg0, f54_arg1 )
		f6_arg0( f6_arg0, f54_arg1 )
	end
	
	ACTIONS.ScaleFullscreen( f6_arg0.Background )
	Engine.DHFCHIIJCA( "quartermaster" )
	f6_arg0.BundlesGrid:SetMask( f6_arg0.GridMask )
	if CONDITIONS.IsNotWZStoreDisabledOrIsNotMagmaGameMode() then
		local f6_local0
		if CONDITIONS.IsGiftingEnabled() then
			f6_local0 = "LUA_MENU/FRANCHISE_STORE_WITH_PROMPT_RS"
		else
			f6_local0 = "LUA_MENU/FRANCHISE_STORE_WITH_PROMPT"
		end
		f6_arg0.FranchiseStorePrompt:SetText( Engine.CBBHFCGDIC( f6_local0 ) )
	end
	f6_arg0:addElement( LOOT.GetLootFlareMaterialStreamer() )
	f6_arg0._controllerIndex = f6_arg1
	f6_arg0._promotedItems = STORE.ParsePromotedItems( f6_arg1 )
	f6_arg0._chaseItems = STORE.ParseChaseItems( f6_arg1 )
	local f6_local0 = BATTLEPASS.GetCurrentCPRewards( f6_arg1 )
	local f6_local1
	if f6_local0 then
		f6_local1 = f6_local0.totalCP
		if not f6_local1 then
		
		else
			f6_arg0._totalCP = f6_local1
			f6_local1 = STORE.GetSaleTimer( f6_arg1 )
			if f6_local1 and 0 < #f6_local1 and tonumber( f6_local1 ) > Engine.DEIDGHDBHD() and 0 < STORE.GetHighestDiscountPercentage( f6_arg1 ) then
				f6_arg0.SaleBanner:SetAlpha( 1 )
			else
				f6_arg0.SaleBanner:SetAlpha( 0 )
			end
			if CONDITIONS.IsStoreSalesBannerEnabled() then
				f6_arg0.SaleBanner:SetAlpha( 0 )
			end
			if Dvar.IBEGCHEFE( "MLTTQSTKQS" ) then
				f6_arg0.GridMask:setImage( RegisterMaterial( "stencil_mask" ) )
				f6_arg0.GridMask:SetBottom( -70 * _1080p )
			end
			f0_local0( f6_arg0, f6_arg1 )
			if QUARTERMASTER.itemData then
				QUARTERMASTER.itemData = {}
			end
			f6_arg0.BackButtonOverride = function ( f53_arg0, f53_arg1 )
				local f53_local0 = LUI.FlowManager.GetScopedData( f53_arg0 )
				local f53_local1 = LUI.FlowManager.GetPerControllerPersistentData( f6_arg0 )
				f53_local1._selectedCategory = nil
				if f53_local0.useStandaloneStore then
					LUI.FlowManager.RequestLeaveMenu( f53_arg0 )
				else
					local f53_local2
					if f53_arg1.qualifier == "keyboard" or f53_arg1.qualifier == "gamepad" then
						f53_local2 = false
					else
						f53_local2 = true
					end
					local f53_local3
					if f53_local2 then
						f53_local3 = FocusType.MouseOver
						if not f53_local3 then
						
						else
							local f53_local4 = f53_arg0:getParent()
							local f53_local5 = f53_arg1.controller or f6_arg0
							local f53_local6 = TAB.GetIndex( TAB.MP.PLAY )
							if f6_arg0._returnToEventTabFromStore then
								f53_local6 = TAB.GetIndex( TAB.MP.EVENT )
							end
							f53_local4.Tabs:FocusTab( f53_local5, f53_local6, f53_local3 )
						end
					end
					f53_local3 = FocusType.Gamepad
				end
				return false
			end
			
			local f6_local2 = function ( f51_arg0, f51_arg1, f51_arg2, f51_arg3, f51_arg4 )
				local f51_local0 = LUI.FlowManager.GetPerControllerPersistentData( f6_arg0 )
				f6_arg0._categoryData = f51_arg2
				if f6_arg0.DisableAutoScrollTimer and not f6_arg0._autoScroll then
					f6_arg0.DisableAutoScrollTimer()
				end
				if #f51_arg2.items < f51_arg3 then
					f51_arg3 = 1
				end
				local f51_local1 = f51_arg2.items[f51_arg3]
				if f51_arg4 then
					local f51_local2 = f51_arg4:GetFocusPosition( LUI.DIRECTION.horizontal )
					if f51_local2 then
						f51_local1.positionInGrid = f51_local2 + 1
						f6_arg0._positionInGrid = f51_local1.positionInGrid
					end
				end
				if f51_local1.purchaseEnd then
					local f51_local2, f51_local3, f51_local4 = STORE.GetCategoryTimeLeft( nil, f51_local1.purchaseEnd )
					if f51_local2 <= 0 then
						f6_arg0:dispatchEventToChildren( {
							expiredBundle = true,
							name = "categoryTimerUpdate"
						} )
					end
				end
				local f51_local3 = function ()
					if not f51_arg0.isFirstPartyCategory and not (f51_arg0 and f51_arg0.emptyCategory or false) then
						f51_arg0._isItemGiftable = GIFT.IsItemGiftable( f51_arg0.id )
					else
						f51_arg0._isItemGiftable = false
					end
					local f52_local0 = f51_arg0.BundlesGrid:GetCurrentMenu()
					local f52_local1 = f51_arg0._isItemGiftable
					if f52_local1 then
						f52_local1 = CONDITIONS.IsGiftingEnabled()
					end
					f51_arg0.BillboardItem:SetGiftPromtButtonActive( f52_local1 )
				end
				
				f51_local3()
				f6_arg0.BillboardItem:UpdateBillboard( f51_local1, f51_arg2.isFirstPartyCategory )
				if not f51_arg2.isFirstPartyCategory then
					if QUARTERMASTER.itemData and QUARTERMASTER.itemData.sessionId ~= nil then
						QUARTERMASTER.RecordMenuBrowseEvent( f6_arg0, false, f6_arg0._sourceMenu )
					end
					if f6_arg0._initialBrowse then
						if not f6_arg0._storeEnterComplete then
							QUARTERMASTER.RecordStoreEnterEvent( f6_arg0, f6_arg0._storeLayout, f6_arg0.recommendationData, f6_arg0._sourceMenu, f6_arg0._allCategoryData )
							f6_arg0._storeEnterComplete = true
						end
						QUARTERMASTER.BeginMenuBrowseEvent( f6_arg0, f51_arg2, f51_local1, f6_arg0._storeLayout, f6_arg0.recommendationData )
					else
						f6_arg0._initialBrowse = true
					end
				end
				f51_local3 = f6_arg0._selectedCategory ~= f51_arg2.categoryIndex
				f6_arg0._selectedCategory = f51_arg2.categoryIndex
				f51_local0._selectedCategory = f51_arg2.categoryIndex
				f6_arg0._selectedBundle = f51_arg3
				local f51_local4 = CONDITIONS.IsWZStoreDisabled()
				if f51_local4 then
					f51_local4 = CONDITIONS.IsMagmaGameMode()
				end
				f51_local4 = f51_local4 ~= true
				if f51_local3 and f51_local4 then
					f6_arg0:dispatchEventToChildren( {
						categoryChanged = true,
						name = "categoryTimerUpdate"
					} )
					f6_arg0( f6_arg0 )
				elseif f51_local4 ~= true then
					f6_arg0.ArrowUp:SetAlpha( 0 )
					f6_arg0.ArrowDown:SetAlpha( 0 )
				end
			end
			
			local f6_local3 = Engine.EHGIGBJJC( Store.EHGIGBJJC() )
			f6_arg0._allCategoryData = STORE.GetCategoryData( f6_arg1 )
			if CONDITIONS.IsPostSeasonAndMagma() then
				f0_local0( f6_arg0 )
			end
			f6_arg0._recommendations = STORE.CheckForPersonalRecommendations( f6_arg1 )
			if f6_local3.scheduleFilename then
				f6_arg0._storeSchedule = Engine.DBABFCGGIC( f6_local3.scheduleFilename )
			end
			if not f6_arg0._recommendations then
				f6_arg0.recommendationData = {
					isEnabled = false
				}
			end
			local f6_local4 = LUI.FlowManager.GetScopedData( f6_arg0 )
			local f6_local5 = f6_local4.openedZeusUpsell
			if f6_local5 then
				f6_local5 = STORE.IsZeusOwned( f6_arg1 )
			end
			f6_local4.openedZeusUpsell = nil
			if f6_local5 then
				f6_local4.selectedBundleIndex = nil
				f6_local4.firstPartyColumnIndex = nil
			end
			local f6_local6 = CONDITIONS.IsWZStoreDisabled()
			if f6_local6 then
				f6_local6 = CONDITIONS.IsMagmaGameMode()
			end
			if f6_local6 ~= true then
				f6_arg0._allCategoryData[#f6_arg0._allCategoryData + 1] = {
					isFirstPartyCategory = true,
					name = "MENU/STORE_CAT_FRANCHISE"
				}
				f6_arg0:InjectPlaceholdersForFirstPartyCategories( f6_arg1 )
			end
			if f6_arg0._allCategoryData ~= nil then
				for f6_local7 = 1, #f6_arg0._allCategoryData, 1 do
					local f6_local10 = f6_arg0._allCategoryData[f6_local7]
					f6_local10.items = f6_local10.items or {}
					f0_local0( f6_arg0, f6_arg1, f6_local10 )
					f6_local10.categoryIndex = f6_local7
				end
			end
			f6_arg0._storeLayout = f6_local3.layoutType
			local f6_local8 = nil
			if LUI.FlowManager.IsMenuOnTop( "BRMainMenuStore" ) then
				f6_local8 = "BladeMenu"
			else
				f6_local8 = -1
			end
			f6_arg0._sourceMenu = f6_local8
			f6_arg0._storeEnterComplete = false
			f6_arg0._initialBrowse = false
			local f6_local11 = f6_arg0:Wait( 2000, true )
			f6_local11.onComplete = function ()
				if not f6_arg0._storeEnterComplete then
					QUARTERMASTER.RecordStoreEnterEvent( f6_arg0, f6_arg0, f6_arg0.recommendationData, f6_arg0, f6_arg0._allCategoryData )
					f6_arg0._storeEnterComplete = true
				end
			end
			
			local f6_local10 = function ( f49_arg0, f49_arg1 )
				if f49_arg1 and f49_arg1.name then
					local f49_local0 = f49_arg1.items
					if not f49_local0 or 0 >= #f49_local0 or f49_local0[1].emptyCategory then
						f49_arg0.CategoryText:setText( ToUpperCase(), Engine.CBBHFCGDIC( "CAS/X_TO_Y", Engine.CBBHFCGDIC( f49_arg1.name ), Engine.CBBHFCGDIC( "MENU/SOLD_OUT" ) ) )
					else
						f49_arg0.CategoryText:setText( ToUpperCase( Engine.CBBHFCGDIC( f49_arg1.name ) ) )
					end
				else
					f49_arg0.CategoryText:setText( ToUpperCase( Engine.CBBHFCGDIC( "MENU/SOLD_OUT" ) ) )
				end
				if f49_arg1 and f49_arg1.rowGameSourceIDOrMixed then
					f49_arg0:UpdateWZSnipeBar( f49_arg1.rowGameSourceIDOrMixed )
				end
			end
			
			f6_arg0.BundlesGrid:SetRefreshChild( function ( f35_arg0, f35_arg1, f35_arg2 )
				if f6_arg0._allCategoryData == nil or #f6_arg0._allCategoryData == 0 then
					
				end
				local f35_local0 = f6_arg0._allCategoryData[f35_arg2 + 1]
				f35_arg0.RowGrid:SetDefaultFocus( function ()
					if f35_arg0 == nil then
						return 
					end
					local f48_local0 = LUI.FlowManager.GetScopedData( f35_arg0 )
					local f48_local1 = f35_arg0._selectedBundle
					if not f48_local1 then
						f48_local1 = f48_local0.selectedBundleIndex or 1
					end
					if #f35_arg0.items < f48_local1 then
						f48_local1 = #f35_arg0.items
					end
					f48_local0.selectedBundleIndex = nil
					return {
						y = 0,
						x = f48_local1 - 1
					}
				end )
				f35_arg0.RowGrid:SetRefreshChild( function ( f37_arg0, f37_arg1, f37_arg2 )
					local f37_local0 = f35_arg0.items[f37_arg1 + 1]
					if not f37_local0 then
						DebugPrint( "STORE SCROLL BUG: Column: " .. f37_arg1 .. ", Row: " .. f37_arg2 )
						f37_arg0:registerEventHandler( "button_over", function ( element, event )
							
						end )
						f37_arg0:registerEventHandler( "button_action", function ( element, event )
							
						end )
						f37_arg0:registerEventHandler( "mouseenter", function ( element, event )
							
						end )
						f37_arg0:registerEventHandler( "mouseleave", function ( element, event )
							
						end )
						f37_arg0:registerEventHandler( "categoryTimerUpdate", function ( element, event )
							
						end )
						f37_arg0:UpdateNewIndicator( 0 )
						return 
					end
					f37_arg0:UpdateButton( f37_local0 )
					f37_arg0:UpdateChaseItem( f37_local0, f35_arg0._chaseItems, f35_arg0.isFirstPartyCategory )
					if not f35_arg0.isFirstPartyCategory then
						if not f37_local0.emptyCategory and not STORE.HasSeenItem( f35_arg0, f37_local0.id ) then
							f37_arg0:UpdateNewIndicator( 1 )
						else
							f37_arg0:UpdateNewIndicator( 0 )
						end
					else
						f37_arg0:UpdateNewIndicator( 0 )
					end
					f37_arg0:registerEventHandler( "button_over", function ( element, event )
						f37_arg0( element, event, f37_arg0, f37_arg0 + 1, f37_arg0.RowGrid )
						f37_arg0._focusedBundle = element
					end )
					f37_arg0:registerEventHandler( "button_action", function ( element, event )
						f37_arg0:BillboardCategoryButtonAction( element, event, f37_arg0 )
					end )
					f37_arg0:registerEventHandler( "mouseenter", function ( element, event )
						f37_arg0._gridChildMouseFocusCount = f37_arg0._gridChildMouseFocusCount + 1
					end )
					f37_arg0:registerEventHandler( "mouseleave", function ( element, event )
						f37_arg0._gridChildMouseFocusCount = math.max( 0, f37_arg0._gridChildMouseFocusCount - 1 )
					end )
					f37_arg0:registerEventHandler( "categoryTimerUpdate", function ( element, event )
						if not event.expiredBundle and f37_arg0.purchaseEnd then
							local f38_local0, f38_local1, f38_local2 = STORE.GetCategoryTimeLeft( nil, f37_arg0.purchaseEnd )
							if f38_local0 <= 0 then
								f37_arg0:dispatchEventToChildren( {
									expiredBundle = true,
									name = "categoryTimerUpdate"
								} )
							end
						end
					end )
					f37_arg0:UpdateWZSnipeBar( f35_arg0.rowGameSourceIDOrMixed and f37_local0.gameSourceID or nil )
				end )
				f35_arg0._timerValue = nil
				f35_arg0._idPubVarString = nil
				f35_arg0:registerEventHandler( "categoryTimerUpdate", function ( element, event )
					if f35_arg0 == nil then
						return 
					end
					local f36_local0 = f35_arg0.categoryIndex == f35_arg0._selectedCategory
					if f35_arg0.isFirstPartyCategory and not event.firstPartyCategoryIgnoreUpdate then
						if not event.categoryChanged then
							f35_arg0.RowGrid:SetNumRows( 1 )
							f35_arg0.RowGrid:SetNumColumns( #f35_arg0.items )
							f35_arg0.RowGrid:RefreshContent()
						end
						if f36_local0 then
							f35_arg0.NoMoreItemsMessage:SetAlpha( 0 )
						end
						return 
					end
					local f36_local1 = f35_arg0.items
					local f36_local2
					if f36_local1 and 0 < #f36_local1 then
						f36_local2 = f36_local1[1]
						if not f36_local2 then
						
						else
							if f36_local0 then
								if f36_local2 == nil or f36_local2.emptyCategory then
									f35_arg0.NoMoreItemsMessage:SetAlpha( 1 )
								else
									f35_arg0.NoMoreItemsMessage:SetAlpha( 0 )
								end
							end
							if not f35_arg0.justForYou then
								local f36_local3, f36_local4, f36_local5 = STORE.GetCategoryTimeLeft( f35_arg0.timerPubVar )
								if not f35_arg0._timerValue and f35_arg0.timerPubVar and f36_local5 ~= "" then
									f35_arg0._timerValue = f36_local5
								end
								local f36_local6 = f35_arg0.idPubVar and Dvar.DHEEJCCJBH( f35_arg0.idPubVar ) or ""
								if not f35_arg0._idPubVarString and f36_local6 ~= "" then
									f35_arg0._idPubVarString = f36_local6
								end
								local f36_local7 = event.expiredBundle and f36_local0
								local f36_local8 = event.catalogFetched
								local f36_local9 = f35_arg0._timerValue
								if f36_local9 then
									f36_local9 = f35_arg0._timerValue ~= f36_local5
								end
								local f36_local10 = f35_arg0._idPubVarString
								if f36_local10 then
									f36_local10 = f35_arg0._idPubVarString ~= f36_local6
								end
								local f36_local11 = event.categoryChanged
								local f36_local12
								if not f36_local7 then
									f36_local12 = f36_local7
								elseif not f36_local8 then
									f36_local12 = f36_local8
								elseif not f36_local9 then
									f36_local12 = f36_local9
								else
									f36_local12 = f36_local10
								end
								if f36_local12 or f36_local11 then
									f35_arg0( f35_arg0, f35_arg0, f35_arg0 )
									if f36_local12 then
										f35_arg0.RowGrid:SetNumRows( 1 )
										f35_arg0.RowGrid:SetNumColumns( #f35_arg0.items )
										f35_arg0.RowGrid:RefreshContent()
									end
									f35_arg0._timerValue = f36_local5
									f35_arg0._idPubVarString = f35_arg0.idPubVarString
									if not f35_arg0._refocusing and (Dvar.IBEGCHEFE( "LMKNLPNKTM" ) or f36_local7 or f36_local8 and f35_arg0.hasFirstPartyBundle) then
										f35_arg0._refocusing = true
										f35_arg0.RowGrid:processEvent( {
											name = "lose_focus"
										} )
										f35_arg0.RowGrid:SetFocusedPosition( {
											x = 0,
											y = 0
										}, true )
										f35_arg0._refocusing = false
									end
								end
							end
							f35_arg0( f35_arg0, f35_arg0 )
						end
					end
					f36_local2 = nil
				end )
				f35_arg0.RowGrid:SetNumRows( 1 )
				local f35_local1 = f35_arg0.RowGrid
				local f35_local2 = f35_local1
				f35_local1 = f35_local1.SetNumColumns
				local f35_local3
				if f35_local0 ~= nil then
					f35_local3 = #f35_local0.items
					if not f35_local3 then
					
					else
						f35_local1( f35_local2, f35_local3 )
						f35_arg0.RowGrid:RefreshContent()
						f6_arg0( f35_arg0, f35_local0 )
					end
				end
				f35_local3 = 0
			end )
			f6_arg0.BundlesGrid:SetNumColumns( 1 )
			f6_arg0.BundlesGrid:SetNumRows( f6_arg0._allCategoryData and #f6_arg0._allCategoryData or 0 )
			f6_arg0.BundlesGrid:RefreshContent()
			local self = LUI.UITimer.new( {
				interval = 1000,
				event = {
					firstPartyCategoryIgnoreUpdate = true,
					name = "categoryTimerUpdate"
				}
			} )
			self.id = "timer"
			f6_arg0:addElement( self )
			local f6_local13 = LUI.UITimer.new( {
				event = "autoScrollTimerUpdate",
				interval = f0_local0
			} )
			f6_local13.id = "autoScrollTimer"
			f6_arg0:addElement( f6_local13 )
			f6_arg0._autoScrollEnabled = true
			f6_arg0:registerEventHandler( "autoScrollTimerUpdate", function ( element, event )
				local f34_local0 = LUI.IsLastInputMouseNavigation( f6_arg0 )
				if f34_local0 then
					f34_local0 = 0 < f6_arg0._gridChildMouseFocusCount
				end
				if f6_arg0._autoScrollEnabled and not f34_local0 and f6_arg0._selectedCategory and f6_arg0._selectedBundle and 0 < #f6_arg0._allCategoryData then
					local f34_local1 = f6_arg0._allCategoryData[f6_arg0._selectedCategory]
					local f34_local2 = f6_arg0._selectedBundle + 1
					if #f34_local1.items < f34_local2 then
						f34_local2 = 1
					end
					local f34_local3 = f6_arg0.BundlesGrid:GetElementAtPosition( 0, f6_arg0._selectedCategory - 1 )
					if f34_local3 then
						local f34_local4 = f34_local3.RowGrid
						f6_arg0._autoScroll = true
						f34_local4:SetFocusedPosition( {
							y = 0,
							x = f34_local2 - 1
						}, false )
						f6_arg0._autoScroll = false
					end
				end
			end )
			f6_arg0._autoScrollEnabledTimerHolder = LUI.UIElement.new()
			f6_arg0:addElement( f6_arg0._autoScrollEnabledTimerHolder )
			f6_arg0.DisableAutoScrollTimer = function ()
				f6_arg0._autoScrollEnabled = false
				local f32_local0 = f6_arg0._autoScrollEnabledTimerHolder:Wait( Dvar.CFHDGABACF( "NPSTPKMPKS" ), true )
				f32_local0.onComplete = function ()
					f32_local0._autoScrollEnabled = true
				end
				
			end
			
			
			local bindButton = LUI.UIBindButton.new()
			bindButton.id = "bindButton"
			f6_arg0:addElement( bindButton )
			f6_arg0.bindButton = bindButton
			
			f6_arg0.bindButton:addEventHandler( "button_alt1", function ( f31_arg0, f31_arg1 )
				local f31_local0 = f6_arg0._allCategoryData[f6_arg0._selectedCategory]
				if f31_local0 == nil then
					return 
				elseif not f31_local0.isFirstPartyCategory then
					f6_arg0._startPurchaseImmediately = true
					f6_arg0:BillboardCategoryButtonAction( nil, nil, f31_local0 )
				else
					local f31_local1 = f6_arg0._selectedBundle or 1
					local f31_local2 = f31_local0.items[f31_local1]
					local f31_local3 = LUI.FlowManager.GetScopedData( f6_arg0 )
					f31_local3.firstPartyColumnIndex = f31_local1
					if f31_local2.buttonAction then
						f6_arg0._startPurchaseImmediately = false
						f31_local2.buttonAction( f31_arg0, f31_arg1 )
						return 
					end
				end
			end )
			local f6_local15 = function ( f30_arg0 )
				assert( f30_arg0 )
				LUI.FlowManager.RequestPopupMenu( nil, "GiftBundlePurchaseConfirmationPopup", true, f6_arg0, false, {
					bundleGiftInfo = f6_arg0._selectedBundleGiftInfo,
					recipientXuidString = f30_arg0
				} )
			end
			
			local f6_local16 = function ( f29_arg0 )
				Engine.BJDBIAGIDA( SOUND_SETS.default.action )
				if not f6_arg0._storeEnterComplete then
					QUARTERMASTER.RecordStoreEnterEvent( f6_arg0, f6_arg0._storeLayout, f6_arg0.recommendationData, f6_arg0._sourceMenu, f6_arg0._allCategoryData )
					QUARTERMASTER.BeginMenuBrowseEvent( f6_arg0._controllerIndex, f6_arg0._categoryData, f6_arg0._categoryData.items[1], f6_arg0._storeLayout, f6_arg0.recommendationData )
					f6_arg0._storeEnterComplete = true
				end
				QUARTERMASTER.RecordMenuBrowseEvent( f6_arg0, true )
				local f29_local0 = STORE.GoToStore
				local f29_local1 = f6_arg0
				local f29_local2 = f6_arg0:GetCurrentMenu()
				f29_local0( f29_local1, f29_local2.id, f29_arg0.id )
			end
			
			local f6_local17 = function ()
				if f6_arg0._isItemGiftable then
					local f27_local0 = f6_arg0._allCategoryData[f6_arg0._selectedCategory]
					local f27_local1 = f27_local0.items[f6_arg0._selectedBundle or 1]
					local f27_local2 = f27_local1.id
					f6_arg0._selectedBundleGiftInfo = f27_local1
					local f27_local3 = {
						controllerIndex = f6_arg0,
						bundleSKU = f27_local1.id,
						selectedGifteeCallback = f6_arg0
					}
					GIFT.StartFTUEFlow( f6_arg0, function ()
						LUI.FlowManager.RequestPopupMenu( nil, "FlyInPopup", true, f27_local0, false, {
							flyInLeftNarrow = true,
							widget = MenuBuilder.BuildRegisteredType( "GiftingFriendSelectPopup", f27_local0 )
						} )
					end )
				end
			end
			
			if CONDITIONS.IsNotWZStoreDisabledOrIsNotMagmaGameMode() then
				local f6_local18 = CONDITIONS.IsGiftingEnabled()
				if f6_local18 and not f6_local17 then
					local f6_local19 = f6_local17
				else
					local f6_local19 = f6_local16
				end
				f6_arg0.bindButton:addEventHandler( "button_alt2", function ( f26_arg0, f26_arg1 )
					f6_arg0( f26_arg0 )
				end )
				if f6_local18 then
					local bindButtonFranchiseStore = LUI.UIBindButton.new()
					bindButtonFranchiseStore.id = "bindButtonFranchiseStore"
					f6_arg0:addElement( bindButtonFranchiseStore )
					f6_arg0.bindButtonFranchiseStore = bindButtonFranchiseStore
					
					f6_arg0.bindButtonFranchiseStore:addEventHandler( "button_right_stick", function ( f25_arg0, f25_arg1 )
						f6_arg0( f25_arg0 )
					end )
				end
			end
			f6_arg0.bindButton:addEventHandler( "button_left_stick", function ( f24_arg0, f24_arg1 )
				if Dvar.IBEGCHEFE( "OLNMSNSTKS" ) then
					LUI.FlowManager.RequestPopupMenu( f6_arg0, "CreatorCodePopup", true, f6_arg0, false, f6_arg0 )
					Engine.BJDBIAGIDA( SOUND_SETS.default.selectAlt )
				end
			end )
			f6_arg0.bindButton:addEventHandler( "button_left_trigger", function ( f23_arg0, f23_arg1 )
				LUI.FlowManager.RequestAddMenu( "BundleLockerMenu", true, f6_arg0._controllerIndex, false )
			end )
			f6_arg0:addEventHandler( "gamepad_button", function ( f22_arg0, f22_arg1 )
				if f22_arg1.controller ~= f6_arg0 and (f22_arg1.button == "primary" or f22_arg1.button == "alt1" or f22_arg1.button == "alt2" or f22_arg1.button == "left" or f22_arg1.button == "right" or f22_arg1.button == "up" or f22_arg1.button == "down") then
					return true
				else
					
				end
			end )
			local f6_local18 = function ( f21_arg0, f21_arg1 )
				local f21_local0
				if CONDITIONS.IsGiftingEnabled() then
					f21_local0 = "button_right_stick"
				else
					f21_local0 = "button_alt2"
				end
				if f21_arg0._menu.HelperBar ~= nil then
					f21_arg0._menu.HelperBar.ButtonHelperText:PopButtonPrompt( {
						button_ref = f21_local0
					} )
				end
				if LUI.IsLastInputGamepad( f6_arg0 ) and CONDITIONS.IsNotWZStoreDisabledOrIsNotMagmaGameMode() then
					f21_arg0.FranchiseStorePrompt:SetAlpha( 1 )
					if f21_arg0._gridChildMouseFocusCount == 0 and f21_arg0._focusedBundle then
						f21_arg0._focusedBundle:GainFocus( f21_arg1 )
					end
				else
					if f21_arg0._gridChildMouseFocusCount == 0 and f21_arg0._focusedBundle then
						f21_arg0._focusedBundle:processEvent( {
							name = "gain_focus"
						} )
					end
					f21_arg0.FranchiseStorePrompt:SetAlpha( 0 )
					if f21_arg0._menu.HelperBar ~= nil and CONDITIONS.IsNotWZStoreDisabledOrIsNotMagmaGameMode() then
						f21_arg0._menu.HelperBar.ButtonHelperText:PushButtonPrompt( {
							kbm_only = true,
							helper_text = Engine.CBBHFCGDIC( "MENU/STORE_CAT_FRANCHISE" ),
							button_ref = f21_local0,
							container = f21_arg0.FranchisePromptContainer,
							containerAlignment = LUI.Alignment.Right
						} )
					end
				end
			end
			
			f6_arg0.BundlesGrid:addEventHandler( "layout_initialized", function ( f20_arg0, f20_arg1 )
				f6_arg0._menu = f20_arg0:GetCurrentMenu()
				f6_arg0:addAndCallEventHandler( "update_input_type", f6_arg0 )
				local f20_local0 = LUI.FlowManager.GetPerControllerPersistentData( f6_arg0 )
				if f20_local0._selectedCategory then
					f20_arg0:SetFocusedPosition( {
						x = 0,
						y = f20_local0._selectedCategory - 1
					}, false )
				else
					f20_arg0:GainFocus( {
						controllerIndex = f6_arg0
					} )
				end
			end )
			f6_arg0.ArrowUp:addEventHandler( "grid_focus_up_blocked", function ( f19_arg0, f19_arg1 )
				f19_arg0:SetAlpha( 0, 100 )
			end )
			f6_arg0.ArrowUp:addEventHandler( "grid_focus_up_not_blocked", function ( f18_arg0, f18_arg1 )
				f18_arg0:SetAlpha( 1, 200 )
			end )
			f6_arg0.ArrowDown:addEventHandler( "grid_focus_down_blocked", function ( f17_arg0, f17_arg1 )
				f17_arg0:SetAlpha( 0, 100 )
			end )
			f6_arg0.ArrowDown:addEventHandler( "grid_focus_down_not_blocked", function ( f16_arg0, f16_arg1 )
				f16_arg0:SetAlpha( 1, 200 )
			end )
			local f6_local19 = function ( f14_arg0 )
				if not f14_arg0.numRowsPassed then
					f14_arg0.numRowsPassed = 0
				end
				if f14_arg0.numRowsPassed == 0 then
					f14_arg0.waitingForNextScroll = true
					local f14_local0 = f14_arg0:Wait( Dvar.CFHDGABACF( "LRKMTOLKTO" ) )
					f14_local0.onComplete = function ()
						f14_arg0.waitingForNextScroll = false
						f14_arg0.numRowsPassed = 0
					end
					
				end
				f14_arg0.numRowsPassed = f14_arg0.numRowsPassed + 1
			end
			
			local bindButtonFranchiseStore = function ( f13_arg0 )
				local f13_local0 = Dvar.CFHDGABACF( "MKRLLMTMRS" )
				local f13_local1 = f13_arg0.numRowsPassed
				if f13_local1 then
					f13_local1 = f13_local0 <= f13_arg0.numRowsPassed
				end
				return f13_local1
			end
			
			local f6_local21 = function ( f12_arg0, f12_arg1 )
				if f12_arg1.down and f12_arg1.qualifier == "mousewheel" and (not f6_arg0.waitingForNextScroll or not f6_arg0( f6_arg0 )) then
					f6_arg0( f6_arg0 )
					return f6_arg0.BundlesGrid:GamepadButton( f12_arg1 )
				else
					
				end
			end
			
			local f6_local22 = function ( f11_arg0, f11_arg1 )
				if f11_arg1.down and f11_arg1.qualifier == "mousewheel" then
					if not f6_arg0.waitingForNextScroll or not f6_arg0( f6_arg0 ) then
						f6_arg0( f6_arg0 )
						return f6_arg0.BundlesGrid:GamepadButton( f11_arg1 )
					else
						
					end
				else
					return f6_arg0.BundlesGrid:GamepadButton( f11_arg1 )
				end
			end
			
			f6_arg0.BillboardItem.Image:SetHandleMouse( true )
			f6_arg0.BillboardItem.Image:registerEventHandler( "leftmousedown", function ( element, event )
				return true
			end )
			f6_arg0.BillboardItem.Image:registerEventHandler( "leftmouseup", function ( element, event )
				if f6_arg0._allCategoryData ~= nil then
					local f9_local0 = f6_arg0._allCategoryData[f6_arg0._selectedCategory]
					if f9_local0 ~= nil then
						f6_arg0:BillboardCategoryButtonAction( element, event, f9_local0 )
					end
				end
				return true
			end )
			f6_arg0.BillboardItem.Image:addEventHandler( "gamepad_button", f6_local21 )
			f6_arg0.BundlesGrid._showNumbersAndArrowsKBM = true
			f6_arg0.BundlesGrid._updateArrowVisibilityOnRefresh = false
			f6_arg0.BundlesGrid._alwaysTrapMouseWheel = true
			f6_arg0.BundlesGrid:registerEventHandler( "gamepad_button", f6_local22 )
			f6_arg0.MouseScrollCatcher:SetHandleMouse( true )
			f6_arg0.MouseScrollCatcher:OverrideMouseCursorType( MouseCursorType.CURSOR_TYPE_ARROW_NORMAL )
			f6_arg0.MouseScrollCatcher:addEventHandler( "gamepad_button", f6_local21 )
			f6_arg0:addEventHandler( "tab_create", function ( f8_arg0, f8_arg1 )
				local f8_local0 = f8_arg0:GetCurrentMenu()
				if f8_local0 then
					local f8_local1 = LUI.FlowManager.GetScopedData( f8_local0 )
					if f8_local1.returnToEventTabFromStore then
						f8_local1.returnToEventTabFromStore = nil
						f8_arg0._returnToEventTabFromStore = true
					end
				end
			end )
			f6_arg0:addEventHandler( "ingamestore_purchased_product", function ( f7_arg0, f7_arg1 )
				if f7_arg1.transactionResult == STORE.TransactionResult.TRANSACTION_SUCCEEDED then
					f6_arg0( f6_arg0, f7_arg1.controllerIndex )
				end
			end )
		end
	end
	f6_local1 = 0
end

function MPStoreBillboardGrid( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "MPStoreBillboardGrid"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	local Background = nil
	
	Background = LUI.UIImage.new()
	Background.id = "Background"
	Background:SetRGBFromInt( 0, 0 )
	Background:SetAlpha( 0.95, 0 )
	Background:setImage( RegisterMaterial( "widg_gradient_bottom_to_top" ), 0 )
	Background:SetVMin( 0.5, 0 )
	self:addElement( Background )
	self.Background = Background
	
	local MouseScrollCatcher = nil
	
	MouseScrollCatcher = LUI.UIImage.new()
	MouseScrollCatcher.id = "MouseScrollCatcher"
	MouseScrollCatcher:SetRGBFromInt( 0, 0 )
	MouseScrollCatcher:SetAlpha( 0, 0 )
	MouseScrollCatcher:setImage( RegisterMaterial( "widg_gradient_bottom_to_top" ), 0 )
	MouseScrollCatcher:SetVMin( 0.5, 0 )
	MouseScrollCatcher:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, _1080p * 200, _1080p * -85 )
	self:addElement( MouseScrollCatcher )
	self.MouseScrollCatcher = MouseScrollCatcher
	
	local BillboardItem = nil
	
	BillboardItem = MenuBuilder.BuildRegisteredType( "StoreBillboardItem", {
		controllerIndex = f1_local1
	} )
	BillboardItem.id = "BillboardItem"
	BillboardItem:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, _1080p * 200, _1080p * 780 )
	self:addElement( BillboardItem )
	self.BillboardItem = BillboardItem
	
	local BundlesGrid = nil
	
	BundlesGrid = LUI.UIPeekingGrid.new( {
		scrollingThresholdX = 1,
		buildArrowsLabel = false,
		maxVelocity = 5000,
		adjustSizeToContent = false,
		scrollingThresholdY = 1,
		wrapX = false,
		maxVisibleColumns = 1,
		maxVisibleRows = 2,
		wrapY = false,
		arrowsVerticalOffset = 0,
		springCoefficient = 400,
		controllerIndex = f1_local1,
		buildChild = function ()
			return MenuBuilder.BuildRegisteredType( "MPStoreBillboardGridRow", {
				controllerIndex = menu
			} )
		end,
		refreshChild = function ( f4_arg0, f4_arg1, f4_arg2 )
			
		end,
		spacingX = _1080p * 0,
		spacingY = _1080p * 0,
		columnWidth = _1080p * 1680,
		rowHeight = _1080p * 190,
		horizontalAlignment = LUI.Alignment.Left,
		verticalAlignment = LUI.Alignment.Top
	} )
	BundlesGrid.id = "BundlesGrid"
	BundlesGrid:setUseStencil( true )
	BundlesGrid:SetAnchorsAndPosition( 0, 0, 1, 0, _1080p * 130, _1080p * -140, _1080p * -370, 0 )
	self:addElement( BundlesGrid )
	self.BundlesGrid = BundlesGrid
	
	local GridMask = nil
	
	GridMask = LUI.UIImage.new()
	GridMask.id = "GridMask"
	GridMask:setImage( RegisterMaterial( "store_bundle_grid_mask" ), 0 )
	GridMask:SetAnchorsAndPosition( 0, 0, 1, 0, _1080p * 120, _1080p * -120, _1080p * -370, _1080p * -54 )
	self:addElement( GridMask )
	self.GridMask = GridMask
	
	local VerticalScrollbar = nil
	
	VerticalScrollbar = MenuBuilder.BuildRegisteredType( "VerticalScrollbar", {
		controllerIndex = f1_local1
	} )
	VerticalScrollbar.id = "VerticalScrollbar"
	VerticalScrollbar:SetAnchorsAndPosition( 1, 0, 1, 0, _1080p * -140, _1080p * -129, _1080p * -330, _1080p * -85 )
	self:addElement( VerticalScrollbar )
	self.VerticalScrollbar = VerticalScrollbar
	
	local NoMoreItemsMessage = nil
	
	NoMoreItemsMessage = MenuBuilder.BuildRegisteredType( "NoMoreItemsMessage", {
		controllerIndex = f1_local1
	} )
	NoMoreItemsMessage.id = "NoMoreItemsMessage"
	NoMoreItemsMessage:SetAlpha( 0, 0 )
	NoMoreItemsMessage:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -512, _1080p * 512, _1080p * -90, _1080p * -10 )
	self:addElement( NoMoreItemsMessage )
	self.NoMoreItemsMessage = NoMoreItemsMessage
	
	local StoreEmpty = nil
	
	StoreEmpty = MenuBuilder.BuildRegisteredType( "EventBanner", {
		controllerIndex = f1_local1
	} )
	StoreEmpty.id = "StoreEmpty"
	StoreEmpty:SetAlpha( 0, 0 )
	StoreEmpty.Backer:SetRGBFromTable( SWATCHES.Store.NoItemBGAlt, 0 )
	StoreEmpty.Backer:SetAlpha( 1, 0 )
	StoreEmpty.Node:SetRGBFromTable( SWATCHES.Store.NoItemTimer, 0 )
	StoreEmpty:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 96, _1080p * 246, _1080p * 160, _1080p * 194 )
	self:addElement( StoreEmpty )
	self.StoreEmpty = StoreEmpty
	
	local ArrowDown = nil
	
	ArrowDown = MenuBuilder.BuildRegisteredType( "StoreScrollArrow", {
		controllerIndex = f1_local1
	} )
	ArrowDown.id = "ArrowDown"
	ArrowDown:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * -250, _1080p * 250, _1080p * -110, _1080p * -60 )
	self:addElement( ArrowDown )
	self.ArrowDown = ArrowDown
	
	local ArrowUp = nil
	
	ArrowUp = MenuBuilder.BuildRegisteredType( "StoreScrollArrow", {
		controllerIndex = f1_local1
	} )
	ArrowUp.id = "ArrowUp"
	ArrowUp:SetZRotation( 180, 0 )
	ArrowUp.FreeBundleText:SetZRotation( 180, 0 )
	ArrowUp:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * -250, _1080p * 250, _1080p * -350, _1080p * -300 )
	self:addElement( ArrowUp )
	self.ArrowUp = ArrowUp
	
	local FranchiseStorePrompt = nil
	
	FranchiseStorePrompt = MenuBuilder.BuildRegisteredType( "PromptButton", {
		controllerIndex = f1_local1
	} )
	FranchiseStorePrompt.id = "FranchiseStorePrompt"
	FranchiseStorePrompt:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -330, _1080p * -130, _1080p * 164, _1080p * 196 )
	self:addElement( FranchiseStorePrompt )
	self.FranchiseStorePrompt = FranchiseStorePrompt
	
	local SupportingCreatorCode = nil
	
	SupportingCreatorCode = MenuBuilder.BuildRegisteredType( "SupportingCreatorCode", {
		controllerIndex = f1_local1
	} )
	SupportingCreatorCode.id = "SupportingCreatorCode"
	SupportingCreatorCode:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -761, _1080p * -371, _1080p * 172, _1080p * 196 )
	self:addElement( SupportingCreatorCode )
	self.SupportingCreatorCode = SupportingCreatorCode
	
	local FranchisePromptContainer = nil
	FranchisePromptContainer = MenuBuilder.BuildRegisteredType( "ButtonPromptContainer", {
		controllerIndex = f1_local1
	} )
	FranchisePromptContainer.id = "FranchisePromptContainer"
	if CONDITIONS.AlwaysFalse() then
		FranchisePromptContainer.Label:setText( "", 0 )
	end
	FranchisePromptContainer:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -361, _1080p * -130, _1080p * 165, _1080p * 196 )
	self:addElement( FranchisePromptContainer )
	self.FranchisePromptContainer = FranchisePromptContainer
	
	local SaleBanner = nil
	
	SaleBanner = MenuBuilder.BuildRegisteredType( "StoreSaleBanner", {
		controllerIndex = f1_local1
	} )
	SaleBanner.id = "SaleBanner"
	SaleBanner:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 115, _1080p * 830, _1080p * 175, _1080p * 210 )
	self:addElement( SaleBanner )
	self.SaleBanner = SaleBanner
	
	self._sequences.DefaultSequence = function ()
		
	end
	
	local f1_local17 = nil
	MouseScrollCatcher:RegisterAnimationSequence( "EmptyStore", {
		{
			value = -4.161494641805374E+160,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	BillboardItem:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	BundlesGrid:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	GridMask:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	VerticalScrollbar:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	NoMoreItemsMessage:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 1,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	StoreEmpty:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	ArrowDown:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	ArrowUp:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	FranchiseStorePrompt:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	SupportingCreatorCode:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	FranchisePromptContainer:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	SaleBanner:RegisterAnimationSequence( "EmptyStore", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.EmptyStore = function ()
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
		menu:AnimateSequence( "EmptyStore" )
	end
	
	local f1_local18 = LUI.UIScrollbar.new
	local f1_local19 = {
		direction = LUI.DIRECTION.vertical,
		eventListener = VerticalScrollbar,
		startCap = VerticalScrollbar.startCap,
		endCap = VerticalScrollbar.endCap,
		sliderArea = VerticalScrollbar.sliderArea
	}
	local f1_local20 = VerticalScrollbar.sliderArea
	if f1_local20 then
		f1_local20 = VerticalScrollbar.sliderArea.slider
	end
	f1_local19.slider = f1_local20
	f1_local20 = VerticalScrollbar.sliderArea
	if f1_local20 then
		f1_local20 = VerticalScrollbar.sliderArea.fixedSizeSlider
	end
	f1_local19.fixedSizeSlider = f1_local20
	BundlesGrid:AddScrollbar( f1_local18( f1_local19 ) )
	BundlesGrid:AddArrow( ArrowUp )
	BundlesGrid:AddArrow( ArrowDown )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "MPStoreBillboardGrid", MPStoreBillboardGrid )
LockTable( _M )
