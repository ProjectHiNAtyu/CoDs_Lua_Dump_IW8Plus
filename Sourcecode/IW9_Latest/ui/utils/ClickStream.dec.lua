-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
ClickStream = ClickStream or {}
ClickStream.Direction = {
	FORWARD = 2,
	BACKWARD = 1,
	NONE = 0
}
ClickStream.InputType = {
	CONTROLLER_SECONDARY = 3,
	MOUSE_CLICK = 1,
	CONTROLLER_PRIMARY = 2,
	NONE = 0
}
ClickStream.ActionType = {
	LEAVE_MENU = 1,
	CUSTOMIZED_ACTION = 3,
	OPEN_MENU = 2,
	NONE = 0
}
ClickStream.FindTabsAtMenu = function ( f6_arg0, f6_arg1 )
	if f6_arg1 and f6_arg1._tabsWidget then
		return f6_arg1._tabsWidget
	else
		local f6_local0 = LUI.FlowManager.FindTabsAtElement( f6_arg0, f6_arg1 )
		if f6_local0 then
			f6_arg1._tabsWidget = f6_local0
			return f6_local0
		else
			
		end
	end
end

ClickStream.IsPopupNeeded = function ( f5_arg0 )
	if String.IsNilOrEmpty( f5_arg0 ) then
		return false
	elseif CONDITIONS.IsMobileOrMobileSim() then
		return true
	end
	local f5_local0 = Engine[0x6093D047200548]( "clickstreampopup:clickstreampopuplist" )
	for f5_local4, f5_local5 in ipairs( f5_local0[0x6D977E15D062CEF] ) do
		if f5_local5[0xF079DB2540F342E] == f5_arg0 then
			return true
		end
	end
	return false
end

ClickStream.OnNavigation = function ( f4_arg0, f4_arg1, f4_arg2, f4_arg3, f4_arg4 )
	if not ClickStream.IsEnabled() then
		return 
	elseif f4_arg4 == ClickStream.Direction.BACKWARD then
		local f4_local0
		if 0 < #f4_arg0.menuInfoStack then
			f4_local0 = #f4_arg0.menuInfoStack - 1
			if not f4_local0 then
			
			else
				f4_arg2 = f4_arg0.menuInfoStack[f4_local0]
			end
		end
		f4_local0 = 0
	elseif f4_arg4 == ClickStream.Direction.FORWARD and (not ClickStream.IsIncludingPopup() or not f4_arg3) then
		f4_arg3 = f4_arg0:GetFirstNonPopUpMenu()
	end
	local f4_local0 = f4_arg4
	local f4_local1
	if CONDITIONS.InGame() then
		f4_local1 = "Ingame HUD current screen"
	else
		f4_local1 = "No previous menu in stack"
	end
	local f4_local2
	if CONDITIONS.InGame() then
		f4_local2 = "Ingame HUD destination screen"
	else
		f4_local2 = "No destination menu in stack"
	end
	local f4_local3
	if f4_arg2 then
		f4_local3 = f4_arg2.name
		if not f4_local3 then
		
		else
			local f4_local4
			if f4_arg3 then
				f4_local4 = f4_arg3.name
				if not f4_local4 then
				
				else
					if f4_local3 == f4_local4 then
						return 
					end
					local f4_local5 = ClickStream.IsIncludingPopup()
					local f4_local6 = true
					if f4_arg2 and f4_arg2.isPopup then
						f4_local6 = ClickStream.IsPopupNeeded( f4_arg2.name )
					end
					local f4_local7 = true
					if f4_arg3 and f4_arg3.isPopup then
						f4_local7 = ClickStream.IsPopupNeeded( f4_arg3.name )
					end
					local f4_local8
					if not f4_local5 then
						f4_local8 = f4_local5
					elseif not f4_local6 then
						f4_local8 = f4_local6
					else
						f4_local8 = f4_local7
					end
					local f4_local9 = 0
					local f4_local10 = Engine[0x3B8CFB6758EF57C]()
					local f4_local11 = 0
					local f4_local12, f4_local13 = nil
					if f4_local8 then
						if f4_arg3 then
							if f4_arg3.menuDurationTimeStamp == nil then
								f4_arg3.menuDurationTimeStamp = f4_local10
							end
							if f4_arg3 then
								local f4_local14 = f4_local10 - f4_arg3.menuDurationTimeStamp
								if not f4_local14 then
									f4_local11 = f4_local14
								end
							end
							f4_local11 = 0
						end
						if f4_arg2 then
							f4_arg2.menuDurationTimeStamp = f4_local10
							local f4_local14 = ClickStream.FindTabsAtMenu( f4_arg2.menu, f4_arg2.menu )
							if LUI.TabManager.HasTab( f4_local14 ) then
								local f4_local16 = LUI.TabManager.GetTabAtIndex( f4_local14, f4_local14:GetDefaultTab() + 1 )
								local f4_local17
								if f4_local16 then
									f4_local17 = "#Tab " .. (f4_local16.menuId and f4_local16.menuId or f4_local16.id)
									if not f4_local17 then
									
									else
										f4_local3 = f4_local3 .. "-" .. f4_local17
										f4_arg2.currentTabName = f4_local17
									end
								end
								f4_local17 = "#EmptyTab"
							elseif f4_arg2.currentTabName then
								local f4_local15 = f4_local3 .. "-" .. f4_arg2.currentTabName
								if not f4_local15 then
									f4_local3 = f4_local15
								else
									
								end
							end
						end
						ClickStream.SendDlogEvent( f4_arg1, {
							isNavigation = true,
							direction = f4_local0,
							destinationScreen = f4_local3,
							currentScreen = f4_local4,
							duration = f4_local11
						} )
					end
				end
			end
			f4_local4 = f4_local1
		end
	end
	f4_local3 = f4_local2
end

ClickStream.SendDlogEvent = function ( f3_arg0, f3_arg1 )
	local f3_local0 = f3_arg1.isNavigation or false
	local f3_local1 = {
		inputtype = 0,
		buttondata = nil,
		buttonid = nil,
		version = 4.667261643131709E-62,
		actiontype = 0,
		isnavigation = f3_local0,
		destinationscreen = f3_arg1.destinationScreen or "NA",
		currentscreen = f3_arg1.currentScreen or "NA",
		direction = f3_arg1.direction or 0,
		duration = f3_arg1.duration or 0
	}
	if f3_local0 then
		
	else
		
	end
	Engine[0x15D98DF5F61904B]( f3_arg0, "dlog_event_clickstream", f3_local1 )
end

ClickStream.IsEnabled = function ()
	return not Dvar[0x9E5BE3B4BBA4E0E]( 0xCF18002D13E1B99 )
end

ClickStream.IsIncludingPopup = function ()
	if CONDITIONS.IsMobileOrMobileSim() then
		return true
	else
		return Dvar[0x9E5BE3B4BBA4E0E]( 0xFCB731EB9ED47C9 )
	end
end

