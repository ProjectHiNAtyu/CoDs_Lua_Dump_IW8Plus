-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:04
module( ..., package.seeall )
local f0_local0 = "GLGunsmithButton"
local f0_local1 = function ( f59_arg0, f59_arg1 )
	return function ()
		FrontEndScene.SetExclusiveWeaponModels( {
			FrontEndScene.ClientWeapons.Preview
		} )
		if not WEAPON.IsWeaponNoneValue( f59_arg0._weaponTable.weapon ) then
			f59_arg0._weaponModel = WEAPON.GetWeaponModel( f59_arg0, FrontEndScene.ClientWeapons.Preview, WEAPON.OffsetFiles.PreviewData )
		else
			f59_arg0._weaponModel = SHOWCASE.GetDefaultWeaponModel()
			f59_arg0._weaponTable = WEAPON.GenerateEmptyWeaponTable( f59_arg0._weaponPlayerData )
			f59_arg0._weaponTable.weapon = WEAPON.GetDefaultPrimaryWeaponRef()
		end
		f59_arg0:addElement( f59_arg0._weaponModel )
		WEAPON.LoadAndSetModel( f59_arg0, f59_arg0._weaponModel, f59_arg0._weaponTable )
		f59_arg0:processEvent( {
			name = "scene_transitioned"
		} )
	end
	
end

local f0_local2 = function ( f58_arg0, f58_arg1, f58_arg2 )
	if not f58_arg2.loadoutIndex then
		f58_arg2.loadoutIndex = 0
	end
	if not f58_arg2.weaponSlot then
		f58_arg2.weaponSlot = 0
	end
end

local f0_local3 = function ( f57_arg0 )
	local f57_local0, f57_local1 = nil
	local f57_local2 = GUNSMITH.GetCustomModName( f57_arg0._weaponPlayerData.blueprintName:get() )
	if f57_local2 and 0 < #f57_local2 then
		f57_local0 = f57_local2
	elseif f57_arg0._weaponTable and f57_arg0._weaponTable.lootID ~= LOOT.emptyID then
		f57_local0 = WEAPON.GetLootWeaponName( f57_arg0._weaponTable.weapon, f57_arg0._weaponTable.lootID )
	else
		f57_local0 = Engine[0xED84C33EC5F01EA]( 0xEA96979AEBBB476, WEAPON.GetName( f57_arg0._weaponTable.weapon ) )
	end
	if CONDITIONS.IsGLGunsmithEnabled() then
		local f57_local3 = GL_HACK.GetWeaponPlatformName( f57_arg0._weaponTable.weapon )
		if f57_local3 ~= nil and 0 < #f57_local3 then
			f57_local0 = f57_local3
		end
	end
	f57_arg0.MenuTitle:SetTitle( f57_local0 )
end

local f0_local4 = function ( f56_arg0, f56_arg1 )
	local f56_local0 = LUI.FlowManager.GetScopedData( f56_arg0 )
	f56_local0.startTime = Engine[0x3B8CFB6758EF57C]()
	local f56_local1 = f56_local0.lastTimeStamp
	if not f56_local1 then
		f56_local1 = Engine[0x3B8CFB6758EF57C]()
	end
	f56_local0.lastTimeStamp = f56_local1
	f56_local0.attachmentTimeSpent = f56_local0.attachmentTimeSpent or 0
	f56_local0.customizeTimeSpent = f56_local0.customizeTimeSpent or 0
	f56_local0.previousAttachmentConfig = ATTACHMENT.GetConfigString( f56_arg0._weaponTable )
	f56_local0.previousCosmeticConfig = WEAPON.GetCosmeticConfigString( f56_arg0._weaponTable )
	f56_local0.previousBlueprintString = WEAPON.GetWeaponBlueprintString( f56_arg1, f56_arg0._weaponTable, f56_local0.previousAttachmentConfig )
end

local f0_local5 = function ( f55_arg0, f55_arg1, f55_arg2 )
	for f55_local3, f55_local4 in pairs( f55_arg1[f55_arg2] ) do
		local f55_local5 = tonumber
		local f55_local6 = LUI.Split( f55_local4[0xAFBBA6738B22B00], "|" )
		f55_local5 = f55_local5( f55_local6[1] )
		if f55_arg0._usedButtons[f55_local5] then
			return f55_arg0[f0_local0 .. f55_local5]
		end
	end
end

local f0_local6 = function ( f54_arg0 )
	for f54_local9, f54_local10 in pairs( GUNSMITH.GetGunsmithNavigationIndicesTable() ) do
		if f54_arg0._usedButtons[f54_local10[0xED4445254D041CC]] then
			local f54_local3 = f54_arg0[f0_local0 .. f54_local10[0xED4445254D041CC]]
			for f54_local7, f54_local8 in pairs( GUNSMITH.NavigationDirections ) do
				GUNSMITH.UpdateButtonNavigation( f54_local3, f0_local0( f54_arg0, f54_local10, f54_local8 ) or f54_local3, f54_local7, f54_local3._canTune )
			end
		end
	end
	f54_arg0._navigationSetup = true
end

local f0_local7 = function ( f48_arg0, f48_arg1, f48_arg2 )
	GUNSMITH.AddHelperBarSaveWeaponButton( f48_arg0, f48_arg1, f48_arg2.forShowcase )
	if CONDITIONS.IsWeaponPreviewEnabled() and f48_arg0.HelperBar then
		f48_arg0.HelperBar.Background:SetAlpha( 0 )
		LUI.TextChat.SetupMenuForNoChat( f48_arg0 )
		f48_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 10,
			replaceTop = true,
			button_ref = "button_l3",
			helper_text = Engine[0xED84C33EC5F01EA]( 0xCBEAF62674E5E75 ),
			helper_definition = Engine[0xED84C33EC5F01EA]( 0xF2D581450245105 )
		} )
		f48_arg0:AddGamepadEventCallback( "button_left_stick", function ( f53_arg0, f53_arg1 )
			local f53_local0 = f53_arg1.controller or f48_arg0
			local f53_local1 = f48_arg0
			local f53_local2
			if f53_arg1.qualifier ~= "keyboard" and f53_arg1.qualifier ~= "gamepad" then
				f53_local2 = false
			else
				f53_local2 = true
			end
			f53_local1.shouldPlaySound = f53_local2
			f48_arg0.weaponPlayerData = f53_arg0._weaponPlayerData
			GUNSMITH.OpenWeaponPreviewMenu( f48_arg0.weaponPlayerData, f53_local0, f48_arg0 )
		end )
	end
	f48_arg0.BackButtonOverride = function ( f52_arg0, f52_arg1 )
		if LUI.IsLastInputGamepad( f52_arg1.controller ) and CONDITIONS.IsConsoleGame() and OSK[0x736AF74410E3002]() then
			return false
		elseif LUI.FlowManager.IsInStack( LOADOUT.GetLoadoutMenuRef() ) then
			local f52_local0 = LUI.FlowManager.GetScopedData( LOADOUT.GetLoadoutMenuRef() )
			local f52_local1 = f52_arg1.controller or f48_arg0
			local f52_local2 = LUI.FlowManager.GetScopedData( f52_arg0 )
			local f52_local3 = f52_arg1.controller or f52_local1
			local f52_local4 = f52_local2.lastTimeStamp or "0"
			local f52_local5 = Engine[0x3B8CFB6758EF57C]()
			if f52_local2.attachmentTimeSpent and f52_local2.customizeTimeSpent then
				f52_local2.attachmentTimeSpent = f52_local2.attachmentTimeSpent + Engine[0x250B0A331992E67]( f52_local5, "-" .. f52_local4 )
				f52_local2.customizeTimeSpent = f52_local2.customizeTimeSpent + Engine[0x250B0A331992E67]( f52_local5, "-" .. f52_local4 )
				METRICS.GunsmithSessionSendDLogEvent( f52_local3, f52_local0.sessionID, f52_arg0._weaponTable, f48_arg0.loadoutIndex, f52_local2.attachmentTimeSpent, f52_local2.customizeTimeSpent, f52_local2.previousAttachmentConfig, f52_local2.previousCosmeticConfig, f52_local2.previousBlueprintString )
			end
		end
		return true
	end
	
	if CONDITIONS.IsFrontendFiringRangeEnabled() and not f48_arg2.forShowcase then
		local f48_local0 = function ( f51_arg0 )
			local f51_local0 = false
			if f51_arg0 and f51_arg0.event then
				f51_local0 = f51_arg0.event.qualifier == "keyboard"
			end
			if f51_local0 or LUI.IsLastInputGamepad( f48_arg0 ) then
				Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
			end
			f48_arg0.currentWeaponTable = WEAPON.GenerateWeaponTable( f48_arg0._weaponPlayerData )
			local f51_local1 = f48_arg0._weaponSlot
			local f51_local2 = WEAPON.PrimarySlot
			f48_arg0.secondaryWeaponTable = WEAPON.GenerateWeaponTable( f48_arg0._loadoutPlayerData.weaponSetups[REG9 and WEAPON.SecondarySlot or WEAPON.PrimarySlot] )
			f48_arg0.fromGunsmith = true
			if 0 < tonumber( f48_arg0.currentWeaponTable.variantID ) then
				f48_arg0.currentWeaponTable.lootName = WEAPON.GetLootWeaponName( f48_arg0.currentWeaponTable.weapon, f48_arg0.currentWeaponTable.lootID )
			end
			if 0 < tonumber( f48_arg0.secondaryWeaponTable.variantID ) then
				f48_arg0.secondaryWeaponTable.lootName = WEAPON.GetLootWeaponName( f48_arg0.secondaryWeaponTable.weapon, f48_arg0.secondaryWeaponTable.lootID )
			end
			WEAPON.OpenFiringRange( f48_arg0, f48_arg0 )
		end
		
		if f48_arg0.HelperBar then
			f48_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
				isHold = true,
				priority = 1,
				replaceTop = true,
				button_ref = "button_alt2",
				side = "left",
				helper_text = Engine[0xED84C33EC5F01EA]( 0x142AAF5CD0DA682 ),
				helper_definition = Engine[0xED84C33EC5F01EA]( 0x71B72F1718054D7 ),
				container = f48_arg0.FiringRangePrompt,
				callback = f48_local0
			} )
		end
	end
	if GUNSMITH.IsRemoveAllAttachmentsEnabled() and CONDITIONS.InFrontend() and not f48_arg2.forShowcase then
		local f48_local0 = function ( f49_arg0 )
			local f49_local0 = false
			if f49_arg0 and f49_arg0.event then
				f49_local0 = f49_arg0.event.qualifier == "keyboard"
				if f49_local0 and f49_arg0.event.down == false then
					
				else
					
				end
			end
			if f49_local0 or LUI.IsLastInputGamepad( f48_arg0 ) then
				Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
			end
			local f49_local1 = f48_arg0._weaponPlayerData
			if GUNSMITH.IsWeaponSetupBlueprintIntact( f49_local1 ) then
				GUNSMITH.SetupCallbackFuncForBlueprintEdit( f48_arg0, f49_local1, GUNSMITH.BlueprintEditStatus.EditBlueprint, function ()
					f49_arg0:dispatchEventToRoot( {
						name = "break_blueprint"
					} )
					for f50_local4, f50_local5 in pairs( f49_arg0._usedButtons ) do
						if f50_local5 ~= ATTACHMENT.receiverCategory then
							local f50_local3 = f49_arg0[f49_arg0 .. f50_local4]
							f50_local3.RemoveAll = true
							GUNSMITH.TryRemoveAttachment( f50_local3, nil, nil, f50_local5, true )
							f50_local3:dispatchEventToAllChildren( {
								immediate = true,
								name = "lose_focus"
							} )
						end
					end
				end )
			else
				for f49_local6, f49_local7 in pairs( f48_arg0._usedButtons ) do
					if f49_local7 ~= ATTACHMENT.receiverCategory then
						local f49_local5 = f48_arg0[f48_arg0 .. f49_local6]
						f49_local5.RemoveAll = true
						GUNSMITH.TryRemoveAttachment( f49_local5, nil, nil, f49_local7, true )
						f49_local5:dispatchEventToAllChildren( {
							immediate = true,
							name = "lose_focus"
						} )
					end
				end
			end
			f48_arg0( f48_arg0 )
			if LUI.IsLastInputGamepad( f48_arg0 ) then
				f48_arg0._lastFocusedButtonGroupElement:processEvent( {
					immediate = true,
					name = "gain_focus"
				} )
			end
		end
		
		if f48_arg0.HelperBar then
			f48_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
				side = "left",
				priority = 2,
				replaceTop = true,
				button_ref = "button_right_trigger",
				isHold = true,
				helper_text = Engine[0xED84C33EC5F01EA]( 0xE2F778D98189FBF ),
				helper_definition = Engine[0xED84C33EC5F01EA]( 0xE2F778D98189FBF ),
				callback = f48_local0
			} )
		end
	end
end

local f0_local8 = function ( f47_arg0, f47_arg1 )
	local f47_local0 = f47_arg0[f0_local0 .. f47_arg1]
	if f47_local0 then
		if GUNSMITH.GetSelectedAttachIndexForCategory( f47_local0._category, f47_arg0._weaponTable ) then
			return false
		elseif f47_local0._attachments and 0 < #f47_local0._attachments then
			for f47_local5, f47_local6 in ipairs( f47_local0._attachments ) do
				local f47_local4 = CONDITIONS.AreRestrictionsActive()
				if f47_local4 then
					f47_local4 = MatchRules[0x722F56788C744E9]( f47_local6.ref, f47_local0._weaponRef )
				end
				if not f47_local4 and f47_local6.ref ~= "none" then
					return false
				end
			end
		end
	end
	return true
end

local f0_local9 = function ( f46_arg0 )
	for f46_local4, f46_local5 in pairs( GUNSMITH.GetGunsmithNavigationIndicesTable() ) do
		local f46_local6 = f46_local5[0xED4445254D041CC]
		if not f46_arg0._usedButtons[f46_local6] or f0_local0( f46_arg0, f46_local6 ) then
			local f46_local3 = f46_arg0[f0_local0 .. f46_local6]
			if f46_local3 ~= nil then
				f46_local3:closeTree()
				f46_arg0[f0_local0 .. f46_local6] = nil
				f46_arg0._usedButtons[f46_local6] = nil
			end
		end
	end
	f46_arg0._buttonsRemoved = true
end

local f0_local10 = function ( f45_arg0 )
	local f45_local0 = StringTable[0x8073B436CDE1BF]( CSV.attachmentCategoryLocks.file, CSV.attachmentCategoryLocks.cols.ref, f45_arg0 )
	local f45_local1
	if f45_local0 then
		f45_local1 = f45_local0
	else
		f45_local1 = 0 <= f45_local0
	end
	return f45_local1
end

local f0_local11 = function ( f44_arg0, f44_arg1 )
	if not f44_arg1 then
		if not f44_arg0._gunsmithOnboardingButton then
			return 
		end
		f44_arg1 = f44_arg0._gunsmithOnboardingButton
	end
	local f44_local0 = f44_arg0._controllerIndex
	local f44_local1 = f44_arg1.TuneButton
	f44_local1:SetVisible( true )
	f44_local1:SetHandleMouse( true )
	f44_local1:SetButtonDisabled( false )
	local f44_local2, f44_local3, f44_local4, f44_local5 = f44_arg1:getLocalRect()
	local f44_local6 = f44_local3 + f44_local1:getHeight() / 2
	local f44_local7 = Engine[0xEE6F69FEA944B13]()
	local f44_local8 = f44_local7:getWidth()
	local f44_local9 = f44_local7:getHeight()
	local f44_local10 = f44_local8 / 2 < f44_local2
	local f44_local11 = f44_local3 < f44_local9 / 2
	local f44_local12 = {}
	local f44_local13
	if f44_local10 and not f44_local2 then
		f44_local13 = f44_local2
	else
		f44_local13 = f44_local4
	end
	f44_local12.x = f44_local13
	f44_local12.y = f44_local6
	TIP.CreateTips( Onboarding.Tips.TUNING_ACCESS( f44_local0, f44_arg1, f44_local10, f44_local11, f44_local12 ) )
end

local f0_local12 = function ( f43_arg0, f43_arg1 )
	if f43_arg0._weaponTable and f43_arg0._weaponTable.attachments and f43_arg0._attachments and f43_arg0._usedButtons then
		GUNSMITH.UpdateBlockedAttachments( f43_arg1, f43_arg0._weaponTable, f43_arg0._attachments, f43_arg0._usedButtons )
	end
	for f43_local10, f43_local11 in pairs( GUNSMITH.GetGunsmithNavigationIndicesTable() ) do
		local f43_local12 = f43_local11[0xED4445254D041CC]
		local f43_local13 = {}
		for f43_local3, f43_local4 in pairs( GUNSMITH.NavigationDirections ) do
			local f43_local6 = f43_local11[f43_local4]
			local f43_local7 = f43_local6[1]
			local f43_local8 = tonumber
			local f43_local9 = LUI.Split( f43_local6[1][0xAFBBA6738B22B00], "|" )
			f43_local13[f43_local3] = f43_arg0[f0_local0 .. (f43_local7 and f43_local8( f43_local9[1] ) or f43_local12)]
		end
		GUNSMITH.SetupButtonNavigatioin( f43_arg0[f0_local0 .. f43_local12], f43_local13, f43_local12 )
	end
	f43_local0 = {
		unlockLevel = 4294967295,
		isLocked = false
	}
	f43_local1 = WEAPON.GetWeaponModelName( f43_arg0._weaponTable.weapon, f43_arg0._weaponTable, {
		includeAttachments = true
	} )
	f43_local2 = ClientWeapon[0x8E1E8769A4A0774]( f43_arg1, f43_local1 )
	if not GUNSMITH.IsDisabled( f43_arg0._weaponTable.weapon ) then
		f43_local10 = ATTACHMENT.GetBundleByRef( f43_arg0._weaponTable.weapon .. "_tuning" )
	else
		f43_local10 = false
	end
	if f43_local10 then
		f43_local11 = f43_local10
	else
		f43_local11 = LOOT.IsUnlockedWithID( f43_arg1, f43_local10[0x28887F70BF5EBA] )
	end
	local f43_local12 = 0 < #f43_arg0._categoryLockDetails
	for f43_local5, f43_local3 in pairs( f43_arg0._usedButtons ) do
		if f43_local3 then
			local f43_local4 = f43_arg0[f0_local0 .. f43_local5]
			local f43_local6 = ATTACHMENT.IsWeaponAttachmentTunable( f43_arg1, f43_arg0._weaponTable, f43_local3, f43_local11, f43_local1, f43_local2 )
			local f43_local8 = {
				category = f43_local3,
				attachments = f43_arg0._attachments[f43_local3],
				weaponPlayerData = f43_arg0._weaponPlayerData,
				isTunable = f43_local6,
				loadoutIndex = f43_arg0._loadoutIndex,
				weaponSlot = f43_arg0._weaponSlot,
				forShowcase = f43_arg0._forShowcase,
				weaponTable = f43_arg0._weaponTable,
				weaponModelName = f43_local1,
				categoryLockData = f43_local0,
				buttonIndex = f43_local5
			}
			if not IsPrivateMatch() and f0_local0( f43_arg0._weaponTable.weapon ) and f43_arg0._categoryLockDetails[f43_local3] then
				f43_local8.categoryLockData = f43_arg0._categoryLockDetails[f43_local3]
			end
			f43_local4:Setup( f43_arg1, f43_local8 )
			if CONDITIONS.InFrontend() and f43_local6 and f43_local11 and not GUNSMITH.IsWeaponSetupBlueprintIntact( f43_arg0._weaponPlayerData ) then
				if Onboarding.WasCompleted( f43_arg1, Onboarding.tutorials.GUNSMITH ) or not Onboarding.WasCompleted( f43_arg1, Onboarding.tutorials.TUNING_ACCESS ) then
					f43_arg0._gunsmithOnboardingButton = f43_local4
				end
			end
		end
	end
	if not f43_arg0._buttonsRemoved then
		f0_local0( f43_arg0 )
	end
	if not f43_arg0._navigationSetup then
		f0_local0( f43_arg0 )
	end
end

local f0_local13 = function ( f42_arg0, f42_arg1, f42_arg2 )
	if f42_arg0.GunsmithWeaponDetails then
		local f42_local0 = GUNSMITH.GetWeaponDetails( f42_arg1, f42_arg2 )
		f42_arg0._curAmmoDataTable = f42_local0
		if f42_arg0.UpdateDetailsDataSources then
			f42_arg0:UpdateDetailsDataSources( f42_arg1, f42_local0 )
		else
			f42_arg0.GunsmithWeaponDetails:Setup( f42_arg1, f42_local0 )
		end
		if not CONDITIONS.IsMobileOrMobileSim() then
			f42_arg0.GunsmithWeaponDetails:UpdateTacticalBuildLockUp( f42_arg0._weaponPlayerData, f42_arg2 )
		end
	end
end

local f0_local14 = function ( f41_arg0, f41_arg1 )
	return ClientModel[0x9088CC2C1E6A1E9]( CLIENT_MODEL.GetClientModelIndex( f41_arg0 ), f41_arg1 )
end

local f0_local15 = function ( f40_arg0, f40_arg1, f40_arg2, f40_arg3 )
	local f40_local0 = CLIENT_MODEL.GetClientModelIndex( f40_arg1 )
	local f40_local1 = ClientModel[0x7FE4C5AFE1F4377]( f40_local0, -1 )
	local f40_local2 = Engine[0xC3B7925CCAC9430]( f40_arg0, f40_arg2, f40_arg3 )
	f40_local1.yAngle = f40_local2.yAngle
	f40_local1.xAngle = f40_local2.xAngle
	ClientModel[0xEFA1738E096A743]( f40_local0, f40_local1 )
end

local f0_local16 = function ( f39_arg0 )
	CLIENT_MODEL.SetAllModelsModifiable( f39_arg0 )
	CLIENT_MODEL.InitGunViseModels()
	CLIENT_MODEL.HideModels( {
		base = CLIENT_MODEL.coreMPModels.GUN_VISE_SUPPORT_BASE,
		insert = CLIENT_MODEL.coreMPModels.GUN_VISE_SUPPORT_INSERT
	} )
	CLIENT_MODEL.SetModel( CLIENT_MODEL.coreMPModels.MAG_DISPLAY, "tag_origin" )
end

local f0_local17 = function ( f32_arg0, f32_arg1, f32_arg2 )
	local f32_local0 = {
		base = CLIENT_MODEL.coreMPModels.GUN_VISE_MAGWELL_BASE,
		insert = CLIENT_MODEL.coreMPModels.GUN_VISE_MAGWELL_INSERT
	}
	local f32_local1 = ClientWeapon[0x5DD69014A9C290]( FrontEndScene.ClientWeapons.Preview )
	ClientWeapon[0x8B8A4E0355DF0C0]( FrontEndScene.ClientWeapons.Preview, 0, 0, 0 )
	local f32_local2 = function ()
		local f34_local0 = LUI.UIWeaponModel.WEAPON_REFRESH_TIME
		local f34_local1 = f32_arg0 and f32_arg0.GunsmithWeaponDetails:Wait( f34_local0 ) or f32_arg0:Wait( f34_local0 )
		f34_local1.onComplete = function ()
			GUNSMITH.UpdateAmmoModel( f34_local0, f34_local0 )
			if CONDITIONS.IsMobileOrMobileSim() then
				ClientWeapon[0x8B8A4E0355DF0C0]( FrontEndScene.ClientWeapons.Preview, 0, 0, 0 )
			else
				f34_local0( f34_local0, f34_local0.insert, f34_local0, "offset_vise_attach" )
				local f35_local0 = Engine[0xF3C157C48E60860]( f34_local0, f34_local0, "offset_vise_attach" )
				local f35_local1 = Engine[0xF3C157C48E60860]( f34_local0, f34_local0, WEAPON.SilencedFlashTag )
				local f35_local2 = Engine[0xF3C157C48E60860]( f34_local0, f34_local0, WEAPON.MuzzleFlashTag )
				local f35_local3
				if f35_local1 then
					f35_local3 = WEAPON.SilencedFlashTag
					if not f35_local3 then
						if f35_local2 then
							f35_local3 = WEAPON.MuzzleFlashTag
							if not f35_local3 then
							
							else
								local f35_local4
								if Engine[0xF3C157C48E60860]( f34_local0, f34_local0, WEAPON.RearTag ) then
									f35_local4 = WEAPON.RearTag
									if not f35_local4 then
									
									else
										local f35_local5 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, GUNSMITH.defaultTag )
										local f35_local6 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, f35_local3 )
										local f35_local7 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, f35_local4 )
										local f35_local8 = f34_local0( CLIENT_MODEL.coreMPModels.GUN_VISE_BASE, CLIENT_MODEL.coreMPModels.GUN_VISE_BASE.tagOrigin )
										local f35_local9 = (f35_local6.xPosition + f35_local7.xPosition) / 2
										local f35_local10 = (f35_local6.yPosition + f35_local7.yPosition) / 2
										local f35_local11 = f35_local5.xPosition - f35_local9
										local f35_local12 = f35_local5.yPosition - f35_local10
										local f35_local13 = FrontEndScene.GetWeaponModelOffset( WEAPON.GetWeaponModelName( f34_local0._weaponTable.weapon, f34_local0._weaponTable, {
											includeAttachments = true
										} ), WEAPON.OffsetFiles.PreviewData )
										local f35_local14 = f35_local5.xPosition - f35_local8.xPosition + f35_local11 + f35_local13.xOffset
										local f35_local15 = f35_local5.yPosition - f35_local8.yPosition + f35_local12 + f35_local13.yOffset
										local f35_local16 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, "tag_mag_attach" )
										local f35_local17 = f34_local0( f34_local0.insert, f34_local0.insert.tagGunAttach )
										local f35_local18 = f35_local17.zPosition - f35_local16.zPosition + f35_local13.zOffset + GUNSMITH.GetWeaponZOffset( f34_local0, f34_local0, f34_local0._weaponTable.attachments, true )
										DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.xOffset:SetValue( f34_local0, f35_local14 )
										DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.yOffset:SetValue( f34_local0, f35_local15 )
										DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.zOffset:SetValue( f34_local0, f35_local18 )
										ClientWeapon[0x8B8A4E0355DF0C0]( FrontEndScene.ClientWeapons.Preview, f35_local14, f35_local15, f35_local18 )
									end
								end
								f35_local4 = WEAPON.PistolRearTag
							end
						end
						f35_local3 = WEAPON.FlashTag
					end
				else
					if f35_local2 then
						f35_local3 = WEAPON.MuzzleFlashTag
						if not f35_local3 then
						
						else
							local f35_local4
							if Engine[0xF3C157C48E60860]( f34_local0, f34_local0, WEAPON.RearTag ) then
								f35_local4 = WEAPON.RearTag
								if not f35_local4 then
								
								else
									local f35_local5 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, GUNSMITH.defaultTag )
									local f35_local6 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, f35_local3 )
									local f35_local7 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, f35_local4 )
									local f35_local8 = f34_local0( CLIENT_MODEL.coreMPModels.GUN_VISE_BASE, CLIENT_MODEL.coreMPModels.GUN_VISE_BASE.tagOrigin )
									local f35_local9 = (f35_local6.xPosition + f35_local7.xPosition) / 2
									local f35_local10 = (f35_local6.yPosition + f35_local7.yPosition) / 2
									local f35_local11 = f35_local5.xPosition - f35_local9
									local f35_local12 = f35_local5.yPosition - f35_local10
									local f35_local13 = FrontEndScene.GetWeaponModelOffset( WEAPON.GetWeaponModelName( f34_local0._weaponTable.weapon, f34_local0._weaponTable, {
										includeAttachments = true
									} ), WEAPON.OffsetFiles.PreviewData )
									local f35_local14 = f35_local5.xPosition - f35_local8.xPosition + f35_local11 + f35_local13.xOffset
									local f35_local15 = f35_local5.yPosition - f35_local8.yPosition + f35_local12 + f35_local13.yOffset
									local f35_local16 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, "tag_mag_attach" )
									local f35_local17 = f34_local0( f34_local0.insert, f34_local0.insert.tagGunAttach )
									local f35_local18 = f35_local17.zPosition - f35_local16.zPosition + f35_local13.zOffset + GUNSMITH.GetWeaponZOffset( f34_local0, f34_local0, f34_local0._weaponTable.attachments, true )
									DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.xOffset:SetValue( f34_local0, f35_local14 )
									DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.yOffset:SetValue( f34_local0, f35_local15 )
									DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.zOffset:SetValue( f34_local0, f35_local18 )
									ClientWeapon[0x8B8A4E0355DF0C0]( FrontEndScene.ClientWeapons.Preview, f35_local14, f35_local15, f35_local18 )
								end
							end
							f35_local4 = WEAPON.PistolRearTag
						end
					end
					f35_local3 = WEAPON.FlashTag
				end
				local f35_local4
				if Engine[0xF3C157C48E60860]( f34_local0, f34_local0, WEAPON.RearTag ) then
					f35_local4 = WEAPON.RearTag
					if not f35_local4 then
					
					else
						local f35_local5 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, GUNSMITH.defaultTag )
						local f35_local6 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, f35_local3 )
						local f35_local7 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, f35_local4 )
						local f35_local8 = f34_local0( CLIENT_MODEL.coreMPModels.GUN_VISE_BASE, CLIENT_MODEL.coreMPModels.GUN_VISE_BASE.tagOrigin )
						local f35_local9 = (f35_local6.xPosition + f35_local7.xPosition) / 2
						local f35_local10 = (f35_local6.yPosition + f35_local7.yPosition) / 2
						local f35_local11 = f35_local5.xPosition - f35_local9
						local f35_local12 = f35_local5.yPosition - f35_local10
						local f35_local13 = FrontEndScene.GetWeaponModelOffset( WEAPON.GetWeaponModelName( f34_local0._weaponTable.weapon, f34_local0._weaponTable, {
							includeAttachments = true
						} ), WEAPON.OffsetFiles.PreviewData )
						local f35_local14 = f35_local5.xPosition - f35_local8.xPosition + f35_local11 + f35_local13.xOffset
						local f35_local15 = f35_local5.yPosition - f35_local8.yPosition + f35_local12 + f35_local13.yOffset
						local f35_local16 = Engine[0xC3B7925CCAC9430]( f34_local0, f34_local0, "tag_mag_attach" )
						local f35_local17 = f34_local0( f34_local0.insert, f34_local0.insert.tagGunAttach )
						local f35_local18 = f35_local17.zPosition - f35_local16.zPosition + f35_local13.zOffset + GUNSMITH.GetWeaponZOffset( f34_local0, f34_local0, f34_local0._weaponTable.attachments, true )
						DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.xOffset:SetValue( f34_local0, f35_local14 )
						DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.yOffset:SetValue( f34_local0, f35_local15 )
						DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.zOffset:SetValue( f34_local0, f35_local18 )
						ClientWeapon[0x8B8A4E0355DF0C0]( FrontEndScene.ClientWeapons.Preview, f35_local14, f35_local15, f35_local18 )
					end
				end
				f35_local4 = WEAPON.PistolRearTag
			end
			CLIENT_MODEL.HideModels( f34_local0 )
			local f35_local0 = f34_local0 and f34_local0.GunsmithWeaponDetails:Wait( 5 ) or f34_local0:Wait( 5 )
			f35_local0.onComplete = function ()
				local f36_local0 = ATTACHMENT.GetAttachmentCategoryBone( ATTACHMENT.receiverCategory )
				local f36_local1 = Engine[0xC3B7925CCAC9430]( f35_local0, f35_local0, f36_local0 )
				local f36_local2 = CLIENT_MODEL.NO_CLIENT_MODEL .. "," .. f36_local1.xPosition .. "," .. f36_local1.yPosition .. "," .. f36_local1.zPosition .. "," .. f36_local1.xAngle .. "," .. f36_local1.yAngle .. "," .. f36_local1.zAngle
				if GL_HACK.GetWeaponMPRef( f35_local0._weaponTable.weapon ) == "jup_jp31_dm_compound_mp" then
					f36_local2 = CLIENT_MODEL.NO_CLIENT_MODEL .. "," .. f36_local1.xPosition .. "," .. f36_local1.yPosition .. "," .. f36_local1.zPosition .. "," .. 0 .. "," .. 153.605 .. "," .. 0
				end
				Engine[0x6055C55456F05DF]( f36_local2, 1 )
				if f35_local0 then
					local f36_local3 = f35_local0.GunsmithWeaponDetails:Wait( 5 )
					f36_local3.onComplete = function ()
						GUNSMITH.SetGunsmithWeaponOffset( f36_local0 )
						GUNSMITH.SetGunsmithCameraPosition( f36_local0 )
					end
					
				end
				DataSources.frontEnd.MP.CAC.gunsmithWeaponOffsets.offsetsData.tagDataString:SetValue( f35_local0, f36_local2 )
				local f36_local3 = LUI.FlowManager.GetScopedData( f35_local0 )
				local f36_local4 = ATTACHMENT.GetAttachmentCategoryButton( ATTACHMENT.receiverCategory )
				if f36_local3 and f36_local3.buttonIndex then
					local f36_local5 = f35_local0[f35_local0 .. f36_local3.buttonIndex]
					if not f36_local5 and f35_local0._usedButtons then
						for f36_local9, f36_local10 in pairs( f35_local0._usedButtons ) do
							if f36_local10 then
								f36_local3.buttonCategoryToFocus = f36_local10
								f36_local3.buttonIndex = f36_local9
								f36_local5 = f35_local0[f35_local0 .. f36_local9]
								break
							end
						end
					end
					f36_local5:processEvent( {
						immediate = true,
						name = "gain_focus"
					} )
				elseif f35_local0._usedButtons[f36_local4] then
					local f36_local5 = f35_local0[f35_local0 .. f36_local4]
					if f36_local5 ~= nil then
						f36_local5:processEvent( {
							immediate = true,
							name = "gain_focus"
						} )
					end
				else
					if f35_local0._usedButtons and not LUI.IsLastInputMouseNavigation( f35_local0 ) then
						for f36_local8, f36_local9 in pairs( f35_local0._usedButtons ) do
							local f36_local10 = f35_local0[f35_local0 .. f36_local8]
							if f36_local10 then
								f36_local10:processEvent( {
									immediate = true,
									name = "gain_focus"
								} )
								break
							end
						end
					end
					local f36_local5 = f35_local0( f35_local0.insert, f35_local0.insert.tagOrigin )
					local f36_local6 = f35_local0( f35_local0.insert, f35_local0.insert.tagGunAttach )
					local f36_local7 = Engine[0xC3B7925CCAC9430]( f35_local0, f35_local0, "offset_vise_attach" )
					f36_local5.xPosition = f36_local7.xPosition - f36_local6.xPosition - f36_local5.xPosition
					f36_local5.yPosition = f36_local7.yPosition - f36_local6.yPosition - f36_local5.yPosition
					ClientModel[0x9C89C00DF9B85ED]( CLIENT_MODEL.GetClientModelIndex( f35_local0.insert ), f36_local5 )
					local f36_local8 = f35_local0 and f35_local0.GunsmithWeaponDetails:Wait( 5 ) or f35_local0:Wait( 5 )
					f36_local8.onComplete = function ()
						local f37_local0 = f36_local0( f36_local0.base, f36_local0.base.tagOrigin )
						f36_local0 = f36_local0( f36_local0.insert, f36_local0.insert.tagOrigin )
						f37_local0.xPosition = f36_local0.xPosition
						f37_local0.yPosition = f36_local0.yPosition
						ClientModel[0x9C89C00DF9B85ED]( CLIENT_MODEL.GetClientModelIndex( f36_local0.base ), f37_local0 )
					end
					
				end
			end
			
		end
		
	end
	
	local f32_local3 = LUI.FlowManager.GetScopedData( f32_arg0 )
	if f32_local3.startTime ~= f32_local3.lastTimeStamp then
		f32_local2()
	else
		f32_arg0:SubscribeToModel( f32_arg0._weaponPositionUpdatedModel, function ( f33_arg0 )
			if DataModel[0x614D394F6F9A18D]( f33_arg0 ) then
				f32_arg0()
			end
		end, true )
	end
end

local f0_local18 = function ( f31_arg0, f31_arg1 )
	if not f31_arg0._lastFocusedButtonGroupElement then
		local f31_local0 = LUI.FlowManager.GetScopedData( f31_arg0 )
		local f31_local1 = ATTACHMENT.GetAttachmentCategoryButton( ATTACHMENT.receiverCategory )
		if f31_local0 and f31_local0.buttonIndex then
			f31_arg0._lastFocusedButtonGroupElement = f31_arg0[f0_local0 .. f31_local0.buttonIndex]
		elseif f31_arg0._usedButtons[f31_local1] then
			f31_arg0._lastFocusedButtonGroupElement = f31_arg0[f0_local0 .. f31_local1]
		elseif f31_arg0._usedButtons then
			for f31_local5, f31_local6 in pairs( f31_arg0._usedButtons ) do
				if f31_arg0[f0_local0 .. f31_local5] then
					f31_arg0._lastFocusedButtonGroupElement = f31_arg0[f0_local0 .. f31_local5]
					break
				end
			end
		end
	end
end

local f0_local19 = function ( f30_arg0, f30_arg1 )
	if f30_arg0._usedButtons then
		for f30_local3, f30_local4 in pairs( f30_arg0._usedButtons ) do
			if f30_local4 == f30_arg1 then
				return f30_arg0[f0_local0 .. f30_local3]
			end
		end
		
	else
		return nil
	end
end

local f0_local20 = function ( f29_arg0, f29_arg1 )
	if f29_arg0._weaponTable and f29_arg0._weaponTable.attachments and f29_arg0._attachments and f29_arg0._usedButtons then
		GUNSMITH.UpdateBlockedAttachments( f29_arg1, f29_arg0._weaponTable, f29_arg0._attachments, f29_arg0._usedButtons )
		for f29_local5, f29_local6 in pairs( f29_arg0._usedButtons ) do
			local f29_local7 = f29_arg0._attachments[f29_local6]
			if f29_local6 ~= ATTACHMENT.receiverCategory and f29_local6 ~= ATTACHMENT.conversionkit and f29_local7 then
				local f29_local3 = GUNSMITH.AreAllAttachmentsBlockedInCategory( f29_arg1, f29_local7 )
				local f29_local4 = f0_local0( f29_arg0, f29_local6 )
				if f29_local4 then
					f29_local4:UpdateBlockedIcon( f29_local3.allBlocked )
				end
			end
		end
	end
end

local f0_local21 = function ( f28_arg0, f28_arg1, f28_arg2 )
	if f28_arg0.GunsmithWeaponDetails and f28_arg0.GunsmithWeaponDetails.StatsWithDetails and f28_arg0.GunsmithWeaponDetails.StatsWithDetails.WeaponAttributes then
		local f28_local0 = GUNSMITH.SetupWeaponAttributes( f28_arg1, f28_arg0._weaponTable, f28_arg0._weaponPlayerData )
		if f28_local0 then
			if f28_arg2 then
				f28_arg0.GunsmithWeaponDetails.StatsWithDetails.WeaponAttributes:Setup( f28_local0, true, false )
			else
				f28_arg0.GunsmithWeaponDetails.StatsWithDetails.WeaponAttributes:Update( f28_local0 )
			end
		end
	end
end

local f0_local22 = function ( f27_arg0, f27_arg1, f27_arg2 )
	f27_arg0._controllerIndex = f27_arg1
	f27_arg0._forShowcase = f27_arg2.forShowcase
	f27_arg0._commitShowcaseChanges = f27_arg2.commitShowcaseChanges
	local f27_local0 = LUI.DataSourceFromOmnvar.new( "frontend_weapon_position_updated" )
	f27_arg0._weaponPositionUpdatedModel = f27_local0:GetModel( f27_arg1 )
	f27_local0 = LUI.DataSourceFromOmnvar.new( "frontend_weapon_position_force_update" )
	f27_arg0._weaponPositionForceUpdateModel = f27_local0:GetModel( f27_arg1 )
	if Engine[0x2DA54CF5D6B7F02]() then
		f0_local0( f27_arg0, f27_arg1, f27_arg2 )
	end
	f27_arg0._loadoutIndex = f27_arg2.loadoutIndex
	f27_arg0._weaponSlot = f27_arg2.weaponSlot
	f27_arg2.loadoutPlayerData = f27_arg0._loadoutPlayerData
	f27_arg2.weaponPlayerData = f27_arg0._weaponPlayerData
	if CONDITIONS.IsDMZMatch() then
		f27_arg0._equippedWeaponSlot = f27_arg2.equippedWeaponSlot
	end
end

local f0_local23 = function ( f25_arg0, f25_arg1 )
	f25_arg0:SubscribeToModel( f25_arg0._weaponPositionUpdatedModel, function ( f26_arg0 )
		if DataModel[0x614D394F6F9A18D]( f26_arg0 ) then
			GUNSMITH.SetGunsmithWeaponOffset( f25_arg0 )
			GUNSMITH.SetGunsmithCameraPosition( f25_arg0 )
		end
	end, true )
	GUNSMITH.SetAreInWeaponPreviewScene( false )
end

local f0_local24 = function ( f23_arg0, f23_arg1 )
	if not f23_arg0.waitForTagDataTimer then
		f23_arg0.waitForTagDataTimer = LUI.UITimer.new( {
			interval = 50,
			event = "waitForTagData"
		} )
		f23_arg0:addElement( f23_arg0.waitForTagDataTimer )
	end
	local f23_local0 = ClientWeapon[0x5DD69014A9C290]( FrontEndScene.ClientWeapons.Preview )
	f23_arg0:registerEventHandler( "waitForTagData", function ( element, event )
		local f24_local0 = Engine[0xF3C157C48E60860]( f23_arg0, f23_arg0, WEAPON.SilencedFlashTag )
		local f24_local1 = Engine[0xF3C157C48E60860]( f23_arg0, f23_arg0, WEAPON.MuzzleFlashTag )
		local f24_local2
		if f24_local0 then
			f24_local2 = WEAPON.SilencedFlashTag
			if not f24_local2 then
				if f24_local1 then
					f24_local2 = WEAPON.MuzzleFlashTag
					if not f24_local2 then
					
					else
						local f24_local3 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, GUNSMITH.defaultTag )
						local f24_local4 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, f24_local2 )
						local f24_local5 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, WEAPON.RearTag )
						local f24_local6 = f23_arg0
						local f24_local7
						if f24_local3 then
							f24_local7 = f24_local3
						elseif f24_local4 then
							f24_local7 = f24_local4
						else
							f24_local7 = f24_local5
						end
						f24_local6.isTagDataAvailable = f24_local7
						if f23_arg0.isTagDataAvailable then
							f23_arg0( f23_arg0, f23_arg0 )
							if f23_arg0.waitForTagDataTimer then
								f23_arg0.waitForTagDataTimer:closeTree()
								f23_arg0.waitForTagDataTimer = nil
							end
						end
					end
				end
				f24_local2 = WEAPON.FlashTag
			end
		else
			if f24_local1 then
				f24_local2 = WEAPON.MuzzleFlashTag
				if not f24_local2 then
				
				else
					local f24_local3 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, GUNSMITH.defaultTag )
					local f24_local4 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, f24_local2 )
					local f24_local5 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, WEAPON.RearTag )
					local f24_local6 = f23_arg0
					local f24_local7
					if f24_local3 then
						f24_local7 = f24_local3
					elseif f24_local4 then
						f24_local7 = f24_local4
					else
						f24_local7 = f24_local5
					end
					f24_local6.isTagDataAvailable = f24_local7
					if f23_arg0.isTagDataAvailable then
						f23_arg0( f23_arg0, f23_arg0 )
						if f23_arg0.waitForTagDataTimer then
							f23_arg0.waitForTagDataTimer:closeTree()
							f23_arg0.waitForTagDataTimer = nil
						end
					end
				end
			end
			f24_local2 = WEAPON.FlashTag
		end
		local f24_local3 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, GUNSMITH.defaultTag )
		local f24_local4 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, f24_local2 )
		local f24_local5 = Engine[0xC3B7925CCAC9430]( f23_arg0, f23_arg0, WEAPON.RearTag )
		local f24_local6 = f23_arg0
		local f24_local7
		if f24_local3 then
			f24_local7 = f24_local3
		elseif f24_local4 then
			f24_local7 = f24_local4
		else
			f24_local7 = f24_local5
		end
		f24_local6.isTagDataAvailable = f24_local7
		if f23_arg0.isTagDataAvailable then
			f23_arg0( f23_arg0, f23_arg0 )
			if f23_arg0.waitForTagDataTimer then
				f23_arg0.waitForTagDataTimer:closeTree()
				f23_arg0.waitForTagDataTimer = nil
			end
		end
	end )
end

local f0_local25 = function ( f21_arg0, f21_arg1 )
	if f21_arg0._weaponPositionForceUpdateModel ~= nil then
		f21_arg0:SubscribeToModel( f21_arg0._weaponPositionForceUpdateModel, function ( f22_arg0 )
			if DataModel[0x614D394F6F9A18D]( f22_arg0 ) then
				f21_arg0( f21_arg0, f21_arg0, true )
			end
		end, true )
	end
end

local f0_local26 = function ( f20_arg0, f20_arg1 )
	local f20_local0 = GL_HACK.GetWeaponMPRef( f20_arg0._weaponTable.weapon )
	local f20_local1 = LUI.FlowManager.GetScopedData( f20_arg0 )
	if f20_local1.attachmentData and f20_local1.attachmentData[f20_local0] then
		f20_arg0._attachments = f20_local1.attachmentData[f20_local0].attachments
		f20_arg0._bucketItems = f20_local1.attachmentData[f20_local0].bucketItems
	else
		f20_arg0._attachments, f20_arg0._bucketItems = GL_HACK.GetAttachmentsAndBucketItems( f20_arg1, {
			isWeaponParts = true,
			isForceRequestingAttachmentData = true,
			weaponRef = f20_local0,
			blueprintID = f20_arg0._weaponTable.lootID
		} )
		f20_local1.attachmentData = {}
		f20_local1.attachmentData[f20_local0] = {}
		f20_local1.attachmentData[f20_local0].attachments = f20_arg0._attachments
		f20_local1.attachmentData[f20_local0].bucketItems = f20_arg0._bucketItems
	end
	if not WEAPON.IsWeaponNoneValue( f20_arg0._weaponTable.weapon ) then
		f20_arg0._usedButtons = GUNSMITH.GetUsedAttachmentIndices( f20_arg0._weaponTable.weapon, f20_arg0._attachments )
	else
		local f20_local2 = WEAPON.GenerateEmptyWeaponTable()
		f20_arg0._usedButtons = GUNSMITH.GetUsedAttachmentIndices( WEAPON.GetDefaultPrimaryWeaponRef(), f20_local2.attachments )
	end
	if CONDITIONS.IsGLGunsmithEnabled() and CONDITIONS.IsGunsmithReceiverButtonEnabled() and f20_arg0._attachments[ATTACHMENT.receiverCategory] and 0 < #f20_arg0._attachments[ATTACHMENT.receiverCategory] then
		f20_arg0._usedButtons[ATTACHMENT.GetAttachmentCategoryButton( ATTACHMENT.receiverCategory )] = ATTACHMENT.receiverCategory
	end
	f20_arg0._categoryLockDetails = GUNSMITH.GetCategoryLockDetails( f20_arg1, f20_arg0._weaponTable.weapon )
end

local f0_local27 = function ( f19_arg0, f19_arg1 )
	local f19_local0 = f19_arg0._curTuneButton
	if f19_local0 then
		f19_local0:SetVisible( false )
		f19_local0:SetHandleMouse( false )
		f19_local0:SetButtonDisabled( true )
	end
	if f19_arg0._curReticleButton then
		f19_arg0._curReticleButton:SetVisible( false )
		f19_arg0._curReticleButton:SetHandleMouse( false )
	end
	f19_arg0._curTuneButton = f19_arg1.tuneButton
	f19_arg0._curReticleButton = f19_arg1.reticleButton
end

local f0_local28 = function ( f18_arg0, f18_arg1, f18_arg2 )
	f18_arg0._weaponPlayerData.blueprintTuned:set( 0 )
	if f18_arg2._usedButtons then
		for f18_local4, f18_local5 in pairs( f18_arg2._usedButtons ) do
			if f18_local5 ~= ATTACHMENT.receiverCategory then
				local f18_local3 = f18_arg2[f0_local0 .. f18_local4]
				if f18_local3 and f18_local3.UpdateTuneIcon then
					f18_local3:UpdateTuneIcon( f18_arg1 )
				end
			end
		end
	end
	if f18_arg0.GunsmithWeaponDetails then
		f18_arg0.GunsmithWeaponDetails:UpdateTacticalBuildLockUp( f18_arg0._weaponPlayerData, f18_arg0._weaponTable )
	end
end

local f0_local29 = function ( f17_arg0, f17_arg1 )
	if f17_arg0.UpdateDetailsDataSources then
		f17_arg0:UpdateDetailsDataSources( f17_arg1, GUNSMITH.GetWeaponDetails( f17_arg1, f17_arg0._weaponTable ) )
	else
		local f17_local0 = GUNSMITH.GetEquipCounts( f17_arg0._weaponTable.weapon, f17_arg0._weaponTable, f17_arg0._weaponTable.attachments )
		f17_arg0.GunsmithWeaponDetails:UpdateModification( f17_local0.attachmentCount, f17_arg0.GunsmithWeaponDetails.AttachmentEquipPips._maxPips, f17_local0.restrictedAttachmentCount, f17_local0 )
	end
end

local f0_local30 = function ( f14_arg0, f14_arg1 )
	f14_arg0:addEventHandler( "attachment_count_update", function ( f16_arg0, f16_arg1 )
		f14_arg0._weaponTable = f16_arg1.weaponTable
		f14_arg0( f14_arg0, f14_arg0 )
		f14_arg0( f14_arg0, f14_arg0, false )
	end )
	f14_arg0:addEventHandler( "update_attachments", function ( f15_arg0, f15_arg1 )
		f14_arg0._weaponTable = f15_arg1.weaponTable
		f14_arg0( f14_arg0, f14_arg0 )
		if not CONDITIONS.IsMobileOrMobileSim() and f14_arg0.GunsmithWeaponDetails then
			f14_arg0.GunsmithWeaponDetails:UpdateTacticalBuildLockUp( f14_arg0._weaponPlayerData, f14_arg0._weaponTable )
		end
	end )
end

local f0_local31 = function ( f13_arg0 )
	if f13_arg0.Vignette then
		ACTIONS.ScaleFullscreen( f13_arg0.Vignette )
	end
	if f13_arg0.Gradient then
		ACTIONS.ScaleFullscreen( f13_arg0.Gradient )
	end
	if f13_arg0.SaveMod then
		f13_arg0.SaveMod:SetAlpha( 0 )
	end
	if f13_arg0.CustomModSlotCount then
		f13_arg0.CustomModSlotCount:SetAlpha( 0 )
	end
	if f13_arg0.NextSlotUnlock then
		f13_arg0.NextSlotUnlock:SetAlpha( 0 )
	end
end

local f0_local32 = function ( f12_arg0 )
	local f12_local0 = f12_arg0._controllerIndex
	if f12_arg0.comingFromGunsmithTips then
		ACTIONS.UploadStats( f12_arg0, f12_local0 )
	end
	f12_arg0.comingFromGunsmithTips = false
	local f12_local1
	if CONDITIONS.ForceOnboarding() then
		f12_local1 = true
	else
		f12_local1 = Onboarding.WasCompleted( f12_local0, Onboarding.tutorials.GUNSMITH )
	end
	local f12_local2 = not Onboarding.WasCompleted( f12_local0, Onboarding.tutorials.TUNING_ACCESS )
	if f12_local1 then
		if not Onboarding.WasCompleted( f12_local0, Onboarding.tutorials.AFTERMARKET_PARTS ) and f12_arg0.GLGunsmithButton12 then
			local f12_local3 = f12_arg0._attachments[ATTACHMENT.conversionkit]
			if f12_local3 and 0 < #f12_local3 then
				for f12_local13, f12_local14 in ipairs( f12_local3 ) do
					local f12_local15 = LOOT.GetIDForRef( f12_local14 )
					if f12_local15 and PROGRESSION.IsUnlockedWithID( f12_arg0._controllerIndex, f12_local15 ) then
						local f12_local7 = TIP.CreateTips
						local f12_local8 = Onboarding.Tips.AFTERMARKET_PARTS
						local f12_local9 = f12_arg0
						local f12_local10 = f12_local0
						local f12_local11 = f12_arg0.GLGunsmithButton12
						local f12_local12
						if f12_local2 then
							f12_local12 = f0_local0
							if not f12_local12 then
							
							else
								f12_local7( f12_local8( f12_local9, f12_local10, f12_local11, f12_local12 ) )
								f12_local2 = false
								break
							end
						end
						f12_local12 = nil
					end
				end
			end
		end
		if f12_local2 then
			f0_local0( f12_arg0, f12_arg0._gunsmithOnboardingButton )
		end
	end
end

local f0_local33 = function ( f11_arg0, f11_arg1 )
	if not Onboarding.WasCompleted( f11_arg1, Onboarding.tutorials.GUNSMITH ) then
		local f11_local0 = {}
		local f11_local1 = f11_arg0:getParent()
		if f11_local1 then
			f11_local1 = f11_arg0:getParent()
			f11_local1 = f11_local1.Tabs
		end
		local f11_local2
		if f11_local1 then
			f11_local2 = f11_local1
		else
			f11_local2 = f11_local1._tabElements
		end
		table.insert( f11_local0, f11_local1 )
		for f11_local6, f11_local7 in ipairs( f11_local2 ) do
			table.insert( f11_local0, f11_local7 )
		end
		table.insert( f11_local0, f11_local1.rightShoulderButton )
		TIP.CreateTips( Onboarding.Tips.GUNSMITH( f11_arg1, f11_arg0, f0_local0, f11_local0, f11_local1 ) )
	end
end

local f0_local34 = function ( f10_arg0, f10_arg1 )
	if f10_arg0.WeaponBlueprintBranding and f10_arg0._weaponTable then
		GUNSMITH.UpdateWeaponStatsBranding( f10_arg1, f10_arg0.WeaponBlueprintBranding.Branding, WEAPON.GenerateWeaponTableFromWeaponString( f10_arg0._weaponTable.weapon, WEAPON.GetWeaponModelName( f10_arg0._weaponTable.weapon, f10_arg0._weaponTable, {
			includeAttachments = true
		} ), {
			shouldConvertVariantIDToNumber = true,
			shouldIncludeAllAttachments = true
		} ) )
	end
end

local f0_local35 = function ( f9_arg0, f9_arg1 )
	local f9_local0 = LUI.FlowManager.GetScopedData( f9_arg0 )
	f9_local0.startTime = Engine[0x3B8CFB6758EF57C]()
	local f9_local1 = f9_local0.lastTimeStamp
	if not f9_local1 then
		f9_local1 = Engine[0x3B8CFB6758EF57C]()
	end
	f9_local0.lastTimeStamp = f9_local1
	f9_local0.attachmentTimeSpent = f9_local0.attachmentTimeSpent or 0
	f9_local0.customizeTimeSpent = f9_local0.customizeTimeSpent or 0
	f9_local0.previousAttachmentConfig = ATTACHMENT.GetConfigString( f9_arg0._weaponTable )
	f9_local0.previousCosmeticConfig = WEAPON.GetCosmeticConfigString( f9_arg0._weaponTable )
	f9_local0.previousBlueprintString = WEAPON.GetWeaponBlueprintString( f9_arg1, f9_arg0._weaponTable, f9_local0.previousAttachmentConfig )
end

local f0_local36 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.GetGunsmithButtonGroupForCategory = f0_local0
	f3_arg0._controllerIndex = f3_arg1
	f0_local0( f3_arg0, f3_arg1, f3_arg2 )
	GUNSMITH.SetupWeaponData( f3_arg0, f3_arg1, f3_arg0._weaponSlot, f3_arg0._forShowcase )
	GUNSMITH.SetupWeaponModel( f3_arg0, f3_arg1 )
	GUNSMITH.InitGunsmithWeaponOffsetDataSources()
	GUNSMITH.SetAreInGunsmithScene( true )
	f0_local0( f3_arg1 )
	if GUNSMITH.WasInWeaponPreviewScene() then
		f0_local0( f3_arg0, f3_arg1 )
	else
		f0_local0( f3_arg0, f3_arg1 )
	end
	f0_local0( f3_arg0, f3_arg1 )
	WEAPON.SetGunsmithSceneForWeapon( WEAPON.GetWeaponClassWithAttachments( f3_arg0._weaponTable ) )
	ClientWeapon[0x59B77D6F41ED417]( FrontEndScene.ClientWeapons.Preview, false )
	if WEAPON.IsWeaponNoneValue( f3_arg0._weaponTable.weapon ) then
		f3_arg0._weaponTable.weapon = WEAPON.GetDefaultPrimaryWeaponRef()
	end
	MenuUtils.SetupSceneChangeCallback( f3_arg0, f0_local0( f3_arg0, f3_arg1 ) )
	f0_local0( f3_arg0, f3_arg1 )
	GUNSMITH.SetupSaveWeaponPopup( f3_arg0, f3_arg1, f3_arg2 )
	f0_local0( f3_arg0, f3_arg1, f3_arg2 )
	f0_local0( f3_arg0, f3_arg1, f3_arg0._weaponTable )
	f0_local0( f3_arg0, f3_arg1, true )
	f0_local0( f3_arg0, f3_arg1 )
	if not f3_arg2.forShowcaseInspect then
		f0_local0( f3_arg0, f3_arg1 )
		f0_local0( f3_arg0, f3_arg1 )
	end
	f3_arg0:addEventHandler( "update_tune_button", f0_local0 )
	f3_arg0:addEventHandler( "set_last_focused_element", function ( f8_arg0, f8_arg1 )
		f3_arg0._lastFocusedButtonGroupElement = f8_arg1.lastFocusedButtonGroupElement
	end )
	f3_arg0:addEventHandler( "break_blueprint", function ( f7_arg0, f7_arg1 )
		f3_arg0( f3_arg0, f3_arg0, f7_arg0 )
	end )
	ACTIONS.AnimateSequence( f3_arg0, "GL_Layout" )
	f0_local0( f3_arg0, f3_arg1 )
	f0_local0( f3_arg0, f3_arg1 )
	f0_local0( f3_arg0 )
	if IsLanguageArabic() then
		ACTIONS.AnimateSequence( f3_arg0, "AR" )
	end
	f3_arg0:addEventHandler( "restore_focus", function ( f6_arg0, f6_arg1 )
		GUNSMITH.SetGunsmithCameraPosition( f3_arg0 )
		f3_arg0( f6_arg0, f6_arg1 )
		return true
	end )
	f0_local0( f3_arg0, f3_arg1 )
	f3_arg0:SubscribeToInputTypeModel( f3_arg1, function ( f5_arg0, f5_arg1 )
		f3_arg0( f5_arg1, {
			controller = f5_arg1._controllerIndex
		} )
	end, true )
	f3_arg0:addEventHandler( "menu_close", GUNSMITH.OnGunsmithMenuCloseEventHandler )
	f3_arg0:addEventHandler( "menu_create", function ()
		if not CONDITIONS.AreFrontendTipsEnabled() then
			return 
		else
			f3_arg0( f3_arg0, f3_arg0 )
			f3_arg0( f3_arg0 )
		end
	end )
	if f3_arg0.CDLRestrictionTag then
		local f3_local0 = GUNSMITH.IsWeaponSetupBlueprintIntact( f3_arg0._weaponPlayerData )
		local f3_local1 = GUNSMITH.DoesWeaponSetupContainProtunedAttachment( f3_arg0._weaponPlayerData )
		local f3_local2
		if f3_local0 then
			f3_local2 = f3_local0
		else
			f3_local2 = f3_local1
		end
		local f3_local3 = 50
		local f3_local4 = LAYOUT.GetTextWidth( f3_arg0.GunsmithWeaponDetails.WeaponName )
		local f3_local5 = f3_arg0.GunsmithWeaponDetails:GetAnchorsAndPosition()
		f3_local4 = f3_local4 + f3_local5.left
		if f3_local2 then
			f3_local4 = f3_local4 + f3_local3 + LAYOUT.GetTextWidth( f3_arg0.GunsmithWeaponDetails.ProtunedTag.Label )
		end
		f3_local5 = f3_arg0.CDLRestrictionTag:GetAnchorsAndPosition()
		local f3_local6 = 16
		if f3_local5.left < f3_local4 then
			f3_arg0.CDLRestrictionTag:SetLeft( f3_local4 + f3_local6 )
		end
	end
end

local f0_local37 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
	f2_arg0.GetGunsmithButtonGroupForCategory = f0_local0
end

function GunsmithBase( f1_arg0, f1_arg1 )
	local f1_local0 = ACTIONS
	local f1_local1 = LUI
	local f1_local2 = f1_local1.UIElement.new()
	f1_local2:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920, 0, 1080 )
	f1_local2.id = "GunsmithBase"
	local f1_local3
	if f1_arg1 then
		f1_local3 = f1_arg1
	else
		f1_local3 = f1_arg1.controllerIndex
	end
	f1_local3 = f1_local1.ValidateControllerIndex( f1_local2, f1_local3 )
	local f1_local4 = f1_local2
	GUNSMITH.SetupGunsmithMenu( f1_local2, f1_local3, f1_arg1 )
	f0_local0( f1_local2, f1_local3, f1_arg1 )
	return f1_local2
end

MenuBuilder.registerType( 0x375412319226915, GunsmithBase )
LockTable( _M )
