-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
module( ..., package.seeall )
local f0_local0 = 10
local f0_local1 = "button_right_trigger"
local f0_local2 = "button_side_navigation"
local f0_local3 = "button_left_trigger"
local f0_local4 = Engine[0xED84C33EC5F01EA]( 0xA4C706FC71E678F )
local f0_local5 = Engine[0xED84C33EC5F01EA]( 0x5C76D41878B3E0 )
local f0_local6 = function ( f52_arg0 )
	local f52_local0 = LUI.FlowManager.GetScopedData( f52_arg0 )
	f52_local0.lastFocusedWeaponButtonPosition = f52_arg0._focusedWeaponButtonPosition
end

local f0_local7 = function ( f51_arg0, f51_arg1, f51_arg2 )
	if f51_arg0._selectedWeapon.weapon ~= f51_arg2.ref then
		f51_arg0:dispatchEventToRoot( {
			name = "send_toast_notification",
			immediate = true,
			options = {
				iconScale = 4.667263495923649E-62,
				displayTime = 3000,
				icon = "cac_equip_fill",
				iconColor = SWATCHES.genericMenu.notificationHighlight,
				header = Engine[0xED84C33EC5F01EA]( 0xE1DD4086AE4AD11 ),
				description = f51_arg2.header,
				type = LUI.ToastManager.NotificationType.WeaponEquipped,
				controllerIndex = f51_arg1
			}
		} )
	end
	if not f51_arg0._forShowcase and CoD.IsDMZMatch() and DMZ.IsInstanceInventoryEnabledFrontend() then
		DMZ.SetInsuredWeaponPlayerData( f51_arg1, f51_arg0._weaponSlot, f51_arg2 )
	elseif not f51_arg2.isBase then
		if not WEAPON.EquipModification( f51_arg0._loadoutPlayerData.weaponSetups[f51_arg0._weaponSlot], f51_arg2, f51_arg1, f51_arg2.isCustom ) then
			return false
		end
	else
		WEAPON.EquipBaseWeapon( f51_arg0._loadoutPlayerData.weaponSetups[f51_arg0._weaponSlot], f51_arg2.weapon )
		GUNSMITH.EquipBaseWeaponPartsAttachment( f51_arg0._controllerIndex, f51_arg0._loadoutPlayerData.weaponSetups[f51_arg0._weaponSlot] )
	end
	if f51_arg0._forShowcase then
		Social[0x6B83DE97344CD52]( f51_arg1 )
	end
	if not f51_arg0._forShowcase then
		LOOT.SendDlogLootEquipped( f51_arg1, LOOT.itemTypes.WEAPON, f51_arg0._selectedWeapon, f51_arg2 )
	end
	LUI.FlowManager.RequestLeaveMenuByName( LOADOUT.GetWeaponMenuRef(), true, true )
	LUI.FlowManager.RequestLeaveMenu( f51_arg0, false )
	return true
end

local f0_local8 = function ( f50_arg0, f50_arg1, f50_arg2, f50_arg3 )
	local f50_local0
	if not f50_arg2 then
		f50_local0 = f50_arg2
	else
		f50_local0 = {}
	end
	f50_local0.weaponTable = f50_arg0._currentWeapon
	f50_arg0:UpdateLastFocusedButton()
	LUI.FlowManager.RequestAddMenu( GUNSMITH.GetWeaponPreviewMenuRef(), true, f50_arg1, nil, f50_local0, true )
end

local f0_local9 = function ( f49_arg0 )
	local f49_local0
	if not f49_arg0 then
		f49_local0 = f49_arg0
	else
		f49_local0 = {}
	end
	local f49_local1 = f49_local0.menu
	local f49_local2 = f49_local1._controllerIndex
	local f49_local3 = f49_local0.event
	f49_local0.isFromHelperBar = true
	local f49_local4 = WEAPON.IsContextualStoreEnabled()
	if f49_local4 then
		f49_local4 = LUI.FlowManager.GetScopedData( f49_local1 )
		f49_local4 = f49_local4.isStoreTab
	end
	f49_local0.fromStore = f49_local4
	f49_local4 = f49_local1._weaponData
	if f49_local4 then
		f49_local4 = f49_local1._weaponData.bundle
	end
	f49_local0.bundle = f49_local4
	f49_local0.currentWeaponTable = f49_local1._currentWeapon
	f49_local4 = f49_local1._weaponSlot
	local f49_local5 = WEAPON.PrimarySlot
	f49_local0.secondaryWeaponTable = WEAPON.GenerateWeaponTable( f49_local1._loadoutPlayerData.weaponSetups[REG12 and WEAPON.SecondarySlot or WEAPON.PrimarySlot] )
	if 0 < tonumber( f49_local0.currentWeaponTable.variantID ) then
		f49_local0.currentWeaponTable.lootName = WEAPON.GetLootWeaponName( f49_local0.currentWeaponTable.weapon, f49_local0.currentWeaponTable.lootID )
	end
	if 0 < tonumber( f49_local0.secondaryWeaponTable.variantID ) then
		f49_local0.secondaryWeaponTable.lootName = WEAPON.GetLootWeaponName( f49_local0.secondaryWeaponTable.weapon, f49_local0.secondaryWeaponTable.lootID )
	end
	f49_local1:UpdateLastFocusedButton()
	WEAPON.OpenFiringRange( f49_local2, f49_local0 )
	if f49_local3 and (f49_local3.qualifier == "keyboard" or f49_local3.qualifier == "gamepad") then
		Engine[0xC4146BA76D0F982]( SOUND_SETS.loadout.firingRange )
	end
end

local f0_local10 = function ( f48_arg0, f48_arg1, f48_arg2, f48_arg3 )
	f48_arg2.isFromHelperBar = true
	f48_arg0:UpdateLastFocusedButton()
	if CoD.IsDMZMatch() then
		DMZ.SetInsuredWeaponPlayerData( f48_arg1, f48_arg0._weaponSlot, f48_arg0._currentWeapon )
		LUI.FlowManager.RequestAddMenu( LOADOUT.GetGunsmithTabsMenuRef(), true, f48_arg1, nil, {
			weaponSlot = f48_arg0._weaponSlot,
			loadoutIndex = DMZ.LoadoutIndex,
			dmzInsuranceSlot = f48_arg0._weaponSlot
		}, true )
	else
		local f48_local0 = {
			currentWeaponTable = f48_arg0._currentWeapon
		}
		local f48_local1 = f48_arg0._weaponSlot
		local f48_local2 = WEAPON.PrimarySlot
		f48_local0.secondaryWeaponTable = WEAPON.GenerateWeaponTable( f48_arg0._loadoutPlayerData.weaponSetups[REG13 and WEAPON.SecondarySlot or WEAPON.PrimarySlot] )
		if 0 < tonumber( f48_local0.currentWeaponTable.variantID ) then
			f48_local0.currentWeaponTable.lootName = WEAPON.GetLootWeaponName( f48_local0.currentWeaponTable.weapon, f48_local0.currentWeaponTable.lootID )
		end
		if 0 < tonumber( f48_local0.secondaryWeaponTable.variantID ) then
			f48_local0.secondaryWeaponTable.lootName = WEAPON.GetLootWeaponName( f48_local0.secondaryWeaponTable.weapon, f48_local0.secondaryWeaponTable.lootID )
		end
		if f0_local0( f48_arg0, f48_arg1, f48_local0.currentWeaponTable ) then
			if f48_arg0._forShowcase then
				GUNSMITH.OpenShowcaseGunsmith( f48_arg1 )
			else
				GUNSMITH.OpenGunsmith( f48_arg1, f48_arg0._loadoutIndex, f48_arg0._weaponSlot, true )
			end
		end
	end
end

local f0_local11 = function ( f47_arg0, f47_arg1 )
	if not f47_arg0.DMZItemBonus then
		return 
	end
	local f47_local0 = f47_arg1.tacticalBuild
	if f47_local0 then
		f47_local0 = f47_arg1.tacticalBuild.insuredCooldownOverrideTimer
	end
	if CONDITIONS.InFrontend() and not f47_arg0._isDetailedStatsVisible and f47_local0 and 0 < f47_local0 then
		f47_arg0.DMZItemBonus:SetVisible( true )
		f47_arg0.DMZItemBonus:SetBodyText( LOOT.itemTypes.WEAPON, TIME.ConvertSecondsToMinutes( f47_local0 ) )
	else
		f47_arg0.DMZItemBonus:SetVisible( false )
	end
end

local f0_local12 = function ( f46_arg0, f46_arg1 )
	if not f46_arg0.GenericItemBonus then
		return 
	elseif not GL_HACK.ShouldHideDMZReactiveWidget() and CONDITIONS.InFrontend() and not f46_arg0._isDetailedStatsVisible then
		f46_arg0.GenericItemBonus:SetVisible( WEAPON.HasReactiveBonusEffect( f46_arg0._controllerIndex, f46_arg1.lootID ) )
	else
		f46_arg0.GenericItemBonus:SetVisible( false )
	end
end

local f0_local13 = function ( f45_arg0, f45_arg1 )
	local f45_local0 = WEAPON.GetWeaponBlueprintTacticalBuildDataByLootID( f45_arg0._controllerIndex, f45_arg1 )
	if f45_local0 and f45_local0.hasVaultCamo and not f45_arg0._isDetailedStatsVisible then
		f45_arg0.UniversalWrapsBonus:SetVisible( true )
		f45_arg0.UniversalWrapsBonus:SetBodyText( f45_arg1 )
	else
		f45_arg0.UniversalWrapsBonus:SetVisible( false )
	end
end

local f0_local14 = function ( f44_arg0, f44_arg1 )
	if f44_arg0.WeaponBlueprintBranding then
		GUNSMITH.UpdateWeaponStatsBranding( f44_arg0._controllerIndex, f44_arg0.WeaponBlueprintBranding.Branding, f44_arg1, f44_arg0._isDetailedStatsVisible )
	end
end

local f0_local15 = function ( f43_arg0 )
	if f43_arg0.event and not f43_arg0.event.down and f43_arg0.event.name ~= "button_action" then
		return 
	end
	local f43_local0 = f43_arg0.menu
	local f43_local1 = f43_local0.InfoPanel:IsVisible()
	f43_local0.DetailedWeaponStats:SetVisible( f43_local1 )
	f43_local0.InfoPanel:SetVisible( not f43_local1 )
	f43_local0._isDetailedStatsVisible = f43_local1
	local f43_local2 = f43_local0._focusedWeaponButton
	if f43_local2 then
		f43_local0:dispatchEventToCurrentMenu( {
			name = "update_active_armory_promo_visibility",
			controller = f43_local0._controllerIndex,
			isActiveArmory = f43_local2._isArmoryActiveWeapon
		} )
		local f43_local3 = f43_local2._weaponData
		local f43_local4 = GUNSMITH.GetWeaponArmoryDetails( f43_local0._controllerIndex, f43_local3 )
		f0_local0( f43_local0, f43_local2._weaponLootID )
		f0_local0( f43_local0, f43_local3 )
		f0_local0( f43_local0, f43_local4 )
		f0_local0( f43_local0, f43_local3 )
	end
	local f43_local3 = f43_local0.HelperBar.ButtonHelperText
	local f43_local5 = f43_local3
	f43_local3 = f43_local3.UpdateHelperText
	local f43_local6 = f43_local0._controllerIndex
	local f43_local7 = f0_local0
	local f43_local8
	if f43_local1 then
		f43_local8 = f0_local0
		if not f43_local8 then
		
		else
			f43_local3( f43_local5, f43_local6, f43_local7, f43_local8 )
			f43_local0.WeaponsGrid:RefreshContent()
		end
	end
	f43_local8 = f0_local0
end

local f0_local16 = function ( f42_arg0 )
	local f42_local0 = f42_arg0._currentWeapon
	if f42_local0 then
		f42_local0 = f42_arg0._currentWeapon.isUnlocked
	end
	return f42_local0
end

local f0_local17 = function ( f37_arg0, f37_arg1, f37_arg2, f37_arg3 )
	if CONDITIONS.InFrontend() and not CONDITIONS.IsCIABuildEnabled() and CONDITIONS.IsWeaponPreviewEnabled() then
		f37_arg1:AddContextualMenuAction( {
			id = "previewWeapon",
			button = "button_l3",
			actionName = Engine[0xED84C33EC5F01EA]( 0xCBEAF62674E5E75 ),
			actionFunction = function ()
				f37_arg0 = {}
				f37_arg0.isFromHelperBar = true
				f37_arg0( f37_arg0, f37_arg0, f37_arg0, nil )
			end
		} )
		local f37_local0 = WEAPON.IsContextualStoreEnabled()
		if f37_local0 then
			f37_local0 = LUI.FlowManager.GetScopedData( f37_arg0 )
			f37_local0 = f37_local0.isStoreTab
		end
		if CONDITIONS.IsFrontendFiringRangeEnabled() then
			local f37_local1 = f37_arg1:GetWeaponData()
			if f37_local1.isUnlocked or CONDITIONS.IsTryAGunEnabled() and f37_local0 then
				f37_arg1:AddContextualMenuAction( {
					id = "goToFiringRange",
					button = "button_alt2",
					actionName = Engine[0xED84C33EC5F01EA]( 0x142AAF5CD0DA682 ),
					actionFunction = function ()
						f37_arg0 = f37_arg0 or {}
						f37_arg0.menu = f37_arg0
						f37_arg0( f37_arg0 )
					end
				} )
			end
		end
		if not f37_arg1.isAlreadyEquipped and CONDITIONS.IsGLGunsmithEnabled() then
			local f37_local1 = f37_arg1:GetWeaponData()
			if f37_local1.isUnlocked and not f37_local0 then
				f37_arg1:AddContextualMenuAction( {
					id = "equipAndOpenGunsmith",
					actionName = Engine[0xED84C33EC5F01EA]( 0xA2721749007B7D5 ),
					actionFunction = function ()
						f37_arg0 = {}
						f37_arg0.isFromHelperBar = true
						f37_arg0( f37_arg0, f37_arg0, f37_arg0, nil )
					end,
					button = f0_local0
				} )
			end
		end
	end
	if DETAILED_WEAPON_STATS.IsEnabledInBlueprintScreen() and DETAILED_WEAPON_STATS.isValidWeaponType( f37_arg0._weaponClass ) then
		f37_arg1:AddContextualMenuAction( {
			id = "DetailedWeaponStats",
			actionName = f37_arg0._isDetailedStatsVisible and f0_local0 or f0_local0,
			actionFunction = function ()
				f37_arg0( {
					menu = f37_arg0
				} )
			end,
			button = f0_local0
		} )
	end
end

local f0_local18 = function ( f36_arg0, f36_arg1, f36_arg2 )
	local f36_local0 = {}
	local f36_local1 = 1 - f36_arg0._weaponModelSlot
	if f36_local1 < 0 then
		f36_local1 = 0
	end
	local f36_local2 = f36_arg0._loadoutPlayerData.weaponSetups[f36_local1]
	table.insert( f36_local0, WEAPON.GetWeaponModelNameFromPlayerData( f36_local2.weapon:get(), f36_local2, {
		includeCamos = true,
		includeAttachments = true,
		includeStickers = true,
		controllerIndex = f36_arg1
	} ) )
	table.insert( f36_local0, f36_arg2 )
	STREAMING.RequestModels( f36_arg1, {
		requesterWidget = f36_arg0,
		modelType = STREAMING.ModelTypes.WeaponView,
		models = f36_local0
	} )
end

local f0_local19 = function ( f35_arg0, f35_arg1 )
	local f35_local0 = nil
	if not f35_arg0._forShowcase and f35_arg0._weaponSlot <= WEAPON.SecondarySlot then
		local f35_local1 = 1 - f35_arg0._weaponSlot
		if DMZ.IsInstanceInventoryEnabledFrontend() then
			f35_local0 = DMZ.GetEquippedInstanceWeapon( f35_local1 )
		else
			local f35_local2 = f35_arg0._loadoutPlayerData.weaponSetups[f35_local1]
			if f35_local2 then
				f35_local0 = f35_local2
			else
				f35_local0 = f35_local2.weapon:get()
			end
		end
	end
	local f35_local1
	if f35_local0 then
		f35_local1 = f35_local0
	else
		f35_local1 = f35_local0 == f35_arg1
	end
	return f35_local1
end

local f0_local20 = function ( f33_arg0 )
	local f33_local0 = function ( f34_arg0 )
		if f34_arg0.menu:IsCurrentWeaponUnlocked() then
			f33_arg0( f34_arg0.menu, f34_arg0.menu._controllerIndex, {}, f34_arg0.event )
		end
	end
	
	f33_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
		button_ref = f33_arg0._equipWeaponOpenGunsmithButtonRef
	} )
	local f33_local1 = f0_local0
	local f33_local2 = f33_arg0
	local f33_local3 = LUI.FlowManager.GetScopedData( f33_arg0 )
	f33_local1 = f33_local1( f33_local2, f33_local3.weaponRef )
	local f33_local4 = WEAPON.IsContextualStoreEnabled()
	if f33_local4 then
		f33_local4 = LUI.FlowManager.GetScopedData( f33_arg0 )
		f33_local4 = f33_local4.isStoreTab
	end
	if not f33_local1 and CONDITIONS.IsGLGunsmithEnabled() and CONDITIONS.InFrontendMPOrCP() and not CONDITIONS.IsCIABuildEnabled() and f33_arg0:IsCurrentWeaponUnlocked() and not f33_local4 then
		f33_arg0._equipWeaponOpenGunsmithButtonRef = LUI.IsGamepadActiveInputMethodForPrompts( f33_arg0._controllerIndex ) and f0_local0 or f0_local0
		f33_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 5,
			isHold = true,
			helper_text = Engine[0xED84C33EC5F01EA]( 0xA2721749007B7D5 ),
			button_ref = f33_arg0._equipWeaponOpenGunsmithButtonRef,
			callback = f33_local0,
			callbackOptions = {
				menu = f33_arg0
			},
			helper_definition = Engine[0xED84C33EC5F01EA]( 0xF7DDC7898E0A360 )
		} )
	end
end

local f0_local21 = function ( f28_arg0, f28_arg1 )
	f28_arg0._currentWeapon = f28_arg1
	local f28_local0 = GUNSMITH.GetWeaponArmoryDetails( f28_arg0._controllerIndex, f28_arg1 )
	if f28_arg0.UpdateDetailsDataSources then
		f28_arg0:UpdateDetailsDataSources( f28_arg0._controllerIndex, f28_local0 )
	else
		f28_arg0.InfoPanel:UpdatePanel( f28_local0 )
	end
	if CONDITIONS.IsChallengeTrackingEnabled() then
		if not String.IsNilOrEmpty( f28_local0.challengeId ) then
			local f28_local1 = Challenge.GetWeaponChallengeTypeAndDataByLootID( f28_arg0._controllerIndex, f28_local0.lootID )
			if f28_local1 then
				TrackedChallenges.RefreshButtonHelperBarPrompts( f28_arg0, f28_arg0._controllerIndex, f28_arg0.HelperBar, f28_local0.challengeId, f28_local1, {
					priority = 2
				} )
			end
		else
			TrackedChallenges.ClearButtonHelperBarPrompts( f28_arg0, f28_arg0._controllerIndex, f28_arg0.HelperBar )
		end
	end
	if f28_arg0.DetailedWeaponStats and DETAILED_WEAPON_STATS.isValidWeaponType( f28_arg0._weaponClass ) and DETAILED_WEAPON_STATS.IsEnabledInBlueprintScreen() then
		local f28_local1 = WEAPON.GetWeaponModelName( f28_arg1.weapon, f28_arg1, {
			includeAttachments = true
		} )
		local f28_local2 = WEAPON.GetWeaponModelName( f28_arg1.weapon, WEAPON.GenerateWeaponTableFromID( f28_arg0._controllerIndex, LOOT.GetItemID( f28_arg1.weapon ) ), {
			includeAttachments = false
		} )
		f28_arg0.DetailedWeaponStats:Setup( f28_arg0, f28_arg0._controllerIndex, f28_local0 )
		f28_arg0.DetailedWeaponStats:SetupStats( f28_arg0._controllerIndex, f28_local2, f28_local1 )
	end
	if CONDITIONS.InFrontend() then
		f28_arg0._weaponData = f28_arg1
		local f28_local1 = function ()
			local f30_local0 = WEAPON.GetWeaponModelName( f28_arg0.weapon, f28_arg0, {
				includeCamos = true,
				includeAttachments = true,
				includeStickers = true,
				controllerIndex = f28_arg0._controllerIndex
			} )
			f28_arg0._currentWeaponModelName = f30_local0
			f28_arg0( f28_arg0, f28_arg0._controllerIndex, f30_local0 )
			local f30_local1 = function ()
				if f30_local0.PreviewWeapon then
					f30_local0:PreviewWeapon()
				end
			end
			
			if not CLIENT_MODEL.SetLauncherCase( f28_arg0.weapon, f28_arg0._weaponModelSlot, f28_arg0.lootID ) then
				WEAPON.SetModelIfLoaded( f28_arg0._controllerIndex, f28_arg0._weaponModel, f30_local0, {
					forceOffsetsAndRotations = true,
					callbackFunc = f30_local1
				} )
				local f30_local2 = f28_arg0._weaponModelSlot == WEAPON.PrimarySlot
				ClientWeapon[0x59B77D6F41ED417]( WEAPON.PrimarySlot, f30_local2 )
				ClientWeapon[0x59B77D6F41ED417]( WEAPON.SecondarySlot, not f30_local2 )
			end
			local f30_local2 = f28_arg0:Wait( 5 )
			f30_local2.onComplete = function ()
				if f30_local0._weaponModelSlot == FrontEndScene.ClientWeapons.GunTableSecondary then
					f30_local0._secondaryWeaponModel:SetOffsetsAndRotations( f30_local0 )
				else
					local f31_local0 = LOADOUT.GetLoadoutSquadMember( f30_local0._controllerIndex )
					local f31_local1 = f31_local0.loadouts[f30_local0._loadoutIndex].weaponSetups[FrontEndScene.ClientWeapons.GunTableSecondary]
					f30_local0._secondaryWeaponModel:SetOffsetsAndRotations( WEAPON.GetWeaponModelNameFromPlayerData( f31_local1.weapon:get(), f31_local1, {
						includeCamos = true,
						includeAttachments = true,
						includeStickers = true,
						controllerIndex = f30_local0._controllerIndex
					} ) )
				end
				CLIENT_MODEL.UpdateGunCase( f30_local0._controllerIndex, f30_local0._loadoutPlayerData, f30_local0 )
			end
			
		end
		
		if f28_arg0.SetupVariantTransition then
			f28_arg0:SetupVariantTransition( f28_local1 )
		else
			f28_local1()
		end
	end
	local f28_local1 = WEAPON.IsContextualStoreEnabled()
	if f28_local1 then
		f28_local1 = LUI.FlowManager.GetScopedData( f28_arg0 )
		f28_local1 = f28_local1.isStoreTab
	end
	if f28_local1 then
		if f28_arg0.InfoPanel.StatsWithDetails then
			f28_arg0.InfoPanel.StatsWithDetails:SetVisible( false )
			ACTIONS.AnimateSequence( f28_arg0.InfoPanel, "ArmoryStoreTabLayout" )
		end
		if f28_arg0.InfoPanel.LockedText then
			f28_arg0.InfoPanel.LockedText:SetVisible( false )
		end
		if f28_arg0.InfoPanel.LockIcon then
			f28_arg0.InfoPanel.LockIcon:SetVisible( false )
		end
		if f28_arg0.InfoPanel.LockConnector then
			f28_arg0.InfoPanel.LockConnector:SetVisible( false )
		end
		if f28_arg0.InfoPanel.ProgressionButton then
			f28_arg0.InfoPanel.ProgressionButton:SetVisible( false )
		end
	end
	if f28_arg0.BundleUpsellButton and f28_local1 then
		f28_arg0.BundleUpsellButton:SetupUpsellButtonWithLootID( f28_arg0._controllerIndex, f28_arg1.lootID )
		if f28_arg1.isCustom then
			f28_arg0.BundleUpsellButton:HideButton()
		end
		f28_arg0.BundleUpsellButton:SetPreOpenBundleCallbackFunc( function ()
			local f29_local0 = LUI.FlowManager.GetScopedData( f28_arg0 )
			f29_local0.isFromStoreButton = true
			f29_local0 = LUI.FlowManager.GetScopedData( f28_arg0 )
			f29_local0.returnFromBundle = true
		end )
	end
	f0_local0( f28_arg0, f28_local0 )
	f0_local0( f28_arg0, f28_arg1 )
	f0_local0( f28_arg0, f28_arg1.lootID )
	f0_local0( f28_arg0, f28_arg1 )
	if f28_arg0.HelperBar and (not f28_local1 or CONDITIONS.IsTryAGunEnabled()) then
		f28_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
			button_ref = "button_alt2"
		} )
		if CONDITIONS.IsFrontendFiringRangeEnabled() and CONDITIONS.InFrontendMPOrCP() and not CONDITIONS.IsCIABuildEnabled() and (f28_arg0:IsCurrentWeaponUnlocked() or CONDITIONS.IsTryAGunEnabled() and f28_local1) then
			f28_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
				side = "left",
				priority = 6,
				isHold = true,
				button_ref = "button_alt2",
				helper_text = Engine[0xED84C33EC5F01EA]( 0x142AAF5CD0DA682 ),
				helper_definition = Engine[0xED84C33EC5F01EA]( 0x71B72F1718054D7 ),
				callback = f0_local0,
				callbackOptions = {
					menu = f28_arg0
				}
			} )
		end
		f0_local0( f28_arg0 )
	end
end

local f0_local22 = function ( f27_arg0, f27_arg1, f27_arg2 )
	local f27_local0 = false
	if f27_arg0._selectedWeapon.weapon == f27_arg2.weapon then
		f27_local0 = true
	elseif GAMEMODE_SCRIPTBUNDLE_UTILS.IsBuyAndSellFlowEnabled() then
		local f27_local1 = EXGM_UTILS.GetItemPrice( f27_arg2.lootID )
		if f27_local1 <= EXGM_UTILS.GetLocalPlayerBalance( f27_arg1 ) then
			local f27_local2 = LOADOUT.GetLoadoutSquadMember( f27_arg0._controllerIndex )
			f27_local2 = f27_local2.loadouts[f27_arg0._loadoutIndex].weaponSetups[f27_arg0._weaponSlot]
			if f27_local2.weapon:get() ~= WEAPON.FistsValue then
				local f27_local3 = EXGM_UTILS.GetItemPrice( f27_local2.lootItemID:get() )
				EXGM_UTILS.UpdateLocalPlayerBalance( f27_arg1, f27_local3 )
				LUI.ToastManager.CreateToast( f27_arg1, LUI.ToastManager.StandardEmphasisWithTopRightTextToast( Engine[0xED84C33EC5F01EA]( 0x5E144908A9BCE62 ), WEAPON.GetLootWeaponName( f27_local2.weapon:get(), f27_local2.lootItemID:get() ), Engine[0xED84C33EC5F01EA]( 0x9CC5C5D7BF0D452, INVENTORY.GetCashDisplay( f27_local3 ) ), LUI.ToastManager.ToastNotificationType.Gear ) )
			end
			EXGM_UTILS.UpdateLocalPlayerBalance( f27_arg1, -f27_local1 )
			LUI.ToastManager.CreateToast( f27_arg1, LUI.ToastManager.StandardEmphasisWithTopRightTextToast( Engine[0xED84C33EC5F01EA]( 0xE1DD4086AE4AD11 ), f27_arg2.header, Engine[0xED84C33EC5F01EA]( 0x9CC5C5D7BF0D452, INVENTORY.GetCashDisplay( f27_local1 ) ), LUI.ToastManager.ToastNotificationType.Gear ) )
			f27_local0 = true
		end
	elseif not CONDITIONS.IsMobileOrMobileSim() then
		f27_arg0:dispatchEventToRoot( {
			name = "send_toast_notification",
			immediate = true,
			options = {
				iconScale = 4.667263495923649E-62,
				displayTime = 3000,
				icon = "cac_equip_fill",
				iconColor = SWATCHES.genericMenu.notificationHighlight,
				header = Engine[0xED84C33EC5F01EA]( 0xE1DD4086AE4AD11 ),
				description = f27_arg2.header,
				type = LUI.ToastManager.NotificationType.WeaponEquipped,
				controllerIndex = f27_arg1
			}
		} )
		f27_local0 = true
	end
	if f27_local0 then
		local f27_local1 = LOADOUT.GetLoadoutSquadMember( f27_arg0._controllerIndex )
		f27_local1 = f27_local1.loadouts[f27_arg0._loadoutIndex]
		if f27_arg0._forShowcase then
			f27_local1 = SHOWCASE.GetLoadoutForController( f27_arg1, f27_arg0._loadoutIndex )
		end
		if not f27_arg0._forShowcase and CoD.IsDMZMatch() and DMZ.IsLimitedInventoryEnabled() then
			DMZ.SetInsuredWeaponPlayerData( f27_arg1, f27_arg0._weaponSlot, f27_arg2 )
			if CONDITIONS.IsObLoadoutUseStats() then
				OB.EquipInsuredWeaponToLoadoutSlot( f27_arg1, f27_arg2 )
			end
		elseif CONDITIONS.UsingFreeMelee() and f27_arg0._weaponSlot == WEAPON.FreeMeleeSlot then
			LOADOUT.EquipFreeMeleeFromWeaponID( f27_arg1, f27_arg2.lootID )
		else
			WEAPON.EquipModification( f27_arg0._loadoutPlayerData.weaponSetups[f27_arg0._weaponSlot], f27_arg2, f27_arg1, f27_arg2.isCustom )
		end
		if f27_arg0._forShowcase then
			Social[0x6B83DE97344CD52]( f27_arg1 )
		end
		if not f27_arg0._forShowcase then
			LOOT.SendDlogLootEquipped( f27_arg1, LOOT.itemTypes.WEAPON, f27_arg0._selectedWeapon, f27_arg2 )
		end
		LUI.FlowManager.RequestLeaveMenuByName( LOADOUT.GetWeaponMenuRef(), true, true )
		LUI.FlowManager.RequestLeaveMenu( f27_arg0, false )
	end
end

local f0_local23 = function ( f26_arg0, f26_arg1 )
	if f26_arg0.fromBundle == f26_arg1.fromBundle then
		if f26_arg0.displayOrder == f26_arg1.displayOrder then
			if not f26_arg0.isCustom and not f26_arg1.isCustom then
				if not f26_arg0.isBase and not f26_arg1.isBase then
					return f26_arg1.rarity < f26_arg0.rarity
				end
				local f26_local0 = f26_arg0.isBase
				if f26_local0 then
					f26_local0 = not f26_arg1.isBase
				end
				return f26_local0
			end
			local f26_local0 = f26_arg1.isCustom
			if f26_local0 then
				f26_local0 = not f26_arg0.isCustom
			end
			return f26_local0
		else
			return f26_arg0.displayOrder < f26_arg1.displayOrder
		end
	else
		local f26_local0
		if not f26_arg0.fromBundle then
			f26_local0 = f26_arg1.fromBundle
		else
			f26_local0 = false
		end
	end
	return f26_local0
end

local f0_local24 = function ( f25_arg0, f25_arg1, f25_arg2 )
	local f25_local0 = {
		byWeapons = {
			[f25_arg2.weaponRef] = true
		}
	}
	local f25_local1 = WEAPON.IsContextualStoreEnabled()
	if f25_local1 then
		f25_local1 = f25_arg2.newTabIndex == GUNSMITH.STORE_TAB_INDEX
	end
	f25_arg2.isStoreTab = f25_local1
	if f25_arg2.isFromHelperBar then
		f25_arg2.isStoreTab = false
		f25_arg2.isFromHelperBar = nil
	end
	if (f25_arg2.isFromStoreButton or f25_arg2.returnFromBundle) and 0 < f25_arg2.storeCount then
		f25_arg2.isStoreTab = true
		f25_arg2.isFromStoreButton = false
	end
	if f25_arg2.storeCount == 0 then
		f25_arg2.isStoreTab = false
	end
	if f25_arg2.isStoreTab then
		f25_arg0._currentModifications = WEAPON.GetWeaponArmoryStoreBundles( f25_arg1, f25_arg2.weaponRef )
	else
		f25_arg0._currentModifications = WEAPON.GetModifications( f25_arg1, f25_local0 )
	end
	f25_local1 = false
	local f25_local2 = 0
	for f25_local6, f25_local7 in ipairs( f25_arg0._currentModifications ) do
		if f25_local7.variantID == WEAPON.baseVariant and not f25_local7.isCustom then
			f25_local1 = true
			f25_local2 = f25_local6
		end
	end
	if f25_arg2.isStoreTab and f25_local1 then
		table.remove( f25_arg0._currentModifications, f25_local2 )
	end
	if not f25_local1 and not f25_arg2.isStoreTab then
		f25_local3 = WEAPON.GetModification( f25_arg1, f25_arg2.weaponRef, WEAPON.GetBlueprintBaseID( f25_arg2.weaponRef ) )
		f25_local3.isBase = true
		f25_local3.isCustom = false
		table.insert( f25_arg0._currentModifications, 1, f25_local3 )
	end
	f25_local3 = 0
	for f25_local7, f25_local8 in pairs( f25_arg0._currentModifications ) do
		f25_local3 = f25_local3 + #f25_local8
		table.sort( f25_local8, f0_local0 )
	end
end

local f0_local25 = function ( f15_arg0, f15_arg1, f15_arg2 )
	local f15_local0 = false
	if CONDITIONS.AreRestrictionsActiveAndBlueprintsAllowed( f15_arg0, f15_arg1 ) and Restrictions.IsWeaponRestricted( f15_arg2 ) then
		f15_local0 = true
	end
	f15_arg0._hasSetInitIndexToFocus = false
	local f15_local1 = LUI.FlowManager.GetScopedData( f15_arg0 )
	local f15_local2
	if (not f15_local1.returnFromBundle or f15_local1.newTabIndex ~= 1) and f15_local1.lastTabIndex ~= f15_local1.newTabIndex then
		f15_local2 = false
	else
		f15_local2 = true
	end
	local f15_local3 = {
		x = 0,
		y = 0
	}
	if f15_local2 and not Table.IsNilOrEmpty( f15_local1.lastFocusedWeaponButtonPosition ) then
		f15_local3 = f15_local1.lastFocusedWeaponButtonPosition
		f15_local1.returnFromBundle = false
	end
	f15_arg0.WeaponsGrid:TouchMouseSetActiveToDefaultFocusMenuCreate( f15_arg1 )
	f15_arg0.WeaponsGrid:SetNumChildren( #f15_arg0._currentModifications )
	f15_arg0.WeaponsGrid:SetRefreshChild( function ( f19_arg0, f19_arg1, f19_arg2 )
		local f19_local0 = f15_arg0
		local f19_local1 = WEAPON.IsContextualStoreEnabled()
		if f19_local1 then
			f19_local1 = LUI.FlowManager.GetScopedData( f19_local0 )
			f19_local1 = f19_local1.isStoreTab
		end
		local f19_local2 = WEAPON.GetModificationDetails( f15_arg0, f15_arg0._currentModifications[f19_arg1 + 1], {
			checkOwnershipUnlock = f19_local1
		} )
		local f19_local3 = GUNSMITH.AreModsEqual( f15_arg0._selectedWeapon, f19_local2 )
		f19_local2.isAlreadyEquipped = f15_arg0( f19_local0, f19_local2.weapon )
		f19_arg0:Setup( f15_arg0, f19_local0, f19_local2, f19_arg1, f19_local3, f15_arg0._weaponPlayerData )
		f19_arg0:RemoveContextualMenuFromElement()
		f15_arg0( f15_arg0, f19_arg0, f15_arg0 )
		if not f19_arg0._hasEventHandlers then
			f19_arg0:addEventHandler( "button_over", function ( f24_arg0, f24_arg1 )
				if GUNSMITH.AllowSaveCustomWeapon() then
					f19_arg0._focusedWeaponButton = f24_arg0
				end
				local f24_local0, f24_local1 = f19_arg0.WeaponsGrid:GetChildPosition( f24_arg0 )
				f19_arg0._focusedWeaponButtonPosition = {
					x = f24_local0,
					y = f24_local1
				}
				f19_arg0( f19_arg0, f24_arg0:GetWeaponData() )
			end )
			f19_arg0:addEventHandler( "button_over_disable", function ( f23_arg0, f23_arg1 )
				if GUNSMITH.AllowSaveCustomWeapon() then
					f19_arg0._focusedWeaponButton = f23_arg0
				end
				local f23_local0, f23_local1 = f19_arg0.WeaponsGrid:GetChildPosition( f23_arg0 )
				f19_arg0._focusedWeaponButtonPosition = {
					x = f23_local0,
					y = f23_local1
				}
				f19_arg0( f19_arg0, f23_arg0:GetWeaponData() )
			end )
			f19_arg0._hasEventHandlers = true
		end
		local f19_local4 = GUNSMITH.GetWeaponArmoryDetails( f15_arg0._controllerIndex, f19_local2 )
		if CONDITIONS.InFrontend() and CONDITIONS.IsChallengeTrackingEnabled() and not String.IsNilOrEmpty( f19_local4.challengeId ) then
			local f19_local5 = function ( f22_arg0, f22_arg1 )
				if not f19_arg0.challengeId then
					return 
				end
				local f22_local0 = Challenge.GetWeaponChallengeTypeAndDataByLootID( f19_arg0._controllerIndex, f19_arg0.lootID )
				if f22_local0 then
					TrackedChallenges.AttemptTrackChallenge( f19_arg0, f19_arg0._controllerIndex, tonumber( f19_arg0.challengeId ), f22_local0 )
					TrackedChallenges.RefreshButtonHelperBarPrompts( f19_arg0, f19_arg0._controllerIndex, f19_arg0.HelperBar, f19_arg0.challengeId, f22_local0, {
						priority = 2
					} )
				end
			end
			
			f19_arg0:replaceEventHandler( "button_action_disable", function ( f21_arg0, f21_arg1 )
				f19_arg0( f21_arg0, f21_arg1 )
				return true
			end )
			f19_arg0:AddGamepadEventCallback( "button_primary", function ( f20_arg0, f20_arg1 )
				if not CONDITIONS.IsMouseNavigation( f20_arg1.controller ) then
					return 
				else
					f19_arg0( f20_arg0, f20_arg1 )
					return true
				end
			end )
		end
		f19_arg0:RemoveGamepadEventCallback( "button_primary" )
		if not f19_local0._hasSetInitIndexToFocus and f19_arg1 == f15_arg0.x and f19_arg2 == f15_arg0.y then
			f19_local0.WeaponsGrid:SetFocusedPosition( f15_arg0, true )
			if f19_arg0.GetWeaponData then
				f15_arg0( f19_local0, f19_arg0:GetWeaponData() )
			end
			f19_local0._hasSetInitIndexToFocus = true
		end
	end )
	f15_arg0.WeaponsGrid:RefreshContent()
	local f15_local4 = f15_arg0:Wait( 200 )
	f15_local4.onComplete = function ()
		f15_arg0.WeaponsGrid:SetFocusedPosition( f15_arg0, true )
	end
	
	f15_arg0:replaceEventHandler( "menu_create", function ( f16_arg0, f16_arg1 )
		local f16_local0 = f15_arg0:getParent()
		if Challenge.IsWinChallengesUnlocked( f15_arg0 ) and not Challenge.IsMenuChallengeCompleteCallbackRegistered( f16_local0 ) then
			Challenge.RegisterMenuChallengeCompleteCallback( f16_local0, function ( f17_arg0, f17_arg1 )
				f16_arg0.WeaponsGrid:RefreshContent()
				f16_arg0.InfoPanel.UnlockCriteriaWidget:UpdateFromDataSources( f16_arg0 )
			end )
		end
	end )
end

local f0_local26 = function ( f13_arg0, f13_arg1, f13_arg2 )
	if not CONDITIONS.InFrontend() then
		
	else
		
	end
	if CONDITIONS.IsWeaponPreviewEnabled() then
		f13_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
			button_ref = "button_left_stick"
		} )
		f13_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 3,
			button_ref_override_icon = "button_l3",
			button_ref = "button_left_stick",
			helper_text = Engine[0xED84C33EC5F01EA]( 0xCBEAF62674E5E75 ),
			helper_definition = Engine[0xED84C33EC5F01EA]( 0xF2D581450245105 )
		} )
	end
	if DETAILED_WEAPON_STATS.IsEnabledInBlueprintScreen() and DETAILED_WEAPON_STATS.isValidWeaponType( f13_arg0._weaponClass ) then
		f13_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
			button_ref = f0_local0
		} )
		f13_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 4,
			helper_text = f13_arg0._isDetailedStatsVisible and f0_local0 or f0_local0,
			button_ref = f0_local0,
			helper_definition = Engine[0xED84C33EC5F01EA]( 0x5C76D41878B3E0 ),
			callback = f0_local0,
			callbackOptions = {
				menu = f13_arg0
			}
		} )
	end
	if CONDITIONS.IsWeaponPreviewEnabled() then
		f13_arg0:AddGamepadEventCallback( "button_left_stick", function ( f14_arg0, f14_arg1 )
			f13_arg0( f14_arg0, f14_arg1.controller or f13_arg0, f13_arg0, f14_arg1 )
		end )
	end
end

local f0_local27 = function ( f12_arg0, f12_arg1 )
	f12_arg0._isDetailedStatsVisible = false
	f12_arg0.UpdateDetailedStatsVisibility = f0_local0
	ACTIONS.AnimateSequence( f12_arg0.DetailedWeaponStats, "Blueprint" )
end

local f0_local28 = function ( f11_arg0, f11_arg1, f11_arg2 )
	if CONDITIONS.InFrontend() then
		local f11_local0 = WEAPON.GetWeaponModel
		local f11_local1 = f11_arg1
		local f11_local2 = f11_arg0._weaponModelSlot
		if not f11_local2 then
			f11_local2 = WEAPON.PrimarySlot
		end
		f11_arg0._weaponModel = f11_local0( f11_local1, f11_local2 )
		f11_arg0:addElement( f11_arg0._weaponModel )
		f11_arg0._secondaryWeaponModel = WEAPON.GetWeaponModel( f11_arg1, WEAPON.SecondarySlot )
		f11_arg0:addElement( f11_arg0._secondaryWeaponModel )
		f11_local0 = LUI.FlowManager.GetScopedData( f11_arg0 )
		if f11_local0.returnFromBundle then
			Engine[0x685AE31DEDA30A4]( "loadout_showcase" )
			CLIENT_MODEL.SendClientModelTagDataToServer( f11_arg2, f11_arg2, f11_arg1 )
		end
	end
end

local f0_local29 = function ( f9_arg0, f9_arg1 )
	if GUNSMITH.AllowSaveCustomWeapon( f9_arg0._forShowcase ) then
		f9_arg0:AddGamepadEventCallback( "button_alt1", function ( f10_arg0, f10_arg1 )
			if f10_arg0._focusedWeaponButton then
				local f10_local0 = f10_arg0._focusedWeaponButton:GetWeaponData()
				local f10_local1 = f10_arg1.controller or f9_arg0
				if f10_local0 and f10_local0.isCustom then
					f10_arg0._focusedWeaponButton:SetupCustomWeaponMenu( f10_local1, f10_local0, f9_arg0._forShowcase )
				end
			end
		end )
	end
end

local f0_local30 = function ( f6_arg0 )
	f6_arg0:registerEventHandler( "update_for_weapon", function ( element, event )
		f6_arg0( element, event.weaponData )
	end )
	f6_arg0:registerEventHandler( "equip_weapon", function ( element, event )
		f6_arg0( element, event.controller, event.weaponData )
	end )
end

local f0_local31 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.InitCurrentModificationsTable = f0_local0
	f3_arg0.SetupWeaponGrid = f0_local0
	f3_arg0.IsCurrentWeaponUnlocked = f0_local0
	f3_arg0.UpdateLastFocusedButton = f0_local0
	f3_arg0._controllerIndex = f3_arg1
	local f3_local0 = f3_arg2.weaponSlot
	if not f3_local0 then
		f3_local0 = WEAPON.PrimarySlot
	end
	f3_arg0._weaponSlot = f3_local0
	f3_arg0._loadoutIndex = f3_arg2.loadoutIndex
	f3_arg0._forShowcase = f3_arg2.forShowcase
	f3_arg0._weaponClass = WEAPON.GetWeaponClass( f3_arg2.weaponRef )
	f3_arg0._weaponModelSlot = f3_arg2.weaponModelSlot or f3_arg0._weaponSlot
	if CONDITIONS.UsingFreeMelee() and f3_arg2.weaponSlot == WEAPON.FreeMeleeSlot then
		f3_arg0._loadoutIndex = 0
		f3_arg0._loadoutPlayerData = LOADOUT.GetFrontendLoadoutWithShowcase( f3_arg1, 0, f3_arg2.forShowcase )
		f3_local0 = LOADOUT.GetLoadoutSquadMember( f3_arg1 )
		f3_arg0._weaponPlayerData = f3_local0.freeMeleeSetup
	else
		f3_arg0._loadoutPlayerData = LOADOUT.GetFrontendLoadoutWithShowcase( f3_arg1, f3_arg2.loadoutIndex, f3_arg2.forShowcase )
		f3_arg0._weaponPlayerData = f3_arg0._loadoutPlayerData.weaponSetups[f3_arg2.weaponSlot]
	end
	f3_arg0._selectedWeapon = WEAPON.GenerateWeaponTable( f3_arg0._weaponPlayerData )
	f0_local0( f3_arg0, f3_arg1, f3_arg2.weaponRef )
	f0_local0( f3_arg0, f3_arg1, f3_arg2 )
	f0_local0( f3_arg0, f3_arg1 )
	f3_arg0.InfoPanel:ShowCost()
	f0_local0( f3_arg0, f3_arg1, f3_arg2.weaponRef )
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0, f3_arg1, f3_arg2 )
	WEAPON.SetSceneForWeaponSlot( f3_arg0._weaponModelSlot, f3_arg2.weaponRef )
	if f3_arg0.DetailedWeaponStats and DETAILED_WEAPON_STATS.IsEnabledInBlueprintScreen() and DETAILED_WEAPON_STATS.isValidWeaponType( f3_arg0._weaponClass ) then
		f0_local0( f3_arg0, f3_arg1 )
	end
	f3_arg0:SubscribeToInputTypeModel( f3_arg0._controllerIndex, function ( f5_arg0, f5_arg1 )
		if f5_arg1.HelperBar then
			f3_arg0( f5_arg1 )
		end
	end )
	if CONDITIONS.InFrontend() and CONDITIONS.IsChallengeTrackingEnabled() and CONDITIONS.IsChallengeTrackingFlyInEnabled() then
		f3_arg0:AddGamepadEventCallback( "button_select", function ( f4_arg0, f4_arg1 )
			TrackedChallenges.OpenChallengesTrackedFlyIn( f3_arg0._controllerIndex, nil, nil, f3_arg0 )
		end )
		f3_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 1,
			button_ref = "button_select",
			helper_text = Engine[0xED84C33EC5F01EA]( TrackedChallenges.TRACKED_CHALLENGES_TITLE ),
			helper_definition = Engine[0xED84C33EC5F01EA]( TrackedChallenges.TRACKED_CHALLENGES_TOOLTIP )
		} )
	end
end

local f0_local32 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function WeaponArmoryBase( f1_arg0, f1_arg1 )
	local f1_local0 = ACTIONS
	local f1_local1 = LUI
	local f1_local2 = f1_local1.UIElement.new()
	f1_local2:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920, 0, 1080 )
	f1_local2.id = "WeaponArmoryBase"
	local f1_local3
	if f1_arg1 then
		f1_local3 = f1_arg1
	else
		f1_local3 = f1_arg1.controllerIndex
	end
	f1_local3 = f1_local1.ValidateControllerIndex( f1_local2, f1_local3 )
	local f1_local4 = f1_local2
	GUNSMITH.SetupWeaponArmoryMenu( f1_local2, f1_local3, f1_arg1 )
	f0_local0( f1_local2, f1_local3, f1_arg1 )
	return f1_local2
end

MenuBuilder.registerType( 0xF25A10EA0338AAE, WeaponArmoryBase )
LockTable( _M )
