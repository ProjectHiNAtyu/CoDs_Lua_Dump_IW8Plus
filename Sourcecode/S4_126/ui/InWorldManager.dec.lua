-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
LUI.InWorldManager = LUI.Class( LUI.UIElement )
LUI.InWorldManager.init = function ( f10_arg0, f10_arg1 )
	LUI.UIElement.init( f10_arg0 )
	f10_arg0.id = "InWorldManager"
	f10_arg0._controllerIndex = f10_arg1
end

LUI.InWorldManager.ShouldBeVisible = function ( f9_arg0 )
	local f9_local0
	if not Engine[0x12586A3F4FB490E]() then
		f9_local0 = Game[0xA988866C889EAAD]()
	else
		f9_local0 = false
	end
	return f9_local0
end

LUI.InWorldManager.StartFinalKillcam = function ( f8_arg0 )
	f8_arg0.FinalKillcam = {}
end

LUI.InWorldManager.EndFinalKillcam = function ( f7_arg0 )
	assert( f7_arg0.FinalKillcam )
end

LUI.InWorldManager.UpdateWidgetsVisibility = function ( f6_arg0, f6_arg1 )
	if (AnyActiveMenusInStack( LUI.UIRoot.GetRootForControllerIndex( f6_arg1 ) ) or CONDITIONS.IsNukeEndState( f6_arg0, f6_arg1 )) and f6_arg0.headIcons then
		f6_arg0.headIcons:RemoveFromParent()
	else
		f6_arg0:addElement( f6_arg0.headIcons )
	end
end

LUI.InWorldManager.MPRegisterUpdateWidgetVisibilityHandlers = function ( f4_arg0, f4_arg1 )
	local f4_local0 = function ( f5_arg0, f5_arg1 )
		LUI.InWorldManager.UpdateWidgetsVisibility( f5_arg0, f4_arg0 )
	end
	
	f4_arg0:registerEventHandler( "empty_menu_stack", f4_local0 )
	f4_arg0:registerEventHandler( "non_empty_menu_stack", f4_local0 )
	f4_arg0:registerOmnvarHandler( "ui_nuke_end_milliseconds", f4_local0 )
	LUI.InWorldManager.UpdateWidgetsVisibility( f4_arg0, f4_arg1 )
end

LUI.InWorldManager.InitLayer = function ( f2_arg0 )
	f2_arg0.scopeReticleManager = MenuBuilder.BuildRegisteredType( "ScopeReticleManager" )
	f2_arg0:addElement( f2_arg0.scopeReticleManager )
	f2_arg0.accessoryManager = MenuBuilder.BuildRegisteredType( "AccessoryManager" )
	f2_arg0:addElement( f2_arg0.accessoryManager )
	if not Dvar[0x9E5BE3B4BBA4E0E]( "#x3ed852b5512d431cd" ) then
		f2_arg0.headIcons = LUI.UIElement.new()
		f2_arg0.headIcons:SetupHeadIcons()
		f2_arg0:addElement( f2_arg0.headIcons )
	end
	if Engine[0xD151EC5B41223B5]() then
		f2_arg0:MPRegisterUpdateWidgetVisibilityHandlers( f2_arg0._controllerIndex )
	end
	if Engine[0x74423E76DECE3E4]() then
		local f2_local0 = function ( f3_arg0, f3_arg1 )
			METRICS.MatchEndDLogRecording( f3_arg1.controller )
		end
		
		if not f2_arg0._missionEndDlogHandlerAdded then
			f2_arg0:registerOmnvarHandler( "ui_mission_end_dlog", f2_local0 )
			f2_arg0._missionEndDlogHandlerAdded = true
		end
	end
	f2_arg0:SetUseGameClock( true )
end

LUI.InWorldManager.ClearLayer = function ( f1_arg0, f1_arg1 )
	if f1_arg0.scopeReticleManager then
		f1_arg0.scopeReticleManager:closeTree()
		f1_arg0.scopeReticleManager = nil
	end
	if f1_arg0.accessoryManager then
		f1_arg0.accessoryManager:closeTree()
		f1_arg0.accessoryManager = nil
	end
	f1_arg0:closeChildren()
end

