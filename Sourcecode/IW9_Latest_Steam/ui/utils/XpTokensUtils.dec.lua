-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
XPTOKENS = XPTOKENS or {}
XPTOKENS.tokensList = {}
XPTOKENS.ActivationFailureMessage = 0x11A2794C005CC50
XPTOKENS.doubleXpTokenTypes = {
	BATTLE_PASS = 3,
	XP = 1,
	WEAPON = 2
}
XPTOKENS.durationTypes = {
	MINUTES_60 = 4,
	MINUTES_15 = 1,
	MINUTES_45 = 3,
	MINUTES_30 = 2
}
XPTOKENS.raritytoDurationTypes = {
	XPTOKENS.durationTypes.MINUTES_15,
	XPTOKENS.durationTypes.MINUTES_30,
	XPTOKENS.durationTypes.MINUTES_45,
	XPTOKENS.durationTypes.MINUTES_60
}
XPTOKENS.TokensMaterialsStrings = {
	[XPTOKENS.doubleXpTokenTypes.XP] = {
		active = 0xEB18BB7A5DD107D,
		inactive = 0x2937EFF76EC9353
	},
	[XPTOKENS.doubleXpTokenTypes.WEAPON] = {
		active = 0x3F5B94BD871A2A,
		inactive = 0xE5F914618F0CF9C
	},
	[XPTOKENS.doubleXpTokenTypes.BATTLE_PASS] = {
		active = 0x455F35BF38C2703,
		inactive = 0xE97B6583D31DA85
	}
}
XPTOKENS.TokensDurationMaterialsStrings = {
	[XPTOKENS.durationTypes.MINUTES_15] = 0xE6439EA9D2E5CE8,
	[XPTOKENS.durationTypes.MINUTES_30] = 0xE5D32EA9D283255,
	[XPTOKENS.durationTypes.MINUTES_45] = 0xE533DEA9D1FF081,
	[XPTOKENS.durationTypes.MINUTES_60] = 0xE4C34EA9D19C288
}
XPTOKENS.GetTokenData = function ( f32_arg0, f32_arg1 )
	if not f32_arg0 then
		return {}
	end
	local f32_local0 = {
		tokenID = f32_arg0,
		XPName = Engine[0xED84C33EC5F01EA]( StringTable[0x2DCF0973239E909]( CSV.consumablesIDs.file, CSV.consumablesIDs.cols.id, f32_arg0, CSV.consumablesIDs.cols.name ) ),
		tokenAmount = f32_arg1,
		ref = StringTable[0x2DCF0973239E909]( CSV.consumablesIDs.file, CSV.consumablesIDs.cols.id, f32_arg0, CSV.consumablesIDs.cols.ref ),
		achievementID = StringTable[0x2DCF0973239E909]( CSV.consumablesIDs.file, CSV.consumablesIDs.cols.id, f32_arg0, CSV.consumablesIDs.cols.AE_ID ),
		eventName = StringTable[0x2DCF0973239E909]( CSV.consumablesIDs.file, CSV.consumablesIDs.cols.id, f32_arg0, CSV.consumablesIDs.cols.AEEvent ),
		image = StringTable[0x2DCF0973239E909]( CSV.consumablesIDs.file, CSV.consumablesIDs.cols.id, f32_arg0, CSV.consumablesIDs.cols.image ),
		duration = Engine[0xED84C33EC5F01EA]( StringTable[0x2DCF0973239E909]( CSV.consumablesIDs.file, CSV.consumablesIDs.cols.id, f32_arg0, CSV.consumablesIDs.cols.duration ) ),
		rarity = tonumber( StringTable[0x2DCF0973239E909]( CSV.consumablesIDs.file, CSV.consumablesIDs.cols.id, f32_arg0, CSV.consumablesIDs.cols.quality ) )
	}
	if f32_local0.tokenID == LOOT.DOUBLE_XP_TOKENS.XP_Year then
		f32_local0.rarity = 5
	end
	return f32_local0
end

XPTOKENS.GetTokenType = function ( f31_arg0 )
	if Table.IsItemIndexInArray( LOOT.DOUBLE_XP_TOKENS, f31_arg0 ) then
		return LOOT.doubleXpTypes.XP
	elseif Table.IsItemIndexInArray( LOOT.DOUBLE_WEAPON_XP_TOKENS, f31_arg0 ) then
		return LOOT.doubleXpTypes.WEAPON
	elseif Table.IsItemIndexInArray( LOOT.DOUBLE_BATTLE_PASS_TOKENS, f31_arg0 ) then
		return LOOT.doubleXpTypes.BATTLE_PASS
	else
		
	end
end

XPTOKENS.GetLootIdTable = function ( f30_arg0 )
	if f30_arg0 == LOOT.doubleXpTypes.XP then
		return LOOT.DOUBLE_XP_TOKENS
	elseif f30_arg0 == LOOT.doubleXpTypes.WEAPON then
		return LOOT.DOUBLE_WEAPON_XP_TOKENS
	elseif f30_arg0 == LOOT.doubleXpTypes.BATTLE_PASS then
		return LOOT.DOUBLE_BATTLE_PASS_TOKENS
	else
		return {}
	end
end

XPTOKENS.AchievementIdToLootId = function ( f29_arg0 )
	for f29_local7, f29_local8 in pairs( LOOT.doubleXpTypes ) do
		for f29_local4, f29_local5 in pairs( XPTOKENS.GetLootIdTable( f29_local8 ) ) do
			local f29_local3 = StringTable[0x2DCF0973239E909]( CSV.consumablesIDs.file, CSV.consumablesIDs.cols.id, f29_local5, CSV.consumablesIDs.cols.AE_ID )
			if f29_local3 then
				f29_local3 = tonumber( f29_local3 )
			end
			if f29_local3 == f29_arg0 then
				return f29_local5
			end
		end
	end
	return LOOT.emptyID
end

XPTOKENS.GetTokenUseTitle = function ( f28_arg0 )
	if f28_arg0 == LOOT.doubleXpTypes.XP then
		return Engine[0xED84C33EC5F01EA]( 0x82D1477BAA01F78 )
	elseif f28_arg0 == LOOT.doubleXpTypes.WEAPON then
		return Engine[0xED84C33EC5F01EA]( 0x2EFBD371106B687 )
	elseif f28_arg0 == LOOT.doubleXpTypes.BATTLE_PASS then
		return Engine[0xED84C33EC5F01EA]( 0xF462069240A8F85 )
	else
		return ""
	end
end

XPTOKENS.GetTokenUseLocked = function ( f27_arg0 )
	if DataSources.alwaysLoaded.loot.xpTokenUseLocked then
		return DataSources.alwaysLoaded.loot.xpTokenUseLocked:GetValue( f27_arg0 )
	else
		return false
	end
end

XPTOKENS.SetTokenUseLocked = function ( f26_arg0, f26_arg1 )
	if DataSources.alwaysLoaded.loot.xpTokenUseLocked then
		DataSources.alwaysLoaded.loot.xpTokenUseLocked:SetValue( f26_arg0, f26_arg1 )
	end
end

XPTOKENS.PopulateXPTokens = function ( f24_arg0 )
	XPTOKENS.tokensList = {}
	for f24_local11, f24_local12 in pairs( LOOT.doubleXpTypes ) do
		if not XPTOKENS.tokensList[f24_local12] then
			XPTOKENS.tokensList[f24_local12] = {}
		end
		local f24_local3 = XPTOKENS.GetLootIdTable( f24_local12 )
		local f24_local4 = XPTOKENS.GetTokenUseTitle( f24_local12 )
		for f24_local9, f24_local10 in pairs( f24_local3 ) do
			if f24_local10 ~= LOOT.DOUBLE_XP_TOKENS.XP_Year then
				local f24_local8 = XPTOKENS.GetTokenData( f24_local10, PROXY_LOOT.IsOwned( f24_arg0, f24_local10 ) )
				f24_local8.header = f24_local4
				f24_local8.type = f24_local12
				table.insert( XPTOKENS.tokensList[f24_local12], f24_local8 )
			end
		end
		table.sort( XPTOKENS.tokensList[f24_local12], function ( f25_arg0, f25_arg1 )
			if f25_arg0.rarity and f25_arg1.rarity then
				return f25_arg0.rarity < f25_arg1.rarity
			else
				
			end
		end )
	end
end

XPTOKENS.GetRemainingTimeForTokenType = function ( f23_arg0, f23_arg1 )
	local f23_local0 = 0
	local f23_local1 = 0
	local f23_local2 = CoD.GetUTC()
	if not f23_local2 then
		f23_local2 = tonumber( Engine[0x3B8CFB6758EF57C]() )
	end
	local f23_local3, f23_local4, f23_local5 = XPTOKENS.GetDoubleXPTimersForType( f23_arg0, f23_arg1 )
	if 0 < f23_local4 - f23_local2 then
		f23_local0 = f23_local4 - f23_local2
	end
	if 0 < f23_local3 - f23_local2 then
		f23_local1 = f23_local3 - f23_local2
	end
	return f23_local1, f23_local0
end

XPTOKENS.GetAllDoubleXpEventState = function ()
	local f22_local0 = LOOT.IsDoubleXPActive()
	local f22_local1 = LOOT.IsDoubleWeaponXPActive()
	local f22_local2 = LOOT.IsDoubleBattlePassXPActive()
	if f22_local2 then
		f22_local2 = CONDITIONS.IsBattlePassEnabled()
	end
	return f22_local0, f22_local1, f22_local2
end

XPTOKENS.IsAnyDoubleXPEventsActivated = function ()
	local f21_local0, f21_local1, f21_local2 = XPTOKENS.GetAllDoubleXpEventState()
	local f21_local3
	if not f21_local0 then
		f21_local3 = f21_local0
	elseif not f21_local1 then
		f21_local3 = f21_local1
	else
		f21_local3 = f21_local2
	end
	return f21_local3
end

XPTOKENS.GetAllXPTimers = function ( f20_arg0 )
	local f20_local0 = PROGRESSION.GetTokensEndTimesInSec( f20_arg0 )
	local f20_local1 = PROGRESSION.GetGlobalDoubleXPEventsEndTime()
	return {
		rankTokenEndTime = f20_local0[PROGRESSION.DoubleXPType.PLAYER],
		rankEventEndTime = f20_local1[PROGRESSION.DoubleXPType.PLAYER],
		weaponTokenEndTime = f20_local0[PROGRESSION.DoubleXPType.WEAPON],
		weaponEventEndTime = f20_local1[PROGRESSION.DoubleXPType.WEAPON],
		battlePassTokenEndTime = f20_local0[PROGRESSION.DoubleXPType.BATTLEPASS],
		battlePassEventEndTime = f20_local1[PROGRESSION.DoubleXPType.BATTLEPASS]
	}
end

XPTOKENS.GetDoubleXPTimersForType = function ( f19_arg0, f19_arg1 )
	local f19_local0 = XPTOKENS.GetAllXPTimers( f19_arg0 )
	local f19_local1, f19_local2, f19_local3 = XPTOKENS.GetAllDoubleXpEventState()
	if f19_arg1 == XPTOKENS.doubleXpTokenTypes.XP then
		return f19_local0.rankEventEndTime, f19_local0.rankTokenEndTime, f19_local1
	elseif f19_arg1 == XPTOKENS.doubleXpTokenTypes.WEAPON then
		return f19_local0.weaponEventEndTime, f19_local0.weaponTokenEndTime, f19_local2
	elseif f19_arg1 == XPTOKENS.doubleXpTokenTypes.BATTLE_PASS then
		return f19_local0.battlePassEventEndTime, f19_local0.battlePassTokenEndTime, f19_local3
	else
		return f19_local0
	end
end

XPTOKENS.GetSectionTokensData = function ( f18_arg0 )
	return XPTOKENS.tokensList[f18_arg0]
end

XPTOKENS.HasAvailableTokens = function ( f17_arg0, f17_arg1 )
	for f17_local3, f17_local4 in pairs( XPTOKENS.GetSectionTokensData( f17_arg1 ) ) do
		if 0 < f17_local4.tokenAmount then
			return true
		end
	end
	return false
end

XPTOKENS.GetAllDoubleXPStates = function ( f16_arg0 )
	local f16_local0 = CoD.GetUTC()
	if not f16_local0 then
		f16_local0 = tonumber( Engine[0x3B8CFB6758EF57C]() )
	end
	local f16_local1 = XPTOKENS.GetAllXPTimers( f16_arg0 )
	local f16_local2
	if (f16_local1.rankTokenEndTime == nil or 0 >= f16_local1.rankTokenEndTime - f16_local0) and (f16_local1.rankEventEndTime == nil or 0 >= f16_local1.rankEventEndTime - f16_local0) then
		f16_local2 = false
	else
		f16_local2 = true
	end
	local f16_local3
	if (f16_local1.weaponTokenEndTime == nil or 0 >= f16_local1.weaponTokenEndTime - f16_local0) and (f16_local1.weaponEventEndTime == nil or 0 >= f16_local1.weaponEventEndTime - f16_local0) then
		f16_local3 = false
	else
		f16_local3 = true
	end
	local f16_local4 = false
	if XPTOKENS.IsBattlePassOwned( f16_arg0 ) then
		if (f16_local1.battlePassTokenEndTime == nil or 0 >= f16_local1.battlePassTokenEndTime - f16_local0) and (f16_local1.battlePassEventEndTime == nil or 0 >= f16_local1.battlePassEventEndTime - f16_local0) then
			f16_local4 = false
		else
			f16_local4 = true
		end
	end
	local f16_local5, f16_local6, f16_local7 = XPTOKENS.GetAllDoubleXpEventState()
	local f16_local8
	if not f16_local5 then
		f16_local8 = f16_local5
	else
		f16_local8 = f16_local2
	end
	local f16_local9
	if not f16_local6 then
		f16_local9 = f16_local6
	else
		f16_local9 = f16_local3
	end
	local f16_local10
	if not f16_local7 then
		f16_local10 = f16_local7
	else
		f16_local10 = f16_local4
	end
	return f16_local8, f16_local9, f16_local10
end

XPTOKENS.IsDoubleXPActivatedForType = function ( f15_arg0, f15_arg1 )
	local f15_local0, f15_local1, f15_local2 = XPTOKENS.GetAllDoubleXPStates( f15_arg0 )
	if f15_arg1 == XPTOKENS.doubleXpTokenTypes.XP then
		return f15_local0
	elseif f15_arg1 == XPTOKENS.doubleXpTokenTypes.WEAPON then
		return f15_local1
	elseif f15_arg1 == XPTOKENS.doubleXpTokenTypes.BATTLE_PASS then
		return f15_local2
	else
		return false
	end
end

XPTOKENS.IsBattlePassOwned = function ( f14_arg0 )
	local f14_local0 = CONDITIONS.IsBattlePassEnabled()
	if f14_local0 then
		f14_local0 = BATTLEPASS.IsOwned( f14_arg0, SEASON.GetCurrentSeason() )
	end
	return f14_local0
end

XPTOKENS.IsDoubleXpEventBannerActive = function ()
	local f13_local0 = CONDITIONS.IsDvarBoolEnabled( 0xD48984A0AC52B61 )
	if f13_local0 then
		f13_local0 = XPTOKENS.IsAnyDoubleXPEventsActivated()
	end
	return f13_local0
end

XPTOKENS.IsTokenDataDisabled = function ( f12_arg0 )
	local f12_local0
	if f12_arg0.tokenAmount ~= 0 then
		if f12_arg0.type == XPTOKENS.doubleXpTokenTypes.XP then
			f12_local0 = XPTOKENS.DoubleXPActive
			if not f12_local0 then
			
			else
				return f12_local0
			end
		end
		if f12_arg0.type == XPTOKENS.doubleXpTokenTypes.WEAPON then
			f12_local0 = XPTOKENS.WeaponXPActive
			if not f12_local0 then
			
			else
				return f12_local0
			end
		end
		if f12_arg0.type == XPTOKENS.doubleXpTokenTypes.BATTLE_PASS then
			f12_local0 = XPTOKENS.BattlePassXPActive
		else
			f12_local0 = false
		end
	else
		f12_local0 = true
	end
	return f12_local0
end

XPTOKENS.GetXpTokensTitle = function ( f11_arg0 )
	if f11_arg0 == XPTOKENS.doubleXpTokenTypes.XP then
		return Engine[0xED84C33EC5F01EA]( 0x65848D7B8005D30 )
	elseif f11_arg0 == XPTOKENS.doubleXpTokenTypes.WEAPON then
		return Engine[0xED84C33EC5F01EA]( 0x41E761AAD00B2A3 )
	elseif f11_arg0 == XPTOKENS.doubleXpTokenTypes.BATTLE_PASS then
		return Engine[0xED84C33EC5F01EA]( 0x3D55227F00E2EAB )
	else
		
	end
end

XPTOKENS.OpenMobileXpTokensPanelAction = function ( f10_arg0, f10_arg1, f10_arg2 )
	if MobileFlyInPopupUtils.GetCurrentFlyInPopup() == MobileFlyInPopupUtils.PopupsEnum.XPTOKENS_PANEL then
		LUI.FlowManager.closeFlyInPopup( true )
		return 
	end
	local f10_local0 = MobileFlyInPopupUtils.Popups[MobileFlyInPopupUtils.PopupsEnum.XPTOKENS_PANEL]
	if not f10_arg2 then
		f10_arg2 = {}
	end
	f10_arg2.MobileFlyInRight = true
	MobileFlyInPopupUtils.MobileOpenFlyInPopup( f10_arg0, f10_arg1, f10_local0, f10_local0, f10_arg2 )
	MobileFlyInPopupUtils.SetCurrentFlyInPopup( MobileFlyInPopupUtils.PopupsEnum.XPTOKENS_PANEL )
end

XPTOKENS.MobileOpenBattlePassMenu = function ( f9_arg0, f9_arg1, f9_arg2 )
	LUI.FlowManager.closeFlyInPopup( true )
	ACTIONS.PopMenuStackUpToMenu( "MainMenuMobile", false )
	URI.QueueURI( "./MobileBattlepassMenu", f9_arg1 )
end

XPTOKENS.MobileInitXPTokensHeaderDatasources = function ()
	if DataSources.frontEnd.mobile.header.xpToken == nil then
		DataSources.frontEnd.mobile.header.xpToken = {}
	end
	local f8_local0 = "frontEnd.mobile.header.xpToken"
	DataSources.frontEnd.mobile.header.xpToken.xpCurrentIcon = LUI.DataSourceInControllerModel.new( f8_local0 .. ".xpCurrentIcon", 0xA86CABE20306DA1 )
	DataSources.frontEnd.mobile.header.xpToken.xpCurrentTimer = LUI.DataSourceInControllerModel.new( f8_local0 .. ".xpCurrentTimer" )
	DataSources.frontEnd.mobile.header.xpToken.xpShowTimer = LUI.DataSourceInControllerModel.new( f8_local0 .. ".xpShowTimer" )
end

XPTOKENS.IsMobileXPTokensMenuEnabled = function ()
	return CONDITIONS.IsDvarBoolEnabled( 0xBBDBAE93FF854FA )
end

XPTOKENS.IsPartyRankXPEventEnabled = function ()
	return Dvar[0x22EAAB59AA27E9B]( 0x562364E09176965 ) == 2
end

XPTOKENS.IsPartyWeaponXPEventEnabled = function ()
	return Dvar[0x22EAAB59AA27E9B]( 0x562364E09176965 ) == 2
end

XPTOKENS.IsPartyXPEventEnabled = function ()
	local f4_local0 = XPTOKENS.IsPartyRankXPEventEnabled()
	if not f4_local0 then
		f4_local0 = XPTOKENS.IsPartyWeaponXPEventEnabled()
	end
	return f4_local0
end

XPTOKENS.IsPartyRankXPEventBoostActive = function ()
	local f3_local0 = XPTOKENS.IsPartyRankXPEventEnabled()
	if f3_local0 then
		f3_local0 = 1 < DataSources.alwaysLoaded.activeParty.memberCount:GetValue()
	end
	return f3_local0
end

XPTOKENS.IsPartyWeaponXPEventBoostActive = function ()
	local f2_local0 = XPTOKENS.IsPartyWeaponXPEventEnabled()
	if f2_local0 then
		f2_local0 = 1 < DataSources.alwaysLoaded.activeParty.memberCount:GetValue()
	end
	return f2_local0
end

XPTOKENS.IsPartyXPEventBoostActive = function ()
	local f1_local0 = XPTOKENS.IsPartyRankXPEventBoostActive()
	if not f1_local0 then
		f1_local0 = XPTOKENS.IsPartyWeaponXPEventBoostActive()
	end
	return f1_local0
end

