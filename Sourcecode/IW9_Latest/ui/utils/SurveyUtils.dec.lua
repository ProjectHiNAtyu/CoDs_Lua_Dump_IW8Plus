-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
SURVEY = SURVEY or {}
SURVEY.SurveyPopupMenuName = "PlayerSurveyPopup"
SURVEY.GetGameMode = function ()
	local f12_local0 = Engine[0xD36E3CAF4F0D8DB]()
	if f12_local0 == Enum[0xAC7E3CE067D9A9F][0x8A94A07B5502CF8] then
		return "mp"
	elseif f12_local0 == Enum[0xAC7E3CE067D9A9F][0x8A64607B54DF055] then
		return "br"
	elseif f12_local0 == Enum[0xAC7E3CE067D9A9F][0x8A23E07B549F9E6] then
		return "cp"
	elseif f12_local0 == Enum[0xAC7E3CE067D9A9F][0xAB52E18F478CE80] then
		return "dmz"
	else
		return ""
	end
end

SURVEY.SendSurveyDlogResponseEvent = function ( f11_arg0, f11_arg1, f11_arg2 )
	Engine[0x15D98DF5F61904B]( f11_arg0, "dlog_event_client_survey_response_data", {
		name = f11_arg2.name,
		version = f11_arg2.version,
		survey_question = f11_arg2.question,
		survey_answer = f11_arg1,
		entry_point = f11_arg2.entryPoint,
		game_mode = f11_arg2.gameMode,
		is_quitter = f11_arg2.isQuitter
	} )
end

SURVEY.HandlePlayerSurveyResponded = function ( f10_arg0, f10_arg1, f10_arg2, f10_arg3 )
	SURVEY.SendSurveyDlogResponseEvent( f10_arg0, f10_arg2, f10_arg3 )
	Engine[0xAF7FB041D72A06E]( f10_arg0, 0, f10_arg1, f10_arg3.isQuitter )
end

SURVEY.HandlePlayerSurveyCanceled = function ( f9_arg0, f9_arg1 )
	SURVEY.SendSurveyDlogResponseEvent( f9_arg0, "survey_cancelled", f9_arg1 )
	Engine[0xAF7FB041D72A06E]( f9_arg0, 0, -1, f9_arg1.isQuitter )
end

SURVEY.IsSurveyDwDataEnabled = function ()
	return Dvar[0x9E5BE3B4BBA4E0E]( 0xCD8309F8E15AFC3 )
end

SURVEY.FlipSurveyAnswers = function ( f7_arg0 )
	if 50 < math.random( 1, 100 ) then
		for f7_local0 = 1, math.floor( #f7_arg0 / 2 ), 1 do
			local f7_local3 = #f7_arg0 + 1 - f7_local0
			f7_arg0[f7_local3] = f7_arg0[f7_local0]
			f7_arg0[f7_local0] = f7_arg0[f7_local3]
		end
	end
end

SURVEY.GetDWSurveyData = function ( f4_arg0, f4_arg1 )
	local f4_local0 = LUI.DataSourceInControllerModel.new( "gameSurvey.isLocalized" )
	local f4_local1 = f4_local0:GetValue( f4_arg0 )
	local f4_local2 = LUI.DataSourceInControllerModel.new( "gameSurvey.question" )
	local f4_local3 = f4_local2:GetValue( f4_arg0 )
	local f4_local4 = LUI.DataSourceInControllerModel.new( "gameSurvey.name" )
	local f4_local5 = f4_local4:GetValue( f4_arg0 )
	local f4_local6 = LUI.DataSourceInControllerModel.new( "gameSurvey.version" )
	local f4_local7 = f4_local6:GetValue( f4_arg0 )
	local f4_local8 = LUI.DataSourceInControllerModel.new( "gameSurvey.answersCount" )
	local f4_local9 = f4_local8:GetValue( f4_arg0 )
	local f4_local10 = LUI.DataSourceInControllerModel.new( "gameSurvey.exclusiveGameMode" )
	local f4_local11 = f4_local10:GetValue( f4_arg0 )
	if not f4_local3 or not f4_local5 or not f4_local7 or not f4_local9 then
		
	end
	local f4_local12 = nil
	if f4_local1 then
		f4_local12 = Engine[0xED84C33EC5F01EA]( f4_local3 )
	else
		f4_local12 = Engine[0x7D3158A9539A355]( f4_local3 )
	end
	local f4_local13 = {
		name = f4_local5,
		version = f4_local7,
		question = f4_local3
	}
	local f4_local14
	if CONDITIONS.InFrontend() then
		f4_local14 = "frontEnd"
	else
		f4_local14 = "inGame"
	end
	f4_local13.entryPoint = f4_local14
	f4_local13.gameMode = SURVEY.GetGameMode()
	f4_local13.isQuitter = f4_arg1
	f4_local14 = {}
	for f4_local15 = 0, f4_local9 - 1, 1 do
		local f4_local18 = LUI.DataSourceInControllerModel.new( "gameSurvey.answers." .. f4_local15 )
		local f4_local19 = f4_local18:GetValue( f4_arg0 )
		if not f4_local19 then
			
		else
			
		end
		local f4_local20 = nil
		if f4_local1 then
			f4_local20 = Engine[0xED84C33EC5F01EA]( f4_local19 )
		else
			f4_local20 = Engine[0x7D3158A9539A355]( f4_local19 )
		end
		table.insert( f4_local14, {
			label = f4_local20,
			action = function ( f6_arg0 )
				SURVEY.HandlePlayerSurveyResponded( f6_arg0, f4_arg0, f4_arg0, f4_arg0 )
			end
		} )
	end
	return {
		question = f4_local12,
		answers = f4_local14,
		isLocalized = f4_local1,
		exclusiveGameMode = f4_local11,
		onCancel = function ( f5_arg0 )
			SURVEY.HandlePlayerSurveyCanceled( f5_arg0, f4_arg0 )
		end
		
	}
end

SURVEY.ShouldIgnoreCurrentGameMode = function ( f3_arg0 )
	if f3_arg0 ~= "" and f3_arg0 ~= SURVEY.GetGameMode() then
		return true
	else
		return false
	end
end

SURVEY.OpenPostGameSurveyIfRequired = function ( f1_arg0, f1_arg1 )
	local f1_local0 = IsPublicMatch() or false
	f1_local0 = Engine[0x3F37DF12DBDF73C]() or false
	Dvar[0x8EA06EEDB58D872]( 0xC82DD5FCC645D14, false )
	f1_local0 = SURVEY.IsSurveyDwDataEnabled() or false
	f1_local0 = SURVEY.GetDWSurveyData( f1_arg0, f1_arg1 )
	if not f1_local0 then
		local f1_local1 = false
	end
	if not f1_local0.isLocalized and not IsLanguageEnglish() then
		local f1_local1 = false
	end
	if SURVEY.ShouldIgnoreCurrentGameMode( f1_local0.exclusiveGameMode ) then
		local f1_local1 = false
	end
	SURVEY.FlipSurveyAnswers( f1_local0.answers )
	if CONDITIONS.InGame() then
		local f1_local2 = LUI.UIRoot.GetActiveLayer( LUI.UIRoot.GetRootForControllerIndex( f1_arg0 ) )
		if f1_local2 then
			f1_local0.onClose = function ( f2_arg0, f2_arg1 )
				local f2_local0 = LUI.UIRoot.GetActiveLayer( LUI.UIRoot.GetRootForControllerIndex( f1_arg0 ) )
				if f2_local0 then
					f2_local0:SetMouseFocusBlockerForAllChildren( false )
				end
			end
			
			f1_local2:SetMouseFocusBlockerForAllChildren( true )
		end
	end
	LUI.FlowManager.RequestPopupMenu( nil, SURVEY.SurveyPopupMenuName, false, f1_arg0, false, f1_local0 )
	return true
end

