-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.menutitle" )
require( "ui.generated.widgets.frontend.store.requiredcpamount" )
require( "ui.generated.widgets.frontend.events.purchasefeaturedeventbundlebutton" )
require( "ui.generated.widgets.scrollbar.verticalscrollbar" )
local f0_local0 = function ( f17_arg0, f17_arg1 )
	f17_arg0.BundlesGrid.navigation = {}
end

local f0_local1 = function ( f16_arg0, f16_arg1 )
	LUI.FlowManager.RequestLeaveMenu( f16_arg0, true, true )
	STORE.OpenProductPreviewMenuFromPurchase( f16_arg0._controllerIndex, f16_arg1.bundle, true )
end

local f0_local2 = function ( f15_arg0, f15_arg1 )
	LUI.FlowManager.RequestLeaveMenu( f15_arg0, true, true )
end

local f0_local3 = function ( f8_arg0, f8_arg1 )
	assert( STORE.IsCatalogReady( f8_arg1 ) )
	local f8_local0 = STORE.UI.GetEventBundles( f8_arg1 )
	f8_arg0.BundlesGrid:SetMask( f8_arg0.BundlesGridMask )
	f8_arg0.BundlesGrid:SetNumChildren( #f8_local0 )
	f8_arg0.NoContentTitle:SetVisible( #f8_local0 == 0 )
	f8_arg0.NoContentBody:SetVisible( #f8_local0 == 0 )
	f8_arg0.RequiredCPAmount:SetVisible( 0 < #f8_local0 )
	STORE.Events.AddPurchaseHandler( f8_arg0, f8_arg1, f0_local0, f0_local0 )
	f8_arg0.BundlesGrid:SetRefreshChild( function ( f12_arg0, f12_arg1, f12_arg2 )
		local f12_local0 = f8_arg0[f12_arg2 + 1 - (f8_arg0._startOffset or 0)]
		f12_arg0.navigation = {}
		f12_arg0:SetupButton( f12_local0 )
		if not f12_arg0._handlersAdded then
			f12_arg0:addEventHandler( "button_over", function ( f14_arg0, f14_arg1 )
				if f12_arg0._menuMetrics and f12_arg0._menuMetrics then
					table.insert( f12_arg0._menuMetrics.hoveredItems, 1, {
						name = STORE.Bundles.GetName( f12_arg0 ),
						time = {
							hoverStart = os.time()
						}
					} )
				end
			end )
			f12_arg0:addEventHandler( "button_up", function ( f13_arg0, f13_arg1 )
				if f12_arg0._menuMetrics and f12_arg0._menuMetrics then
					f12_arg0._menuMetrics.hoveredItems[1].time.hoverEnd = os.time()
					f12_arg0._menuMetrics.hoveredItems[1].time.hoverDuration = f12_arg0._menuMetrics.hoveredItems[1].time.hoverEnd - f12_arg0._menuMetrics.hoveredItems[1].time.hoverStart
				end
			end )
			f12_arg0._handlersAdded = true
		end
	end )
	f8_arg0.BundlesGrid:AddScrollbar( {
		_customScrolling = true,
		SetLinkedGridDataSource = function ()
			
		end,
		UpdateScrolling = function ()
			local f11_local0 = f8_arg0.BundlesGrid:GetFocusPositionIndex( {
				clampContentIndexToDatasetLength = true
			} )
			if not f11_local0 then
				return 
			end
			f8_arg0.BundlesGrid.focusPosition = f11_local0
			if f8_arg0._lastFocusPosition ~= f11_local0 then
				f8_arg0._lastFocusPosition = f11_local0
			end
		end,
		LinkTo = function ()
			
		end
	} )
	f8_arg0.BundlesGrid:RefreshContent()
	f0_local0( f8_arg0, #f8_local0 )
end

local f0_local4 = function ( f4_arg0, f4_arg1, f4_arg2 )
	f4_arg0._controllerIndex = f4_arg1
	f4_arg0.MenuTitle:SetTitle( ToUpperCase( Engine[0xED84C33EC5F01EA]( 0xEA8EAD88B6CBB48 ) ), 0 )
	f0_local0( f4_arg0, f4_arg1 )
	f4_arg0:addEventHandler( "closing_quick_access_menu", function ( f7_arg0, f7_arg1 )
		f7_arg0:exitAnimation( f7_arg0, f4_arg0 )
	end )
	f4_arg0._menuMetrics = {
		startTime = os.time(),
		hoveredItems = {},
		hoveredItemsName = {},
		hoveredItemsDuration = {},
		mwChallengeProgress = {},
		wzChallengeProgress = {},
		masteryChallengeProgress = {}
	}
	f4_arg0:addEventHandler( "update_seasonal_event_exit_action", function ( f6_arg0, f6_arg1 )
		f4_arg0._menuMetrics.exitAction = f6_arg1.navigationAction
	end )
	f4_arg0:addEventHandler( "on_close", function ( f5_arg0, f5_arg1 )
		f4_arg0._menuMetrics.leaveTime = os.time()
		f4_arg0._menuMetrics.screenDuration = f4_arg0._menuMetrics.leaveTime - f4_arg0._menuMetrics.startTime
		local f5_local0 = f4_arg0._menuMetrics
		local f5_local1 = LUI.FlowManager.GetTopMostOpenMenuInfo()
		f5_local0.destinationMenu = f5_local1.name
		for f5_local0 = 1, #f4_arg0._menuMetrics.hoveredItems, 1 do
			table.insert( f4_arg0._menuMetrics.hoveredItemsName, f4_arg0._menuMetrics.hoveredItems[f5_local0].name )
			table.insert( f4_arg0._menuMetrics.hoveredItemsDuration, f4_arg0._menuMetrics.hoveredItems[f5_local0].time.hoverDuration or 0 )
		end
		Engine[0x15D98DF5F61904B]( f4_arg0, "dlog_event_ui_event_page_new_content_widget", {
			screen_duration = f4_arg0._menuMetrics.screenDuration,
			hovered_items_name = f4_arg0._menuMetrics.hoveredItemsName,
			hovered_items_duration = f4_arg0._menuMetrics.hoveredItemsDuration,
			exit_action = f4_arg0._menuMetrics.exitAction or "Exit back to Events Menu"
		} )
	end )
end

function PurchaseBundlesPopup( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 600 * _1080p, 0, 1080 * _1080p )
	self.id = "PurchaseBundlesPopup"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local MenuTitle = nil
	
	MenuTitle = MenuBuilder.BuildRegisteredType( "MenuTitle", {
		controllerIndex = f1_local1
	} )
	MenuTitle.id = "MenuTitle"
	MenuTitle.MenuTitle:setText( ToUpperCase( Engine[0xED84C33EC5F01EA]( 0xE5F63499A6B0703 ) ), 0 )
	MenuTitle.ModeTitle:setText( "", 0 )
	MenuTitle.Line:SetVisible( false )
	MenuTitle:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, _1080p * 100 )
	self:addElement( MenuTitle )
	self.MenuTitle = MenuTitle
	
	local RequiredCPAmount = nil
	
	RequiredCPAmount = MenuBuilder.BuildRegisteredType( "RequiredCPAmount", {
		controllerIndex = f1_local1
	} )
	RequiredCPAmount.id = "RequiredCPAmount"
	RequiredCPAmount:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -260, _1080p * 260, _1080p * 113, _1080p * 179 )
	self:addElement( RequiredCPAmount )
	self.RequiredCPAmount = RequiredCPAmount
	
	local BundlesGridMask = nil
	
	BundlesGridMask = LUI.UIImage.new()
	BundlesGridMask.id = "BundlesGridMask"
	BundlesGridMask:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 88.5, _1080p * 511.5, _1080p * 311, _1080p * 1055 )
	self:addElement( BundlesGridMask )
	self.BundlesGridMask = BundlesGridMask
	
	local BundlesGrid = nil
	
	BundlesGrid = LUI.UIGrid.new( {
		maxVisibleColumns = 1,
		maxVisibleRows = 4,
		wrapY = false,
		wrapX = false,
		controllerIndex = f1_local1,
		buildChild = function ()
			return MenuBuilder.BuildRegisteredType( "PurchaseFeaturedEventBundleButton", {
				controllerIndex = menu
			} )
		end,
		refreshChild = function ( f2_arg0, f2_arg1, f2_arg2 )
			
		end,
		spacingY = _1080p * 11,
		columnWidth = _1080p * 424,
		rowHeight = _1080p * 236
	} )
	BundlesGrid.id = "BundlesGrid"
	BundlesGrid:setUseStencil( true )
	BundlesGrid:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -211.5, _1080p * 212.5, _1080p * 319, _1080p * 1055 )
	self:addElement( BundlesGrid )
	self.BundlesGrid = BundlesGrid
	
	local VerticalScrollbar = nil
	
	VerticalScrollbar = MenuBuilder.BuildRegisteredType( "VerticalScrollbar", {
		controllerIndex = f1_local1
	} )
	VerticalScrollbar.id = "VerticalScrollbar"
	VerticalScrollbar:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -73, _1080p * -62, _1080p * 319, _1080p * 1057 )
	self:addElement( VerticalScrollbar )
	self.VerticalScrollbar = VerticalScrollbar
	
	local NoContentTitle = nil
	
	NoContentTitle = LUI.UIStyledText.new()
	NoContentTitle.id = "NoContentTitle"
	NoContentTitle:SetVisible( false )
	NoContentTitle:SetRGBFromTable( SWATCHES.IW9StyleGuide.styleGuideCool01, 0 )
	NoContentTitle:SetAlpha( 0.7, 0 )
	NoContentTitle:setText( Engine[0xED84C33EC5F01EA]( 0xDEAB9040333EFB4 ), 0 )
	NoContentTitle:setCaseStyle( LUI.CaseStyle.Uppercase )
	NoContentTitle:SetFont( FONTS.GetFont( FONTS.PrimaryBold.File ) )
	NoContentTitle:SetFontSize( 28 * _PT )
	NoContentTitle:SetMinFontSize( 18 * _PT )
	NoContentTitle:SetWordWrap( true )
	NoContentTitle:SetTracking( 1 * _1080p, 0 )
	NoContentTitle:SetAlignment( LUI.Alignment.Center )
	NoContentTitle:SetVerticalAlignment( LUI.Alignment.Bottom )
	NoContentTitle:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -245, _1080p * 245, _1080p * -77, _1080p * -33 )
	self:addElement( NoContentTitle )
	self.NoContentTitle = NoContentTitle
	
	local NoContentBody = nil
	
	NoContentBody = LUI.UIStyledText.new()
	NoContentBody.id = "NoContentBody"
	NoContentBody:SetVisible( false )
	NoContentBody:SetRGBFromTable( SWATCHES.IW9StyleGuide.styleGuideCool02, 0 )
	NoContentBody:SetAlpha( 0.7, 0 )
	NoContentBody:setText( Engine[0xED84C33EC5F01EA]( 0x447E30EA142F176 ), 0 )
	NoContentBody:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
	NoContentBody:SetFontSize( 24 * _PT )
	NoContentBody:SetMinFontSize( 18 * _PT )
	NoContentBody:SetWordWrap( true )
	NoContentBody:SetAlignment( LUI.Alignment.Center )
	NoContentBody:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -247.5, _1080p * 242.5, _1080p * -25, _1080p * 108 )
	self:addElement( NoContentBody )
	self.NoContentBody = NoContentBody
	
	local f1_local9 = LUI.UIScrollbar.new
	local f1_local10 = {
		direction = LUI.DIRECTION.vertical,
		eventListener = VerticalScrollbar,
		startCap = VerticalScrollbar.startCap,
		endCap = VerticalScrollbar.endCap,
		sliderArea = VerticalScrollbar.sliderArea
	}
	local f1_local11 = VerticalScrollbar.sliderArea
	if f1_local11 then
		f1_local11 = VerticalScrollbar.sliderArea.slider
	end
	f1_local10.slider = f1_local11
	f1_local11 = VerticalScrollbar.sliderArea
	if f1_local11 then
		f1_local11 = VerticalScrollbar.sliderArea.fixedSizeSlider
	end
	f1_local10.fixedSizeSlider = f1_local11
	BundlesGrid:AddScrollbar( f1_local9( f1_local10 ) )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "PurchaseBundlesPopup", PurchaseBundlesPopup )
LockTable( _M )
