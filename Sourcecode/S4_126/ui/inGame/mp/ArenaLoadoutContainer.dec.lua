-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
module( ..., package.seeall )
require( "ui.inGame.mp.ArenaNewLoadoutMessage" )
require( "ui.inGame.mp.ArenaLoadout" )
local f0_local0 = {
	Random = 2,
	PickUp = 3,
	ReversProgression = 5,
	Progression = 4,
	Normal = 1
}
local f0_local1 = function ( f7_arg0, f7_arg1 )
	local f7_local0 = {
		{
			widget = f7_arg0.ArenaLoadout.PrimaryEquipment,
			dataSource = DataSources.inGame.player.primaryEquipment
		},
		{
			widget = f7_arg0.ArenaLoadout.SecondaryEquipment,
			dataSource = DataSources.inGame.player.secondaryEquipment
		}
	}
	local f7_local1 = function ( f12_arg0 )
		if f7_arg0[f12_arg0].name ~= nil and f7_arg0[f12_arg0].icon ~= nil then
			f7_arg0[f12_arg0].widget:SetupEquipment( {
				equipmentName = f7_arg0[f12_arg0].name,
				equipmentIcon = f7_arg0[f12_arg0].icon
			} )
		end
	end
	
	local f7_local2 = function ( f10_arg0 )
		return function ()
			f10_arg0[f10_arg0].name = f10_arg0[f10_arg0].dataSource.name:GetValue( f10_arg0 )
			f10_arg0( f10_arg0 )
		end
		
	end
	
	local f7_local3 = function ( f8_arg0 )
		return function ()
			f8_arg0[f8_arg0].icon = f8_arg0[f8_arg0].dataSource.icon:GetValue( f8_arg0 )
			f8_arg0( f8_arg0 )
		end
		
	end
	
	for f7_local4 = 1, #f7_local0, 1 do
		f7_arg0:SubscribeToModel( f7_local0[f7_local4].dataSource.name:GetModel( f7_arg1 ), f7_local2( f7_local4 ) )
		f7_arg0:SubscribeToModel( f7_local0[f7_local4].dataSource.icon:GetModel( f7_arg1 ), f7_local3( f7_local4 ) )
	end
end

local f0_local2 = function ( f5_arg0, f5_arg1, f5_arg2 )
	assert( f5_arg0.ArenaLoadout )
	f5_arg0:SubscribeToModel( DataSources.inGame.HUD.loadoutNotify:GetModel( f5_arg1 ), function ()
		local f6_local0 = LUI.DataSourceFromOmnvar.new( "ui_current_round" )
		f6_local0 = f6_local0:GetValue( f5_arg0 )
		local f6_local1 = DataSources.inGame.MP.match.countdownTime:GetValue( f5_arg0 )
		local f6_local2 = false
		if f6_local1 ~= nil and f6_local1 ~= -1 then
			if f6_local0 == 1 then
				if 0 < f6_local1 then
					f6_local2 = true
				end
			else
				f6_local2 = true
			end
		end
		if CONDITIONS.IsArenaEvoGameType() then
			f6_local2 = true
		end
		if f6_local2 == true then
			local f6_local3 = Game[0x7F3101B17A29E1A]( f5_arg0 )
			if DYN_ATTACHMENT.IsDynamicAttachmentIconsEnabled() and f6_local3 then
				if f6_local3.primaryWeaponName and f6_local3.primaryWeaponRef and WEAPON.GetDynamicWeaponEnableValue( f6_local3.primaryWeaponRef ) then
					local f6_local4 = Game[0x10771632FB424AC]( f5_arg0, true )
					DYN_ATTACHMENT.SetupWeaponAttachmentStreamer( f5_arg0.ArenaLoadout, DYN_ATTACHMENT.GetDynamicAttachmentsTableByRef( f6_local4[1] ), true )
				end
				if f6_local3.secondaryWeaponName and f6_local3.secondaryWeaponName ~= "Combat Knife" and f6_local3.secondaryWeaponRef and WEAPON.GetDynamicWeaponEnableValue( f6_local3.secondaryWeaponRef ) then
					local f6_local4 = Game[0x10771632FB424AC]( f5_arg0, true )
					DYN_ATTACHMENT.SetupWeaponAttachmentStreamer( f5_arg0.ArenaLoadout, DYN_ATTACHMENT.GetDynamicAttachmentsTableByRef( f6_local4[2] ), true )
				end
			end
			local f6_local4 = Game[0x10771632FB424AC]( f5_arg0 )
			local f6_local5 = f6_local4[1]
			local f6_local6 = f6_local4[2]
			local f6_local7 = DataSources.inGame.HUD.arenaLoadoutType:GetValue( f5_arg0 )
			local f6_local8 = Game[0x28624DEF6F708C8]( f5_arg0, "ui_arena_en_primary" )
			local f6_local9
			if f6_local5 then
				f6_local9 = f6_local5
			else
				f6_local9 = f6_local5[1] ~= nil
			end
			local f6_local10
			if f6_local6 then
				f6_local10 = f6_local6
			else
				f6_local10 = f6_local6[1] ~= nil
			end
			if f6_local9 then
				f5_arg0.ArenaLoadout.PrimaryWeapon:UpdateAttachments( f6_local5 )
			end
			if f6_local10 then
				f5_arg0.ArenaLoadout.SecondaryWeapon:UpdateAttachments( f6_local6 )
			end
			if f6_local3 then
				if f6_local7 == f5_arg0.PickUp then
					f5_arg0.ArenaLoadout.SecondaryWeapon.Name:SetAlpha( 0, 0 )
					f5_arg0.ArenaLoadout.SecondaryWeapon.DynamicAttachmentIcon:SetAlpha( 0, 0 )
					f5_arg0.ArenaLoadout.PrimaryEquipment.Name:SetAlpha( 0, 0 )
					f5_arg0.ArenaLoadout.PrimaryEquipment.Icon:SetAlpha( 0, 0 )
					f5_arg0.ArenaLoadout.SecondaryEquipment.Name:SetAlpha( 0, 0 )
					f5_arg0.ArenaLoadout.SecondaryEquipment.Icon:SetAlpha( 0, 0 )
				end
				if f6_local3.primaryWeaponIcon and f6_local3.primaryWeaponName then
					local f6_local11 = Game[0x10771632FB424AC]( f5_arg0, true )
					local f6_local12 = DYN_ATTACHMENT.GetDynamicAttachmentsTableByRef( f6_local11[1] )
					local f6_local13 = {}
					for f6_local14 = 1, #f6_local11[1], 1 do
						local f6_local17 = f6_local11[1][f6_local14]
						if f6_local17 and 0 < #f6_local17 and ATTACHMENT.IsDisplayNameAvailable( f6_local17 ) then
							table.insert( f6_local13, f6_local17 )
						end
					end
					f5_arg0.ArenaLoadout.PrimaryWeapon:UpdateWeaponInfo( f5_arg0, {
						displayAttachmentRefTable = f6_local13,
						weaponIcon = f6_local3.primaryWeaponIcon,
						weaponName = f6_local3.primaryWeaponName,
						weaponRef = f6_local3.primaryWeaponRef
					}, f6_local12 )
				end
				if f6_local3.secondaryWeaponIcon and f6_local3.secondaryWeaponName and f6_local3.secondaryWeaponName ~= "Combat Knife" then
					local f6_local11 = Game[0x10771632FB424AC]( f5_arg0, true )
					local f6_local12 = DYN_ATTACHMENT.GetDynamicAttachmentsTableByRef( f6_local11[2] )
					local f6_local13 = {}
					for f6_local14 = 1, #f6_local11[2], 1 do
						local f6_local17 = f6_local11[2][f6_local14]
						if f6_local17 and 0 < #f6_local17 and ATTACHMENT.IsDisplayNameAvailable( f6_local17 ) then
							table.insert( f6_local13, f6_local17 )
						end
					end
					f5_arg0.ArenaLoadout.SecondaryWeapon:UpdateWeaponInfo( f5_arg0, {
						displayAttachmentRefTable = f6_local13,
						weaponIcon = f6_local3.secondaryWeaponIcon,
						weaponName = f6_local3.secondaryWeaponName,
						weaponRef = f6_local3.secondaryWeaponRef
					}, f6_local12 )
					ACTIONS.AnimateSequence( f5_arg0.ArenaLoadout, "PrimaryAndSecondary" )
				else
					f5_arg0.ArenaLoadout.SecondaryWeapon.Name:SetAlpha( 0, 0 )
					f5_arg0.ArenaLoadout.SecondaryWeapon.DynamicAttachmentIcon:SetAlpha( 0, 0 )
					ACTIONS.AnimateSequence( f5_arg0.ArenaLoadout, "PrimaryOnly" )
				end
				if DataSources.inGame.HUD.arena.loadout.primaryWeapon:GetValue( f5_arg0 ) ~= f6_local3.primaryWeaponIcon then
					DataSources.inGame.HUD.arena.loadout.primaryWeapon:SetValue( f5_arg0, f6_local3.primaryWeaponIcon )
					ACTIONS.AnimateSequence( f5_arg0, "NewLoadout" )
				end
				if CONDITIONS.IsSplitscreen( f5_arg0 ) then
					ACTIONS.AnimateSequence( f5_arg0.ArenaLoadout, "Splitscreen" )
				end
				ACTIONS.AnimateSequence( f5_arg0, "Show" )
			end
			if f6_local8 ~= -1 then
				ACTIONS.AnimateSequence( f5_arg0, "ShowEnemyLoadout" )
			end
		end
	end )
	f0_local0( f5_arg0, f5_arg1 )
end

function ArenaLoadoutContainer( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "ArenaLoadoutContainer"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	self._sequenceLengths = self._sequenceLengths or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine[0x12586A3F4FB490E]() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1, "Missing controllerIndex!" )
	local f1_local2 = self
	local Flash = nil
	
	Flash = LUI.UIImage.new()
	Flash.id = "Flash"
	Flash:SetRGBFromTable( SWATCHES.Arena.NewSecondary, 0 )
	Flash:SetPixelGridEnabled( true )
	Flash:SetPixelGridContrast( 0.5, 0 )
	Flash:SetPixelGridBlockWidth( 2, 0 )
	Flash:SetPixelGridBlockHeight( 2, 0 )
	Flash:SetPixelGridGutterWidth( 1, 0 )
	Flash:SetPixelGridGutterHeight( 1, 0 )
	Flash:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, 0, 0, _1080p * -33, _1080p * 1 )
	self:addElement( Flash )
	self.Flash = Flash
	
	local NewLoadoutMessage = nil
	
	NewLoadoutMessage = MenuBuilder.BuildRegisteredType( "ArenaNewLoadoutMessage", {
		controllerIndex = f1_local1
	} )
	NewLoadoutMessage.id = "NewLoadoutMessage"
	NewLoadoutMessage:SetAlpha( 0, 0 )
	NewLoadoutMessage:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 100, _1080p * 500, _1080p * 100, _1080p * 130 )
	self:addElement( NewLoadoutMessage )
	self.NewLoadoutMessage = NewLoadoutMessage
	
	local ArenaLoadout = nil
	
	ArenaLoadout = MenuBuilder.BuildRegisteredType( "ArenaLoadout", {
		controllerIndex = f1_local1
	} )
	ArenaLoadout.id = "ArenaLoadout"
	ArenaLoadout:SetAlpha( 0, 0 )
	ArenaLoadout:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 100, _1080p * 500, _1080p * 150, _1080p * 950 )
	self:addElement( ArenaLoadout )
	self.ArenaLoadout = ArenaLoadout
	
	self._sequences.DefaultSequence = function ()
		
	end
	
	self._sequenceLengths.DefaultSequence = 0
	local f1_local6 = nil
	ArenaLoadout:RegisterAnimationSequence( "Show", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 436
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 836
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * 140
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 940
		},
		{
			value = 1,
			duration = 200,
			property = TWEEN_PROPERTY.Alpha,
			easing = LUI.EASING.inQuadratic
		},
		{
			duration = 200,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 100,
			easing = LUI.EASING.inQuadratic
		},
		{
			duration = 200,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 500,
			easing = LUI.EASING.inQuadratic
		},
		{
			duration = 4800,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 100
		},
		{
			duration = 4800,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 500
		},
		{
			value = 1,
			duration = 4800,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			value = 0,
			duration = 1000,
			property = TWEEN_PROPERTY.Alpha,
			easing = LUI.EASING.outQuadratic
		},
		{
			duration = 1000,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 90,
			easing = LUI.EASING.outQuadratic
		},
		{
			duration = 1000,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 490,
			easing = LUI.EASING.outQuadratic
		}
	} )
	self._sequences.Show = function ()
		menu:AnimateSequence( "Show" )
	end
	
	self._sequenceLengths.Show = 6000
	local f1_local7 = nil
	Flash:RegisterAnimationSequence( "NewLoadout", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 864
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * -980
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 860
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * -950
		},
		{
			value = 1,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			value = 1,
			duration = 250,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			duration = 250,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -860
		},
		{
			duration = 400,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 860,
			easing = LUI.EASING.inOutCubic
		},
		{
			duration = 150,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -860,
			easing = LUI.EASING.inOutCubic
		},
		{
			value = 0,
			duration = 250,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			duration = -28,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -860
		},
		{
			duration = -28,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -860
		}
	} )
	NewLoadoutMessage:RegisterAnimationSequence( "NewLoadout", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 90
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 490
		},
		{
			value = 1,
			duration = 200,
			property = TWEEN_PROPERTY.Alpha,
			easing = LUI.EASING.inQuadratic
		},
		{
			duration = 200,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 100,
			easing = LUI.EASING.inQuadratic
		},
		{
			duration = 200,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 500,
			easing = LUI.EASING.inQuadratic
		},
		{
			value = 1,
			duration = 4790,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			duration = 4790,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 500
		},
		{
			duration = 4790,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 100
		},
		{
			value = 0,
			duration = 1010,
			property = TWEEN_PROPERTY.Alpha,
			easing = LUI.EASING.outQuadratic
		},
		{
			duration = 1010,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 90,
			easing = LUI.EASING.outQuadratic
		},
		{
			duration = 1010,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 490,
			easing = LUI.EASING.outQuadratic
		}
	} )
	self._sequences.NewLoadout = function ()
		menu:AnimateSequence( "NewLoadout" )
		menu:AnimateSequence( "NewLoadout" )
	end
	
	self._sequenceLengths.NewLoadout = 6000
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "ArenaLoadoutContainer", ArenaLoadoutContainer )
LockTable( _M )
