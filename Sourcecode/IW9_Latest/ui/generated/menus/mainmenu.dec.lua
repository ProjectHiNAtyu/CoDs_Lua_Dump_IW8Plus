-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.mainmenutabs" )
LUI.FlowManager.RegisterFenceGroup( "MainMenu", {
	nil,
	"koreanRating",
	"bootCheck",
	"signIn",
	"gamerProfile",
	"shaderUpload",
	"multiLogin",
	"onlineServices",
	"freeToPlayPrivilege",
	"crossPlayPrivilege",
	"ugcPrivilege",
	"onlineCommunicationsPrivilege",
	"socialNetworkSharingPrivilege",
	"platform",
	"patch",
	"onlinePlayerstats",
	"mainOnlineData",
	"platformServices",
	"playlists",
	"exchange",
	"churnReward",
	"fenceSpinner"
} )
LUI.FlowManager.RequestSetStack( "MainMenu", {
	{
		name = "MainLockoutMenu"
	}
} )
local f0_local0 = function ( f19_arg0, f19_arg1 )
	local f19_local0 = BATTLEMAP.GetBaseMenuScopedData()
	if f19_arg0._moveToBPMap and not f19_local0.bpEventIntroChecked then
		f19_local0.state = BATTLEMAP.BattlePassStates.HAUNTING_INTRO
		BATTLEMAP.OpenBattleMap( f19_arg1 )
	end
	f19_local0.bpEventIntroChecked = true
end

local f0_local1 = function ( f18_arg0, f18_arg1 )
	Dvar[0x8EA06EEDB58D872]( 0xA868542C2B793AC, false )
	Dvar[0x8EA06EEDB58D872]( 0x30EA57EA86FCB72, true )
	Social[0x4CFFBE37F5E69BB]( f18_arg1.controller, "MainMenu OnCreate" )
	Lobby[0x2043FF221ED6A77]( PartyUIRoot.MAIN_MENU )
	BATTLEMAP.PreStreamBattleMapAssets( f18_arg1.controller, false )
	f0_local0( f18_arg0, f18_arg1.controller )
end

local f0_local2 = function ()
	Dvar[0x8EA06EEDB58D872]( 0x3DDB961100B5F47, false )
	Dvar[0x8EA06EEDB58D872]( 0x85EF1ED1D39D3A3, false )
	Game[0x16DC23DB3DC4FD1]( controllerIndex )
end

local f0_local3 = function ()
	if not CONDITIONS.ArePartiesEnabledInMainMenu() then
		Dvar[0x8EA06EEDB58D872]( 0xD360034020A5D7A, false )
		Dvar[0x8EA06EEDB58D872]( 0x62400405F9F3C0B, false )
	end
	f0_local0()
end

local f0_local4 = function ()
	Dvar[0x8EA06EEDB58D872]( 0xD360034020A5D7A, false )
	Dvar[0x8EA06EEDB58D872]( 0x62400405F9F3C0B, false )
	f0_local0()
end

local f0_local5 = function ( f14_arg0 )
	assert( f14_arg0 )
	Engine[0x4B0C2D659AE39D3]( "Pressed a Main Menu button", f14_arg0 )
end

function ConfirmOpenCoopMenu()
	local f13_local0 = Engine[0x45B054C920178E9]()
	f0_local0()
	if CONDITIONS.ArePartiesEnabledInMainMenu() then
		f0_local0( f13_local0 )
	end
	Engine[0x3DACD106DDC0D71]()
	if CP.HasSeenIntro( f13_local0, 0 ) == 0 then
		LUI.FlowManager.RequestAddMenu( "CinematicFullscreen", true, f13_local0, false, {
			disableQuickAccess = true,
			cpIntro = true,
			video = "cp_opening_cine_intro"
		} )
	else
		LUI.FlowManager.RequestAddMenu( "CPMainMenu", false, f13_local0, false, nil, true )
	end
end

function AttemptOpenCPMenuAfterDLCModePopup( f11_arg0, f11_arg1 )
	local f11_local0 = Engine[0x2634E2AA518C252]()
	local f11_local1 = Engine[0x7024E7C50CD3F2F]( CoD.PlayMode.Aliens )
	if CONDITIONS.ArePartiesEnabledInMainMenu() then
		if f11_local1 < f11_local0 then
			LUI.FlowManager.RequestPopupMenu( f11_arg0, "OpeningMenuWithHighPrivatePartyMemberCountWarning", true, f11_arg1, false, {
				currentCount = f11_local0,
				maxCount = f11_local1
			} )
		elseif Engine[0x71D9671B0095515]() then
			if Lobby.SplitScreenChecksPassed( f11_arg0, f11_arg1, function ()
				ConfirmOpenCoopMenu()
			end
			 ) then
				ConfirmOpenCoopMenu()
			end
		else
			ConfirmOpenCoopMenu()
		end
	end
end

function DisbandPartyEnterDLCModePopup( f9_arg0, f9_arg1 )
	assert( f9_arg1.controllerIndex )
	local f9_local0 = MenuBuilder.BuildRegisteredType( "PopupYesNo", {
		title = Engine[0xED84C33EC5F01EA]( 0x1CCA5C59ECE1EA6 ),
		message = Engine[0xED84C33EC5F01EA]( 0xDB5020A22DE373 ),
		yesAction = function ( f10_arg0, f10_arg1 )
			if f9_arg0.mpMainMenuOptions then
				PLAY_MENU.AttemptOpenMPMenuAfterDLCModePopup( f10_arg0, f9_arg0.controllerIndex, f9_arg0.mpMainMenuOptions )
			else
				AttemptOpenCPMenuAfterDLCModePopup( f10_arg0, f9_arg0.controllerIndex )
			end
		end
	} )
	f9_local0.id = "Disband_Party_Enter_DLC_Mode_Popup"
	return f9_local0
end

MenuBuilder.registerType( "Disband_Party_Enter_DLC_Mode_Popup", DisbandPartyEnterDLCModePopup )
local f0_local6 = function ( f8_arg0 )
	local f8_local0 = PLAYER_DATA.IO( f8_arg0, CoD.StatsGroup.NonGame )
	if 0 < f8_local0.didFixRoyalKnifeVariantIndexMixUp:get() then
		return 
	end
	local f8_local1 = false
	local f8_local2 = GL_HACK.FixRoyalKnifeVariantIndexMixUp( f8_arg0, CoD.StatsGroup.RankedLoadouts )
	if not f8_local2 then
		f8_local1 = f8_local2
	else
		
	end
	f8_local2 = GL_HACK.FixRoyalKnifeVariantIndexMixUp( f8_arg0, CoD.StatsGroup.PrivateLoadouts )
	if not f8_local2 then
		f8_local1 = f8_local2
	else
		
	end
	f8_local2 = GL_HACK.FixRoyalKnifeVariantIndexMixUp( f8_arg0, CoD.StatsGroup.CoopLoadouts )
	if not f8_local2 then
		f8_local1 = f8_local2
	else
		
	end
	f8_local2 = GL_HACK.FixRoyalKnifeVariantIndexMixUp( f8_arg0, CoD.StatsGroup.WZRankedLoadouts )
	if not f8_local2 then
		f8_local1 = f8_local2
	else
		
	end
	f8_local2 = GL_HACK.FixRoyalKnifeVariantIndexMixUp( f8_arg0, CoD.StatsGroup.WZPrivateLoadouts )
	if not f8_local2 then
		f8_local1 = f8_local2
	else
		
	end
	f8_local2 = GL_HACK.FixRoyalKnifeVariantIndexMixUp( f8_arg0, CoD.StatsGroup.LeaguePlayLoadouts )
	if not f8_local2 then
		f8_local1 = f8_local2
	else
		
	end
	f8_local2 = GL_HACK.FixRoyalKnifeVariantIndexMixUp( f8_arg0, CoD.StatsGroup.WZLeaguePlayLoadouts )
	if not f8_local2 then
		f8_local1 = f8_local2
	else
		
	end
	f8_local2 = GL_HACK.FixRoyalKnifeVariantIndexMixUpCustomMods( f8_arg0 )
	if not f8_local2 then
		f8_local1 = f8_local2
	else
		
	end
	if f8_local1 then
		ACTIONS.UploadStats( nil, f8_arg0 )
	end
	f8_local2 = PLAYER_DATA.IO( f8_arg0, CoD.StatsGroup.NonGame )
	f8_local2.didFixRoyalKnifeVariantIndexMixUp:set( 1 )
end

local f0_local7 = function ( f7_arg0 )
	local f7_local0 = PLAYER_DATA.IO( f7_arg0, CoD.StatsGroup.NonGame )
	if 0 < f7_local0.wasProtuningPlayerDataConverted:get() then
		return 
	else
		GUNSMITH.ConvertProtuningPlayerData( f7_arg0, CoD.StatsGroup.RankedLoadouts )
		GUNSMITH.ConvertProtuningPlayerData( f7_arg0, CoD.StatsGroup.PrivateLoadouts )
		GUNSMITH.ConvertProtuningPlayerData( f7_arg0, CoD.StatsGroup.CoopLoadouts )
		GUNSMITH.ConvertProtuningPlayerData( f7_arg0, CoD.StatsGroup.WZRankedLoadouts )
		GUNSMITH.ConvertProtuningPlayerData( f7_arg0, CoD.StatsGroup.WZPrivateLoadouts )
		GUNSMITH.ConvertProtuningPlayerData( f7_arg0, CoD.StatsGroup.LeaguePlayLoadouts )
		GUNSMITH.ConvertProtuningPlayerData( f7_arg0, CoD.StatsGroup.WZLeaguePlayLoadouts )
		local f7_local1 = PLAYER_DATA.IO( f7_arg0, CoD.StatsGroup.NonGame )
		f7_local1.wasProtuningPlayerDataConverted:set( 1 )
	end
end

local f0_local8 = function ( f6_arg0 )
	local f6_local0 = PLAYER_DATA.IO( f6_arg0, CoD.StatsGroup.NonGame )
	f6_local0 = f6_local0.executionValidationRequired:get() <= 0
	if Dvar[0x9E5BE3B4BBA4E0E]( 0x6537D59248C94D8 ) and f6_local0 then
		OPERATOR.ValidateAllOperatorExecutions( f6_arg0, f6_local0 )
		local f6_local1 = PLAYER_DATA.IO( f6_arg0, CoD.StatsGroup.NonGame )
		f6_local1.executionValidationRequired:set( 1 )
	end
end

local f0_local9 = function ( f3_arg0, f3_arg1, f3_arg2 )
	Engine[0xBD7B960877CF84D]( f3_arg1 )
	if CONDITIONS.IsSony() then
		InGameStore.ShowStoreIcon( false )
	end
	if not STORE.IsCatalogReady( f3_arg1 ) then
		LUI.DeferredFence.Attach( f3_arg0, f3_arg1, "STORE", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f5_arg0, f5_arg1 )
			InGameStore.FetchCatalog( f3_arg0, false, false )
		end )
	end
	f0_local0( f3_arg1 )
	f0_local0( f3_arg1 )
	if not CONDITIONS.IsSubGameModeMainMenuInMenuStack() and not BuiltInEsports[0x9894ED459E76619]() then
		Engine[0x2E1889B2FD148F6]( Enum[0xFA786CCC4BE4587][0xFD56C8DFAC46196] )
		Engine[0x6D60E06FE7052C2]( Enum[0xAC7E3CE067D9A9F][0xFD56C8DFAC46196] )
		if f3_arg0.MainMenuTabs then
			f3_arg0.MainMenuTabs:SetActiveProjectText()
		end
		Dvar[0xE3CB005036E0C0F]( 0x65E9A96EB2FF62B, "main_menu" )
		Dvar[0xE3CB005036E0C0F]( 0xFF7F040FA04B28E, "war" )
		Dvar[0x8EA06EEDB58D872]( 0x5D05C0CBFA8BDC1, false )
	end
	if Game[0x6DD1B6FF7A0A975]( f3_arg1 ) == true then
		BATTLEMAP.PreStreamBattleMapAssets( f3_arg1, true )
	end
	f3_arg0:addEventHandler( "menu_create", f0_local0 )
	if f3_arg0.MainMenuTabs then
		f3_arg0.MainMenuTabs:SetupTabs( f3_arg1, {
			tabLayout = MAINMENUTABS.Layouts.MainMenu
		} )
		if not CONDITIONS.IsCortezSubExe() and not CONDITIONS.UseCortezEjectedMenus() then
			f3_arg0.MainMenuTabs.MenuTitle:UpdateLogo( "COD" )
			if f3_arg0.MainMenuTabs.MenuTitle.BackButtonArrow then
				f3_arg0.MainMenuTabs:SetBackButtonDisabled( true )
			end
		end
	end
	if CONDITIONS.ArePartiesEnabledInMainMenu() then
		f3_arg0.isSignInMenu = true
	end
	if CONDITIONS.IsPlayerDataWeaponSetupsValidationEnabled() then
		LUI.DeferredFence.Attach( f3_arg0, f3_arg1, "LOOT_VALIDATION", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f4_arg0, f4_arg1 )
			if f4_arg1.fenceState == LUI.Fence.FenceObjectState.PASSING then
				LOADOUT.ValidatePlayerDataWeaponSetups( f3_arg0 )
				f3_arg0( f3_arg0 )
			end
		end, true )
	end
	f3_arg0:dispatchEventToRoot( {
		showTabs = true,
		name = "update_tab_visibility"
	} )
	local f3_local0 = SEASON.GetCurrentSeason()
	local f3_local1
	if f3_local0 == SEASONAL_EVENT.HauntingEventSeason then
		f3_local1 = BATTLEMAP.HasEventStarted()
		if f3_local1 then
			if not BATTLEMAP.HasEventEnded() and not Onboarding.BattlePass.HasPlayerSeenBPEventIntro( f3_arg1 ) then
				f3_local1 = Onboarding.BattlePassIntro.WasCompleted( f3_arg1, f3_local0 )
				if f3_local1 then
					f3_local1 = Onboarding.BattlePass.WasCompleted( f3_arg1 )
				end
			else
				f3_local1 = false
			end
		end
	else
		f3_local1 = false
	end
	f3_arg0._moveToBPMap = f3_local1
	if not f3_arg0._moveToBPMap then
		if CONDITIONS.IsCortezSubExe() then
			DebugPrint( "don't show MainMenuPopup in CortezSub" )
		else
			f3_local1 = LUI.MainMenuPopupManager.Instance()
			f3_local1:ShowIntroPopups( f3_arg1 )
		end
	end
end

local f0_local10 = function ()
	if CONDITIONS.IsMobileOrMobileSim() then
		Dvar[0x8EA06EEDB58D872]( 0x62400405F9F3C0B, not Dvar[0x9E5BE3B4BBA4E0E]( 0x3DDB961100B5F47 ) )
	else
		Dvar[0x8EA06EEDB58D872]( 0x3DDB961100B5F47, false )
		Dvar[0x8EA06EEDB58D872]( 0x62400405F9F3C0B, true )
	end
	Dvar[0x8EA06EEDB58D872]( 0x85EF1ED1D39D3A3, false )
	Dvar[0x8EA06EEDB58D872]( 0x77A1EC53BD776DB, false )
	Dvar[0x8EA06EEDB58D872]( 0x5D05C0CBFA8BDC1, false )
	Dvar[0x8EA06EEDB58D872]( 0xEEEDDD8C404C6E7, false )
	Dvar[0x8EA06EEDB58D872]( 0x10DDDD00791A119, true )
	Dvar[0x8EA06EEDB58D872]( 0xDBDFBBD226D1F0E, false )
	Lobby[0xA70FDE57A75B032]( false )
end

function MainMenu( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "MainMenu"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	self.HelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	self.HelperBar.id = "HelperBar"
	if CONDITIONS.IsMobileOrMobileSim() then
		self.HelperBar:SetAnchorsAndPosition( 1, 0, 0, 0, _1080p * -120, 0, 0, 0 )
	else
		self.HelperBar:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -85, 0 )
	end
	self.HelperBar:setPriority( 10 )
	self:addElement( self.HelperBar )
	local f1_local2 = self
	local MainMenuTabs = nil
	
	MainMenuTabs = MenuBuilder.BuildRegisteredType( "MainMenuTabs", {
		controllerIndex = f1_local1
	} )
	MainMenuTabs.id = "MainMenuTabs"
	MainMenuTabs.MenuTitle.MenuTitle:setText( "", 0 )
	MainMenuTabs.MenuTitle.ModeTitle:setText( "", 0 )
	MainMenuTabs:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	self:addElement( MainMenuTabs )
	self.MainMenuTabs = MainMenuTabs
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "MainMenu", MainMenu )
LUI.FlowManager.RegisterStackPushBehaviour( "MainMenu", f0_local10 )
LockTable( _M )
