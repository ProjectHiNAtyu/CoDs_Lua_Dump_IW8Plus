-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:01
module( ..., package.seeall )
require( "ui.generated.widgets.globalpanelbackground" )
require( "ui.generated.widgets.globalpaneltabshort" )
require( "ui.generated.widgets.togglebutton" )
require( "ui.generated.widgets.frontend.menutitletext" )
require( "ui.generated.widgets.frontend.mp.connectionicon" )
local f0_local0 = 500
local f0_local1 = 5000
local f0_local2 = function ( f14_arg0 )
	if not CHANNELS.IsValidPartyID( f14_arg0._channelID ) or f14_arg0._channelType == Enum[0x71816B8A6999EAF][0xC0E29ADAA5D346F] then
		return 
	end
	local f14_local0 = CHANNELS.GetChannelDetails( f14_arg0._controllerIndex, f14_arg0._channelID )
	if f14_arg0._memberCount ~= f14_local0.memberCount then
		f14_arg0.MenuTitleText:SetTitle( ToUpperCase( Engine[0xED84C33EC5F01EA]( 0x981CE4FEFAA242, CHANNELS.GetChannelName( f14_arg0._controllerIndex, f14_arg0._channelID ), f14_local0.memberCount, f14_local0.maxPlayers ) ) )
		f14_arg0._memberCount = f14_local0.memberCount
	end
end

local f0_local3 = function ( f13_arg0 )
	if CHANNELS.IsValidPartyID( f13_arg0._channelID ) then
		local f13_local0 = CHANNELS.IsVoicePartyConnectionStable( f13_arg0._controllerIndex )
		if f13_local0 ~= f13_arg0._isVoicePartyConnectionStable then
			f13_arg0._isVoicePartyConnectionStable = f13_local0
			f13_arg0.ToggleButton:SetToggleWarningState( not f13_local0 )
		end
	end
	if TEXTCHAT.IsValidChatID( f13_arg0._chatID ) then
		local f13_local0 = TEXTCHAT.CanConnectToTextChat()
		if f13_local0 ~= f13_arg0._isChatConnectionStable then
			f13_arg0._isChatConnectionStable = f13_local0
			for f13_local5, f13_local6 in ipairs( f13_arg0._channelTabs ) do
				if f13_local6.tabID == CHANNELS.TAB_ID.CHAT then
					local f13_local4 = f13_arg0.Tabs:GetTabAtIndex( f13_local5 )
					f13_local4:SetWarningState( not f13_local0 )
					break
				end
			end
		end
	end
end

local f0_local4 = function ( f10_arg0 )
	f10_arg0._channelTabs = {}
	if CHANNELS.IsValidPartyID( f10_arg0._channelID ) then
		table.insert( f10_arg0._channelTabs, {
			icon = "icon_global_party",
			menuName = "ChannelMembers",
			disabled = false,
			tabID = CHANNELS.TAB_ID.MEMBERS
		} )
	end
	if TEXTCHAT.IsValidChatID( f10_arg0._chatID ) and CONDITIONS.IsChannelsTextChatEnabled( f10_arg0._controllerIndex ) then
		if TEXTCHAT.IsWhisper( f10_arg0._controllerIndex, f10_arg0._chatID ) and not CONDITIONS.WhispersEnabled( f10_arg0._controllerIndex ) then
			assert( false, "Tried to open whisper channel while whispers are disabled" )
		else
			table.insert( f10_arg0._channelTabs, {
				icon = "icon_global_chat",
				menuName = "ChannelChat",
				disabled = false,
				tabID = CHANNELS.TAB_ID.CHAT
			} )
		end
	end
	if CHANNELS.IsValidPartyID( f10_arg0._channelID ) and f10_arg0._channelType ~= Enum[0x71816B8A6999EAF][0x6779FA46C0A2058] then
		table.insert( f10_arg0._channelTabs, {
			icon = "icon_global_options",
			menuName = "ChannelSettings",
			disabled = false,
			tabID = CHANNELS.TAB_ID.SETTINGS
		} )
	end
	f10_arg0.Tabs:SetSendEventOnTabChange( true )
	f10_arg0:addEventHandler( LUI.TabManager.TAB_SWITCH_EVENT, function ( f12_arg0, f12_arg1 )
		assert( f12_arg1.index )
		f10_arg0.activeTabWidget:processEvent( f12_arg1 )
		return true
	end )
	local f10_local0 = LUI.FlowManager.GetScopedData( f10_arg0 )
	local f10_local1 = f10_arg0._channelScopedData.selectedChannelDefaultTabIndex
	if not f10_local1 then
		f10_local1 = CHANNELS.TAB_ID.MEMBERS
	end
	local f10_local2 = {}
	for f10_local6, f10_local7 in ipairs( f10_arg0._channelTabs ) do
		table.insert( f10_local2, {
			name = f10_local7.name,
			icon = f10_local7.icon,
			disabled = f10_local7.disabled,
			hasDefaultFocus = f10_local7.tabID == f10_local1,
			focusFunction = function ( f11_arg0, f11_arg1, f11_arg2, f11_arg3 )
				local f11_local0 = f10_arg0._channelTabs[f11_arg2 + 1].tabID
				if f10_arg0.activeTabID and f11_local0 == f10_arg0.activeTabID and f10_arg0.activeTabWidget then
					return 
				else
					TAB.UpdateBuiltWidgetOnTabChange( f10_arg0, f10_arg0.activeTabID, "activeTabWidget", f11_arg2, f11_arg3, f10_arg0.menuName, {
						alignBottom = true,
						buildPriority = 1,
						controllerIndex = f11_arg1
					} )
					f10_arg0.activeTabID = f11_local0
				end
			end
		} )
	end
	if 0 < #f10_local2 then
		f10_arg0.Tabs:SetTabs( f10_local2 )
		f10_arg0.Tabs:SizeTabsToFit()
		f10_arg0.Tabs:SetAlignment( LUI.Alignment.Center )
	end
	if #f10_local2 <= 1 then
		f10_arg0.Tabs:SetVisible( false )
	end
end

local f0_local5 = function ( f8_arg0 )
	if CHANNELS.IsValidPartyID( f8_arg0._channelID ) then
		f8_arg0.MenuTitleText:SetTitle( CHANNELS.GetChannelName( f8_arg0._controllerIndex, f8_arg0._channelID, false ), nil, true )
		if f8_arg0._channelType == Enum[0x71816B8A6999EAF][0x5F503BE0C38AF61] or f8_arg0._channelType == Enum[0x71816B8A6999EAF][0x6779FA46C0A2058] then
			f8_arg0:CreateEventTimer( "memberCountRefreshTimer", f0_local0, {
				immediate = true,
				callbackFunc = function ( f9_arg0, f9_arg1 )
					f8_arg0( f9_arg0 )
					return true
				end
			} )
		end
	elseif TEXTCHAT.IsWhisper( f8_arg0._controllerIndex, f8_arg0._chatID ) then
		f8_arg0.MenuTitleText:SetTitle( TEXTCHAT.GetWhisperMemberGamertag( f8_arg0._controllerIndex, f8_arg0._chatID ), nil, true )
	end
	f8_arg0.MenuTitleText:SetupBackButton( f8_arg0._controllerIndex )
end

local f0_local6 = function ( f5_arg0 )
	if CHANNELS.IsValidPartyID( f5_arg0._channelID ) then
		f5_arg0._voicePartyID = Social[0xF12FC4AFD7A2A6D]( f5_arg0._controllerIndex )
		f5_arg0.ToggleButton:SetToggleState( f5_arg0._voicePartyID == f5_arg0._channelID )
		f5_arg0.ToggleButton.Action = function ( f7_arg0 )
			CHANNELS.ToggleVoicePartyConnection( f5_arg0._controllerIndex, f5_arg0._channelID )
			f5_arg0._voicePartyID = Social[0xF12FC4AFD7A2A6D]( f5_arg0._controllerIndex )
			f5_arg0.ToggleButton:SetToggleState( f5_arg0._voicePartyID == f5_arg0._channelID )
		end
		
		if not CONDITIONS.IsVoiceChatEnabled() then
			f5_arg0.ConnectionIcon:SetVoiceChatDisabled( true )
		else
			f5_arg0.ConnectionIcon:SetVoiceConnectedState( true )
		end
		f5_arg0:AddGamepadEventCallback( "button_right_trigger", function ( f6_arg0, f6_arg1 )
			f6_arg0.ToggleButton:Action()
		end )
	else
		f5_arg0._voicePartyID = nil
		f5_arg0:RemoveElement( f5_arg0.ToggleButton )
		f5_arg0.ToggleButton:closeTree()
		f5_arg0.ToggleButton = nil
		f5_arg0:RemoveElement( f5_arg0.ConnectionIcon )
		f5_arg0.ConnectionIcon:closeTree()
		f5_arg0.ConnectionIcon = nil
		f5_arg0:RemoveElement( f5_arg0.VoiceConnectPrompt )
		f5_arg0.VoiceConnectPrompt:closeTree()
		f5_arg0.VoiceConnectPrompt = nil
	end
end

local f0_local7 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.SetupTitle = f0_local0
	f3_arg0._controllerIndex = f3_arg1
	f3_arg0._channelScopedData = CHANNELS.GetChannelScopedData()
	f3_arg0._channelID = f3_arg0._channelScopedData.selectedChannelID
	f3_arg0._channelType = f3_arg0._channelScopedData.selectedChannelType
	f3_arg0._chatID = f3_arg0._channelScopedData.selectedChannelChatID
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0 )
	f3_arg0:CreateEventTimer( "serviceRefreshTimer", f0_local0, {
		immediate = true,
		callbackFunc = function ( f4_arg0, f4_arg1 )
			f3_arg0( f4_arg0 )
			return true
		end
	} )
end

function ChannelPanel( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 620 * _1080p, 0, 1080 * _1080p )
	self.id = "ChannelPanel"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local Background = nil
	
	Background = MenuBuilder.BuildRegisteredType( "GlobalPanelBackground", {
		controllerIndex = f1_local1
	} )
	Background.id = "Background"
	Background:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	self:addElement( Background )
	self.Background = Background
	
	local SubBacker = nil
	
	SubBacker = LUI.UIImage.new()
	SubBacker.id = "SubBacker"
	SubBacker:SetRGBFromTable( SWATCHES.IW9StyleGuide.styleGuideCool05, 0 )
	SubBacker:SetAlpha( 0.4, 0 )
	SubBacker:setImage( RegisterMaterial( 0xD4247DF2A39F4B0 ), 0 )
	SubBacker:SetBlendMode( BLEND_MODE.multiply )
	SubBacker:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -80, 0 )
	self:addElement( SubBacker )
	self.SubBacker = SubBacker
	
	local TabsBacker = nil
	
	TabsBacker = LUI.UIImage.new()
	TabsBacker.id = "TabsBacker"
	TabsBacker:SetRGBFromTable( SWATCHES.IW9StyleGuide.styleGuideCool05, 0 )
	TabsBacker:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, _1080p * 96, _1080p * 166 )
	self:addElement( TabsBacker )
	self.TabsBacker = TabsBacker
	
	local Tabs = nil
	
	Tabs = LUI.TabManager.new( {
		spacing = 10,
		wrap = true,
		tabHeight = _1080p * 70,
		buildTab = function ()
			return MenuBuilder.BuildRegisteredType( "GlobalPanelTabShort", {
				controllerIndex = menu
			} )
		end,
		controllerIndex = f1_local1
	} )
	Tabs.id = "Tabs"
	Tabs:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -201, _1080p * 201, _1080p * 96, _1080p * 192 )
	self:addElement( Tabs )
	self.Tabs = Tabs
	
	local ToggleButton = nil
	
	ToggleButton = MenuBuilder.BuildRegisteredType( "ToggleButton", {
		controllerIndex = f1_local1
	} )
	ToggleButton.id = "ToggleButton"
	ToggleButton:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -112, _1080p * -66, _1080p * 35.5, _1080p * 59.5 )
	self:addElement( ToggleButton )
	self.ToggleButton = ToggleButton
	
	local VoiceConnectPrompt = nil
	
	VoiceConnectPrompt = LUI.UIStyledText.new()
	VoiceConnectPrompt.id = "VoiceConnectPrompt"
	VoiceConnectPrompt:SetRGBFromTable( SWATCHES.text.offwhite, 0 )
	VoiceConnectPrompt:setText( Engine[0xED84C33EC5F01EA]( 0x135150529AABD15 ), 0 )
	VoiceConnectPrompt:setCaseStyle( LUI.CaseStyle.Uppercase )
	VoiceConnectPrompt:SetFont( FONTS.GetFont( FONTS.PrimaryBold.File ) )
	VoiceConnectPrompt:SetFontSize( 18 * _PT )
	VoiceConnectPrompt:SetMinFontSize( 18 * _PT )
	VoiceConnectPrompt:SetWordWrap( false )
	VoiceConnectPrompt:SetAlignment( LUI.Alignment.Left )
	VoiceConnectPrompt:SetTintFontIcons( true )
	VoiceConnectPrompt:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -53, _1080p * -23, _1080p * 32.5, _1080p * 62.5 )
	self:addElement( VoiceConnectPrompt )
	self.VoiceConnectPrompt = VoiceConnectPrompt
	
	local MenuTitleText = nil
	
	MenuTitleText = MenuBuilder.BuildRegisteredType( "MenuTitleText", {
		controllerIndex = f1_local1
	} )
	MenuTitleText.id = "MenuTitleText"
	MenuTitleText.Text:setText( "", 0 )
	MenuTitleText.Text:setCaseStyle( LUI.CaseStyle.Regular )
	MenuTitleText:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 87, _1080p * 457, _1080p * 31.5, _1080p * 63.5 )
	self:addElement( MenuTitleText )
	self.MenuTitleText = MenuTitleText
	
	local ConnectionIcon = nil
	
	ConnectionIcon = MenuBuilder.BuildRegisteredType( "ConnectionIcon", {
		controllerIndex = f1_local1
	} )
	ConnectionIcon.id = "ConnectionIcon"
	ConnectionIcon:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -163, _1080p * -128, _1080p * 30, _1080p * 65 )
	self:addElement( ConnectionIcon )
	self.ConnectionIcon = ConnectionIcon
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "ChannelPanel", ChannelPanel )
LockTable( _M )
