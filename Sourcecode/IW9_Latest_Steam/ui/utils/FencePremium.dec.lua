-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:48
module( ..., package.seeall )
FencePremiumInterface = LUI.Class( LUI.Fence )
FencePremiumInterface.init = function ( f20_arg0 )
	FencePremiumInterface.super.init( f20_arg0 )
end

FencePremiumInterface.UpdateState = function ( f19_arg0 )
	f19_arg0._state = LUI.Fence.STATE.fail
	for f19_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		if f19_arg0:PassCondition( f19_local0 ) then
			f19_arg0._state = LUI.Fence.STATE.pass
			break
		end
	end
end

FencePremium = LUI.Class( LUI.Fence )
FencePremium.init = function ( f18_arg0 )
	FencePremium.super.init( f18_arg0 )
end

FencePremium.UpdateState = function ( f17_arg0 )
	f17_arg0._state = LUI.Fence.STATE.fail
	for f17_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		if Engine[0x8B495DC361731F7]( f17_local0 ) then
			f17_arg0._state = LUI.Fence.STATE.pass
			return 
		end
	end
	for f17_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		if Engine[0x2DE6F7A69111B92]( f17_local0 ) and not Engine[0xEB0606D5D898BA6]( f17_local0 ) then
			f17_arg0._state = LUI.Fence.STATE.block
			return 
		end
	end
end

FencePremium.PostFail = function ( f16_arg0 )
	if f16_arg0._state == LUI.Fence.STATE.fail then
		local f16_local0 = Engine[0x45B054C920178E9]()
		Engine[0x5DEE98AA6FB3C2]( f16_local0, CoD.LeavePartyMoveUI.YES, CoD.LeavePartyShowMessage.NO, "FencePremium.PostFail" )
		local f16_local1 = {}
		if f16_arg0._timeLimitState then
			f16_local1.title = 0xA05B91C81A5CA0A
		end
		LUI.FlowManager.RequestPopupMenu( nil, "BlockedPremiumMenuPopup", true, f16_local0, false, f16_local1, nil, true, true )
	end
end

LUI.Fence.Register( "premium", FencePremium )
FencePremiumByPlaylist = LUI.Class( FencePremium )
FencePremiumByPlaylist.init = function ( f15_arg0, f15_arg1 )
	FencePremiumByPlaylist.super.init( f15_arg0 )
	f15_arg0._GetCurrentPlaylist = f15_arg1
end

local f0_local0 = function ()
	local f13_local0 = -1
	local f13_local1 = Engine[0xB686A0A723E6442]() - 1
	return function ()
		if f13_local0 < f13_local0 then
			
		else
			
		end
		return nil
	end
	
end

FencePremiumByPlaylist.UpdateState = function ( f12_arg0 )
	local f12_local0, f12_local1 = f12_arg0._GetCurrentPlaylist()
	FencePremiumByPlaylist.super.UpdateState( f12_arg0 )
	if f12_arg0._state ~= LUI.Fence.STATE.fail then
		return 
	elseif not PlaylistUtils.IsPlaylistF2P( Engine[0x45B054C920178E9](), f12_local0, f12_local1 ) then
		return 
	elseif f12_arg0._timeLimitState then
		f12_arg0._state = f12_arg0._timeLimitState
		return 
	elseif Dvar[0x9E5BE3B4BBA4E0E]( 0xB5602B275BDFAD7 ) == true then
		f12_arg0._state = LUI.Fence.STATE.pass
		return 
	end
	for f12_local5 in f0_local0() do
		if Fences[0x6C6D08978B8C65]( f12_local5, "ACHIEVEMENTENGINE" ) ~= LUI.Fence.FenceObjectState.PASSING then
			return 
		end
	end
	for f12_local5 in f0_local0() do
		local f12_local6, f12_local7 = PLAY_MENU.GetFreeTrialTimeLimitProgress( f12_local5 )
		if 0 < f12_local7 then
			f12_arg0._state = LUI.Fence.STATE.pass
			break
		end
	end
	f12_arg0._timeLimitState = f12_arg0._state
end

local f0_local1 = function ()
	local f11_local0 = Playlist[0x7B3B2B73B53EB34]()
	local f11_local1 = Playlist[0xD78924AD23DE66B]()
	if Playlist[0x29DC19B8CA68312]( f11_local1 ) then
		f11_local0 = PlaylistUtils.USE_FILTERED_PLAYLIST_ID
	end
	return f11_local0, f11_local1
end

FencePremiumCPPlaylist = LUI.Class( FencePremiumByPlaylist )
FencePremiumCPPlaylist.init = function ( f10_arg0 )
	FencePremiumCPPlaylist.super.init( f10_arg0, f0_local0 )
end

LUI.Fence.Register( "premiumCPPlaylist", FencePremiumCPPlaylist )
local f0_local2 = function ()
	if Engine[0x8FF0F1C5B20321E]() or Lobby[0xF1D2956B0C99DF6]() then
		local f9_local0 = Playlist[0x7B3B2B73B53EB34]()
		local f9_local1 = Playlist[0xD78924AD23DE66B]()
		if Playlist[0x29DC19B8CA68312]( f9_local1 ) then
			f9_local0 = PlaylistUtils.USE_FILTERED_PLAYLIST_ID
		end
		return f9_local0, f9_local1
	else
		return Lobby[0xB92DA1948EDB47D]( Lobby.PartyUIData.PLAYLIST_ID ), Lobby[0xB92DA1948EDB47D]( Lobby.PartyUIData.PLAYLIST_CATEGORY )
	end
end

FencePremiumMPPlaylist = LUI.Class( FencePremiumByPlaylist )
FencePremiumMPPlaylist.init = function ( f8_arg0 )
	FencePremiumMPPlaylist.super.init( f8_arg0, f0_local0 )
end

LUI.Fence.Register( "premiumMPPlaylist", FencePremiumMPPlaylist )
FencePremiumOrTrial = LUI.Class( FencePremium )
FencePremiumOrTrial.init = function ( f7_arg0 )
	FencePremiumOrTrial.super.init( f7_arg0 )
end

FencePremiumOrTrial.UpdateState = function ( f6_arg0 )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xCBD3CB2E7570D1F ) then
		f6_arg0._state = LUI.Fence.STATE.pass
	else
		FencePremiumOrTrial.super.UpdateState( f6_arg0 )
	end
end

LUI.Fence.Register( "premiumOrTrial", FencePremiumOrTrial )
FencePremiumOrLaunchChunk = LUI.Class( FencePremiumInterface )
FencePremiumOrLaunchChunk.PassCondition = function ( f5_arg0, f5_arg1 )
	local f5_local0 = Engine[0x8B495DC361731F7]( f5_arg1 )
	if not f5_local0 then
		f5_local0 = CONDITIONS.IsLaunchChunk()
	end
	return f5_local0
end

FencePremiumOrLaunchChunk.PostFail = function ( f4_arg0 )
	if f4_arg0._state == LUI.Fence.STATE.fail then
		Engine[0x5DEE98AA6FB3C2]( Engine[0x45B054C920178E9](), CoD.LeavePartyMoveUI.YES, CoD.LeavePartyShowMessage.NO, "FencePremiumOrLaunchChunk.PostFail" )
	end
end

LUI.Fence.Register( "premiumOrLaunchChunk", FencePremiumOrLaunchChunk )
function BlockedPremiumMenuPopup( f1_arg0, f1_arg1 )
	local f1_local0 = {}
	local f1_local1
	if f1_arg1 then
		f1_local1 = f1_arg1.title
		if not f1_local1 then
		
		else
			f1_local0.title = Engine[0xED84C33EC5F01EA]( f1_local1 )
			local f1_local2 = f1_arg1.gameRef and CONDITIONS.IsEntitlementOnDisk( f1_arg1.gameRef ) or false
			local f1_local3 = f1_arg1.gameName and Engine[0xED84C33EC5F01EA]( f1_arg1.gameName ) or ""
			local f1_local4
			if f1_local2 then
				f1_local4 = 0xB54F4B0F2AFF11E
				if not f1_local4 then
				
				else
					f1_local0.message = Engine[0xED84C33EC5F01EA]( f1_local4, f1_local3 )
					f1_local0.buttons = {}
					if CONDITIONS.ShouldDisplayUpsellPopup( f1_arg1.controllerIndex ) and not f1_local2 then
						table.insert( f1_local0.buttons, {
							label = Engine[0xED84C33EC5F01EA]( 0x92637F8CDA20FE0 ),
							action = function ( f3_arg0 )
								local f3_local0 = f1_arg0.controllerIndex
								local f3_local1 = STORE.UI.GetStandardBundle( f3_local0 )
								if f3_local1 then
									STORE.OpenProductPreviewMenu( f3_local0, f3_local1 )
								end
							end
						} )
					end
					table.insert( f1_local0.buttons, {
						label = Engine[0xED84C33EC5F01EA]( 0xC6D515BE207B9A5 ),
						action = function ()
							if CONDITIONS.IsCortezSubExe() then
								PLAY_MENU.ForcePlayerBackToCODHQExecutableOffline( f1_arg0.controllerIndex )
							end
						end
					} )
					local f1_local5 = MenuBuilder.BuildRegisteredType( "PopupMessageAndButtons", f1_local0 )
					f1_local5.id = "BlockedPremiumMenuPopup"
					return f1_local5
				end
			end
			f1_local4 = 0x141C5783F8272C7
		end
	end
	f1_local1 = 0xB7CC88A30D3FF0C
end

MenuBuilder.registerType( "BlockedPremiumMenuPopup", BlockedPremiumMenuPopup )
LockTable( _M )
