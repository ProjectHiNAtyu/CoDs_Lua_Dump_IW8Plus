-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:52
module( ..., package.seeall )
local f0_local0 = function ( f13_arg0, f13_arg1, f13_arg2 )
	local f13_local0 = {
		entityNum = f13_arg2,
		snapToScreenEdges = BRLOOT.CARD_SNAP_TO_SCREEN_EDGES,
		worldOffsetX = BRLOOT.CARD_X_OFFSET,
		worldOffsetY = BRLOOT.CARD_Y_OFFSET,
		worldOffsetZ = BRLOOT.CARD_Z_OFFSET,
		minScale = BRLOOT.CARD_MIN_SCALE,
		maxScale = BRLOOT.CARD_MAX_SCALE,
		perspectiveScaleLerpDistance = Dvar.BJJCJHDBII( "scriptable_lootPopupRadius" ),
		perspectiveScalingEnabled = BRLOOT.CARD_IS_PERSPECTIVE_SCALE_ENABLED
	}
	f13_arg0.lootCard.id = "lootCard_targetEntity_" .. f13_arg2
	f13_arg0.lootCard:SetupAnchoredElement( f13_local0 )
	f13_arg0.lootCard:UpdateLootCard( f13_arg1 )
end

local f0_local1 = function ( f12_arg0, f12_arg1 )
	local f12_local0 = BRLOOT.GetNativeLootData( f12_arg1 )
	local f12_local1 = "BRInteractiveLootCard"
	if f12_local0 and f12_local0.name == "br_armory_trader" then
		f12_local1 = "BRInteractiveLootCardWeaponTrader"
	end
	return f12_local1
end

local f0_local2 = function ( f11_arg0, f11_arg1, f11_arg2, f11_arg3 )
	local lootCard = MenuBuilder.BuildRegisteredType( f11_arg3 )
	lootCard.type = f11_arg3
	f11_arg0._previousLootCard = f11_arg0.lootCard
	lootCard:SetDataSource( f11_arg2, f11_arg1 )
	f11_arg0:addElement( lootCard )
	f11_arg0.lootCard = lootCard
	
end

local f0_local3 = function ( f10_arg0, f10_arg1, f10_arg2, f10_arg3 )
	if f10_arg0.lootCard == nil then
		f0_local0( f10_arg0, f10_arg1, f10_arg3, f0_local0( f10_arg0, f10_arg1 ) )
	elseif f10_arg0.lootCard.id ~= "lootCard_targetEntity_" .. f10_arg2 then
		local f10_local0 = f0_local0( f10_arg0, f10_arg1 )
		if f10_arg0.lootCard.type ~= f10_local0 then
			f10_arg0.lootCard:HideCard( f10_arg1 )
			if f10_arg0._previousLootCard ~= nil then
				local f10_local1 = f10_arg0.lootCard
				f10_arg0.lootCard = f10_arg0._previousLootCard
				f10_arg0._previousLootCard = f10_local1
			else
				f0_local0( f10_arg0, f10_arg1, f10_arg3, f10_local0 )
			end
		end
	end
end

local f0_local4 = function ( f2_arg0, f2_arg1, f2_arg2 )
	local f2_local0 = DataSources.inGame.HUD.hints.interactiveObject.lootCard
	local f2_local1 = f2_local0.targetEntity:GetModel( f2_arg1 )
	local f2_local2 = f2_local0.targetEntityOverride:GetModel( f2_arg1 )
	local f2_local3 = f2_local0.shouldShow:GetModel( f2_arg1 )
	f0_local0( f2_arg0, f2_arg1, targetEntityNum, f2_local0 )
	local f2_local4 = DataModel.JJEHAEBDF( f2_local1 )
	if not f2_local4 then
		f2_local4 = BRLOOT.INVALID_TARGET_ENTITY
	end
	DataModel.DBEBGEAJHJ( f2_local2, f2_local4 )
	f2_arg0:SubscribeToModel( f2_local1, function ( f9_arg0 )
		local f9_local0 = DataModel.JJEHAEBDF( f9_arg0 )
		f2_arg0( f2_arg0, f2_arg0, f9_local0, f2_arg0 )
		if f9_local0 and BRLOOT.ShouldShowLootCard( f2_arg0 ) then
			f2_arg0( f2_arg0, f2_arg0, f9_local0 )
		end
	end )
	local f2_local5 = function ( f7_arg0, f7_arg1 )
		f2_arg0:SubscribeToModel( f7_arg0, function ( f8_arg0 )
			local f8_local0 = Game.DFFJEIIAD( f7_arg0 )
			if f8_local0 and f8_local0.name == f7_arg0 then
				f7_arg0.lootCard:UpdateLootCard( f7_arg0 )
			end
		end, true )
	end
	
	local f2_local6 = DataSources.inGame.player.healthEquipment.numCharges:GetModel( f2_arg1 )
	f2_local5( f2_local6, "brloot_armor_plate" )
	f2_local5( f2_local6, "brloot_plate_pouch" )
	local f2_local7 = DataSources.inGame.player.BRData.PlayerSmallArmsAmmoStore:GetModel( f2_arg1 )
	local f2_local8 = DataSources.inGame.player.BRData.PlayerShotgunAmmoStore:GetModel( f2_arg1 )
	local f2_local9 = DataSources.inGame.player.BRData.PlayerAssaultRifleAmmoStore:GetModel( f2_arg1 )
	local f2_local10 = DataSources.inGame.player.BRData.PlayerSniperAmmoStore:GetModel( f2_arg1 )
	local f2_local11 = DataSources.inGame.player.BRData.PlayerRocketAmmoStore:GetModel( f2_arg1 )
	f2_local5( f2_local7, "brloot_ammo_919" )
	f2_local5( f2_local8, "brloot_ammo_12g" )
	f2_local5( f2_local9, "brloot_ammo_762" )
	f2_local5( f2_local10, "brloot_ammo_50cal" )
	f2_local5( f2_local11, "brloot_ammo_rocket" )
	f2_arg0:SubscribeToModel( f2_local2, function ( f6_arg0 )
		local f6_local0 = DataModel.JJEHAEBDF( f6_arg0 )
		if f6_local0 and f6_local0 ~= BRLOOT.INVALID_TARGET_ENTITY then
			f2_arg0.lootCard:UpdateLootCard( f2_arg0 )
		end
	end, true )
	f2_arg0:SubscribeToModel( DataSources.inGame.HUD.hints.interactiveObject.button.dismiss:GetModel( f2_arg1 ), function ( f5_arg0 )
		if DataModel.JJEHAEBDF( f5_arg0 ) then
			DataModel.DBEBGEAJHJ( f2_arg0, BRLOOT.INVALID_TARGET_ENTITY )
		end
		f2_arg0.lootCard:UpdateLootCard( f2_arg0 )
	end, true )
	f2_arg0:SubscribeToModel( f2_local3, function ( f4_arg0 )
		f2_arg0.lootCard:UpdateLootCard( f2_arg0 )
	end, true )
	f2_arg0:SubscribeToModel( DataSources.inGame.player.inADS:GetModel( f2_arg1 ), function ( f3_arg0 )
		local f3_local0 = DataModel.JJEHAEBDF( f3_arg0 )
		local f3_local1 = 250
		if f3_local0 then
			f2_arg0:SetAlpha( 0, f3_local1, LUI.EASING.outCubic )
		else
			f2_arg0:SetAlpha( 1, f3_local1, LUI.EASING.outCubic )
		end
	end )
end

function BRLootCards( menu, controller )
	local self = LUI.UIVerticalStackedLayout.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "BRLootCards"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "BRLootCards", BRLootCards )
LockTable( _M )
