-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.menutitle" )
require( "ui.generated.widgets.frontend.events.codpointsbalance" )
require( "ui.generated.widgets.frontend.events.viewbattlepassbutton" )
require( "ui.generated.widgets.frontend.events.purchasefeaturedeventbundlebutton" )
require( "ui.generated.widgets.scrollbar.verticalscrollbar" )
local f0_local0 = 32
local f0_local1 = 158
local f0_local2 = 40
local f0_local3 = 20
local f0_local4 = function ( f26_arg0, f26_arg1, f26_arg2 )
	if not String.IsNilOrEmpty( f26_arg2.description ) then
		f26_arg0.Description:SetVisible( true )
		f26_arg0.Description:setText( f26_arg2.description )
		local f26_local0 = LAYOUT.GetTextHeight( f26_arg0.Description )
		local f26_local1 = f26_arg0.Description
		local f26_local2 = f26_local1
		f26_local1 = f26_local1.SetBottom
		local f26_local3 = f26_arg0.Description:GetAnchorsAndPosition()
		f26_local1( f26_local2, f26_local3.top + f26_local0 )
	else
		f26_arg0.Description:closeTree()
		f26_arg0.Description = nil
	end
	if f26_arg2.hideBattlepass or BATTLEPASS.IsOwned( f26_arg1, SEASON.GetCurrentSeason() ) then
		f26_arg0.ViewBattlepassButton:closeTree()
		f26_arg0.ViewBattlepassButton = nil
	end
	local f26_local4 = f26_arg0.Description
	local f26_local0 = f26_arg0.Description:GetAnchorsAndPosition()
	f26_local0 = f26_local4 and f26_local0.bottom + f0_local0 or f0_local0
	if f26_arg0.ViewBattlepassButton then
		local f26_local1 = LAYOUT.GetElementHeight( f26_arg0.ViewBattlepassButton )
		f26_arg0.ViewBattlepassButton:SetTop( f26_local0 )
		f26_arg0.ViewBattlepassButton:SetBottom( f26_local0 + f26_local1 )
		f26_local0 = f26_local0 + f26_local1 + f0_local0
	end
	f26_arg0.BundlesGrid:SetTop( f26_local0 )
	f26_arg0.BundlesGridMask:SetTop( f26_local0 - f0_local0 )
	f26_arg0.VerticalScrollbar:SetTop( f26_local0 )
end

local f0_local5 = function ( f25_arg0, f25_arg1 )
	f25_arg0.MenuTitle:SetTitle( ToUpperCase( f25_arg1 ), 0 )
end

local f0_local6 = function ( f24_arg0, f24_arg1 )
	f24_arg0.CODPointsBalance.navigation = {}
	f24_arg0.BundlesGrid.navigation = {}
	if f24_arg0.ViewBattlepassButton then
		f24_arg0.ViewBattlepassButton.navigation = {}
		if 0 < f24_arg1 then
			f24_arg0.ViewBattlepassButton.navigation.down = f24_arg0.BundlesGrid
			f24_arg0.BundlesGrid:SetFocusedPosition( f24_arg0.BundlesGrid:GetFirstFocusablePosition(), true )
			f24_arg0.BundlesGrid.navigation.up = f24_arg0.ViewBattlepassButton
		end
		f24_arg0.CODPointsBalance.navigation.down = f24_arg0.ViewBattlepassButton
		f24_arg0.ViewBattlepassButton.navigation.up = f24_arg0.CODPointsBalance
	else
		f24_arg0.CODPointsBalance.navigation.down = f24_arg0.BundlesGrid
		f24_arg0.BundlesGrid.navigation.up = f24_arg0.CODPointsBalance
	end
end

local f0_local7 = function ( f23_arg0, f23_arg1 )
	LUI.FlowManager.RequestLeaveMenu( f23_arg0, true, true )
	STORE.OpenProductPreviewMenuFromPurchase( f23_arg0._controllerIndex, f23_arg1.bundle, true )
end

local f0_local8 = function ( f22_arg0, f22_arg1 )
	LUI.FlowManager.RequestLeaveMenu( f22_arg0, true, true )
end

local f0_local9 = function ( f14_arg0, f14_arg1, f14_arg2 )
	f14_arg0._bundles = f14_arg2.startEmpty and {} or f14_arg0._getBundlesFunc( f14_arg1 )
	f14_arg0.BundlesGrid:SetMask( f14_arg0.BundlesGridMask )
	f14_arg0.BundlesGrid:SetNumChildren( #f14_arg0._bundles )
	f14_arg0.NoContentTitle:SetVisible( #f14_arg0._bundles == 0 )
	f14_arg0.NoContentBody:SetVisible( #f14_arg0._bundles == 0 )
	f14_arg0.CODPointsBalance:SetVisible( 0 < #f14_arg0._bundles )
	f14_arg0.CODPointsBalance:UpdateBalance( f14_arg1 )
	f14_arg0.CODPointsBalance:SetButtonAction( function ( f21_arg0, f21_arg1 )
		MINI_STORE.OpenCODPointsPurchase( f14_arg0, f14_arg0.CODPointsBalance )
	end )
	STORE.Events.AddPurchaseHandler( f14_arg0, f14_arg1, f0_local0, f0_local0 )
	f14_arg0.BundlesGrid:SetRefreshChild( function ( f18_arg0, f18_arg1, f18_arg2 )
		local f18_local0 = f14_arg0._bundles[f18_arg2 + 1 - (f14_arg0._startOffset or 0)]
		f18_arg0.navigation = {}
		if f14_arg0.ViewBattlepassButton and f18_arg2 == 0 then
			f18_arg0.navigation.up = f14_arg0.ViewBattlepassButton
		end
		f18_arg0:SetupButton( f18_local0 )
		if not f18_arg0._handlersAdded then
			f18_arg0:addEventHandler( "button_over", function ( f20_arg0, f20_arg1 )
				if f18_arg0._menuMetrics and f18_arg0._menuMetrics.hoveredItems then
					table.insert( f18_arg0._menuMetrics.hoveredItems, 1, {
						name = STORE.Bundles.GetName( f18_arg0 ),
						time = {
							hoverStart = Engine[0x3B8CFB6758EF57C]()
						}
					} )
				end
			end )
			f18_arg0:addEventHandler( "button_up", function ( f19_arg0, f19_arg1 )
				if f18_arg0._menuMetrics and f18_arg0._menuMetrics.hoveredItems and f18_arg0._menuMetrics.hoveredItems[1] then
					f18_arg0._menuMetrics.hoveredItems[1].time.hoverEnd = Engine[0x3B8CFB6758EF57C]()
					f18_arg0._menuMetrics.hoveredItems[1].time.hoverDuration = f18_arg0._menuMetrics.hoveredItems[1].time.hoverEnd - f18_arg0._menuMetrics.hoveredItems[1].time.hoverStart
				end
			end )
			f18_arg0._handlersAdded = true
		end
	end )
	f14_arg0.BundlesGrid:AddScrollbar( {
		_customScrolling = true,
		SetLinkedGridDataSource = function ()
			
		end,
		UpdateScrolling = function ()
			local f17_local0 = f14_arg0.BundlesGrid:GetFocusPositionIndex( {
				clampContentIndexToDatasetLength = true
			} )
			if not f17_local0 then
				return 
			end
			f14_arg0.BundlesGrid.focusPosition = f17_local0
			if f14_arg0._lastFocusPosition ~= f17_local0 then
				f14_arg0._lastFocusPosition = f17_local0
			end
		end,
		LinkTo = function ()
			
		end
	} )
	f14_arg0.BundlesGrid:RefreshContent()
	f0_local0( f14_arg0, #f14_arg0._bundles )
end

local f0_local10 = function ( f13_arg0 )
	local f13_local0 = f13_arg0._bundles
	if f13_local0 then
		f13_local0 = f13_arg0._bundles[1]
	end
	return f13_local0
end

local f0_local11 = function ( f12_arg0 )
	local f12_local0 = f12_arg0._bundles
	if not f12_local0 then
		f12_local0 = {}
	end
	return f12_local0
end

local f0_local12 = function ( f11_arg0 )
	f11_arg0._bundles = f11_arg0._getBundlesFunc( f11_arg0._controllerIndex )
	f11_arg0.NoContentTitle:SetVisible( #f11_arg0._bundles == 0 )
	f11_arg0.NoContentBody:SetVisible( #f11_arg0._bundles == 0 )
	f11_arg0.CODPointsBalance:SetVisible( 0 < #f11_arg0._bundles )
	f11_arg0.CODPointsBalance:UpdateBalance( f11_arg0._controllerIndex )
	f11_arg0.BundlesGrid:SetNumChildren( #f11_arg0._bundles )
	f11_arg0.BundlesGrid:RefreshContent()
end

local f0_local13 = function ( f4_arg0, f4_arg1, f4_arg2 )
	f4_arg0.GetFirstBundle = f0_local0
	f4_arg0.GetAllBundles = f0_local0
	f4_arg0.Refresh = f0_local0
	f4_arg0.SetPopupTitle = f0_local0
	f4_arg0._controllerIndex = f4_arg1
	if f4_arg2.getBundlesFunc then
		f4_arg0._getBundlesFunc = f4_arg2.getBundlesFunc
	else
		f4_arg0._getBundlesFunc = function ( f10_arg0 )
			return STORE.UI.GetEventBundles( f4_arg0._controllerIndex )
		end
		
	end
	f4_arg0.MenuTitle:SetMaxRightEdge( LAYOUT.GetElementRight( f4_arg0.MenuTitle ) - f0_local0 )
	local f4_local0 = f0_local0
	local f4_local1 = f4_arg0
	local f4_local2 = f4_arg2.title
	if not f4_local2 then
		f4_local2 = Engine[0xED84C33EC5F01EA]( 0xEA8EAD88B6CBB48 )
	end
	f4_local0( f4_local1, f4_local2 )
	f0_local0( f4_arg0, f4_arg1, f4_arg2 )
	f0_local0( f4_arg0, f4_arg1, f4_arg2 )
	f4_arg0:addEventHandler( "closing_quick_access_menu", function ( f9_arg0, f9_arg1 )
		f9_arg0:exitAnimation( f9_arg0, f4_arg0 )
	end )
	if f4_arg0.ViewBattlepassButton then
		f4_arg0.ViewBattlepassButton.eventMenu = f4_arg2.parentMenu
		f4_arg0.ViewBattlepassButton:addEventHandler( "button_over", function ( f8_arg0, f8_arg1 )
			if f4_arg0._menuMetrics and f4_arg0._menuMetrics.hoveredItems then
				table.insert( f4_arg0._menuMetrics.hoveredItems, 1, {
					name = f8_arg0.id,
					time = {
						hoverStart = Engine[0x3B8CFB6758EF57C]()
					}
				} )
			end
		end )
		f4_arg0.ViewBattlepassButton:addEventHandler( "button_up", function ( f7_arg0, f7_arg1 )
			if f4_arg0._menuMetrics and f4_arg0._menuMetrics.hoveredItems and f4_arg0._menuMetrics.hoveredItems[1] then
				f4_arg0._menuMetrics.hoveredItems[1].time.hoverEnd = Engine[0x3B8CFB6758EF57C]()
				f4_arg0._menuMetrics.hoveredItems[1].time.hoverDuration = f4_arg0._menuMetrics.hoveredItems[1].time.hoverEnd - f4_arg0._menuMetrics.hoveredItems[1].time.hoverStart
			end
		end )
	end
	f4_arg0._menuMetrics = {
		startTime = Engine[0x3B8CFB6758EF57C](),
		hoveredItems = {},
		hoveredItemsName = {},
		hoveredItemsDuration = {},
		mwChallengeProgress = {},
		wzChallengeProgress = {},
		masteryChallengeProgress = {}
	}
	f4_arg0:addEventHandler( "update_seasonal_event_exit_action", function ( f6_arg0, f6_arg1 )
		f4_arg0._menuMetrics.exitAction = f6_arg1.navigationAction
	end )
	f4_arg0:addEventHandler( "on_close", function ( f5_arg0, f5_arg1 )
		f4_arg0._menuMetrics.leaveTime = Engine[0x3B8CFB6758EF57C]()
		f4_arg0._menuMetrics.screenDuration = f4_arg0._menuMetrics.leaveTime - f4_arg0._menuMetrics.startTime
		local f5_local0 = f4_arg0._menuMetrics
		local f5_local1 = LUI.FlowManager.GetTopMostOpenMenuInfo()
		f5_local0.destinationMenu = f5_local1.name
		for f5_local0 = 1, #f4_arg0._menuMetrics.hoveredItems, 1 do
			table.insert( f4_arg0._menuMetrics.hoveredItemsName, f4_arg0._menuMetrics.hoveredItems[f5_local0].name )
			table.insert( f4_arg0._menuMetrics.hoveredItemsDuration, f4_arg0._menuMetrics.hoveredItems[f5_local0].time.hoverDuration or 0 )
		end
		Engine[0x15D98DF5F61904B]( f4_arg0, "dlog_event_ui_event_page_new_content_widget", {
			screen_duration = f4_arg0._menuMetrics.screenDuration,
			hovered_items_name = f4_arg0._menuMetrics.hoveredItemsName,
			hovered_items_duration = f4_arg0._menuMetrics.hoveredItemsDuration,
			exit_action = f4_arg0._menuMetrics.exitAction or "Exit back to Events Menu"
		} )
	end )
end

function PurchaseBundlesPopup( f1_arg0, f1_arg1 )
	local f1_local0 = LUI
	local f1_local1 = MenuBuilder
	local f1_local2 = f1_local0.UIElement.new()
	f1_local2:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 600, 0, 1080 )
	f1_local2.id = "PurchaseBundlesPopup"
	local f1_local3
	if f1_arg1 then
		f1_local3 = f1_arg1
	else
		f1_local3 = f1_arg1.controllerIndex
	end
	f1_local3 = f1_local0.ValidateControllerIndex( f1_local2, f1_local3 )
	local f1_local4 = nil
	f1_local4 = f1_local1.BuildRegisteredType( 0x93CC4E91B38D10C, {
		controllerIndex = f1_local3
	} )
	f1_local4[0x8B72E07B55C3AC0] = "MenuTitle"
	f1_local4[0x93CC4E91B38D10C]:SetRGB( SWATCHES[0x2B125210C0B2BB1][0xF5C0139BA6F896C], 0 )
	f1_local4[0x93CC4E91B38D10C]:setText( ToUpperCase( Engine[0xED84C33EC5F01EA]( 0xE5F63499A6B0703 ) ), 0 )
	f1_local4:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, 100 )
	f1_local2:addElement( f1_local4 )
	f1_local2[0x93CC4E91B38D10C] = f1_local4
	local f1_local5 = nil
	f1_local5 = f1_local1.BuildRegisteredType( 0x20D265842E4876, {
		controllerIndex = f1_local3
	} )
	f1_local5[0x8B72E07B55C3AC0] = "CODPointsBalance"
	f1_local5:SetAnchorsAndPosition( 1, 0, 0, 1, -430, -30, 100, 140 )
	f1_local2:addElement( f1_local5 )
	f1_local2[0x20D265842E4876] = f1_local5
	local f1_local6 = nil
	f1_local6 = f1_local1.BuildRegisteredType( 0x2D668CB6FE7B4DB, {
		controllerIndex = f1_local3
	} )
	f1_local6[0x8B72E07B55C3AC0] = "ViewBattlepassButton"
	f1_local6:SetAnchorsAndPosition( 0, 1, 0, 1, 88.5, 512.5, 158, 394 )
	f1_local2:addElement( f1_local6 )
	f1_local2[0x2D668CB6FE7B4DB] = f1_local6
	local f1_local7 = nil
	f1_local7 = f1_local0.UIImage.new()
	f1_local7[0x8B72E07B55C3AC0] = "BundlesGridMask"
	f1_local7:SetAnchorsAndPosition( 0, 1, 0, 1, 88.5, 511.5, 433, 1033 )
	f1_local2:addElement( f1_local7 )
	f1_local2[0x4882231158D2922] = f1_local7
	local f1_local8 = nil
	f1_local8 = f1_local0.UIGrid.new( {
		columnWidth = 424,
		maxVisibleColumns = 1,
		maxVisibleRows = 4,
		wrapY = false,
		rowHeight = 236,
		spacingY = 16,
		wrapX = false,
		controllerIndex = f1_local3,
		buildChild = function ()
			return f1_arg0.BuildRegisteredType( 0x3726A6FE77AF9C4, {
				controllerIndex = f1_arg0
			} )
		end,
		refreshChild = function ( f2_arg0, f2_arg1, f2_arg2 )
			
		end,
		scrollType = Enum[0x92A69278394394][0xEDF5C0F5CCFACE1]
	} )
	f1_local8[0x8B72E07B55C3AC0] = "BundlesGrid"
	f1_local8:setUseStencil( true )
	f1_local8:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, -211.5, 211.5, 435, 1035 )
	f1_local2:addElement( f1_local8 )
	f1_local2[0xAE1AAE53B2D9C9A] = f1_local8
	local f1_local9 = nil
	f1_local9 = f1_local1.BuildRegisteredType( 0x24844C1913DAD73, {
		controllerIndex = f1_local3
	} )
	f1_local9[0x8B72E07B55C3AC0] = "VerticalScrollbar"
	f1_local9:SetAnchorsAndPosition( 1, 0, 0, 1, -73, -62, 435, 1035 )
	f1_local2:addElement( f1_local9 )
	f1_local2[0x24844C1913DAD73] = f1_local9
	local f1_local10 = nil
	f1_local10 = f1_local0.UIStyledText.new()
	f1_local10[0x8B72E07B55C3AC0] = "Description"
	f1_local10:SetVisible( false )
	f1_local10:SetRGB( SWATCHES[0x2B125210C0B2BB1][0xF5C0139BA6F896C], 0 )
	f1_local10:SetAlpha( 0.9, 0 )
	f1_local10:setText( "", 0 )
	f1_local10:SetFontStyle( FONT_STYLES[0xF71DBA24EB4212] )
	f1_local10:SetWordWrap( true )
	f1_local10:SetAlignment( f1_local0.Alignment.Left )
	f1_local10:SetAnchorsAndPosition( 0, 1, 0, 1, 88, 512, 158, 205 )
	f1_local2:addElement( f1_local10 )
	f1_local2[0xCC44970C8397929] = f1_local10
	local f1_local11 = nil
	f1_local11 = f1_local0.UIStyledText.new()
	f1_local11[0x8B72E07B55C3AC0] = "NoContentTitle"
	f1_local11:SetVisible( false )
	f1_local11:SetRGB( SWATCHES[0x2B125210C0B2BB1][0xF5C0139BA6F896C], 0 )
	f1_local11:SetAlpha( 0.7, 0 )
	f1_local11:setText( Engine[0xED84C33EC5F01EA]( 0xDEAB9040333EFB4 ), 0 )
	f1_local11:setCaseStyle( f1_local0.CaseStyle.Uppercase )
	f1_local11:SetFontStyle( FONT_STYLES[0x9ECFA58C69AC41A] )
	f1_local11:SetWordWrap( true )
	f1_local11:SetAlignment( f1_local0.Alignment.Center )
	f1_local11:SetVerticalAlignment( f1_local0.Alignment.Bottom )
	f1_local11:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, -245, 245, -77, -33 )
	f1_local2:addElement( f1_local11 )
	f1_local2[0x44363875FBD463] = f1_local11
	local f1_local12 = nil
	f1_local12 = f1_local0.UIStyledText.new()
	f1_local12[0x8B72E07B55C3AC0] = "NoContentBody"
	f1_local12:SetVisible( false )
	f1_local12:SetRGB( SWATCHES[0x2B125210C0B2BB1][0x241D6F6276E2F07], 0 )
	f1_local12:SetAlpha( 0.7, 0 )
	f1_local12:setText( Engine[0xED84C33EC5F01EA]( 0x447E30EA142F176 ), 0 )
	f1_local12:SetFontStyle( FONT_STYLES[0x68FE131283CDA0] )
	f1_local12:SetWordWrap( true )
	f1_local12:SetAlignment( f1_local0.Alignment.Center )
	f1_local12:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, -247.5, 242.5, -25, 108 )
	f1_local2:addElement( f1_local12 )
	f1_local2[0xF1B28F26E7A563B] = f1_local12
	local f1_local13 = f1_local0.UIScrollbar.new
	local f1_local14 = {
		direction = f1_local0.DIRECTION.vertical,
		eventListener = f1_local9,
		startCap = f1_local9[0x7C139B2191BD22D],
		endCap = f1_local9[0xC50558A6315134A],
		sliderArea = f1_local9[0x1267DA9A256716D]
	}
	local f1_local15 = f1_local9[0x1267DA9A256716D]
	if f1_local15 then
		f1_local15 = f1_local9[0x1267DA9A256716D][0x5EE00EDE8E0841C]
	end
	f1_local14.slider = f1_local15
	f1_local15 = f1_local9[0x1267DA9A256716D]
	if f1_local15 then
		f1_local15 = f1_local9[0x1267DA9A256716D][0x491B3F5BB7699CD]
	end
	f1_local14.fixedSizeSlider = f1_local15
	f1_local8:AddScrollbar( f1_local13( f1_local14 ) )
	f0_local0( f1_local2, f1_local3, f1_arg1 )
	f1_local2.__defaultFocus = f1_local2[0xAE1AAE53B2D9C9A]
	f1_local2:addEventHandler( "gain_focus", f1_local0.UIElement.HandleDefaultFocus )
	return f1_local2
end

MenuBuilder.registerType( 0x369770B8F2FD503, PurchaseBundlesPopup )
LockTable( _M )
