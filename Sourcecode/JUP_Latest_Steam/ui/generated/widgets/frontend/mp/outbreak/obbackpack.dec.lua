-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.mp.backpackicon" )
require( "ui.generated.widgets.frontend.mp.dmz.dmzitemslotcorners" )
require( "ui.generated.widgets.frontend.mp.outbreak.obgenericbackpackslot" )
local f0_local0 = function ( f28_arg0, f28_arg1 )
	local f28_local0 = LOOT.IsLootIDValidAndNotAWeapon( f28_arg0 )
	if f28_local0 then
		f28_local0 = LOOT.IsItemExtractableFromBackpack( f28_arg0 )
	end
	if not f28_local0 and f28_arg1 ~= DMZ.EmptyInstanceID then
		DMZInventory[0x9592517BD0FA450]( f28_arg1 )
	end
	return f28_local0
end

local f0_local1 = function ( f23_arg0, f23_arg1, f23_arg2 )
	local f23_local0 = {
		button = "button_primary",
		id = "backPackSlotSwap",
		actionName = f23_arg1._item and Engine[0xED84C33EC5F01EA]( 0xAA4B3526A3C0AC4 ) or Engine[0xED84C33EC5F01EA]( 0x7D9DC9E3291E103 ),
		actionFunction = function ()
			local f27_local0 = LUI.FlowManager.GetScopedData( f23_arg0 )
			LUI.FlowManager.RequestAddMenu( "OBBackpackMenu", true, f23_arg0._controllerIndex, nil, {
				loadoutIndex = f27_local0.selectedLoadoutIndex,
				slotIndex = f23_arg0 - 1,
				slotData = {
					widget = f23_arg0,
					slotIndex = f23_arg0
				}
			}, true )
		end,
		conditionFunction = function ()
			local f26_local0 = f23_arg0._focusable
			if f26_local0 then
				f26_local0 = f23_arg0._item
			end
			return f26_local0
		end
	}
	local f23_local1 = {
		button = "button_alt1",
		id = "backPackSlotUnequip",
		actionName = Engine[0xED84C33EC5F01EA]( 0x699D012FD4100CF ),
		actionFunction = function ()
			if f23_arg0._unequipCallbackFn and f23_arg0._unequipCallbackElement then
				f23_arg0._unequipCallbackFn( f23_arg0._unequipCallbackElement, f23_arg0._item, true )
			end
		end,
		conditionFunction = function ()
			local f24_local0 = f23_arg0._unequipCallbackFn
			if f24_local0 then
				f24_local0 = f23_arg0._unequipCallbackElement
				if f24_local0 then
					f24_local0 = f23_arg0._item
				end
			end
			return f24_local0
		end
	}
	f23_arg1:AddContextualMenuAction( f23_local0 )
	f23_arg1:AddContextualMenuAction( f23_local1 )
end

local f0_local2 = function ( f16_arg0 )
	return function ( f17_arg0, f17_arg1, f17_arg2 )
		local f17_local0 = f16_arg0.BackpackSlots:GetContentIndex( f17_arg1, f17_arg2, {
			relativePosition = false
		} ) + 1
		local f17_local1 = f16_arg0._itemsInBackpack[f17_local0 + OB.InstanceInventoryWeaponSlotOffset]
		f17_arg0._item = nil
		if f17_local1 and f16_arg0( f17_local1.lootID, f17_local1.instanceID ) then
			f17_arg0._item = f17_local1
		end
		if f16_arg0._intelUpdateCallbackFn and f16_arg0._intelUpdateCallbackElement and f17_arg0:isInFocus() then
			f16_arg0._intelUpdateCallbackFn( f16_arg0._intelUpdateCallbackElement, f17_arg0._item )
		end
		local f17_local2 = f17_arg0
		local f17_local3 = f17_arg0.UpdateSlot
		local f17_local4 = f17_arg0._item
		if f17_local4 then
			f17_local4 = f17_arg0._item.lootID
		end
		f17_local3( f17_local2, f17_local4 )
		if not f17_arg0._eventhandlersAdded then
			f17_arg0:addEventHandler( "gamepad_button", function ( f22_arg0, f22_arg1 )
				local f22_local0
				if f22_arg1.qualifier ~= "gamepad" and f22_arg1.qualifier ~= "dpad" and f22_arg1.qualifier ~= "keyboard" then
					f22_local0 = false
				else
					f22_local0 = true
				end
				if f22_arg0:isInFocus() and f22_local0 and f22_arg1.button == "up" then
					f17_arg0:processEvent( {
						name = "button_over"
					} )
				end
			end )
			f17_arg0:addEventHandler( "button_over", function ( f21_arg0, f21_arg1 )
				f17_arg0:dispatchEventToParent( {
					name = "ob_header_highlight",
					index = DMZ.LoadoutManagementWidgetGroupIndex.BACKPACK
				} )
				if f17_arg0._intelUpdateCallbackFn and f17_arg0._intelUpdateCallbackElement then
					f17_arg0._intelUpdateCallbackFn( f17_arg0._intelUpdateCallbackElement, f17_arg0._item )
				end
			end )
			f17_arg0:addEventHandler( "button_active", function ( f20_arg0, f20_arg1 )
				if f17_arg0._intelUpdateCallbackFn and f17_arg0._intelUpdateCallbackElement then
					f17_arg0._intelUpdateCallbackFn( f17_arg0._intelUpdateCallbackElement, nil )
				end
			end )
			f17_arg0:AddGamepadEventCallback( "button_alt1", function ( f19_arg0, f19_arg1 )
				if f17_arg0._unequipCallbackFn and f17_arg0._unequipCallbackElement then
					f17_arg0._unequipCallbackFn( f17_arg0._unequipCallbackElement, f17_arg0._item )
				end
			end )
			f17_arg0:registerEventHandler( "button_action", function ( element, event )
				local f18_local0 = LUI.FlowManager.GetScopedData( f17_arg0 )
				LUI.FlowManager.RequestAddMenu( "OBBackpackMenu", true, event.controller, nil, {
					loadoutIndex = f18_local0.selectedLoadoutIndex,
					slotIndex = f17_arg0 - 1,
					slotData = {
						widget = f17_arg0,
						slotIndex = f17_arg0
					}
				}, true )
				return true
			end )
			f16_arg0( f16_arg0, f17_arg0, f17_local0 )
			f17_arg0._eventhandlersAdded = true
		end
	end
	
end

local f0_local3 = function ( f15_arg0, f15_arg1 )
	f15_arg0._itemsInBackpack = {}
	f15_arg0._itemsInBackpack = DMZ.AddInstanceInventoryItemsByLocation( f15_arg0._itemsInBackpack, DMZ.InventoryLocations.BACKPACK, {
		includeEmptyLocations = true,
		callbackFunc = LOOT.IsLootIDValidAndNotAWeapon
	} )
	local f15_local0 = DMZ.FrontEndBackpackItemSlots.SMALL
	local f15_local1 = OB.GetInstanceInventoryBackpackItemSpawnEntry( f15_arg1 )
	if f15_local1 then
		f15_local0 = f15_local1[0x1219207C605980A]
	else
		local f15_local2 = Game[0xC70896F97C4D9FB]()
		if f15_local2 and f15_local2[0x1219207C605980A] then
			f15_local0 = f15_local2[0x1219207C605980A]
		end
	end
	if f15_local0 == DMZ.FrontEndBackpackItemSlots.SMALL then
		ACTIONS.AnimateSequence( f15_arg0, "DefaultSequence" )
	elseif f15_local0 == DMZ.FrontEndBackpackItemSlots.MEDIUM then
		ACTIONS.AnimateSequence( f15_arg0, "Med" )
	elseif f15_local0 == DMZ.FrontEndBackpackItemSlots.LARGE then
		ACTIONS.AnimateSequence( f15_arg0, "Large" )
	end
	f15_arg0.BackpackSlots:SetRefreshChild( f0_local0( f15_arg0 ) )
	f15_arg0.BackpackSlots:SetNumChildren( f15_local0 )
	f15_arg0.BackpackSlots:RefreshContent()
	f15_arg0.BackpackIcon:SetupBackpackIcon( f15_arg1 )
end

local f0_local4 = function ( f14_arg0, f14_arg1, f14_arg2 )
	f14_arg0._intelUpdateCallbackFn = f14_arg1
	f14_arg0._intelUpdateCallbackElement = f14_arg2
end

local f0_local5 = function ( f13_arg0, f13_arg1, f13_arg2 )
	f13_arg0._unequipCallbackFn = f13_arg1
	f13_arg0._unequipCallbackElement = f13_arg2
end

local f0_local6 = function ( f12_arg0 )
	f12_arg0._itemsInBackpack = {}
	f12_arg0._itemsInBackpack = DMZ.AddInstanceInventoryItemsByLocation( f12_arg0._itemsInBackpack, DMZ.InventoryLocations.BACKPACK, {
		includeEmptyLocations = true,
		callbackFunc = LOOT.IsLootIDValidAndNotAWeapon
	} )
	f12_arg0.BackpackSlots:SetRefreshChild( f0_local0( f12_arg0 ) )
end

local f0_local7 = function ( f11_arg0, f11_arg1 )
	for f11_local3, f11_local4 in ipairs( f11_arg0.BackpackSlots:GetBuiltChildren() ) do
		f11_local4:processEvent( {
			immediate = true,
			name = "lose_focus"
		} )
		if f11_local4.ToggleFocusedAndDisabledState then
			f11_local4:ToggleFocusedAndDisabledState( false )
		end
		if f11_local4.SetFocusable and f11_local4.SetButtonDisabled then
			f11_local4:SetFocusable( false )
			f11_local4:SetButtonDisabled( true )
		end
	end
end

local f0_local8 = function ( f10_arg0, f10_arg1, f10_arg2 )
	f10_arg0._controllerIndex = f10_arg1
	f10_arg0.SetupBackpack = f0_local0
	f10_arg0.DisableBackpackSlots = f0_local0
	f10_arg0.SetupIntelUpdateCallback = f0_local0
	f10_arg0.SetupUnequipCallback = f0_local0
	f10_arg0.RefreshBackpack = f0_local0
end

States = {
	[0xAD14C6E7156B923] = function ( f6_arg0, f6_arg1 )
		local f6_local0 = function ( f9_arg0, f9_arg1 )
			
		end
		
		f6_arg0[0x196F4C3E7C51CBC]:RegisterAnimationSequence( 0x81D3D1917793B59, {
			nil,
			nil,
			-29,
			0,
			nil,
			4294967270,
			0,
			[1] = TWEEN_PROPERTY.Left,
			[4] = TWEEN_PROPERTY.Right
		} )
		local f6_local1 = function ( f8_arg0, f8_arg1 )
			f8_arg0[0x196F4C3E7C51CBC]:AnimateSequence( 0x81D3D1917793B59 )
		end
		
		f6_arg0[0x196F4C3E7C51CBC]:RegisterAnimationSequence( 0x408FEC4209F8D4, {
			nil,
			nil,
			226,
			0,
			nil,
			-29,
			0,
			nil,
			4294967279,
			0,
			nil,
			17,
			0,
			[1] = TWEEN_PROPERTY.Right,
			[4] = TWEEN_PROPERTY.Left,
			[7] = TWEEN_PROPERTY.Top,
			[10] = TWEEN_PROPERTY.Bottom
		} )
		f6_arg0[0x49D85F0EF1CEC84] = {
			[0xEF6C3AB55C07BEF] = f6_local0,
			[0x81D3D1917793B59] = f6_local1,
			[0x408FEC4209F8D4] = function ( f7_arg0, f7_arg1 )
				f7_arg0[0x196F4C3E7C51CBC]:AnimateSequence( 0x408FEC4209F8D4 )
			end
		}
		f6_arg0[0xD97E59A206E4A54] = {
			[0x408FEC4209F8D4] = 0,
			[0x81D3D1917793B59] = 0,
			[0xEF6C3AB55C07BEF] = 0
		}
	end
}
function OBBackpack( f1_arg0, f1_arg1 )
	local f1_local0 = LUI
	local f1_local1 = MenuBuilder
	local f1_local2 = TWEEN_PROPERTY
	local f1_local3 = f1_local0.UIElement.new()
	f1_local3:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1000, 0, 112 )
	f1_local3.id = "OBBackpack"
	f1_local3[0xBD5D934D3CD91E5] = States
	local f1_local4
	if f1_arg1 then
		f1_local4 = f1_arg1
	else
		f1_local4 = f1_arg1.controllerIndex
	end
	f1_local4 = f1_local0.ValidateControllerIndex( f1_local3, f1_local4 )
	local f1_local5 = nil
	f1_local5 = f1_local0.UIImage.new()
	f1_local5[0x8B72E07B55C3AC0] = "BackpackSlotsBacker"
	f1_local5:SetRGB( SWATCHES[0x2B125210C0B2BB1][0xB5D1594B83AC6C5], 0 )
	f1_local5:SetAlpha( 0, 0 )
	f1_local5:Setup3SliceHorizontalImage( 12, 0.3 )
	f1_local5:SetAnchorsAndPosition( 0, 0, 0, 0, 99, -274, -17, 17 )
	f1_local5:SubscribeToModel( DataSources.alwaysLoaded.themes[0x1E634B554C2236]:GetModel( f1_local4 ), function ()
		local f5_local0 = DataSources.alwaysLoaded.themes[0x1E634B554C2236]:GetValue( f1_arg0 )
		if f5_local0 ~= nil then
			f1_arg0:setImage( RegisterMaterial( f5_local0 ), 0 )
		end
	end )
	f1_local3:addElement( f1_local5 )
	f1_local3[0x196F4C3E7C51CBC] = f1_local5
	local f1_local6 = nil
	f1_local6 = f1_local0.UIImage.new()
	f1_local6[0x8B72E07B55C3AC0] = "BackpackIconBacker"
	f1_local6:SetRGB( SWATCHES[0x2B125210C0B2BB1][0xB5D1594B83AC6C5], 0 )
	f1_local6:SetAlpha( 0, 0 )
	f1_local6:Setup3SliceHorizontalImage( 12, 0.3 )
	f1_local6:SetAnchorsAndPosition( 0, 0, 0, 0, -16, -901, -17, 17 )
	f1_local6:SubscribeToModel( DataSources.alwaysLoaded.themes[0x1E634B554C2236]:GetModel( f1_local4 ), function ()
		local f4_local0 = DataSources.alwaysLoaded.themes[0x1E634B554C2236]:GetValue( f1_arg0 )
		if f4_local0 ~= nil then
			f1_arg0:setImage( RegisterMaterial( f4_local0 ), 0 )
		end
	end )
	f1_local3:addElement( f1_local6 )
	f1_local3[0x2D6F186C560C8A2] = f1_local6
	local f1_local7 = nil
	if CONDITIONS.IsJup() then
		f1_local7 = f1_local1.BuildRegisteredType( 0xBF8F84F4181447A, {
			controllerIndex = f1_local4
		} )
		f1_local7[0x8B72E07B55C3AC0] = "BackpackIcon"
		f1_local7:SetHorizontalPivot( f1_local0.HorizontalPivot.Left )
		f1_local7:SetAnchorsAndPosition( 0, 1, 0.5, 0.5, -16, 92, -56, 56 )
		f1_local3:addElement( f1_local7 )
		f1_local3[0xBF8F84F4181447A] = f1_local7
	end
	local f1_local8 = nil
	f1_local8 = f1_local1.BuildRegisteredType( 0xEA89E43EF552403, {
		controllerIndex = f1_local4
	} )
	f1_local8[0x8B72E07B55C3AC0] = "BackpackCorners"
	f1_local8:SetRGB( SWATCHES[0xEAF2060ABE5269B][0x25ECEAC112DE079], 0 )
	f1_local8:SetAnchorsAndPosition( 0, 1, 0, 1, -16, 92, 0, 112 )
	f1_local3:addElement( f1_local8 )
	f1_local3[0x1CE70D1F3BE079B] = f1_local8
	local f1_local9 = nil
	if CONDITIONS.IsJup() then
		f1_local9 = f1_local0.UIGrid.new( {
			wrapY = false,
			maxVisibleColumns = 9,
			maxVisibleRows = 1,
			adjustSizeToContent = true,
			rowHeight = -16,
			spacingX = 16,
			columnWidth = -20,
			wrapX = false,
			controllerIndex = f1_local4,
			buildChild = function ()
				return f1_arg0.BuildRegisteredType( 0x49056568F919B83, {
					controllerIndex = f1_arg0
				} )
			end,
			refreshChild = function ( f2_arg0, f2_arg1, f2_arg2 )
				
			end,
			primaryAxis = f1_local0.DIRECTION.horizontal,
			scrollType = Enum[0x92A69278394394][0x20D1032BAFC0C12],
			sideArrowsOptions = {
				sideArrowsCreated = false
			}
		} )
		f1_local9[0x8B72E07B55C3AC0] = "BackpackSlots"
		f1_local9:SetHorizontalPivot( f1_local0.HorizontalPivot.Left )
		f1_local9:setUseStencil( false )
		f1_local9:SetAnchorsAndPosition( 0, 1, 0.5, 0.5, 108, 836, -56, 56 )
		f1_local3:addElement( f1_local9 )
		f1_local3[0x847F4D4998738C] = f1_local9
	end
	f0_local0( f1_local3, f1_local4, f1_arg1 )
	return f1_local3
end

MenuBuilder.registerType( 0xD7B7FE7458CD1FA, OBBackpack )
LockTable( _M )
