-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
LUI.UIRadialProgressBar = LUI.Class( LUI.UIElement )
LUI.UIRadialProgressBar.init = function ( f7_arg0, f7_arg1 )
	LUI.UIRadialProgressBar.super.init( f7_arg0, f7_arg1 )
	f7_arg0.id = "UIRadialProgressBar"
	assert( type( f7_arg1 ) == "table" )
	assert( type( f7_arg1 ) == "table" )
	local f7_local0 = assert
	local f7_local1
	if f7_arg1.snapToMultiplesOfAngle ~= nil and type( f7_arg1.snapToMultiplesOfAngle ) ~= "number" then
		f7_local1 = false
	else
		f7_local1 = true
	end
	f7_local0( f7_local1 )
	assert( 1 < f7_arg1.segmentCount )
	assert( f7_arg1.segmentMaterial )
	f7_local0 = assert
	f7_local1 = f7_arg1.maskMaterial
	if not f7_local1 then
		f7_local1 = f7_arg1.segmentCount < 3
	end
	f7_local0( f7_local1 )
	f7_arg0.segmentCount = f7_arg1.segmentCount
	f7_arg0.percentUpdateFunc = f7_arg1.percentUpdateFunc
	f7_arg0.snapToMultiplesOfAngle = f7_arg1.snapToMultiplesOfAngle or 0
	f7_arg0.useCodeImplementation = f7_arg0.segmentCount < 3
	if f7_arg0.useCodeImplementation then
		f7_arg0:SetupRadialProgressBar( f7_arg1.counterClockwise == true )
		f7_arg0:setImage( RegisterMaterial( f7_arg1.segmentMaterial ) )
	else
		if f7_arg1.counterClockwise then
			f7_local0 = 1
		else
			f7_local0 = -1
		end
		f7_arg0.rotDirection = f7_local0
		f7_arg0.segmentData = {}
		f7_arg0:CreateSegments( f7_arg1.segmentMaterial, f7_arg1.maskMaterial, f7_arg1.counterClockwise )
		f7_arg0:SetProgress( 0 )
	end
end

LUI.UIRadialProgressBar.SetProgress = function ( f6_arg0, f6_arg1, f6_arg2, f6_arg3 )
	local f6_local0 = nil
	if 0 < f6_arg0.snapToMultiplesOfAngle then
		local f6_local1 = f6_arg0.snapToMultiplesOfAngle / 360
		f6_arg1 = math.floor( 0.5 + f6_arg1 / f6_local1 ) * f6_local1
	end
	if f6_arg0.useCodeImplementation then
		local f6_local2 = f6_arg0
		local f6_local1 = f6_arg0.SetProgressInC
		local f6_local3 = f6_arg1
		local f6_local4
		if not f6_arg2 then
			f6_local4 = f6_arg2
		else
			f6_local4 = 0
		end
		local f6_local5
		if not f6_arg3 then
			f6_local5 = f6_arg3
		else
			f6_local5 = 0
		end
		f6_local0 = f6_local1( f6_local2, f6_local3, f6_local4, f6_local5 )
	else
		f6_arg0.fillPercent = f6_arg1
		f6_arg0:RefreshSegments( f6_arg1 )
	end
	if f6_arg0.percentUpdateFunc then
		f6_arg0.percentUpdateFunc( f6_arg1 )
	end
	return f6_local0
end

LUI.UIRadialProgressBar.SetOnUpdateCallback = function ( f5_arg0, f5_arg1 )
	f5_arg0.percentUpdateFunc = f5_arg1
end

LUI.UIRadialProgressBar.SetSegmentImage = function ( f4_arg0, f4_arg1 )
	if f4_arg0.useCodeImplementation then
		f4_arg0:setImage( f4_arg1 )
	else
		for f4_local0 = 1, f4_arg0.segmentCount, 1 do
			f4_arg0.segmentData[f4_local0].segment:setImage( f4_arg1 )
		end
	end
end

LUI.UIRadialProgressBar.CreateSegments = function ( f3_arg0, f3_arg1, f3_arg2, f3_arg3 )
	local f3_local0 = f3_arg0.rotDirection * 360 / f3_arg0.segmentCount
	local f3_local1 = 1 / f3_arg0.segmentCount
	local f3_local2, f3_local3, f3_local4, f3_local5 = f3_arg0:getCurrentRGBA()
	for f3_local6 = 1, f3_arg0.segmentCount, 1 do
		local f3_local9 = (f3_local6 - 1) * f3_local0
		local self = LUI.UIImage.new()
		self:SetRGBFromTable( {
			r = f3_local2,
			g = f3_local3,
			b = f3_local4
		} )
		self:SetZRotation( f3_local9 )
		self:setImage( RegisterMaterial( f3_arg1 ) )
		self.id = "segment" .. f3_local6
		f3_arg0:addElement( self )
		local f3_local11 = LUI.UIImage.new()
		f3_local11:SetRGBFromTable( {
			r = f3_local2,
			g = f3_local3,
			b = f3_local4
		} )
		f3_local11:SetZRotation( f3_local9 )
		f3_local11:setImage( RegisterMaterial( f3_arg2 ) )
		f3_local11.id = "segmentMask" .. f3_local6
		f3_arg0:addElement( f3_local11 )
		if f3_arg3 then
			self:SetUMin( 1, 0 )
			self:SetUMax( 0, 0 )
			f3_local11:SetUMin( 1, 0 )
			f3_local11:SetUMax( 0, 0 )
		end
		self:SetMask( f3_local11 )
		f3_local11.startRot = f3_local9
		f3_local11.endRot = math.max( f3_local9 + f3_local0 )
		f3_local11.startPercent = (f3_local6 - 1) * f3_local1
		f3_local11.endPercent = math.max( f3_local11.startPercent + f3_local1 )
		table.insert( f3_arg0.segmentData, {
			segment = self,
			mask = f3_local11
		} )
	end
end

LUI.UIRadialProgressBar.RefreshSegments = function ( f2_arg0, f2_arg1 )
	for f2_local0 = 1, f2_arg0.segmentCount, 1 do
		local f2_local3 = f2_arg0.segmentData[f2_local0].mask
		f2_local3:SetZRotation( f2_local3.startRot + LUI.clamp( (f2_arg1 - f2_local3.startPercent) / (f2_local3.endPercent - f2_local3.startPercent), 0, 1 ) * (f2_local3.endRot - f2_local3.startRot) )
	end
end

function BuildRadialProgressBar( f1_arg0, f1_arg1 )
	return LUI.UIRadialProgressBar.new( f1_arg1 )
end

MenuBuilder.registerType( "UIRadialProgressBar", BuildRadialProgressBar )
