-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
module( ..., package.seeall )
local f0_local0 = 3
local f0_local1 = {
	INCOMPLETED_ACHIEVEMENTS = 2,
	ALL_ACHIEVEMENTS = 0,
	COMPLETED_ACHIEVEMENTS = 1
}
local f0_local2 = {
	[f0_local1.ALL_ACHIEVEMENTS] = Engine[0xED84C33EC5F01EA]( 0x58A859785224AF ),
	[f0_local1.COMPLETED_ACHIEVEMENTS] = Engine[0xED84C33EC5F01EA]( 0x60160BEB8236C0D ),
	[f0_local1.INCOMPLETED_ACHIEVEMENTS] = Engine[0xED84C33EC5F01EA]( 0xFEEA86F8EA337BE )
}
local f0_local3 = function ( f16_arg0 )
	local f16_local0 = 0
	local f16_local1 = 0
	for f16_local5, f16_local6 in pairs( f16_arg0._achievements ) do
		if f16_local6.isCompleted then
			f16_local0 = f16_local0 + f16_local6.score
		end
		f16_local1 = f16_local1 + f16_local6.score
	end
	return LUI.Round( f16_local0 / f16_local1, 2 )
end

local f0_local4 = function ( f15_arg0, f15_arg1 )
	return f15_arg0._achievements[f15_arg1 + 1]
end

local f0_local5 = function ( f14_arg0 )
	if f14_arg0._filterState == f0_local0.COMPLETED_ACHIEVEMENTS then
		f14_arg0._areAchievementsCompleted = true
		f14_arg0._areAchievementsIncomplete = false
	elseif f14_arg0._filterState == f0_local0.INCOMPLETED_ACHIEVEMENTS then
		f14_arg0._areAchievementsCompleted = false
		f14_arg0._areAchievementsIncomplete = true
	else
		f14_arg0._areAchievementsCompleted = true
		f14_arg0._areAchievementsIncomplete = true
	end
end

local f0_local6 = function ( f13_arg0 )
	if f13_arg0._filterState == f0_local0.ALL_ACHIEVEMENTS then
		f13_arg0._filterState = f0_local0.COMPLETED_ACHIEVEMENTS
	elseif f13_arg0._filterState == f0_local0.COMPLETED_ACHIEVEMENTS then
		f13_arg0._filterState = f0_local0.INCOMPLETED_ACHIEVEMENTS
	else
		f13_arg0._filterState = f0_local0.ALL_ACHIEVEMENTS
	end
end

local f0_local7 = function ( f12_arg0 )
	return f0_local0[f12_arg0._filterState]
end

local f0_local8 = function ( f11_arg0 )
	f11_arg0._achievements = LUI.AchievementsManager.GetAchievements( f11_arg0._controllerIndex, true )
	f11_arg0.AchievementsList:RefreshContent()
	f11_arg0.TotalScore:SetScore( f0_local0( f11_arg0 ) )
end

local f0_local9 = function ( f6_arg0 )
	local f6_local0 = LUI.AchievementsManager.GetAchievements( f6_arg0._controllerIndex, true )
	f6_arg0._achievements = {}
	local f6_local1 = 0
	f6_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
		button_ref = "button_r3"
	} )
	f0_local0( f6_arg0 )
	for f6_local5, f6_local6 in ipairs( f6_local0 ) do
		if f6_arg0._areAchievementsCompleted and f6_local6.isCompleted then
			table.insert( f6_arg0._achievements, f6_local6 )
			f6_local1 = f6_local1 + 1
		end
		if f6_arg0._areAchievementsIncomplete and not f6_local6.isCompleted then
			table.insert( f6_arg0._achievements, f6_local6 )
		end
	end
	if f6_local1 >= 1 or f6_arg0._filterState == f0_local0.INCOMPLETED_ACHIEVEMENTS then
		f6_local2 = false
	else
		f6_local2 = true
	end
	if f6_local2 or f6_local1 == #f6_local0 then
		f6_arg0._achievements = f6_local0
		f6_arg0._filterState = f0_local0.ALL_ACHIEVEMENTS
	else
		f6_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 1,
			ignoreTooltipPrompt = true,
			button_ref = "button_right_trigger",
			helper_text = Engine[0xED84C33EC5F01EA]( 0xB2CC3512F4EC81A, f0_local0( f6_arg0 ) ),
			container = f6_arg0.PromptsContainer,
			containerAlignment = LUI.Alignment.Left
		} )
	end
	f6_arg0.AchievementsList:SetNumChildren( #f6_arg0._achievements )
	f6_arg0.AchievementsList:SetRefreshChild( function ( f7_arg0, f7_arg1, f7_arg2 )
		local f7_local0 = f6_arg0.AchievementsList:GetContentIndex( f7_arg1, f7_arg2 )
		local f7_local1 = f6_arg0._achievements[f7_local0 + 1]
		local f7_local2 = function ( f10_arg0 )
			local f10_local0 = nil
			for f10_local4, f10_local5 in ipairs( {
				nil,
				0x6CDCE5DCE97CF01,
				0x17A1396942DFF12,
				0x1FE3F79F45C9CB1,
				0x91FAED52D992E46,
				0xF38BFC3972CC0AC
			} ) do
				if f10_local4 - 1 == f10_arg0 then
					f10_local0 = f10_local5
				end
			end
			return f10_local0
		end
		
		f7_arg0.Name:setText( f7_local1.name )
		f7_arg0.Description:setText( f7_local1.description )
		f7_arg0.GameMode:setText( Engine[0xED84C33EC5F01EA]( f7_local2( f7_local1.gameMode ) ) )
		if f7_local1.image then
			f7_arg0.Image:setImage( RegisterMaterial( f7_local1.image ) )
		end
		f7_arg0.isCompleted = f7_local1.isCompleted
		f7_arg0:UpdateAnimationState()
		if f7_local1.isCompleted then
			ACTIONS.AnimateSequence( f7_arg0, "Completed" )
		else
			ACTIONS.AnimateSequence( f7_arg0, "Idle" )
		end
		if Engine[0x2DA54CF5D6B7F02]() then
			if not f7_arg0._currentIndex then
				f7_arg0:addEventHandler( "leftmousedown", function ( f9_arg0, f9_arg1 )
					local f9_local0 = f7_arg0( f7_arg0, f9_arg0._currentIndex )
					Engine[0xB81A5136C5503E4]( "achievements_giveAchievement " .. tostring( f9_local0.nameId ) )
					f7_arg0( f7_arg0 )
					return true
				end )
				f7_arg0:addEventHandler( "rightmousedown", function ( f8_arg0, f8_arg1 )
					local f8_local0 = f7_arg0( f7_arg0, f8_arg0._currentIndex )
					Engine[0xB81A5136C5503E4]( "achievements_clearAchievements" )
					f7_arg0( f7_arg0 )
					return true
				end )
			end
			f7_arg0._currentIndex = f7_local0
		end
	end )
end

local f0_local10 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0x6267D023F0ABFAE ) )
	f3_arg0._filterState = f0_local0.ALL_ACHIEVEMENTS
	f3_arg0._controllerIndex = f3_arg1
	f0_local0( f3_arg0 )
	f3_arg0.TotalScore:SetScore( f0_local0( f3_arg0 ) )
	f3_arg0:addAndCallEventHandler( "update_input_type", function ( f5_arg0, f5_arg1 )
		if not LUI.IsLastInputMouseNavigation( f5_arg1.controllerIndex or f3_arg0 ) then
			f5_arg0.AchievementsList:processEvent( {
				name = "gain_focus",
				controller = f5_arg0._controllerIndex
			} )
		end
	end )
	f3_arg0.AchievementsList:SetScrollSpeed( f0_local0 )
	if Engine[0x9258F49F515F97B]( f3_arg0 ) then
		f3_arg0.Background:SetAlpha( 0 )
	else
		f3_arg0.Background:SetAlpha( 1 )
	end
	if CONDITIONS.IsSteamGame() then
		f3_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 2,
			ignoreTooltipPrompt = true,
			button_ref = "button_alt2",
			helper_text = Engine[0xED84C33EC5F01EA]( 0x5525E92DE955852 ),
			container = f3_arg0.PromptsContainer,
			containerAlignment = LUI.Alignment.Left
		} )
	end
	f3_arg0:addEventHandler( "gamepad_button", function ( f4_arg0, f4_arg1 )
		if CONDITIONS.ButtonSecondary( f4_arg0, f4_arg1 ) and f4_arg1.down then
			ACTIONS.LeaveMenu( f4_arg0 )
		elseif CONDITIONS.ButtonRightTrigger( f4_arg0, f4_arg1 ) and f4_arg1.down then
			Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
			f3_arg0( f3_arg0 )
			f3_arg0( f3_arg0 )
		elseif CONDITIONS.ButtonAltTwo( f4_arg0, f4_arg1 ) and f4_arg1.down and CONDITIONS.IsSteamGame() then
			Engine[0x9BA4C31F5D63821]()
		end
	end )
	if not CONDITIONS.IsMobileOrMobileSim() then
		f3_arg0.MenuTitle:SetupBackButton( f3_arg1 )
	end
end

local f0_local11 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function AchievementsMenuBase( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "AchievementsMenuBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local Background = nil
	
	Background = LUI.UIImage.new()
	Background.id = "Background"
	ACTIONS.ScaleFullscreen( Background )
	Background:setImage( RegisterMaterial( 0x34A0D4541A12F70 ), 0 )
	Background:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, 0, _1080p * 1080 )
	self:addElement( Background )
	self.Background = Background
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "AchievementsMenuBase", AchievementsMenuBase )
LockTable( _M )
