-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
module( ..., package.seeall )
local f0_local0 = function ( f5_arg0 )
	local f5_local0 = 5 * _1080p
	local f5_local1 = 0
	local f5_local2 = 60 * _1080p
	local f5_local3 = LAYOUT.GetTextWidth( f5_arg0.CountText )
	f5_arg0.CountText:SetRight( -f5_local1 + f5_local2 )
	f5_arg0.CountText:SetLeft( -f5_local1 - f5_local3 )
	f5_local1 = f5_local1 + f5_local3
	local f5_local4 = LAYOUT.GetElementWidth( f5_arg0.Icon )
	f5_arg0.Icon:SetRight( -f5_local1 )
	f5_arg0.Icon:SetLeft( -f5_local1 - f5_local4 )
	f5_arg0.totalWidth = (f5_local1 + f5_local4 + f5_local0 * 2) / _1080p
	f5_arg0:dispatchEventToParent( {
		name = "player_count_layout_update"
	} )
end

local f0_local1 = function ( f3_arg0, f3_arg1, f3_arg2 )
	local f3_local0 = f3_arg0._controllerIndex
	if f3_arg0._partyCountSubscription then
		f3_arg0:UnsubscribeFromModel( f3_arg0._partyCountSubscription )
	end
	if f3_arg0._maxPartyCountSubscription then
		f3_arg0:UnsubscribeFromModel( f3_arg0._maxPartyCountSubscription )
	end
	local f3_local1 = function ()
		local f4_local0 = f3_arg0:GetValue( f3_arg0 ) or 0
		local f4_local1 = f3_arg0:GetValue( f3_arg0 ) or 0
		if f4_local0 == 0 and f4_local1 == 0 then
			f3_arg0:SetAlpha( 0 )
		else
			f3_arg0:SetAlpha( 1 )
		end
		local f4_local2 = Engine[0xED84C33EC5F01EA]( "LUA_MENU/PARTY_COUNT_NUMBERS", f4_local0, f4_local1 )
		f3_arg0.CountText:setText( f4_local2 )
		if f3_arg0.partyInfoText ~= f4_local2 then
			f3_arg0( f3_arg0 )
			f3_arg0.partyInfoText = f4_local2
		end
	end
	
	f3_arg0._partyCountSubscription = f3_arg0:SubscribeToModel( f3_arg1:GetModel( f3_local0 ), f3_local1 )
	f3_arg0._maxPartyCountSubscription = f3_arg0:SubscribeToModel( f3_arg2:GetModel( f3_local0 ), f3_local1 )
end

local f0_local2 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.SetDataSources = f0_local0
	f2_arg0._controllerIndex = f2_arg1
	f2_arg0.totalWidth = 0
	f2_arg0.partyInfoText = ""
	f2_arg0.platformCount = 0
	f2_arg0.crossplayCount = 0
	if CONDITIONS.IsBattleNet() or CONDITIONS.IsLaze() then
		ACTIONS.AnimateSequence( f2_arg0, "PC" )
	elseif CONDITIONS.IsSony() then
		ACTIONS.AnimateSequence( f2_arg0, "PS4" )
	elseif CONDITIONS.IsXbox() then
		ACTIONS.AnimateSequence( f2_arg0, "XB3" )
	end
	f0_local0( f2_arg0 )
end

function PlayerCount( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 116 * _1080p, 0, 28 * _1080p )
	self.id = "PlayerCount"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local Icon = nil
	
	Icon = LUI.UIImage.new()
	Icon.id = "Icon"
	Icon:SetRGBFromTable( SWATCHES.text.buttonTextDefault, 0 )
	Icon:SetUseForceOpacityMode( true )
	Icon:setImage( RegisterMaterial( "v_icon_social_friends" ), 0 )
	Icon:SetAnchorsAndPosition( 1, 0, 0.5, 0.5, _1080p * -116, _1080p * -80, _1080p * -18, _1080p * 18 )
	self:addElement( Icon )
	self.Icon = Icon
	
	local CountText = nil
	
	CountText = LUI.UIStyledText.new()
	CountText.id = "CountText"
	CountText:SetRGBFromTable( SWATCHES.text.buttonTextDefault, 0 )
	CountText:SetUseForceOpacityMode( true )
	CountText:setText( "1 / 20", 0 )
	CountText:SetFont( FONTS.GetFont( FONT_STYLES.fontStyle_MBodyText.font.File ) )
	CountText:SetFontSize( FONT_STYLES.fontStyle_MBodyText.size )
	CountText:SetMinFontSize( FONT_STYLES.fontStyle_MBodyText.minSize )
	CountText:SetTextShrinkingDisabled( true )
	CountText:SetWordWrap( false )
	CountText:SetTracking( FONT_STYLES.fontStyle_MBodyText.tracking * _1080p, 0 )
	CountText:SetLeading( FONT_STYLES.fontStyle_MBodyText.leading * _1080p, 0 )
	CountText:SetAlignment( LUI.Alignment.Left )
	CountText:SetVerticalAlignment( LUI.Alignment.Center )
	CountText:SetOptOutRightToLeftAlignmentFlip( true )
	CountText:SetShadowRGBFromInt( 0, 0 )
	CountText:SetOutlineRGBFromInt( 0, 0 )
	CountText:SetMaxVisibleLines( 1 )
	CountText:SetAnchorsAndPosition( 1, 0, 0, 0, _1080p * -80, _1080p * -10, _1080p * -4, _1080p * 4 )
	self:addElement( CountText )
	self.CountText = CountText
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "PlayerCount", PlayerCount )
LockTable( _M )
