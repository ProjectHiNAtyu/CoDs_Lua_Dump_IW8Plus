-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:02
EXGM_UTILS = EXGM_UTILS or {}
EXGM_UTILS.ExtractionResult = {
	EXGM_MISSING_IN_ACTION = 0,
	EXGM_EXTRACTION_SUCCESSFUL = 2,
	EXGM_PLAYER_DIED = 1
}
EXGM_UTILS.StashPopupItemType = {
	ITEMTYPE_OTHERS = 2,
	ITEMTYPE_CONTRABAND = 1,
	ITEMTYPE_WEAPON_IN_WEAPON_SLOT = 0
}
EXGM_UTILS.SectorState = {
	SECTORSTATE_LOCKED = 0,
	SECTORSTATE_LIBERATED = 2,
	SECTORSTATE_UNLOCKED = 1
}
EXGM_UTILS.WarlordState = {
	WARLORDSTATE_LOCKED = 0,
	WARLORDSTATE_ELIMINATED = 2,
	WARLORDSTATE_UNLOCKED = 1
}
EXGM_UTILS.GetFistWeaponLootId = function ()
	return LOOT.GetItemIDFromRef( WEAPON.FistsValue )
end

EXGM_UTILS.SetIsEXGMGameModeDvar = function ( f40_arg0 )
	Dvar[0x8EA06EEDB58D872]( 0xF885C6CBEAC50A1, f40_arg0 )
end

EXGM_UTILS.GetIsEXGMGameModeDvar = function ()
	return Dvar[0x9E5BE3B4BBA4E0E]( 0xF885C6CBEAC50A1 )
end

EXGM_UTILS.GetBankedCash = function ( f38_arg0 )
	local f38_local0 = PLAYER_DATA.IO( f38_arg0, CoD.StatsGroup.JupiterEXGM )
	return f38_local0.dollars:get()
end

EXGM_UTILS.SetBankedCash = function ( f37_arg0, f37_arg1 )
	local f37_local0 = PLAYER_DATA.IO( f37_arg0, CoD.StatsGroup.JupiterEXGM )
	f37_local0.dollars:set( f37_arg1 )
end

EXGM_UTILS.ForceDefaultLoadoutAndInventory = function ( f34_arg0 )
	local f34_local0 = PlayerData[0x8B73907B55C4D71]( f34_arg0, CoD.StatsGroup.Ranked )
	f34_local0 = f34_local0.dmzInventory
	local f34_local1 = function ( f36_arg0, f36_arg1, f36_arg2 )
		f34_arg0[f36_arg0].lootID:set( f36_arg1 )
		f34_arg0[f36_arg0].quantity:set( f36_arg2 )
		f34_arg0[f36_arg0].lootedQuantity:set( 0 )
	end
	
	for f34_local5, f34_local6 in ddlpairs( f34_local0 ) do
		f34_local1( f34_local5, 0, 0 )
	end
	f34_local2 = function ( f35_arg0, f35_arg1 )
		if f35_arg1 then
			WEAPON.EquipModificationByLootID( f34_arg0, f35_arg0, f35_arg1 )
		else
			WEAPON.WipeWeaponSetup( f35_arg0 )
			f35_arg0.weapon:set( WEAPON.FistsValue )
		end
	end
	
	f34_local3, f34_local4 = nil
	f34_local5 = EQUIPMENT.none
	f34_local6 = EQUIPMENT.none
	local f34_local7 = SUPER.superNoneValue
	local f34_local8 = STREAK.none
	local f34_local9 = LOADOUT.GetLoadoutSquadMember( f34_arg0 )
	local f34_local10 = f34_local9.loadouts[DMZ.LoadoutIndex]
	f34_local2( f34_local10.weaponSetups[0], f34_local3 )
	f34_local2( f34_local10.weaponSetups[1], f34_local4 )
	f34_local10.equipmentSetups[0].equipment:set( f34_local5 )
	f34_local10.equipmentSetups[1].equipment:set( f34_local6 )
	f34_local10.fieldUpgradeSetups[0].fieldUpgrade:set( f34_local7 )
	f34_local10.fieldUpgradeSetups[1].fieldUpgrade:set( f34_local8 )
	DMZ.Validate( f34_arg0 )
end

EXGM_UTILS.GetItemPrice = function ( f33_arg0 )
	if f33_arg0 == nil or f33_arg0 == 1 then
		return 0
	end
	local f33_local0 = tonumber( LOOT.GetLootItemValueByID( f33_arg0 ) ) or 0
	if LOOT.IsWeapon( f33_arg0 ) then
		f33_local0 = math.floor( f33_local0 * GAMEMODE_SCRIPTBUNDLE_UTILS.GetWeaponPurchaseFlowValueMultiplier() )
	end
	return f33_local0
end

EXGM_UTILS.GetLocalPlayerBalance = function ( f32_arg0 )
	return EXGM_UTILS.GetBankedCash( f32_arg0 )
end

EXGM_UTILS.UpdateLocalPlayerBalance = function ( f31_arg0, f31_arg1 )
	EXGM_UTILS.SetBankedCash( f31_arg0, EXGM_UTILS.GetLocalPlayerBalance( f31_arg0 ) + f31_arg1 )
end

EXGM_UTILS.GetUnpackedToolUseInfoData = function ( f30_arg0 )
	local f30_local0, f30_local1 = nil
	local f30_local2 = {}
	local f30_local3 = 0
	local f30_local4 = 0
	local f30_local5 = false
	return CoD.ExtractBitsFromBitPositionInValue( f30_arg0, 4, 1 ), CoD.ExtractBitsFromBitPositionInValue( f30_arg0, 4, 5 ), CoD.ExtractBitsFromBitPositionInValue( f30_arg0, 1, 9 ) == 1
end

EXGM_UTILS.MAX_WARLORDS = 4
EXGM_UTILS.ACTIVITIES_SCRIPTBUNDLE_PREFIX = 0xF50F26BFE61482D
EXGM_UTILS.ACTIVITIES_SCRIPTBUNDLE_DEFAULT = "default"
EXGM_UTILS.BOSS_ACTIVITY_SCRIPTBUNDLE_PREFIX = 0x98D135AAFFF12A7
EXGM_UTILS.BOSS_ACTIVITY_SCRIPTBUNDLE_DEFAULT = "default"
EXGM_UTILS.WARLORD_INTEL_STATE_BITWIDTH = 2
EXGM_UTILS.WARLORD_HAS_DATA_START = 1
EXGM_UTILS.WARLORD_HAS_DATA_BITWIDTH = 1
EXGM_UTILS.WARLORD_INDEX_START = EXGM_UTILS.WARLORD_HAS_DATA_START + EXGM_UTILS.WARLORD_HAS_DATA_BITWIDTH
EXGM_UTILS.WARLORD_INDEX_BITWIDTH = 6
EXGM_UTILS.WARLORD_IS_DEAD_START = EXGM_UTILS.WARLORD_INDEX_START + EXGM_UTILS.WARLORD_INDEX_BITWIDTH
EXGM_UTILS.WARLORD_IS_DEAD_BITWIDTH = 1
EXGM_UTILS.WARLORD_SPAWN_METHOD_START = EXGM_UTILS.WARLORD_IS_DEAD_START + EXGM_UTILS.WARLORD_IS_DEAD_BITWIDTH
EXGM_UTILS.WARLORD_SPAWN_METHOD_BITWIDTH = 4
EXGM_UTILS.WARLORD_SPAWN_TIME_START = EXGM_UTILS.WARLORD_SPAWN_METHOD_START + EXGM_UTILS.WARLORD_SPAWN_METHOD_BITWIDTH
EXGM_UTILS.WARLORD_SPAWN_TIME_BITWIDTH = 6
EXGM_UTILS.WARLORD_POI_INDEX_START = EXGM_UTILS.WARLORD_SPAWN_TIME_START + EXGM_UTILS.WARLORD_SPAWN_TIME_BITWIDTH
EXGM_UTILS.WARLORD_POI_INDEX_BITWIDTH = 6
EXGM_UTILS.GetActivitiesScriptBundle = function ()
	local f29_local0 = Engine[0x6093D047200548]( EXGM_UTILS.ACTIVITIES_SCRIPTBUNDLE_PREFIX .. Game[0x3BB743C01674954]() )
	if f29_local0 == nil then
		f29_local0 = Engine[0x6093D047200548]( EXGM_UTILS.ACTIVITIES_SCRIPTBUNDLE_PREFIX .. EXGM_UTILS.ACTIVITIES_SCRIPTBUNDLE_DEFAULT )
	end
	return f29_local0
end

EXGM_UTILS.GetBossActivityScriptBundle = function ()
	local f28_local0 = Engine[0x6093D047200548]( EXGM_UTILS.BOSS_ACTIVITY_SCRIPTBUNDLE_PREFIX .. Game[0x3BB743C01674954]() )
	if f28_local0 == nil then
		f28_local0 = Engine[0x6093D047200548]( EXGM_UTILS.BOSS_ACTIVITY_SCRIPTBUNDLE_PREFIX .. EXGM_UTILS.BOSS_ACTIVITY_SCRIPTBUNDLE_DEFAULT )
	end
	return f28_local0
end

EXGM_UTILS.GetAllPackedWarlordDatas = function ()
	local f27_local0 = {}
	for f27_local1 = 1, EXGM_UTILS.MAX_WARLORDS, 1 do
		f27_local0.insert( DataSources.inGame.EXGM.Warlords.PackedWarlordDatas[f27_local1] )
	end
	return f27_local0
end

EXGM_UTILS.SubscribeToAllWarlords = function ( f25_arg0, f25_arg1, f25_arg2, f25_arg3 )
	return f25_arg0:SubscribeToModel( LUI.AggregateDataSource.new( DataSources.inGame.EXGM.PackedWarlords, EXGM_UTILS.GetAllPackedWarlordDatas(), f25_arg1, function ()
		f25_arg0()
	end
	 ), f25_arg2, f25_arg3 )
end

EXGM_UTILS.ParseWarlordData = function ( f24_arg0, f24_arg1, f24_arg2, f24_arg3 )
	local f24_local0 = f24_arg1[0x5963D9DB9755201]
	local f24_local1 = f24_arg1[0x78C353D0B99DE0E]
	if CoD.ExtractBitsFromBitPositionInValue( f24_arg2, EXGM_UTILS.WARLORD_HAS_DATA_BITWIDTH, EXGM_UTILS.WARLORD_HAS_DATA_START ) == 1 then
		local f24_local2 = {
			WarlordIndex = CoD.ExtractBitsFromBitPositionInValue( f24_arg2, EXGM_UTILS.WARLORD_INDEX_BITWIDTH, EXGM_UTILS.WARLORD_INDEX_START ) + 1,
			IsDead = CoD.ExtractBitsFromBitPositionInValue( f24_arg2, EXGM_UTILS.WARLORD_IS_DEAD_BITWIDTH, EXGM_UTILS.WARLORD_IS_DEAD_START ) == 1,
			SpawnMethodIndex = CoD.ExtractBitsFromBitPositionInValue( f24_arg2, EXGM_UTILS.WARLORD_SPAWN_METHOD_BITWIDTH, EXGM_UTILS.WARLORD_SPAWN_METHOD_START ) + 1,
			SpawnTimeMin = CoD.ExtractBitsFromBitPositionInValue( f24_arg2, EXGM_UTILS.WARLORD_SPAWN_TIME_BITWIDTH, EXGM_UTILS.WARLORD_SPAWN_TIME_START ),
			PoiIndex = CoD.ExtractBitsFromBitPositionInValue( f24_arg2, EXGM_UTILS.WARLORD_POI_INDEX_BITWIDTH, EXGM_UTILS.WARLORD_POI_INDEX_START )
		}
		local f24_local3 = f24_local0[f24_local2.WarlordIndex]
		f24_local2.WarlordPortrait = f24_local3[0xC2AF16C46114BD3]
		f24_local2.AliveIcon = f24_local3[0x7F0A7C13A9C42F3]
		f24_local2.EliminatedIcon = f24_local3[0x1AA93120D105658]
		f24_local2.WarlordLocName = f24_local3[0x65F991765CF1ED1]
		f24_local2.WarlordLocToolSuggestion = f24_local3[0xCF93922C8040780]
		f24_local2.SpawnMethodIcon = f24_local1[f24_local2.SpawnMethodIndex][0x6E20ABE780BC684]
		f24_local2.SpawnMethodText = f24_local1[f24_local2.SpawnMethodIndex][0x53B1BB288761C0A]
		f24_local2.PoiName = MapInfo.GetPoiNameFromActiveMapBundle( f24_local2.PoiIndex )
		f24_local2.IntelState = CoD.ExtractBitsFromBitPositionInValue( f24_arg3, EXGM_UTILS.WARLORD_INTEL_STATE_BITWIDTH, EXGM_UTILS.WARLORD_INTEL_STATE_BITWIDTH * (f24_arg0 - 1) + 1 )
		return f24_local2
	else
		return nil
	end
end

EXGM_UTILS.GetActiveWarlord = function ( f23_arg0, f23_arg1 )
	return EXGM_UTILS.ParseWarlordData( f23_arg0, EXGM_UTILS.GetBossActivityScriptBundle(), DataSources.inGame.EXGM.Warlords.PackedWarlordDatas[f23_arg0]:GetValue( f23_arg1 ), DataSources.inGame.EXGM.Warlords.PackedWarlordIntelStates:GetValue( f23_arg1 ) )
end

EXGM_UTILS.GetActiveWarlords = function ( f22_arg0 )
	local f22_local0 = EXGM_UTILS.GetBossActivityScriptBundle()
	local f22_local1 = DataSources.inGame.EXGM.Warlords.PackedWarlordIntelStates:GetValue( f22_arg0 )
	local f22_local2 = {}
	for f22_local3 = 1, EXGM_UTILS.MAX_WARLORDS, 1 do
		local f22_local6 = EXGM_UTILS.ParseWarlordData( f22_local3, f22_local0, DataSources.inGame.EXGM.Warlords.PackedWarlordDatas[f22_local3]:GetValue( f22_arg0 ), f22_local1 )
		if f22_local6 ~= nil then
			table.insert( f22_local2, f22_local6 )
		end
	end
	return f22_local2
end

EXGM_UTILS.GetWarlordSpawnTimeRemainingMin = function ( f21_arg0, f21_arg1 )
	local f21_local0 = DataSources.inGame.MP.match.endTime:GetValue( f21_arg1 )
	if f21_local0 then
		return (f21_local0 - Game[0x49FC972008AE526]()) / 60000 - f21_arg0.SpawnTimeMin
	else
		return 0
	end
end

EXGM_UTILS.HasWarlordSpawned = function ( f20_arg0, f20_arg1 )
	return EXGM_UTILS.GetWarlordSpawnTimeRemainingMin( f20_arg0, f20_arg1 ) <= 0
end

EXGM_UTILS.GetWarlordPickupInfo = function ( f19_arg0 )
	local f19_local0 = 3
	local f19_local1 = f19_arg0
	if (Dvar[0x1FAB6D9A30481F8]( 0x507B164A1C475A1 ) and Dvar[0x22EAAB59AA27E9B]( 0x507B164A1C475A1 ) or 1) == 1 then
		f19_local0 = 2
		if f19_arg0 < f19_local0 and not f19_arg0 then
			f19_local1 = f19_arg0
		else
			f19_local1 = f19_local0
		end
	end
	return f19_local1, f19_local0
end

EXGM_UTILS.GetWarlordWithIndex = function ( f18_arg0, f18_arg1, f18_arg2 )
	if f18_arg2 == nil then
		f18_arg2 = EXGM_UTILS.GetActiveWarlords( f18_arg1 )
	end
	for f18_local3, f18_local4 in ipairs( f18_arg2 ) do
		if f18_local4.WarlordIndex == f18_arg0 then
			return f18_local4
		end
	end
end

EXGM_UTILS.WARLORD_SPLASH_STATE_START = 1
EXGM_UTILS.WARLORD_SPLASH_STATE_BITWIDTH = 3
EXGM_UTILS.WARLORD_SPLASH_OMNVAR_INDEX_START = EXGM_UTILS.WARLORD_SPLASH_STATE_START + EXGM_UTILS.WARLORD_SPLASH_STATE_BITWIDTH
EXGM_UTILS.WARLORD_SPLASH_OMNVAR_INDEX_BITWIDTH = 2
EXGM_UTILS.InitializeWarlordSplash = function ( f16_arg0, f16_arg1 )
	f16_arg0:SubscribeToModel( DataSources.inGame.EXGM.Warlords.PackedWarlordSplashData:GetModel( f16_arg1 ), function ()
		local f17_local0 = {
			controllerIndex = f16_arg0,
			displayLocation = LUI.SplashManager.MessageType.Warlord.key
		}
		local f17_local1 = DataSources.inGame.EXGM.Warlords.PackedWarlordSplashData:GetValue( f16_arg0 )
		f17_local0.splashState = CoD.ExtractBitsFromBitPositionInValue( f17_local1, EXGM_UTILS.WARLORD_SPLASH_STATE_BITWIDTH, EXGM_UTILS.WARLORD_SPLASH_STATE_START )
		f17_local0.omnvarIndex = CoD.ExtractBitsFromBitPositionInValue( f17_local1, EXGM_UTILS.WARLORD_SPLASH_OMNVAR_INDEX_BITWIDTH, EXGM_UTILS.WARLORD_SPLASH_OMNVAR_INDEX_START ) + 1
		f16_arg0:dispatchEventToRoot( {
			name = "add_message_splash_manager",
			immediate = true,
			options = f17_local0
		} )
	end, true )
end

EXGM_UTILS.GetWeaponSlotCooldownRemovalPrice = function ( f15_arg0 )
	return 400
end

EXGM_UTILS.CanAffordWeaponSlotCooldownRemovalPurchase = function ( f14_arg0 )
	return EXGM_UTILS.GetWeaponSlotCooldownRemovalPrice( f14_arg0 ) <= EXGM_UTILS.GetBankedCash( f14_arg0 )
end

EXGM_UTILS.PurchaseWeaponSlotCooldownRemoval = function ( f13_arg0, f13_arg1 )
	if not EXGM_UTILS.CanAffordWeaponSlotCooldownRemovalPurchase( f13_arg0 ) then
		return false
	else
		local f13_local0 = DMZInventory[0x62BC1029DCFE464]( DMZ.InventoryLocations.EDIT_SLOTS, f13_arg1 )
		if not f13_local0 or f13_local0.instanceID == "0" then
			return false
		else
			DMZInventory[0x13CD2B77EE070BD]( f13_local0.instanceID )
			EXGM_UTILS.UpdateLocalPlayerBalance( f13_arg0, -EXGM_UTILS.GetWeaponSlotCooldownRemovalPrice( f13_arg0 ) )
			return true
		end
	end
end

EXGM_UTILS.GetWeaponSlotPrice = function ( f12_arg0, f12_arg1 )
	local f12_local0
	if f12_arg1 == 1 then
		f12_local0 = 25000
	else
		f12_local0 = 100000
	end
	return f12_local0
end

EXGM_UTILS.CanAffordWeaponSlotPurchase = function ( f11_arg0, f11_arg1 )
	return EXGM_UTILS.GetWeaponSlotPrice( f11_arg1 ) <= EXGM_UTILS.GetBankedCash( f11_arg0 )
end

EXGM_UTILS.PurchaseWeaponSlot = function ( f10_arg0, f10_arg1 )
	if not EXGM_UTILS.CanAffordWeaponSlotPurchase( f10_arg0, f10_arg1 ) then
		return false
	else
		Loot[0x2084D3584384916]( f10_arg0, DMZ.InsuranceSlotLootIDs[f10_arg1 + 1] )
		EXGM_UTILS.UpdateLocalPlayerBalance( f10_arg0, -EXGM_UTILS.GetWeaponSlotPrice( f10_arg0, f10_arg1 ) )
		return true
	end
end

EXGM_UTILS.FrontendUnequipWeapon = function ( f9_arg0, f9_arg1, f9_arg2, f9_arg3 )
	DMZ.RevokeCustomWeaponAndMoveContrabandOutOfWeaponSlot( f9_arg2 )
	if f9_arg3 then
		f9_arg1:SetupButtonWithLootID( f9_arg0, f9_arg2, EXGM_UTILS.GetFistWeaponLootId() )
	else
		f9_arg1:SetWeaponEmpty()
	end
	f9_arg1:dispatchEventToParent( {
		name = "exgm_loadout_changed",
		weaponSlot = f9_arg2
	} )
end

EXGM_UTILS.CreateEquipSelectedItemToSlotFunc = function ( f7_arg0, f7_arg1 )
	return function ( f8_arg0 )
		if f8_arg0 == LOOT.emptyID then
			return false
		end
		local f8_local0 = DMZInventory[0x62BC1029DCFE464]( f7_arg0, f7_arg0 )
		if f8_local0 ~= nil and f8_local0.lootID == f8_arg0 then
			return true
		end
		DMZ.InstanceInventoryDirty = true
		for f8_local4, f8_local5 in ipairs( DMZInventory[0xA4FF5ECAA878E67]( DMZ.InventoryLocations.STASH ) ) do
			if f8_local5.lootID == f8_arg0 then
				if f8_local0 ~= nil and f8_local0.instanceID ~= "0" and f8_local0.lootID ~= LOOT.emptyID then
					DMZInventory[0xCAFE937A69C306F]( f8_local0.instanceID, DMZ.InventoryLocations.STASH, DMZ.GenericSubLocations.FIRST_AVAILABLE )
				end
				DMZInventory[0xCAFE937A69C306F]( f8_local5.instanceID, f7_arg0, f7_arg0 )
				return true
			end
		end
		return false
	end
	
end

EXGM_UTILS.STASH_CATEGORIES = {
	tactical = 4,
	key = 1,
	fieldupgrade = 5,
	consumable = 9,
	other = 14,
	lethal = 3,
	none = 0,
	equipment = 8,
	perks = 7,
	tool = 2,
	killstreak = 6,
	[PERK.FLC_CATEGORY.vest] = 10,
	[PERK.FLC_CATEGORY.gloves] = 11,
	[PERK.FLC_CATEGORY.footwear] = 12,
	[PERK.FLC_CATEGORY.gear] = 13
}
EXGM_UTILS.GetStashItemsTable = function ( f5_arg0 )
	local f5_local0 = {}
	local f5_local1 = {}
	local f5_local2 = {}
	local f5_local3 = {}
	local f5_local4 = {}
	local f5_local5 = {
		[PERK.FLC_CATEGORY.vest] = {},
		[PERK.FLC_CATEGORY.gloves] = {},
		[PERK.FLC_CATEGORY.footwear] = {},
		[PERK.FLC_CATEGORY.gear] = {}
	}
	local f5_local6 = {}
	local f5_local7 = {}
	local f5_local8 = function ( f6_arg0, f6_arg1 )
		if f6_arg0 == LOOT.emptyID then
			return 
		end
		local f6_local0 = {
			isNew = false,
			isLocked = false,
			isEquipped = false,
			itemId = f6_arg0,
			quantity = f6_arg1
		}
		local f6_local1 = LOOT.GetTypeForID( f6_arg0 )
		if f6_local1 == LOOT.itemTypes.CONSUMABLE then
			if LOOT.IsItemKey( f6_arg0 ) then
				table.insert( f5_arg0, f6_local0 )
			elseif LOOT.IsItemBreakableTool( f6_arg0 ) then
				table.insert( f5_arg0, f6_local0 )
			end
		elseif f6_local1 == LOOT.itemTypes.PERK then
			local f6_local2 = PERK.GetPerkCategoryFromId( f6_arg0 )
			if f6_local2 == PERK.FLC_CATEGORY.vest then
				table.insert( f5_arg0[PERK.FLC_CATEGORY.vest], f6_local0 )
			elseif f6_local2 == PERK.FLC_CATEGORY.gloves then
				table.insert( f5_arg0[PERK.FLC_CATEGORY.gloves], f6_local0 )
			elseif f6_local2 == PERK.FLC_CATEGORY.footwear then
				table.insert( f5_arg0[PERK.FLC_CATEGORY.footwear], f6_local0 )
			elseif f6_local2 == PERK.FLC_CATEGORY.gear then
				table.insert( f5_arg0[PERK.FLC_CATEGORY.gear], f6_local0 )
			end
		elseif f6_local1 == LOOT.itemTypes.EQUIPMENT then
			if LOOT.IsLootIDLethal( f6_arg0 ) then
				table.insert( f5_arg0, f6_local0 )
			elseif LOOT.IsLootIDTactical( f6_arg0 ) then
				table.insert( f5_arg0, f6_local0 )
			end
		elseif f6_local1 == LOOT.itemTypes.SUPER then
			table.insert( f5_arg0, f6_local0 )
		elseif f6_local1 == LOOT.itemTypes.STREAK then
			table.insert( f5_arg0, f6_local0 )
		elseif f6_local1 ~= LOOT.itemTypes.WEAPON then
			table.insert( f5_arg0, f6_local0 )
		end
	end
	
	local f5_local9 = DMZInventory[0xA4FF5ECAA878E67]( DMZ.InventoryLocations.STASH )
	local f5_local10 = {}
	for f5_local14, f5_local15 in ipairs( f5_local9 ) do
		if f5_local15 ~= nil and f5_local15.instanceID ~= "0" and f5_local15.lootID ~= LOOT.emptyID then
			if f5_local10[f5_local15.lootID] ~= nil then
				f5_local10[f5_local15.lootID] = f5_local10[f5_local15.lootID] + 1
			else
				f5_local10[f5_local15.lootID] = 1
			end
		end
	end
	for f5_local14, f5_local15 in pairs( f5_local10 ) do
		f5_local8( f5_local14, f5_local15 )
	end
	f5_local11 = {}
	if f5_arg0 == nil or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.consumable] or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.key] then
		table.insert( f5_local11, {
			name = 0xA25255A1607DA10,
			itemSize = 1,
			items = f5_local0
		} )
	end
	if f5_arg0 == nil or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.consumable] or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.tool] then
		table.insert( f5_local11, {
			name = 0x5FDFD0E26C4E097,
			itemSize = 1,
			items = f5_local1
		} )
	end
	if f5_arg0 == nil or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.equipment] or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.tactical] then
		table.insert( f5_local11, {
			name = 0x47F610628BD37ED,
			itemSize = 1,
			items = f5_local2
		} )
	end
	if f5_arg0 == nil or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.equipment] or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.lethal] then
		table.insert( f5_local11, {
			name = 0xE295473B54D48CF,
			itemSize = 1,
			items = f5_local3
		} )
	end
	if f5_arg0 == nil or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.fieldupgrade] then
		table.insert( f5_local11, {
			name = 0xF98235B7098F848,
			itemSize = 1,
			items = f5_local4
		} )
	end
	for f5_local15, f5_local16 in ipairs( PERK.FLC_CATEGORY_NAMES ) do
		if f5_arg0 == nil or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.perks] or f5_arg0[EXGM_UTILS.STASH_CATEGORIES[f5_local15]] then
			table.insert( f5_local11, {
				itemSize = 1,
				name = f5_local16,
				items = f5_local5[f5_local15]
			} )
		end
	end
	if f5_arg0 == nil or f5_arg0[EXGM_UTILS.STASH_CATEGORIES.killstreak] then
		table.insert( f5_local11, {
			name = 0x3CD29E65F09F047,
			itemSize = 1,
			items = f5_local6
		} )
	end
	if (f5_arg0 == nil or f5_arg0.other) and 0 < #f5_local7 then
		table.insert( f5_local11, {
			name = 0x3508B49E95AEF0F,
			itemSize = 1,
			items = f5_local7
		} )
	end
	return f5_local11
end

EXGM_UTILS.DestroyInstanceItemByLootId = function ( f4_arg0, f4_arg1 )
	if f4_arg1 == nil then
		for f4_local3, f4_local4 in ipairs( DMZInventory[0xA4FF5ECAA878E67]( DMZ.InventoryLocations.STASH ) ) do
			if f4_local4.lootID == f4_arg0 then
				f4_arg1 = f4_local4
				break
			end
		end
	end
	if f4_arg1 ~= nil and f4_arg1.instanceID ~= nil then
		DMZInventory[0x9592517BD0FA450]( f4_arg1.instanceID )
		DMZ.InstanceInventoryDirty = true
	end
end

EXGM_UTILS.PopupToDestroyInstanceItemFunc = function ( f1_arg0, f1_arg1 )
	if f1_arg1 == nil or not f1_arg1 then
		f1_arg1 = {}
	end
	return function ( f2_arg0, f2_arg1 )
		local f2_local0 = f2_arg0:IsButtonActive() or false
		LUI.FlowManager.RequestPopupMenu( nil, "PopupYesNo", true, f1_arg0, false, {
			title = Engine[0xED84C33EC5F01EA]( 0x8A4A35078AE58A3 ),
			message = Engine[0xED84C33EC5F01EA]( 0x9BCF970DF39775 ),
			yesAction = function ()
				local f3_local0 = nil
				if f2_arg0._data ~= nil and f2_arg0._data.itemId ~= nil then
					f3_local0 = f2_arg0._data.itemId
					if f2_arg0._data.quantity == nil or f2_arg0._data.quantity == 1 then
						f2_arg0:dispatchEventToCurrentMenu( {
							name = "remove_item_update_display",
							controller = f2_arg0,
							itemWidget = f2_arg0
						} )
					else
						f2_arg0._data.quantity = f2_arg0._data.quantity - 1
						f2_arg0:UpdateQuantityText( f2_arg0._data.quantity )
					end
					EXGM_UTILS.DestroyInstanceItemByLootId( f3_local0 )
				else
					return false
				end
			end
		} )
		return true
	end
	
end

