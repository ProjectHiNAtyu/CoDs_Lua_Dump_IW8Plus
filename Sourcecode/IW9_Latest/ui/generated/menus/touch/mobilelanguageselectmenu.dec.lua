-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
module( ..., package.seeall )
require( "ui.generated.widgets.wzm.mobilealtheader" )
require( "ui.generated.widgets.touch.mobilelanguagebutton" )
local f0_local0 = 4
local f0_local1 = 60 * _1080p
local f0_local2 = 36 * _1080p
local f0_local3 = 490 * _1080p
local f0_local4 = 72 * _1080p
local f0_local5 = function ( f9_arg0, f9_arg1 )
	local f9_local0 = Engine[0xEE6F69FEA944B13]()
	local f9_local1 = 0
	local f9_local2 = 0
	if not f9_arg1 then
		local f9_local3, f9_local4, f9_local5, f9_local6 = f9_local0.flowManager:getLocalRect()
		f9_local1 = f9_local5 - f9_local3
		f9_local2 = f9_local6 - f9_local4
	end
	local f9_local3 = f9_local0:getWidth() + f9_local1
	local f9_local4 = f9_arg0:GetAnchorsAndPosition()
	local f9_local5 = f9_local3 * f9_local4.leftAnchor + f9_local4.left
	local f9_local6 = f9_local3 * (1 - f9_local4.rightAnchor) + f9_local4.right
	local f9_local7 = f9_local0:getHeight() + f9_local2
	return f9_local5, f9_local7 * f9_local4.topAnchor + f9_local4.top, f9_local6, f9_local7 * (1 - f9_local4.bottomAnchor) + f9_local4.bottom
end

local f0_local6 = function ( f8_arg0, f8_arg1 )
	local f8_local0 = Engine[0xF35D89342CF7712]()
	local f8_local1 = Engine[0x961ADE0742DBB36]( f8_arg0 )
	for f8_local6, f8_local7 in pairs( f8_arg1 ) do
		local f8_local5 = nil
		if f8_local0 == f8_local7._language then
			if f8_local1 == f8_local7._language then
				f8_local5 = "SelectedAndActive"
			else
				f8_local5 = "Active"
			end
		elseif f8_local1 == f8_local7._language then
			f8_local5 = "Selected"
		else
			f8_local5 = "DefaultSequence"
		end
		ACTIONS.AnimateSequence( f8_local7, f8_local5 )
	end
end

local f0_local7 = function ( f2_arg0, f2_arg1, f2_arg2 )
	ACTIONS.ScaleFullscreen( f2_arg0 )
	local f2_local0 = {}
	f2_arg0:addEventHandler( "menu_create", function ( f4_arg0, f4_arg1 )
		local f4_local0, f4_local1, f4_local2, f4_local3 = f2_arg0( f2_arg0.GridPlaceHolder, true )
		local f4_local4 = (f4_local2 - f4_local0 - f2_arg0 * (f2_arg0 - 1)) / f2_arg0
		local f4_local5 = f4_local4 / f2_arg0 / f2_arg0
		local f4_local6 = 0
		local f4_local7 = 0
		local f4_local8 = 0
		local f4_local9 = Engine[0xF35D89342CF7712]()
		for f4_local10 = 0, #Languages - 1, 1 do
			if CDNI[0x9B02126D856BF77]( f4_local10 ) and not (Languages[f4_local10] == "LANGUAGE_ENGLISH_SAFE") then
				local f4_local13 = GetLanguageDisplayName( f4_local10 )
				local f4_local14 = MenuBuilder.BuildRegisteredType( "MobileLanguageButton", {
					controllerIndex = f2_arg0
				} )
				f4_local14:SetAnchorsAndPosition( 0, 1, 0, 1, f4_local6, f4_local6 + f4_local4, f4_local7, f4_local7 + f4_local5 )
				f4_local14.Text:setText( f4_local13 )
				f4_local14._language = f4_local10
				f4_local14:registerEventHandler( "button_action", function ( element, event )
					if f4_arg0 == Engine[0x961ADE0742DBB36]( f4_arg0 ) then
						
					else
						
					end
					local f5_local0 = {}
					if Engine[0x88FBC854CDE6C22]( f4_arg0 ) then
						local f5_local1 = Engine[0xE25E29D8ADE8F27]()
						f5_local0.title = Engine[0xED84C33EC5F01EA]( 0x1CCA5C59ECE1EA6 )
						local f5_local2 = Engine[0xED84C33EC5F01EA]
						local f5_local3
						if f5_local1 then
							f5_local3 = 0x3C4186909DA1F5A
							if not f5_local3 then
							
							else
								f5_local0.message = f5_local2( f5_local3 )
								f5_local0.yesAction = function ( f7_arg0, f7_arg1 )
									Engine[0x74FE0B006735E42]( f7_arg1, element )
									Engine[0xB81A5136C5503E4]( "updategamerprofile" )
									DCache[0xEA23CAA4B132C55]( element )
									if element then
										element( f7_arg1, element )
									else
										Engine[0x34C623E28A1C5E7]( "" )
									end
								end
								
							end
						end
						f5_local3 = 0x95AF8D24E168EF
					end
					if CONDITIONS.IsMobileDownloadMenuEnabled() then
						f5_local0.title = Engine[0xED84C33EC5F01EA]( 0xC04891B8A07645B )
						f5_local0.message = Engine[0xED84C33EC5F01EA]( 0x8A6494705E8E162 )
						f5_local0.yesAction = function ( f6_arg0, f6_arg1 )
							LUI.FlowManager.RequestLeaveMenuByName( "PopupYesNo", true )
							LUI.FlowManager.RequestAddMenu( "MobileCDNiDownloadMenu", false, f6_arg1, nil, {
								downloadLanguage = element
							}, true )
						end
						
						LUI.FlowManager.RequestPopupMenu( nil, "PopupYesNo", true, f4_arg0, false, f5_local0 )
						return 
					else
						
					end
				end )
				f2_arg0.GridPlaceHolder:addElement( f4_local14 )
				table.insert( f2_arg0, f4_local14 )
				f4_local8 = f4_local8 + 1
				f4_local6 = f4_local6 + f4_local4 + f2_arg0
				if f4_local8 % f2_arg0 == 0 then
					f4_local7 = f4_local7 + f4_local5 + f2_arg0
					f4_local6 = 0
				end
			end
		end
		f2_arg0( f2_arg0, f2_arg0 )
	end )
	MenuUtils.SubscribeToHealthAndArmorChanges( f2_arg0, f2_arg1, function ( f3_arg0 )
		if not LUI.PostGameManager.IsPostGame( f2_arg0 ) then
			LUI.FlowManager.RequestCloseAllMenus()
		end
	end )
end

function MobileLanguageSelectMenu( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "MobileLanguageSelectMenu"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local BG = nil
	
	BG = LUI.UIFixedAspectRatioImage.new()
	BG.id = "BG"
	BG:setImage( RegisterMaterial( 0xFB2FFBE1596F76F ), 0 )
	BG:setStretchedDimension( LUI.UIFixedAspectRatioImage.Dimensions.FILL_SCREEN )
	self:addElement( BG )
	self.BG = BG
	
	local GridPlaceHolder = nil
	
	GridPlaceHolder = LUI.UIElement.new()
	GridPlaceHolder.id = "GridPlaceHolder"
	GridPlaceHolder:SetAnchorsAndPosition( 0, 0, 0, 0, _1080p * 128, _1080p * -128, _1080p * 146, _1080p * -146 )
	self:addElement( GridPlaceHolder )
	self.GridPlaceHolder = GridPlaceHolder
	
	local MobileSettingsTopBar = nil
	
	MobileSettingsTopBar = MenuBuilder.BuildRegisteredType( "MobileAltHeader", {
		controllerIndex = f1_local1
	} )
	MobileSettingsTopBar.id = "MobileSettingsTopBar"
	MobileSettingsTopBar.MenuTitle:SetRight( _1080p * 753, 0 )
	MobileSettingsTopBar.MenuTitle:setText( Engine[0xED84C33EC5F01EA]( 0xFDF80C51AF7EB51 ), 0 )
	MobileSettingsTopBar:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, _1080p * 40, _1080p * 136 )
	self:addElement( MobileSettingsTopBar )
	self.MobileSettingsTopBar = MobileSettingsTopBar
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "MobileLanguageSelectMenu", MobileLanguageSelectMenu )
LockTable( _M )
