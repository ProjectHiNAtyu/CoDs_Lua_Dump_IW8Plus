-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
CRM = CRM or {}
CRM.DebugMessageContent = {
	action_title = nil,
	message_index = 0,
	item = "400246",
	action = "goto_ingame",
	content_long = "Purchase flavor text/description should go here. This message should only show as a worst-case scenario.",
	image = "mw_store_billboard_bronze_knight",
	action_location = "barracks",
	popup_image = "mw_store_billboard_bronze_knight",
	title = "Available Now!",
	layout_type = 0,
	checksum = "12345678",
	content_short = "Available Now!",
	location_id = 1,
	message_id = "1"
}
CRM.locations = {
	MP_MOTD = 1,
	CP_MOTD = 11,
	CS_NOTIFICATIONS = 10,
	BR_MOTD = 6,
	CP_MSGS = 12,
	BR_MSGS = 7,
	MP_MSGS = 2,
	STORE = 12,
	UNUSABLE = 0,
	PATCH_NOTES = 8,
	ENFORCEMENT_NOTIFICATIONS = 9
}
CRM.keys = {
	MESSAGE_INDEX = "message_index",
	ACTION_LOCATION = "action_location",
	STORE_ITEM = "item",
	LOCATION_ID = "location_id",
	IMAGE = "image",
	POPUP_IMAGE = "popup_image",
	FORCE_VIEW_TIME = "force_view_time",
	CHECKSUM = "checksum",
	TITLE = "title",
	END_DATE = "end_date",
	CONTENT_LONG = "content_long",
	CONTENT_SHORT = "content_short",
	MESSAGE_ID = "message_id",
	START_DATE = "start_date",
	ACTION = "action",
	LAYOUT_TYPE = "layout_type",
	ACTION_TITLE = "action_title"
}
CRM.viewTime = 10000
CRM.CSMessagesMax = 2
CRM.LayoutRegisteredTypes = {
	"CRMLayoutDefault",
	"CRMLayoutFullImage",
	"CRMLayoutBundle"
}
CRM.MessageQueue = {}
CRM.QueueMessage = function ( f77_arg0, f77_arg1 )
	table.insert( CRM.MessageQueue, {
		message = f77_arg0,
		controllerIndex = f77_arg1
	} )
end

CRM.SendQueuedMessages = function ()
	if 0 < #CRM.MessageQueue then
		
	else
		
	end
end

CRM.IsLocationMOTD = function ( f75_arg0 )
	local f75_local0
	if f75_arg0 ~= CRM.locations.MP_MOTD and f75_arg0 ~= CRM.locations.CP_MOTD and f75_arg0 ~= CRM.locations.BR_MOTD then
		f75_local0 = false
	else
		f75_local0 = true
	end
	return f75_local0
end

CRM.GetCurrentModeMOTDLocation = function ()
	if CONDITIONS.IsMagmaGameMode() then
		return CRM.locations.BR_MOTD
	elseif CONDITIONS.IsThirdGameMode() then
		return CRM.locations.CP_MOTD
	else
		return CRM.locations.MP_MOTD
	end
end

CRM.GetCurrentModeMOTDChecksumData = function ( f73_arg0 )
	local f73_local0 = PlayerData[0x8B73907B55C4D71]( f73_arg0, CoD.StatsGroup.NonGame )
	if CONDITIONS.IsMagmaGameMode() then
		return f73_local0.brMotdChecksum
	elseif CONDITIONS.IsThirdGameMode() then
		return f73_local0.cpMotdChecksum
	else
		return f73_local0.mpMotdChecksum
	end
end

CRM.TryForceOpenCRMWindow = function ( f72_arg0, f72_arg1, f72_arg2 )
	local f72_local0 = Engine[0x45B054C920178E9]()
	if Lobby[0x63537242F1D48FF]() and not Lobby[0x6957722EF74F5D2]() then
		return false
	elseif not Engine[0xAB2090771654DF5]( f72_local0 ) then
		return false
	elseif not f72_arg2 then
		f72_arg2 = 0
	end
	local f72_local1 = CRM.GetMessageData( f72_local0, f72_arg1, f72_arg2 )
	if f72_local1 then
		if CRM.IsLocationMOTD( f72_arg1 ) then
			local f72_local2 = PlayerData[0x8B73907B55C4D71]( f72_local0, CoD.StatsGroup.NonGame )
			local f72_local3 = CRM.GetCurrentModeMOTDChecksumData( f72_local0 )
			if not f72_local3 then
				return false
			end
			local f72_local4 = Dvar[0x9E5BE3B4BBA4E0E]( "#x3e8075e4ac5b3d2e5" )
			local f72_local5 = tonumber( f72_local1[CRM.keys.CHECKSUM] )
			if f72_local5 == tonumber( f72_local3:get() ) and not f72_local4 then
				return false
			else
				local f72_local6
				if f72_local1[CRM.keys.ACTION] ~= "goto_ingame" or f72_local1[CRM.keys.ACTION_LOCATION] ~= "store_item" then
					f72_local6 = false
				else
					f72_local6 = true
				end
			end
			if f72_local6 then
				local f72_local7, f72_local8 = STORE.GetIndexForBundle( f72_local1[CRM.keys.STORE_ITEM], f72_local0 )
				local f72_local9
				if f72_local7 then
					f72_local9 = f72_local7
				else
					f72_local9 = f72_local8
				end
				if not f72_local9 then
					return false
				end
			end
			f72_local3:set( f72_local5 )
			CRM.OpenCRMWindow( f72_arg0, true )
			return true
		elseif f72_arg1 == CRM.locations.ENFORCEMENT_NOTIFICATIONS or f72_arg1 == CRM.locations.CS_NOTIFICATIONS then
			local f72_local2 = CRM.GetMessageViewCountDatasource( f72_local1, f72_local0 )
			if 0 < (f72_local2:GetValue( f72_local0 ) or 0) then
				return false
			else
				CRM.OpenCRMWindow( f72_arg0, true, f72_local1 )
				return true
			end
		end
	end
end

CRM.OpenCRMWindow = function ( f71_arg0, f71_arg1, f71_arg2 )
	LUI.FlowManager.RequestPopupMenu( self, "CRMContainer", true, Engine[0x45B054C920178E9](), false, {
		sourceMenu = f71_arg0,
		forceOpen = f71_arg1,
		messageData = f71_arg2
	} )
end

CRM.GetMessageViewCountDatasource = function ( f70_arg0, f70_arg1 )
	return LUI.DataSourceInGlobalModel.new( "alwaysLoaded.CRM.views." .. (f70_arg0[CRM.keys.CHECKSUM] or "1") )
end

CRM.ViewMessage = function ( f69_arg0, f69_arg1 )
	local f69_local0 = CRM.GetMessageViewCountDatasource( f69_arg0, f69_arg1 )
	local f69_local1 = f69_local0:GetValue( f69_arg1 ) or 0
	CRM.QueueMessage( "markCRMMessageRead " .. f69_arg0.location_id .. " " .. f69_arg0.message_index, f69_arg1 )
	f69_local0:SetValue( f69_arg1, f69_local1 + 1 )
end

CRM.GetPatchNoteMessageData = function ()
	local f67_local0 = function ( f68_arg0 )
		local f68_local0 = {}
		for f68_local4 in string.gmatch( f68_arg0, "{%*section%*}(.-){/%*section%*}" ) do
			f68_local0[#f68_local0 + 1] = f68_local4
		end
		f68_local1 = {}
		for f68_local2 = 1, #f68_local0, 1 do
			table.insert( f68_local1, {
				title = string.match( f68_local0[f68_local2], "{%*title%*}(.-){/%*title%*}" ) or "",
				body = string.match( f68_local0[f68_local2], "{%*body%*}(.-){/%*body%*}" ) or ""
			} )
		end
		return f68_local1
	end
	
	local f67_local1 = Engine[0x45B054C920178E9]()
	local f67_local2 = {}
	local f67_local3 = CRM.locations.PATCH_NOTES
	local f67_local4 = Dvar[0x22EAAB59AA27E9B]( "#x3af6b2d203e318635" )
	for f67_local5 = 0, Engine[0x106A485E60BF393]( f67_local1, f67_local3 ), 1 do
		if #f67_local2 == f67_local4 then
			break
		end
		local f67_local8 = CRM.GetMessageData( f67_local1, f67_local3, f67_local5 )
		if f67_local8 then
			f67_local8[CRM.keys.CONTENT_LONG] = f67_local0( f67_local8[CRM.keys.CONTENT_LONG] )
			f67_local2[#f67_local2 + 1] = f67_local8
		end
	end
	return f67_local2
end

CRM.GetMessageContent = function ( f66_arg0, f66_arg1, f66_arg2 )
	if Dvar[0x9E5BE3B4BBA4E0E]( "#x3ede28fa3294fa750" ) then
		if CRM.IsLocationMOTD( f66_arg1 ) and f66_arg2 == 0 then
			return CRM.DebugMessageContent
		else
			return false
		end
	else
		local f66_local0 = Engine[0x6C7EBBD2539523D]( f66_arg0, f66_arg1, f66_arg2 )
		if f66_local0 then
			return f66_local0.message
		else
			return false
		end
	end
end

CRM.GetMenuMessageData = function ()
	local f64_local0 = Engine[0x45B054C920178E9]()
	local f64_local1, f64_local2 = nil
	if Engine[0xD151EC5B41223B5]() then
		if CONDITIONS.IsMagmaGameMode() then
			f64_local1 = CRM.locations.BR_MOTD
			f64_local2 = CRM.locations.BR_MSGS
		else
			f64_local1 = CRM.locations.MP_MOTD
			f64_local2 = CRM.locations.MP_MSGS
		end
	else
		f64_local1 = CRM.locations.CP_MOTD
		f64_local2 = CRM.locations.CP_MSGS
	end
	local f64_local3 = Engine[0x5CA33565A117BF3]( Store[0x5CA33565A117BF3]() )
	local f64_local4 = function ( f65_arg0 )
		local f65_local0
		if f65_arg0[CRM.keys.ACTION] ~= "goto_ingame" or f65_arg0[CRM.keys.ACTION_LOCATION] ~= "store_item" then
			f65_local0 = false
		else
			f65_local0 = true
		end
		if f65_local0 then
			local f65_local1, f65_local2 = STORE.GetIndexForBundle( f65_arg0[CRM.keys.STORE_ITEM], f64_local0, f64_local0 )
			local f65_local3
			if f65_local1 then
				f65_local3 = f65_local1
			else
				f65_local3 = f65_local2
			end
			if not f65_local3 then
				return false
			end
		end
		return true
	end
	
	local f64_local5 = {}
	local f64_local6 = CRM.GetMessageData( f64_local0, f64_local1, 0 )
	if f64_local6 and f64_local4( f64_local6 ) then
		f64_local6.index = #f64_local5
		table.insert( f64_local5, f64_local6 )
	end
	local f64_local7 = Dvar[0x22EAAB59AA27E9B]( "#x35171200c6cfca1d9" )
	for f64_local8 = 0, Engine[0x106A485E60BF393]( f64_local0, f64_local2 ), 1 do
		if #f64_local5 == f64_local7 then
			break
		end
		local f64_local11 = CRM.GetMessageData( f64_local0, f64_local2, f64_local8 )
		if f64_local11 and f64_local4( f64_local11 ) then
			f64_local11.index = #f64_local5
			table.insert( f64_local5, f64_local11 )
		end
	end
	return f64_local5
end

CRM.GetMessageData = function ( f63_arg0, f63_arg1, f63_arg2 )
	local f63_local0 = CRM.GetMessageContent( f63_arg0, f63_arg1, f63_arg2 )
	if not f63_local0 then
		return nil
	end
	f63_local0[CRM.keys.MESSAGE_ID] = f63_arg2
	f63_local0[CRM.keys.LOCATION_ID] = f63_arg1
	if not f63_local0[CRM.keys.LAYOUT_TYPE] then
		f63_local0[CRM.keys.LAYOUT_TYPE] = 0
	else
		f63_local0[CRM.keys.LAYOUT_TYPE] = tonumber( f63_local0[CRM.keys.LAYOUT_TYPE] )
	end
	if not f63_local0[CRM.keys.TITLE] or f63_local0[CRM.keys.TITLE] == "" then
		f63_local0[CRM.keys.TITLE] = Engine[0xED84C33EC5F01EA]( "LUA_MENU/MOTD_CAPS" )
	else
		f63_local0[CRM.keys.TITLE] = f63_local0[CRM.keys.TITLE]
	end
	if not f63_local0[CRM.keys.CONTENT_SHORT] then
		f63_local0[CRM.keys.CONTENT_SHORT] = ""
	else
		f63_local0[CRM.keys.CONTENT_SHORT] = f63_local0[CRM.keys.CONTENT_SHORT]
	end
	if not f63_local0[CRM.keys.CONTENT_LONG] then
		f63_local0[CRM.keys.CONTENT_LONG] = ""
	else
		f63_local0[CRM.keys.CONTENT_LONG] = f63_local0[CRM.keys.CONTENT_LONG]
	end
	if not f63_local0[CRM.keys.POPUP_IMAGE] then
		f63_local0[CRM.keys.POPUP_IMAGE] = f63_local0[CRM.keys.POPUP_IMAGE] or "mw_keyart"
	end
	if not f63_local0[CRM.keys.IMAGE] then
		f63_local0[CRM.keys.IMAGE] = f63_local0[CRM.keys.IMAGE] or "mw_keyart_small"
	end
	if f63_arg1 == CRM.locations.ENFORCEMENT_NOTIFICATIONS or f63_arg1 == CRM.locations.CS_NOTIFICATIONS then
		if not f63_local0[CRM.keys.FORCE_VIEW_TIME] then
			f63_local0[CRM.keys.FORCE_VIEW_TIME] = 5
		end
		f63_local0[CRM.keys.ACTION_TITLE] = nil
		f63_local0[CRM.keys.ACTION] = nil
	end
	if f63_local0[CRM.keys.ACTION] and 0 < #f63_local0[CRM.keys.ACTION] then
		if not f63_local0[CRM.keys.ACTION_TITLE] or f63_local0[CRM.keys.ACTION_TITLE] == "" then
			f63_local0[CRM.keys.ACTION_TITLE] = Engine[0xED84C33EC5F01EA]( "LUA_MENU/SELECT" )
		end
		local f63_local1 = CRM.actionFunctions[f63_local0[CRM.keys.ACTION]]
		if f63_local1 ~= nil then
			f63_local0.actionFunction = f63_local1( f63_arg0, f63_local0 )
		end
	end
	return f63_local0
end

CRM.OpenCRMWindows = function ( f61_arg0 )
	f61_arg0:saveState()
	f61_arg0.nextLocation = CRM.locations.ENFORCEMENT_NOTIFICATIONS
	local f61_local0 = nil
	f61_local0 = function ()
		if f61_arg0.nextLocation then
			local f62_local0 = CRM.TryForceOpenCRMWindow( f61_arg0, f61_arg0.nextLocation, f61_arg0.nextMessageIndex )
			if f61_arg0.nextLocation == CRM.locations.ENFORCEMENT_NOTIFICATIONS then
				f61_arg0.nextLocation = CRM.locations.CS_NOTIFICATIONS
				f61_arg0.nextMessageIndex = 0
			elseif f61_arg0.nextLocation == CRM.locations.CS_NOTIFICATIONS then
				if f61_arg0.nextMessageIndex + 1 == CRM.CSMessagesMax then
					f61_arg0.nextLocation = CRM.GetCurrentModeMOTDLocation()
					f61_arg0.nextMessageIndex = 0
				else
					f61_arg0.nextMessageIndex = f61_arg0.nextMessageIndex + 1
				end
			elseif CRM.IsLocationMOTD( f61_arg0.nextLocation ) then
				f61_arg0.nextLocation = nil
			end
			if not f62_local0 then
				f61_arg0()
			end
		end
	end
	
	f61_local0()
	f61_arg0:addEventHandler( "restore_focus", f61_local0 )
end

CRM.SetupBackButtonHandler = function ( f56_arg0, f56_arg1, f56_arg2, f56_arg3, f56_arg4 )
	if not f56_arg0.bindButton then
		local self = LUI.UIBindButton.new()
		self.id = "bindButton"
		f56_arg0:addElement( self )
		f56_arg0.bindButton = self
	end
	local self = function ()
		local f59_local0 = f56_arg0.bindButton
		local f59_local1 = f59_local0
		f59_local0 = f59_local0.addEventHandler
		f59_local0( f59_local1, "button_secondary", function ( f60_arg0, f60_arg1 )
			f59_local0._lastButtonPressed = "button_secondary"
			ACTIONS.LeaveMenu( f59_local0 )
		end )
	end
	
	if f56_arg2[CRM.keys.FORCE_VIEW_TIME] and f56_arg3 then
		local f56_local1 = tonumber( f56_arg2[CRM.keys.FORCE_VIEW_TIME] ) * 1000
		local f56_local2 = MenuBuilder.BuildRegisteredType( "UICountdown", {
			controllerIndex = f56_arg1
		} )
		f56_local2.id = "CountdownElement"
		f56_local2:SetFont( FONTS.GetFont( FONTS.MainLight.File ) )
		f56_local2:SetAlignment( LUI.Alignment.Right )
		f56_local2:setEndTime( Engine[0x6991337AE950F99]() + f56_local1 )
		f56_local2:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 96, _1080p * 296, _1080p * 931, _1080p * 979 )
		f56_arg0:addElement( f56_local2 )
		local f56_local3 = f56_arg0:Wait( f56_local1 )
		f56_local3.onComplete = function ()
			f56_arg0:closeTree()
			f56_arg0 = nil
			f56_arg0:AddButtonHelperText( {
				clickable = true,
				priority = 4294967286,
				side = "left",
				button_ref = "button_secondary",
				helper_text = Engine[0xED84C33EC5F01EA]( "MENU/BACK" )
			} )
			f56_arg0()
		end
		
	end
	f56_arg0:addEventHandler( "menu_create", function ( f57_arg0, f57_arg1 )
		f56_arg0:AddButtonHelperText( {
			clickable = true,
			priority = 4294967286,
			side = "left",
			button_ref = "button_secondary",
			helper_text = Engine[0xED84C33EC5F01EA]( "MENU/CLOSE" )
		} )
	end )
	self()
end

CRM.UpdateCRMData = function ( f55_arg0, f55_arg1, f55_arg2, f55_arg3, f55_arg4 )
	local f55_local0 = "markCRMMessageRead " .. f55_arg2 .. " " .. f55_arg3
	if f55_arg4 then
		CRM.QueueMessage( f55_local0, f55_arg1 )
	else
		Engine[0x7C75E608EA39B5C]( f55_local0, f55_arg1 )
	end
	f55_arg0:dispatchEventToRoot( {
		name = "update_crm_data",
		controllerIndex = f55_arg1
	} )
end

CRM.QueueReadMessage = function ( f54_arg0, f54_arg1, f54_arg2, f54_arg3 )
	CRM.QueueMessage( "markCRMMessageRead " .. f54_arg2 .. " " .. f54_arg3, f54_arg1 )
end

local f0_local0 = function ( f52_arg0, f52_arg1 )
	return function ( f53_arg0, f53_arg1 )
		Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f52_arg0[CRM.keys.LOCATION_ID], f52_arg0[CRM.keys.MESSAGE_ID], "goto_franchise_store", storeItem ), f52_arg0 )
		CRM.QueueReadMessage( f53_arg0, f52_arg0, f52_arg0[CRM.keys.LOCATION_ID], f52_arg0[CRM.keys.MESSAGE_INDEX] )
		local f53_local0 = f52_arg0[CRM.keys.STORE_ITEM]
		local f53_local1 = STORE.GoToStore
		local f53_local2 = f52_arg0
		local f53_local3 = f53_arg0:GetCurrentMenu()
		f53_local1( f53_local2, f53_local3.id, f53_arg0.id, f53_local0 )
	end
	
end

local f0_local1 = function ( f49_arg0, f49_arg1 )
	if PROGRESSION.IsUnlocked( f49_arg0, LOOT.itemTypes.FEATURE, LOOT.createAClassRef ) or CONDITIONS.IsDevelopmentBuild() then
		return function ( f50_arg0, f50_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f49_arg0[CRM.keys.LOCATION_ID], f49_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "loadouts" ), f49_arg0 )
			CRM.QueueReadMessage( f50_arg0, f49_arg0, f49_arg0[CRM.keys.LOCATION_ID], f49_arg0[CRM.keys.MESSAGE_INDEX] )
			return {
				tabToFocus = "MPWeaponMenu",
				buttonToFocus = "EditLoadoutButton",
				openMenuFunction = function ()
					LUI.FlowManager.RequestAddMenu( "LoadoutSelect", true, f50_arg0 )
				end
				
			}
		end
		
	else
		
	end
end

local f0_local2 = function ( f46_arg0, f46_arg1 )
	if 0 < #WEAPON.GetModifications( f46_arg0 ) or LUI.WebViewManager.MotdEnabled() then
		return function ( f47_arg0, f47_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f46_arg0[CRM.keys.LOCATION_ID], f46_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "armory" ), f46_arg0 )
			CRM.QueueReadMessage( f47_arg0, f46_arg0, f46_arg0[CRM.keys.LOCATION_ID], f46_arg0[CRM.keys.MESSAGE_INDEX] )
			return {
				tabToFocus = "MPWeaponMenu",
				buttonToFocus = "WeaponLockerButton",
				openMenuFunction = function ()
					LUI.FlowManager.RequestAddMenu( "WeaponLocker", true, f47_arg0, false, {
						armoryScreen = true
					}, false, true )
				end
				
			}
		end
		
	else
		
	end
end

local f0_local3 = function ( f43_arg0, f43_arg1 )
	if DataSources.frontEnd.lobby.isSolo:GetValue( f43_arg0 ) then
		return function ( f44_arg0, f44_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f43_arg0[CRM.keys.LOCATION_ID], f43_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "trials" ), f43_arg0 )
			CRM.QueueReadMessage( f44_arg0, f43_arg0, f43_arg0[CRM.keys.LOCATION_ID], f43_arg0[CRM.keys.MESSAGE_INDEX] )
			return {
				tabToFocus = "MPPlayMenu",
				buttonToFocus = "TrialsButton",
				openMenuFunction = function ()
					TRIALS.OpenTrialsMenu( f44_arg0, f44_arg0 )
				end
				
			}
		end
		
	else
		
	end
end

local f0_local4 = function ( f40_arg0, f40_arg1 )
	if CONDITIONS.IsTournamentModeAllowed( self ) and DataSources.frontEnd.lobby.isSolo:GetValue( f40_arg0 ) then
		return function ( f41_arg0, f41_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f40_arg0[CRM.keys.LOCATION_ID], f40_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "tournaments" ), f40_arg0 )
			CRM.QueueReadMessage( f41_arg0, f40_arg0, f40_arg0[CRM.keys.LOCATION_ID], f40_arg0[CRM.keys.MESSAGE_INDEX] )
			return {
				tabToFocus = "MPPlayMenu",
				buttonToFocus = "TournamentButton",
				openMenuFunction = function ()
					TOURNAMENT.OpenTournamentSignUp( f41_arg0 )
				end
				
			}
		end
		
	else
		
	end
end

local f0_local5 = function ( f38_arg0, f38_arg1 )
	if not CONDITIONS.IsWeGameGovBanned() then
		return function ( f39_arg0, f39_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f38_arg0[CRM.keys.LOCATION_ID], f38_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "barracks" ), f38_arg0 )
			CRM.QueueReadMessage( f39_arg0, f38_arg0, f38_arg0[CRM.keys.LOCATION_ID], f38_arg0[CRM.keys.MESSAGE_INDEX] )
			return {
				tabToFocus = "MPBarracksMenu"
			}
		end
		
	else
		
	end
end

local f0_local6 = function ( f36_arg0, f36_arg1 )
	if not CONDITIONS.IsWeGameGovBanned() and not Engine[0x757E77CA15D6B8F]( f36_arg0 ) then
		return function ( f37_arg0, f37_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f36_arg0[CRM.keys.LOCATION_ID], f36_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "challenges" ), f36_arg0 )
			CRM.QueueReadMessage( f37_arg0, f36_arg0, f36_arg0[CRM.keys.LOCATION_ID], f36_arg0[CRM.keys.MESSAGE_INDEX] )
			if CONDITIONS.AreChallengesEnabled() then
				return {
					tabToFocus = "ChallengeMenu"
				}
			else
				
			end
		end
		
	else
		
	end
end

local f0_local7 = function ( f34_arg0, f34_arg1 )
	return function ( f35_arg0, f35_arg1 )
		Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f34_arg0[CRM.keys.LOCATION_ID], f34_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "social" ), f34_arg0 )
		CRM.QueueReadMessage( f35_arg0, f34_arg0, f34_arg0[CRM.keys.LOCATION_ID], f34_arg0[CRM.keys.MESSAGE_INDEX] )
		if LUI.WebViewManager.MotdEnabled() then
			local f35_local0 = LUI.WebViewManager.Instance()
			f35_local0:RequestCloseFullScreen( true )
		else
			ACTIONS.LeaveMenu( f35_arg0 )
		end
		FRIENDS.OpenFriendsList( f34_arg0 )
	end
	
end

local f0_local8 = function ( f32_arg0, f32_arg1 )
	if CONDITIONS.IsStoreAllowed() and STORE.GetCategoryIndex( f32_arg1[CRM.keys.STORE_ITEM] ) ~= nil then
		return function ( f33_arg0, f33_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f32_arg0[CRM.keys.LOCATION_ID], f32_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "store" ), f32_arg0 )
			CRM.QueueReadMessage( f33_arg0, f32_arg0, f32_arg0[CRM.keys.LOCATION_ID], f32_arg0[CRM.keys.MESSAGE_INDEX] )
			return {
				tabToFocus = "MPStoreMenu",
				buttonToFocus = f32_arg0
			}
		end
		
	else
		
	end
end

local f0_local9 = function ( f30_arg0, f30_arg1 )
	if CONDITIONS.IsStoreAllowed() then
		return function ( f31_arg0, f31_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f30_arg0[CRM.keys.LOCATION_ID], f30_arg0[CRM.keys.MESSAGE_INDEX], "goto_ingame", "Store" ), f30_arg0 )
			CRM.QueueReadMessage( f31_arg0, f30_arg0, f30_arg0[CRM.keys.LOCATION_ID], f30_arg0[CRM.keys.MESSAGE_INDEX] )
			return {
				triggerButtonAction = true,
				tabToFocus = "MPStoreMenu",
				bundleToFocus = f30_arg0[CRM.keys.STORE_ITEM]
			}
		end
		
	else
		
	end
end

local f0_local10 = function ( f28_arg0, f28_arg1 )
	if CONDITIONS.IsBattlePassEnabled() then
		return function ( f29_arg0, f29_arg1 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f28_arg0[CRM.keys.LOCATION_ID], f28_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "battlepass" ), f28_arg0 )
			CRM.QueueReadMessage( f29_arg0, f28_arg0, f28_arg0[CRM.keys.LOCATION_ID], f28_arg0[CRM.keys.MESSAGE_INDEX] )
			return {
				tabToFocus = BATTLEPASS.GetBattlepassTabName()
			}
		end
		
	else
		
	end
end

local f0_local11 = function ( f26_arg0, f26_arg1 )
	return function ( f27_arg0, f27_arg1 )
		Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f26_arg0[CRM.keys.LOCATION_ID], f26_arg0[CRM.keys.MESSAGE_ID], "goto_ingame", "operators" ), f26_arg0 )
		CRM.QueueReadMessage( f27_arg0, f26_arg0, f26_arg0[CRM.keys.LOCATION_ID], f26_arg0[CRM.keys.MESSAGE_INDEX] )
		return {
			tabToFocus = "OperatorSelect"
		}
	end
	
end

local f0_local12 = function ( f24_arg0, f24_arg1 )
	if BATTLEPASS.IsOwned( f24_arg0 ) then
		local f24_local0 = LUI.FlowManager.GetScopedData( "MainMenu" )
		f24_local0.returnToMainMenu = true
		local f24_local1 = f0_local0
		local f24_local2 = f24_arg0
		local f24_local3 = f24_arg1
		return 
	else
		local f24_local0 = f0_local0( f24_arg0, f24_arg1 )
		return function ( f25_arg0, f25_arg1 )
			local f25_local0 = LUI.FlowManager.GetScopedData( "MainMenu" )
			f25_local0.crmPurchaseBattlePass = true
			return f24_arg0( f25_arg0, f25_arg1 )
		end
		
	end
end

local f0_local13 = function ( f23_arg0, f23_arg1 )
	assert( f23_arg1[CRM.keys.ACTION_LOCATION] )
	local f23_local0 = CRM.LocationFunctions[f23_arg1[CRM.keys.ACTION_LOCATION]]
	if f23_arg1[CRM.keys.ACTION_LOCATION] == "franchise_store" and f23_arg1[CRM.keys.STORE_ITEM] then
		f23_local0 = CRM.LocationFunctions.franchise_store_item
	end
	if f23_local0 ~= nil then
		return f23_local0( f23_arg0, f23_arg1 )
	else
		
	end
end

local f0_local14 = function ( f21_arg0, f21_arg1 )
	assert( f21_arg1[CRM.keys.ACTION_LOCATION] )
	local f21_local0 = f21_arg1[CRM.keys.ACTION_LOCATION]
	if f21_local0 and 0 < #f21_local0 then
		return function ( f22_arg0, f22_arg1 )
			Engine[0xA265A859B7C189E]( f22_arg1.controller, WebBrowserType.FULLSCREEN, f21_arg0 )
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f21_arg0[CRM.keys.LOCATION_ID], f21_arg0[CRM.keys.MESSAGE_ID], "goto_url", f21_arg0 ), f22_arg1.controller )
			CRM.QueueReadMessage( f22_arg0, f22_arg1.controller, f21_arg0[CRM.keys.LOCATION_ID], f21_arg0[CRM.keys.MESSAGE_INDEX] )
			CRM.UpdateCRMData( f22_arg0, f22_arg1.controller, f21_arg0[CRM.keys.LOCATION_ID], f21_arg0[CRM.keys.MESSAGE_ID] )
		end
		
	else
		
	end
end

MenuBuilder.registerType( "RegisteringEmailPopup", function ( f18_arg0, f18_arg1 )
	local f18_local0 = MenuBuilder.BuildRegisteredType( "FenceDialogPopup", {
		messageText = Engine[0xED84C33EC5F01EA]( "LUA_MENU_MP/REGISTERING_EMAIL" ),
		controllerIndex = f18_arg1.controllerIndex
	} )
	f18_local0.id = "RegisteringEmailPopup"
	f18_local0:addEventHandler( "registration_success", function ( f20_arg0, f20_arg1 )
		Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f18_arg0.locationIndex, f18_arg0.messageID, "register", "registration_success" ), f18_arg0.controllerIndex )
		CRM.UpdateCRMData( f20_arg0, f18_arg0.controllerIndex, f18_arg0.locationIndex, f18_arg0.messageIndex, false )
		LUI.FlowManager.RequestLeaveMenu( f20_arg0 )
	end )
	f18_local0:addEventHandler( "registration_error", function ( f19_arg0, f19_arg1 )
		Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f18_arg0.locationIndex, f18_arg0.messageID, "register", "registration_error" ), f18_arg0.controllerIndex )
		LUI.FlowManager.RequestLeaveMenu( f19_arg0 )
		LUI.FlowManager.RequestPopupMenu( f19_arg0, "MessagePopup", true, f18_arg0.controllerIndex, {
			messageText = Engine[0xED84C33EC5F01EA]( "LUA_MENU_MP/REGISTRATION_FAILED" )
		} )
	end )
	return f18_local0
end )
local f0_local15 = function ( f15_arg0, f15_arg1 )
	return function ( f16_arg0, f16_arg1 )
		OSK[0xC1C15C14B75864C]( f15_arg0, Engine[0xED84C33EC5F01EA]( "LUA_MENU_MP/REGISTER_EMAIL" ), "", 128, false, false, false, function ( f17_arg0, f17_arg1, f17_arg2 )
			if f17_arg1 then
				LUI.FlowManager.RequestPopupMenu( f16_arg0, "RegisteringEmailPopup", true, f17_arg0, false, {
					messageID = f16_arg0[CRM.keys.MESSAGE_ID],
					messageIndex = f16_arg0[CRM.keys.MESSAGE_INDEX],
					locationIndex = f16_arg0[CRM.keys.LOCATION_ID]
				} )
				Engine[0x5F6068BE979AB1F]( f17_arg0, f17_arg1 )
			end
		end )
	end
	
end

local f0_local16 = function ( menu, controller )
	local self = LUI.UIElement.new()
	self:addEventHandler( "menu_create", function ( f14_arg0, f14_arg1 )
		local f14_local0 = menu( menu.controllerIndex, {
			content_long = "KentRocks"
		} )
		f14_local0( f14_arg0 )
		LUI.FlowManager.RequestLeaveMenu( f14_arg0 )
	end )
	return self
end

if Engine[0x2DA54CF5D6B7F02]() then
	MenuBuilder.registerType( "RegisterTestPopup", f0_local16 )
end
MenuBuilder.registerType( "RedeemCRMMessagePopup", function ( f10_arg0, f10_arg1 )
	local f10_local0 = {
		messageText = Engine[0xED84C33EC5F01EA]( "LUA_MENU_MP/REDEEM_CRM_CODE" ),
		controllerIndex = f10_arg1.controllerIndex
	}
	local f10_local1 = false
	local f10_local2 = MenuBuilder.BuildRegisteredType( "FenceDialogPopup", f10_local0 )
	f10_local2.id = "RedeemCRMMessagePopup"
	f10_local2:addEventHandler( "redemption_success", function ( f12_arg0, f12_arg1 )
		LUI.FlowManager.RequestLeaveMenu( f12_arg0 )
		Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f10_arg0.locationIndex, f10_arg0.messageID, "redeem", "redemption_success" ), f10_arg0.controllerIndex )
		CRM.UpdateCRMData( f12_arg0, f10_arg0.controllerIndex, f10_arg0.locationIndex, f10_arg0.messageIndex, f10_arg0 )
		LUI.FlowManager.RequestPopupMenu( f12_arg0, "CodeRedemptionSuccessPopup", true, f10_arg0.controllerIndex )
	end )
	f10_local2:addEventHandler( "redemption_failed", function ( f11_arg0, f11_arg1 )
		LUI.FlowManager.RequestLeaveMenu( f11_arg0 )
		if f11_arg1.errorAlreadyRedeemed then
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f10_arg0.locationIndex, f10_arg0.messageID, "redeem", "redemption_failed_already_redeemed" ), f10_arg0.controllerIndex )
			CRM.UpdateCRMData( f11_arg0, f10_arg0.controllerIndex, f10_arg0.locationIndex, f10_arg0.messageIndex, f10_arg0 )
			LUI.FlowManager.RequestPopupMenu( f11_arg0, "CodeAlreadyRedeemedPopup", true, f10_arg0.controllerIndex )
		elseif f11_arg1.errorCodeExpired then
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f10_arg0.locationIndex, f10_arg0.messageID, "redeem", "redemption_failed_code_expired" ), f10_arg0.controllerIndex )
			CRM.UpdateCRMData( f11_arg0, f10_arg0.controllerIndex, f10_arg0.locationIndex, f10_arg0.messageIndex, f10_arg0 )
			LUI.FlowManager.RequestPopupMenu( f11_arg0, "CodeExpiredPopup", true, f10_arg0.controllerIndex )
		else
			Engine[0x7C75E608EA39B5C]( string.format( "clickCRMMessageAction %d %d %s %s", f10_arg0.locationIndex, f10_arg0.messageID, "redeem", "redemption_failed" ), f10_arg0.controllerIndex )
			LUI.FlowManager.RequestPopupMenu( f11_arg0, "CodeRedemptionFailedPopup", true, f10_arg0.controllerIndex )
		end
	end )
	return f10_local2
end )
local f0_local17 = function ( f8_arg0, f8_arg1 )
	return function ( f9_arg0, f9_arg1 )
		if LUI.WebViewManager.MotdEnabled() then
			local f9_local0 = LUI.WebViewManager.Instance()
			f9_local0:RequestCloseFullScreen( true )
		else
			LUI.FlowManager.RequestLeaveMenu( f9_arg0 )
		end
		Engine[0x5B9DB8CF06C2366]( f8_arg0, f8_arg0[CRM.keys.LOCATION_ID], f8_arg0[CRM.keys.MESSAGE_INDEX] )
	end
	
end

local f0_local18 = function ( f7_arg0, f7_arg1 )
	return CRM.PrerequisiteStatus.READY
end

local f0_local19 = function ( f6_arg0, f6_arg1 )
	local f6_local0 = InGameStore.GetCatalogStatus( f6_arg0 )
	if f6_local0 == InGameStoreCatalogStatus.READY then
		return CRM.PrerequisiteStatus.READY
	elseif f6_local0 == InGameStoreCatalogStatus.ERROR then
		return CRM.PrerequisiteStatus.ERROR
	else
		return CRM.PrerequisiteStatus.PREPARING
	end
end

local f0_local20 = function ( f5_arg0, f5_arg1 )
	if #WEAPON.GetModifications( f5_arg0 ) == 0 then
		return CRM.PrerequisiteStatus.ERROR
	else
		return CRM.PrerequisiteStatus.READY
	end
end

local f0_local21 = function ( f4_arg0, f4_arg1 )
	
end

local f0_local22 = function ( f3_arg0, f3_arg1 )
	InGameStore.FetchCatalog( f3_arg0, true, false )
end

CRM.InitPopupWindow = function ( f1_arg0, f1_arg1, f1_arg2 )
	assert( f1_arg1 )
	assert( f1_arg2.locationIndex )
	assert( f1_arg2.messageIndex )
	assert( f1_arg2.layoutType )
	local f1_local0 = Engine[0x45B054C920178E9]()
	local f1_local1 = MenuBuilder.BuildRegisteredType( CRM.LayoutRegisteredTypes[f1_arg2.layoutType], {
		controllerIndex = f1_local0
	} )
	if f1_arg2 then
		f1_local1.CRMLastMessageIndex = f1_arg2.messageIndex
		f1_local1.CRMLastLocationIndex = f1_arg2.locationIndex
		f1_local1.CRMForceOpen = f1_arg2.forceOpen
	end
	CRM.SetupBackButtonHandler( f1_local1, f1_local0, f1_arg1, f1_arg2.forceOpen, f1_arg0 )
	f1_local1:SetupContent( f1_local0, f1_arg1 )
	f1_local1:addEventHandler( "menu_close", function ( f2_arg0, f2_arg1 )
		if not f1_arg0.action or f1_arg0.action ~= "redeem" then
			CRM.UpdateCRMData( f2_arg0, f1_arg0, f1_arg0.CRMLastLocationIndex, f1_arg0.CRMLastMessageIndex, true )
		end
	end )
	return f1_local1
end

CRM.actionFunctions = {
	goto_ingame = f0_local13,
	goto_franchise_store = f0_local0,
	goto_url = f0_local14,
	register = f0_local15,
	redeem = f0_local17,
	battlepass_tier_gift = f0_local12
}
CRM.LocationFunctions = {
	store = f0_local8,
	store_item = f0_local9,
	social = f0_local7,
	loadouts = f0_local1,
	armory = f0_local2,
	trials = f0_local3,
	tournaments = f0_local4,
	barracks = f0_local5,
	challenges = f0_local6,
	battlepass = f0_local10,
	operators = f0_local11
}
CRM.PrerequisiteStatus = {
	COUNT = 3,
	READY = 2,
	PREPARING = 1,
	ERROR = 0
}
CRM.PrerequisiteFunctions = {
	store = f0_local18,
	store_item = f0_local19,
	social = f0_local18,
	loadouts = f0_local18,
	armory = f0_local20,
	trials = f0_local18,
	tournaments = f0_local18,
	barracks = f0_local18,
	challenges = f0_local18,
	battlepass = f0_local18,
	operators = f0_local18,
	goto_url = f0_local18
}
CRM.PrerequisiteActionFunctions = {
	store = f0_local21,
	store_item = f0_local22,
	social = f0_local21,
	loadouts = f0_local21,
	armory = f0_local21,
	trials = f0_local21,
	tournaments = f0_local21,
	barracks = f0_local21,
	challenges = f0_local21,
	battlepass = f0_local21,
	operators = f0_local21
}
