-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.mainmenutabs" )
require( "ui.generated.widgets.frontend.social.socialpartywidget" )
require( "ui.generated.widgets.frontend.cp.cpcheckpointwidget" )
require( "ui.generated.widgets.frontend.aar.aarflyoutbase" )
local f0_local0 = nil
local f0_local1 = function ( f24_arg0, f24_arg1 )
	return f0_local0( f24_arg0, f24_arg1 )
end

LUI.FlowManager.RequestSetStack( "PrivateMatchLobby", {
	{
		name = "MainLockoutMenu"
	},
	{
		name = "MainMenu"
	},
	{
		name = "MPMainMenu"
	}
} )
LUI.FlowManager.RegisterFenceGroup( "PrivateMatchLobby", {
	nil,
	"premium",
	"onlineServiceSubscription",
	"scenarioMissing",
	"scenarioInstalling",
	"mp"
} )
LUI.FlowManager.RegisterPreNavGroup( "PrivateMatchLobby", {
	nil,
	"premium",
	"scenarioMissing",
	"premiumPartyMembers",
	"scenarioMissingPartyMembers"
} )
MenuBuilder.registerType( "CPPrivateMatchLobby", f0_local1 )
LUI.FlowManager.RequestSetStack( "CPPrivateMatchLobby", {
	{
		name = "MainLockoutMenu"
	},
	{
		name = "MainMenu"
	},
	{
		name = "CPMainMenu"
	}
} )
MenuBuilder.registerType( "PrivateTournamentLobby", function ( f23_arg0, f23_arg1 )
	f23_arg1.isTournament = true
	return f0_local0( f23_arg0, f23_arg1 )
end )
LUI.FlowManager.RequestSetStack( "PrivateTournamentLobby", {
	{
		name = "MainLockoutMenu"
	},
	{
		name = "MainMenu"
	},
	{
		name = "MPMainMenu"
	}
} )
LUI.FlowManager.RegisterFenceGroup( "PrivateTournamentLobby", {
	nil,
	"scenarioMissing",
	"scenarioInstalling",
	"mp"
} )
local f0_local2 = "frontEnd.MP.privateLobby"
local f0_local3 = function ( f20_arg0 )
	if not CONDITIONS.IsPrivatePartyHost() or CONDITIONS.IsSystemLink() then
		
	end
	local f20_local0 = Engine[0xF16311E3FCA3DCF]()
	if not f20_local0 then
		f20_local0 = tonumber( Engine[0x3B8CFB6758EF57C]() )
	end
	DataSources.frontEnd.lobby.privateMatchTimeoutTimeRemaining:SetValue( nil, -1 )
	local f20_local1 = f20_local0 + (Dvar[0x22EAAB59AA27E9B]( 0xEC0D1C74B202BF4 ) or 900000) / 1000 - 2
	local f20_local2 = function ( f21_arg0 )
		return function ()
			local f22_local0 = Engine[0xF16311E3FCA3DCF]()
			if not f22_local0 then
				f22_local0 = tonumber( Engine[0x3B8CFB6758EF57C]() )
			end
			local f22_local1
			if f22_local0 < f21_arg0 then
				f22_local1 = (f21_arg0 - f22_local0) * 1000
				if not f22_local1 then
				
				else
					if f22_local1 == 0 then
						f21_arg0:RemoveEventTimer( "lobby_timeout_timer" )
						DataSources.frontEnd.lobby.privateMatchTimeoutTimeRemaining:SetValue( nil, -1 )
						return 
					elseif f22_local1 <= (Dvar[0x22EAAB59AA27E9B]( 0x1A5B0FD96A7C817 ) or -1) then
						DataSources.frontEnd.lobby.privateMatchTimeoutTimeRemaining:SetValue( nil, f22_local1 )
					end
				end
			end
			f22_local1 = 0
		end
		
	end
	
	if (Dvar[0x22EAAB59AA27E9B]( 0x1A5B0FD96A7C817 ) or -1) ~= -1 then
		f20_arg0:CreateEventTimer( "lobby_timeout_timer", 1000, {
			immediate = true,
			callbackFunc = f20_local2( f20_local1 )
		} )
	end
end

local f0_local4 = function ()
	local f18_local0 = LUI.FlowManager.GetScopedData( "PrivateMatchLobby" )
	if not f18_local0 or f18_local0.privateMatchSetupSubscription then
		
	end
	local f18_local1 = LUI.GetRoot()
	local f18_local2 = f18_local1:GetControllerIndex()
	local f18_local3 = LUI.DataSourceInGlobalModel.new( "frontEnd.lobby.isPrivateMatchLobbySetup" )
	f18_local0.privateMatchSetupSubscription = f18_local1:SubscribeToModel( f18_local3:GetModel( f18_local2 ), function ( f19_arg0 )
		if DataModel[0x614D394F6F9A18D]( f19_arg0 ) then
			local f19_local0 = f18_local0
			if f19_local0.modeInfo and not BuiltInEsports[0x9894ED459E76619]() then
				if not Dvar[0x9E5BE3B4BBA4E0E]( 0x8653010D584AA6E ) then
					LUI.Commands.GameSetup.SetupMode:Execute( f18_local0, f19_local0.modeInfo.ref, f19_local0.modeInfo.category, true )
				else
					LUI.Commands.GameSetup.SetupMode:Execute( f18_local0, GameType.BundleGetName( f19_local0.modeInfo.bundle ), GameType.BundleGetCategory( f19_local0.modeInfo.bundle ), true )
				end
			end
			f18_local0( f18_local0 )
		end
	end )
end

local f0_local5 = function ()
	local f17_local0 = LUI.FlowManager.GetScopedData( "PrivateMatchLobby" )
	if f17_local0 and f17_local0.privateMatchSetupSubscription then
		local f17_local1 = LUI.GetRoot()
		f17_local1:UnsubscribeFromModel( f17_local0.privateMatchSetupSubscription )
		f17_local0.privateMatchSetupSubscription = nil
		f17_local1:RemoveEventTimer( "lobby_timeout_timer" )
		DataSources.frontEnd.lobby.privateMatchTimeoutTimeRemaining:SetValue( nil, -1 )
	end
end

local f0_local6 = function ()
	if CONDITIONS.IsCoreMultiplayer() then
		f0_local0()
	elseif CONDITIONS.IsThirdGameMode() then
		Dvar[0xE3CB005036E0C0F]( 0x3BD81F4A278E5DC, "none" )
	end
	Dvar[0x8EA06EEDB58D872]( 0x85EF1ED1D39D3A3, true )
end

LUI.FlowManager.RegisterStackPushBehaviour( "PrivateMatchLobby", f0_local6 )
LUI.FlowManager.RegisterStackPushBehaviour( "CPPrivateMatchLobby", f0_local6 )
LUI.FlowManager.RegisterStackPopBehaviour( "PrivateMatchLobby", function ()
	f0_local0()
	WipeGlobalModelsAtPath( f0_local0 )
	PRIVATE_MATCH.RemoveBotsByGameSetup()
	MLG.ResetMatchRulesData()
	Dvar[0x8EA06EEDB58D872]( 0x85EF1ED1D39D3A3, false )
end )
LUI.FlowManager.RegisterStackPopBehaviour( "CPPrivateMatchLobby", function ()
	Lobby.LeaveCustomGameLobby()
end )
local f0_local7 = function ( f13_arg0, f13_arg1 )
	MP_COMMON.SetupParty( "Opening PrivateMatchMenu" )
	MP_COMMON.SetupPrivateMatchParty()
	Lobby[0x2043FF221ED6A77]( f13_arg0._isCoreMultiplayer and PartyUIRoot.MP_PRIVATE_MATCH or PartyUIRoot.CP_PRIVATE_MATCH )
	Engine[0x569F3C409C4E3CD]( CoD.PresenceContext.LOBBY )
	if BuiltInEsports[0x9894ED459E76619]() and Dvar[0x9E5BE3B4BBA4E0E]( 0x23AA3D47406905E ) and not Dvar[0x9E5BE3B4BBA4E0E]( 0x2FE41F01E7F6E6D ) then
		BuiltInEsports[0x2E17D9CE77E6F6]( f13_arg1 )
	end
	PRIVATE_MATCH.SetupMatchmakingOnStart( f13_arg1 )
end

local f0_local8 = function ( f12_arg0, f12_arg1 )
	if Game[0x6DD1B6FF7A0A975]( f12_arg1 ) == true then
		if isAliensSolo() then
			PostGameFanfare:start()
		elseif CONDITIONS.ShowAARScoreboardAfterPrivateMatch() then
			Lobby.OpenAfterActionReport( f12_arg1, false, Engine[0xCA085C21FCBD7CA]() )
		end
		Game[0x16DC23DB3DC4FD1]( f12_arg1 )
	end
end

local f0_local9 = function ( f11_arg0, f11_arg1, f11_arg2 )
	Dvar[0x8EA06EEDB58D872]( 0x85EF1ED1D39D3A3, true )
	PRIVATE_MATCH.SetupPrivateMatchGameType( Enum[0x3085A67688502CD][0x1091163476EE813] )
	local f11_local0 = LUI.FlowManager.GetScopedData( f11_arg0 )
	if f11_arg2.isTournament then
		f11_local0.isTournament = true
	end
end

local f0_local10 = function ( f9_arg0, f9_arg1 )
	local f9_local0 = f9_arg1.controller
	if not f9_local0 then
		f9_local0 = Engine[0x45B054C920178E9]()
	end
	f9_arg0.MainMenuTabs:SetupTabs( f9_local0, {
		tabLayout = CONDITIONS.IsCoreMultiplayer() and MAINMENUTABS.Layouts.PrivateMatchLobby or MAINMENUTABS.Layouts.CPPrivateMatchLobby
	} )
	f9_arg0.MainMenuTabs:SetOnLeaveCallback( function ( f10_arg0, f10_arg1 )
		LUI.FlowManager.RequestPopupMenu( f9_arg0, "leave_private_mp_lobby", true, f9_arg0, false, {
			menu = f9_arg0,
			moveUI = false
		} )
		return true
	end )
	local f9_local1 = LUI.FlowManager.GetScopedData( f9_arg0 )
	if not BuiltInEsports[0x9894ED459E76619]() then
		PRIVATE_MATCH.SetDefaultMatchRules( {
			isTournament = f9_local1.isTournament
		} )
	end
	if CONDITIONS.IsThirdGameMode() then
		CP.ClearWaveLoadout( f9_local0 )
		CP.ClearAllPickupMunitions( f9_local0 )
	end
	LOADOUT.CheckOverkillLoadoutSetup( f9_local0 )
end

local f0_local11 = function ( f7_arg0 )
	local self = LUI.UITimer.new( {
		interval = 500,
		event = "check_dmz"
	} )
	f7_arg0:addElement( self )
	self:registerEventHandler( "check_dmz", function ()
		if not MatchRules[0x1A6D0B2E15DF8CF]() then
			return 
		end
		local f8_local0 = MatchRules[0x3A9F1F51625857F]( "subGametype" )
		if f8_local0 == "dmz" and not f7_arg0._execDMZCFG then
			Engine[0xB81A5136C5503E4]( "exec br_dmz_offline.cfg" )
			f7_arg0._execDMZCFG = true
		elseif f8_local0 ~= "dmz" and f7_arg0._execDMZCFG then
			f7_arg0._execDMZCFG = false
		end
	end )
end

local f0_local12 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0._isCoreMultiplayer = CONDITIONS.IsCoreMultiplayer()
	local f2_local0 = MAINMENUTABS.GetTabIndexFromName
	local f2_local1 = f2_arg1
	local f2_local2
	if CONDITIONS.IsCoreMultiplayer() then
		f2_local2 = "PrivateMatchLobby"
	else
		f2_local2 = "CPPrivateMatchLobby"
	end
	f2_arg0._battlePassMenuIndex = f2_local0( f2_local1, f2_local2, "BattlePassMenu" )
	Dvar[0x8EA06EEDB58D872]( 0x2B7DA075887F96F, false )
	LUI.DeferredFence.Attach( f2_arg0, Engine[0xF13D4623D3F6D4E]( 0 ), "CLIENT_CONNECT", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f6_arg0, f6_arg1 )
		local f6_local0 = LUI.FlowManager.GetScopedData( f6_arg0 )
		if not f6_local0.streamingSetup and f6_arg1.fenceState == LUI.Fence.FenceObjectState.PASSING then
			MP_COMMON.SetupStreaming( f2_arg0, f2_arg0 )
			GUNSMITH.InitLoadoutBaseWeaponPartsAttachment( f2_arg0 )
			f6_local0.streamingSetup = true
		end
	end )
	if currentGameModeKey ~= Enum[0xAC7E3CE067D9A9F][0x8A64607B54DF055] and currentGameModeKey ~= Enum[0xAC7E3CE067D9A9F][0x8A94A07B5502CF8] then
		GameModesUtils.StartGameMode( Enum[0xAC7E3CE067D9A9F][0x8A94A07B5502CF8] )
	end
	f2_arg0:CreateEventTimer( PRIVATE_MATCH.MATCH_REFRESH_DELAY_NAME, PRIVATE_MATCH.MATCH_REFRESH_DELAY, {
		immediate = false,
		callbackFunc = function ( f5_arg0, f5_arg1 )
			f2_arg0( f2_arg0, f2_arg0 )
			f5_arg0:RemoveEventTimer( PRIVATE_MATCH.MATCH_REFRESH_DELAY_NAME )
			return true
		end
	} )
	PRIVATE_MATCH.SetupPrivateMatchMusic( f2_arg0, f2_arg1 )
	f0_local0( f2_arg0, f2_arg1 )
	f2_arg0:addEventHandler( "menu_create", f0_local0 )
	f2_local0 = LUI.FlowManager.GetScopedData( f2_arg0 )
	if f2_arg2.isTournament and not f2_local0.matchmakerSettings then
		f2_local0.matchmakerSettings = LUI.DeepCopy( Lobby.DEFAULT_PRIVATE_TOURNAMENT )
	end
	if f2_local0.playIntroCharacterAnimations == nil then
		f2_local0.playIntroCharacterAnimations = true
	end
	if Engine[0x2DA54CF5D6B7F02]() then
		f0_local0( f2_arg0 )
	end
	Streaming[0xE493C1B436663F6]( true )
	Lobby.PreloadViewHandsForLocalPlayer( f2_arg1 )
	f2_arg0:addEventHandler( "match_info_update", function ( f4_arg0, f4_arg1 )
		local f4_local0 = LUI.FlowManager.GetScopedData( f2_arg0 )
		f4_local0.esportsLobbyMatchInfoButtonData = f4_arg1.data
	end )
	f2_arg0:addEventHandler( "match_rules_update", function ( f3_arg0, f3_arg1 )
		Dvar[0x8EA06EEDB58D872]( 0xE0F18CF521DF1EF, MatchRules[0x3A9F1F51625857F]( Lobby.MatchRulesClasses.CommonOption, Lobby.MatchRulesMembers.FriendlyOutlineEnabled ) )
		Dvar[0x8EA06EEDB58D872]( 0x555EF7F98D8AA6, MatchRules[0x3A9F1F51625857F]( Lobby.MatchRulesClasses.CommonOption, Lobby.MatchRulesMembers.EnemyOutlineEnabled ) )
	end )
end

MenuBuilder.registerType( 0x23B61144B840FC3, function ( f1_arg0, f1_arg1 )
	local f1_local0 = CONDITIONS
	local f1_local1 = LUI
	local f1_local2 = MenuBuilder
	local f1_local3 = f1_local1.UIHorizontalNavigatorMenu.new()
	f1_local3.id = "PrivateMatchLobby"
	local f1_local4
	if f1_arg1 then
		f1_local4 = f1_arg1
	else
		f1_local4 = f1_arg1.controllerIndex
	end
	f1_local4 = f1_local1.ValidateControllerIndex( f1_local3, f1_local4 )
	f0_local0( f1_local3, f1_local4, f1_arg1 )
	f1_local3[0x4C364FC7CAA3C92] = f1_local2.BuildRegisteredType( 0x8608EBDC1924A2E, {
		controllerIndex = f1_local4
	} )
	f1_local3[0x4C364FC7CAA3C92][0x8B72E07B55C3AC0] = "HelperBar"
	if f1_local0.IsMobileOrMobileSim() then
		f1_local3[0x4C364FC7CAA3C92]:SetAnchorsAndPosition( 1, 0, 0, 0, -120, 0, 0, 0 )
	else
		f1_local3[0x4C364FC7CAA3C92]:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, -115, -30 )
	end
	f1_local3[0x4C364FC7CAA3C92]:setPriority( 10 )
	f1_local3:addElement( f1_local3[0x4C364FC7CAA3C92] )
	local f1_local5 = f1_local3
	local f1_local6 = nil
	f1_local6 = f1_local1.UIImage.new()
	f1_local6[0x8B72E07B55C3AC0] = "Vignette"
	ACTIONS.AspectRatioScaleAdjustment( f1_local3, f1_local6, LAYOUT.AspectRatioImageScalePct.FADEFRAME_LARGE )
	f1_local6:SetRGB( SWATCHES[0x1F5A9ABAC207F9D][0x8088E72737CAC80], 0 )
	f1_local6:setImage( RegisterMaterial( 0x3A8F29C0EC8E46E ), 0 )
	f1_local6:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, -346, 0 )
	f1_local3:addElement( f1_local6 )
	f1_local3[0xC004DDB3E0372D3] = f1_local6
	local f1_local7 = nil
	f1_local7 = f1_local2.BuildRegisteredType( 0x4B3ACF19C88894F, {
		controllerIndex = f1_local4
	} )
	f1_local7[0x8B72E07B55C3AC0] = "MainMenuTabs"
	f1_local7[0x93CC4E91B38D10C][0x5CC7CCDAE9F0D74]:setText( Engine[0xED84C33EC5F01EA]( 0x2567E6A6F5075A4 ), 0 )
	f1_local7:SetAnchorsAndPosition( 0.5, 0.5, 0, 0, -960, 960, 0, 0 )
	f1_local3:addElement( f1_local7 )
	f1_local3[0x4B3ACF19C88894F] = f1_local7
	local f1_local8 = nil
	f1_local8 = f1_local2.BuildRegisteredType( 0x729C2B2871735A2, {
		controllerIndex = f1_local4
	} )
	f1_local8[0x8B72E07B55C3AC0] = "PartyWidget"
	f1_local8:SetAnchorsAndPosition( 0, 1, 0, 1, 1224, 1824, 94, 264 )
	f1_local3:addElement( f1_local8 )
	f1_local3[0x5309AFCB21454FF] = f1_local8
	local f1_local9 = nil
	if f1_local0.IsRaid() then
		f1_local9 = f1_local2.BuildRegisteredType( 0xD8D5BBD86CF39D4, {
			controllerIndex = f1_local4
		} )
		f1_local9[0x8B72E07B55C3AC0] = "CPCheckpointWidget"
		f1_local9:SetAnchorsAndPosition( 0, 1, 0, 1, 543, 943, 826, 1026 )
		f1_local3:addElement( f1_local9 )
		f1_local3[0xD8D5BBD86CF39D4] = f1_local9
	end
	local f1_local10 = nil
	if f1_local0.InFrontendMPOrCP() then
		f1_local10 = f1_local2.BuildRegisteredType( 0x9B156FD0B79904D, {
			controllerIndex = f1_local4
		} )
		f1_local10[0x8B72E07B55C3AC0] = "AARFlyoutBase"
		f1_local10:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 600, 0, 1080 )
		f1_local3:addElement( f1_local10 )
		f1_local3[0x9B156FD0B79904D] = f1_local10
	end
	f0_local0( f1_local3, f1_local4, f1_arg1 )
	return f1_local3
end )
LUI.FlowManager.RegisterStackPushBehaviour( 0x23B61144B840FC3, f0_local6 )
LockTable( _M )
