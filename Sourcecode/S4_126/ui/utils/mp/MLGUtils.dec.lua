-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
MLG = MLG or {}
MLG.GetRulesVersionNumber = function ()
	local f13_local0 = MatchRules[0x3A9F1F51625857F]( "mlgVersion" )
	if f13_local0 == nil or f13_local0 == "" then
		f13_local0 = "0.0.0"
	end
	return Engine[0x7D3158A9539A355]( f13_local0 )
end

MLG.IsFeatureAvailable = function ()
	local f12_local0 = Dvar[0x9E5BE3B4BBA4E0E]( "#x3297ffeae3a9e9231" )
	if not f12_local0 then
		local f12_local1 = IsPrivateMatch
		if f12_local1 then
			f12_local0 = f12_local1
		else
			f12_local0 = IsPrivateMatch()
		end
	end
	if not f12_local0 then
		f12_local0 = Dvar[0x9E5BE3B4BBA4E0E]( "#x377990b442f9f487e" )
	end
	if f12_local0 then
		f12_local0 = not Engine[0xCA085C21FCBD7CA]()
	end
	if f12_local0 then
		f12_local0 = Dvar[0x9E5BE3B4BBA4E0E]( "#x316497d2002ad6619" )
	end
	return f12_local0
end

MLG.CanIAdjustMLGSettings = function ()
	if not MLG.IsFeatureAvailable() then
		return false
	end
	local f11_local0 = Dvar[0x9E5BE3B4BBA4E0E]( "#x3297ffeae3a9e9231" )
	if not f11_local0 then
		f11_local0 = Lobby[0x867E2628CAA1981]()
	end
	return f11_local0
end

MLG.AreMLGRulesEnabled = function ()
	if not MLG.IsFeatureAvailable() then
		return false
	end
	local f10_local0 = Dvar[0x9E5BE3B4BBA4E0E]( "#x3297ffeae3a9e9231" )
	if Dvar[0x9E5BE3B4BBA4E0E]( "#x3fca802e5beab0d71" ) == nil then
		Engine[0x7C75E608EA39B5C]( "set " .. "#x3fca802e5beab0d71" .. " 0" )
	end
	return Lobby[0x86DF9C05C3A75BA]()
end

MLG.SetUsingMLGRules = function ( f9_arg0 )
	Dvar[0x8EA06EEDB58D872]( "#x3fca802e5beab0d71", f9_arg0 )
	Lobby[0x73BA4B980F071BC]( f9_arg0 )
	if (1 < Engine[0x70187FE84AE61FD]()) or CoD.IsUsingAspectRatio( 1.3333333333333333 ) then
		for f9_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
			LobbyMember[0x22F89D07E40D9F8]( false, f9_local0 )
		end
	end
end

MLG.ToggleMLGRules = function ( f8_arg0 )
	if MLG.CanIAdjustMLGSettings() then
		if not MLG.AreMLGRulesEnabled() then
			if StringTable[0x2DCF0973239E909]( CSV.gameTypesTable.file, CSV.gameTypesTable.cols.ref, Dvar[0x54084D7CA2317BB]( "#x3a30c33efc8281eb1" ), CSV.gameTypesTable.cols.MLG ) == "1" and MatchRules[0x13579400938A3B4]() then
				MLG.SetUsingMLGRules( true )
				MatchRules[0x3C80CD558DAA2CF]()
			elseif not Engine[0xA50293282E72559]( f8_arg0 ) then
				LUI.FlowManager.RequestPopupMenu( self, "MLGNoRulesAvailableOfflinePopup", false, f8_arg0, false )
			else
				LUI.FlowManager.RequestPopupMenu( self, "MLGNoRulesAvailablePopup", false, f8_arg0, false )
			end
		else
			MLG.SetUsingMLGRules( false )
			MatchRules[0xE859FDA0484D3DE]()
		end
	end
end

MLG.Refresh = function ( f7_arg0 )
	local f7_local0 = MLG.AreMLGRulesEnabled()
	f7_arg0.properties = f7_arg0.properties or {}
	if f7_arg0.properties.cacheMLGenabled ~= f7_local0 then
		local f7_local1 = "mlg_"
		local f7_local2
		if f7_local0 then
			f7_local2 = "enabled"
		else
			f7_local2 = "disabled"
		end
		f7_arg0:dispatchEventToRoot( {
			immediate = true,
			name = f7_local1 .. f7_local2
		} )
		MLG.SetButtonHelper( f7_arg0, f7_local0 )
		f7_arg0.properties.cacheMLGenabled = f7_local0
	end
end

MLG.SetButtonHelper = function ( f6_arg0, f6_arg1 )
	local f6_local0 = ""
	if MLG.CanIAdjustMLGSettings() then
		if f6_arg1 then
			f6_local0 = Engine[0xED84C33EC5F01EA]( "PATCH_MENU/DISABLE_MLG_RULES" )
		else
			f6_local0 = Engine[0xED84C33EC5F01EA]( "PATCH_MENU/ENABLE_MLG_RULES" )
		end
	end
	f6_arg0:processEvent( {
		clickable = true,
		side = "right",
		name = "add_button_helper_text",
		button_ref = "button_start",
		helper_text = f6_local0
	} )
end

MLG.Toggle = function ( f5_arg0, f5_arg1 )
	if MLG.CanIAdjustMLGSettings() then
		MLG.ToggleMLGRules( f5_arg1.controller )
	end
	MLG.Refresh( f5_arg0 )
end

MLG.Hide = function ( f4_arg0 )
	f4_arg0:processEvent( {
		name = "mlg_disabled"
	} )
	f4_arg0:processEvent( {
		button_ref = "button_start",
		name = "add_button_helper_text",
		helper_text = nil,
		side = "right"
	} )
end

MLG.IsCDLActive = function ( f3_arg0 )
	if not Dvar[0x9E5BE3B4BBA4E0E]( "#x3495c7dcb91b6750e" ) then
		return false
	elseif CONDITIONS.IsMagmaGameMode() then
		return false
	elseif not Engine[0x12586A3F4FB490E]() and Dvar[0x9E5BE3B4BBA4E0E]( "#x3b4ea11a56b3db121" ) then
		return false
	elseif CONDITIONS.IsInGameBattlesMatch() then
		return MLG.AreMLGRulesEnabled()
	elseif MatchRules[0x1A6D0B2E15DF8CF]() then
		return MatchRules[0x3A9F1F51625857F]( "cwlRulesEnabled" )
	else
		
	end
end

MLG.ArbitrarilySetCDLRuleset = function ( f2_arg0 )
	if MP.GetLastQuickplayFilter( f2_arg0 ) == MP.PLAYLIST_FILTER_MODE.CDLRules and (not Lobby[0x63537242F1D48FF]() or Lobby[0x6957722EF74F5D2]()) then
		MP.SafeArbitrarilyLoadCDLRecipe( f2_arg0 )
		MLG.SetUsingMLGRules( true )
	else
		MLG.ResetMatchRulesData()
	end
end

MLG.ResetMatchRulesData = function ()
	if MatchRules[0x1A6D0B2E15DF8CF]() and MatchRules[0x3A9F1F51625857F]( "cwlRulesEnabled" ) then
		MatchRules[0xE859FDA0484D3DE]()
		MLG.SetUsingMLGRules( false )
	end
	if MatchRules[0x1A6D0B2E15DF8CF]() and MatchRules[0x3A9F1F51625857F]( Lobby.MatchRulesClasses.CommonOption, Lobby.MatchRulesMembers.RemoveDestructibleDoors ) then
		MatchRules[0xE859FDA0484D3DE]()
		Lobby[0xDA79B8D0B79405A]( false )
	end
end

