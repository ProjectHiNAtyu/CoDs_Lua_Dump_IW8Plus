-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:02
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.social.socialmenulayout" )
require( "ui.generated.widgets.frontend.social.socialmenulayoutnew" )
local f0_local0 = function ( f16_arg0, f16_arg1 )
	local f16_local0 = MenuBuilder.BuildRegisteredType( "FlyInPopup", {
		controllerIndex = f16_arg1.controllerIndex,
		widget = MenuBuilder.BuildRegisteredType( "SocialAddFriendsPopup", f16_arg1 )
	} )
	f16_local0.id = "AddFriendsPopup"
	return f16_local0
end

MenuBuilder.registerType( "AddFriendsPopup", f0_local0 )
MenuBuilder.registerType( "FriendRequestsPopup", function ( f15_arg0, f15_arg1 )
	local f15_local0 = MenuBuilder.BuildRegisteredType( "FlyInPopup", {
		controllerIndex = f15_arg1.controllerIndex,
		widget = MenuBuilder.BuildRegisteredType( "SocialFriendRequestsPopup", f15_arg1 )
	} )
	f15_local0.id = "FriendRequestsPopup"
	return f15_local0
end )
local f0_local1 = function ( f14_arg0 )
	if not CONDITIONS.IsNewSocialScreenEnabled() then
		return f14_arg0.MenuLayout.PlayersGrid
	else
		return f14_arg0.SocialMenuLayoutNew.PlayersGrid
	end
end

local f0_local2 = function ( f13_arg0 )
	assert( not CONDITIONS.IsNewSocialScreenEnabled() )
	if f13_arg0.HelperBar == nil then
		return 
	end
	f13_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
		button_ref = "button_r3"
	} )
	if f13_arg0.MenuLayout.PlayersGrid.showOfflineFriends then
		f13_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			button_ref = "button_r3",
			priority = 5,
			helper_text = Engine[0xED84C33EC5F01EA]( 0xFBD30871251C70D )
		} )
	else
		f13_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			button_ref = "button_r3",
			priority = 5,
			helper_text = Engine[0xED84C33EC5F01EA]( 0x7B2B14E573334E8 )
		} )
	end
end

local f0_local3 = function ( f12_arg0 )
	local f12_local0 = LUI.FlowManager.GetScopedData( f12_arg0 )
	f12_arg0.SocialMenuLayoutNew:UpdateFilteringLabel( Engine[0xED84C33EC5F01EA]( 0x9ADAC0AA6B81B29, FRIENDS.FriendTypeFilterStrings[f12_local0.activeFilter] ) )
end

local f0_local4 = function ( f11_arg0 )
	f11_arg0:SetBodyDetails( 0x66C117BB58EE50C, 0x9F4276E88C677BC )
end

local f0_local5 = function ( f10_arg0, f10_arg1 )
	local f10_local0 = PlayercardUtils.GetDataSources( f10_arg1.controllerIndex )
	f10_arg0.SocialMenuLayoutNew:UpdateDetails( nil, PlayercardUtils.PlayerDataFromDataSource( f10_arg1.controllerIndex ) )
end

local f0_local6 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.GetPlayerGrid = f0_local0
	f2_arg0.UpdateToggleOfflinePrompt = f0_local0
	f2_arg0.UpdateSortingLabel = f0_local0
	f2_arg0._platform = CoD.GetActiveSocialFriendsPlatform()
	f2_arg0._controllerIndex = f2_arg1
	if not CONDITIONS.IsNewSocialScreenEnabled() and f2_arg2.buttonHelperBar then
		f2_arg0.HelperBar = f2_arg2.buttonHelperBar
		f2_arg0:UpdateToggleOfflinePrompt()
	end
	local f2_local0 = f2_arg0.MenuLayout
	if CONDITIONS.IsNewSocialScreenEnabled() then
		f2_local0 = f2_arg0.SocialMenuLayoutNew
	end
	f2_local0:UpdateNoFriends( 0 )
	if CONDITIONS.IsNewSocialScreenEnabled() then
		f2_arg0.HelperBar:SetVisible( false )
		f2_local0:SetupEmptyGrid( 0xC3164CD46D11ED0, true )
		f2_local0:SetBodyDetails( 0x66C117BB58EE50C, 0x9F4276E88C677BC )
		f2_local0:UpdateBodyDetailsVisibility( true )
		f2_local0:SetStaticGridHeaderText( 0xF3284E74E6D65E2 )
		f2_local0.OnActionBarGainFocus = f0_local0
		SOCIAL.AddPlayerGridStaticLabelUpdater( f2_arg0.SocialMenuLayoutNew, 0xDC2B550A740511F )
	else
		f2_local0.NoFriendsLabel:setText( Engine[0xED84C33EC5F01EA]( 0x46B9ACFBB2761DA ) )
		f2_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 20,
			button_ref = "button_alt2",
			helper_text = Engine[0xED84C33EC5F01EA]( 0xEB57590979E31AE ),
			container = f2_local0.FirstTopPromptContainer
		} )
		f2_local0.InviteButton:SetPromptText( Engine[0xED84C33EC5F01EA]( 0xD7D605DEA65D04E ) )
	end
	f2_local0:SetPlayerGridWrapping( nil, false )
	
	local bindButton = LUI.UIBindButton.new()
	bindButton.id = "bindButton"
	f2_arg0:addElement( bindButton )
	f2_arg0.bindButton = bindButton
	
	if not CONDITIONS.IsNewSocialScreenEnabled() then
		local f2_local2 = function ()
			NOTIFICATIONS.LinkToFilter( f2_arg0, f2_arg0, {
				value = "friends",
				type = Enum[0xAB1CD948D041C60][0xC57E42946F6E08C]
			} )
		end
		
		f2_arg0.bindButton:addEventHandler( "button_alt1", function ( f8_arg0, f8_arg1 )
			f2_arg0()
		end )
		f2_local0.InviteButton:SetAction( f2_local2 )
		f2_arg0.bindButton:addEventHandler( "button_alt2", function ( f7_arg0, f7_arg1 )
			LUI.FlowManager.RequestPopupMenu( nil, "AddFriendsPopup", true, f2_arg0, false, {
				controllerIndex = f2_arg0._controllerIndex,
				platform = f2_arg0._platform,
				defaultTabFocus = FRIENDS.ManageFriendsTabIDs.ADD_FRIENDS
			} )
		end )
	end
	local f2_local2 = function ( f6_arg0 )
		f2_arg0:UpdateSortingLabel()
		Social[0x39E2616E863B53D]( f2_arg0._controllerIndex, f6_arg0.activeFilter )
		FRIENDS.RefreshData( FRIENDS.TabIDs.FRIENDS, f2_arg0.SocialMenuLayoutNew.PlayersGrid, f2_arg0._controllerIndex, f6_arg0.activeFilter )
	end
	
	if CONDITIONS.IsNewSocialScreenEnabled() then
		FRIENDS.AddFilteringEventHandler( f2_arg0.bindButton, f2_arg0.SocialMenuLayoutNew, f2_local2 )
	end
	local f2_local3 = true
	if CONDITIONS.IsNewSocialScreenEnabled() then
		LUI.DeferredFence.Attach( f2_arg0, f2_arg1, "FRIENDS_LIST", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f5_arg0, f5_arg1 )
			if f2_arg0._friendsListRefreshed then
				return 
			elseif f2_arg0.NoFriendsLabel and f5_arg1.fenceState ~= LUI.Fence.FenceObjectState.PASSING then
				f2_arg0.NoFriendsLabel:setText( Fences[0xEE24D1971822EE5]( f2_arg0, "FRIENDS_LIST" ) )
			end
			if not LUI.DeferredFence.IsFenceComplete( f5_arg1.fenceState ) then
				return 
			end
			f2_arg0._friendsListRefreshed = true
			f2_arg0.PlayersGrid.showOfflineFriends = true
			local f5_local0 = MenuBuilder.BuildRegisteredType( "SocialFriendsActionButtons", {
				controllerIndex = f2_arg0
			} )
			f5_local0.id = "SocialFriendsActionButtons"
			f2_arg0.SocialMenuLayoutNew:SetActionBar( f5_local0 )
			f2_arg0:addEventHandler( "social_friends_action_button_gained_focus", f2_arg0 )
			f2_arg0.SocialMenuLayoutNew:SetupPlayerGrid( FRIENDS.TabIDs.FRIENDS )
			f2_arg0.SocialMenuLayoutNew:SetActiveFilter( FRIENDS.FriendsListSortingAlgorithm.ALL, f2_arg0 )
			f2_arg0.SocialMenuLayoutNew:GainInitialFocus()
		end, f2_local3 )
	else
		LUI.DeferredFence.Attach( f2_arg0, f2_arg1, "FRIENDS_LIST", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f3_arg0, f3_arg1 )
			if f2_arg0.NoFriendsLabel and f3_arg1.fenceState ~= LUI.Fence.FenceObjectState.PASSING then
				f2_arg0.NoFriendsLabel:setText( Fences[0xEE24D1971822EE5]( f2_arg0, "FRIENDS_LIST" ) )
			end
			if not LUI.DeferredFence.IsFenceComplete( f3_arg1.fenceState ) then
				
			else
				
			end
			f2_arg0:SetRefreshChildFuncByTab( FRIENDS.TabIDs.FRIENDS )
			local f3_local0 = f2_arg0
			local f3_local1 = PLAYER_DATA.IO( f2_arg0, CoD.StatsGroup.NonGame )
			f3_local0._toggleOfflineFriendsData = f3_local1.toggleOfflineFriends
			f3_local0 = f2_arg0.PlayersGrid
			f3_local1 = f2_arg0._toggleOfflineFriendsData
			if f3_local1 then
				f3_local1 = f2_arg0._toggleOfflineFriendsData:get() == 1
			end
			f3_local0.showOfflineFriends = f3_local1
			f2_arg0:UpdateToggleOfflinePrompt()
			f2_arg0.bindButton:addEventHandler( "button_right_stick", function ( f4_arg0, f4_arg1 )
				Engine[0xC4146BA76D0F982]( SOUND_SETS.default.selectAlt )
				local f4_local0 = not f3_arg0.PlayersGrid.showOfflineFriends
				local f4_local1 = f3_arg0._toggleOfflineFriendsData
				local f4_local2 = f4_local1
				f4_local1 = f4_local1.set
				local f4_local3
				if f4_local0 then
					f4_local3 = 1
				else
					f4_local3 = 0
				end
				f4_local1( f4_local2, f4_local3 )
				f3_arg0.PlayersGrid.showOfflineFriends = f4_local0
				f3_arg0:UpdateToggleOfflinePrompt()
				FRIENDS.RefreshData( FRIENDS.TabIDs.FRIENDS, f3_arg0.PlayersGrid, f3_arg0 )
			end )
		end )
	end
end

function SocialFriendsMenu( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "SocialFriendsMenu"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	self.HelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	self.HelperBar.id = "HelperBar"
	self.HelperBar:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -85, 0 )
	self.HelperBar:setPriority( 10 )
	self:addElement( self.HelperBar )
	local f1_local2 = self
	local f1_local3 = nil
	if not CONDITIONS.IsNewSocialScreenEnabled() then
		f1_local3 = MenuBuilder.BuildRegisteredType( "SocialMenuLayout", {
			controllerIndex = f1_local1
		} )
		f1_local3.id = "MenuLayout"
		f1_local3:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, 0, _1080p * 1080 )
		self:addElement( f1_local3 )
		self.MenuLayout = f1_local3
	end
	local f1_local4 = nil
	if CONDITIONS.IsNewSocialScreenEnabled() then
		f1_local4 = MenuBuilder.BuildRegisteredType( "SocialMenuLayoutNew", {
			controllerIndex = f1_local1
		} )
		f1_local4.id = "SocialMenuLayoutNew"
		f1_local4:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
		self:addElement( f1_local4 )
		self.SocialMenuLayoutNew = f1_local4
	end
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "SocialFriendsMenu", SocialFriendsMenu )
LockTable( _M )
