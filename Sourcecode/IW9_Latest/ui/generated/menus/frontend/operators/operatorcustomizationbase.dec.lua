-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
module( ..., package.seeall )
local f0_local0 = function ( f27_arg0, f27_arg1, f27_arg2, f27_arg3, f27_arg4 )
	local f27_local0 = {}
	local f27_local1 = {}
	local f27_local2 = f27_arg0.OperatorlootGrid:GetFocusableIndicesFromPosition( {
		x = f27_arg1,
		y = f27_arg2
	} )
	for f27_local3 = 1, #f27_local2, 1 do
		local f27_local6 = f27_arg0._lootData[f27_local2[f27_local3]]
		if f27_arg0._currentLootType == LOOT.itemTypes.OPERATOR_SKIN then
			local f27_local7 = OPERATOR.GetOperatorSkin( f27_arg3, f27_local6.lootIndex, f27_arg4 )
			if f27_local7.bodyModel and 0 < #f27_local7.bodyModel then
				table.insert( f27_local0, f27_local7.bodyModel )
			end
			if f27_local7.headModel and 0 < #f27_local7.headModel then
				table.insert( f27_local1, f27_local7.headModel )
			end
		end
		if f27_arg0._currentLootType == LOOT.itemTypes.OPERATOR_EXECUTION then
			local f27_local7 = OPERATOR.GetExecutionPet( f27_local6.lootIndex )
			if f27_local7 and 0 < #f27_local7 then
				table.insert( f27_local0, OPERATOR.GetPetModel( f27_local7 ) )
			end
		end
	end
	local f27_local4 = OPERATOR.GetOperatorSkin( f27_arg3, OPERATOR.GetEquippedItemForLootType( f27_arg3, f27_arg4, LOOT.itemTypes.OPERATOR_SKIN ), f27_arg4 )
	if f27_local4.bodyModel and 0 < #f27_local4.bodyModel then
		table.insert( f27_local0, f27_local4.bodyModel )
	end
	if f27_local4.headModel and 0 < #f27_local4.headModel then
		table.insert( f27_local1, f27_local4.headModel )
	end
	local f27_local5 = OPERATOR.GetPetForOperator( f27_arg3, f27_arg4 )
	if f27_local5 and 0 < #f27_local5 then
		table.insert( f27_local0, OPERATOR.GetPetModel( f27_local5 ) )
	end
	if 0 < #f27_local0 and 0 < #f27_local1 then
		FrontEndScene.RequestBodyModels( f27_local0 )
		FrontEndScene.RequestHeadModels( f27_local1 )
	end
end

local f0_local1 = function ( f26_arg0, f26_arg1 )
	local f26_local0 = LOADOUT.GetCustomizationSetup( f26_arg1 )
	if f26_local0.operators[f26_arg0.currentState]:get() ~= f26_arg0.operatorRef then
		f26_local0.operators[f26_arg0.currentState]:set( f26_arg0.operatorRef )
		LUI.ToastManager.CreateToast( f26_arg1, LUI.ToastManager.StandardEmphasisToast( Engine[0xED84C33EC5F01EA]( 0x4001E7BD10C7068 ), Engine[0xED84C33EC5F01EA]( OPERATOR.GetName( f26_arg0.operatorRef ) ), LUI.ToastManager.ToastNotificationType.Gear ) )
	end
end

local f0_local2 = function ( f25_arg0, f25_arg1, f25_arg2 )
	for f25_local0 = 1, #f25_arg1, 1 do
		if f25_arg1[f25_local0].ref == f25_arg2 then
			return f25_local0
		end
	end
	return 1
end

local f0_local3 = function ( f24_arg0, f24_arg1 )
	local f24_local0 = LOADOUT.GetCustomizationSetup( f24_arg1 )
	if f24_arg0.currentState == OPERATOR.SuperFaction.EAST then
		local f24_local1 = f24_arg0.eastSelectedOperator
		if not f24_local1 then
			f24_local1 = f24_local0.operators[f24_arg0.currentState]:get()
		end
		f24_arg0.operatorRef = f24_local1
	else
		local f24_local1 = f24_arg0.westSelectedOperator
		if not f24_local1 then
			f24_local1 = f24_local0.operators[f24_arg0.currentState]:get()
		end
		f24_arg0.operatorRef = f24_local1
	end
end

local f0_local4 = function ( f23_arg0, f23_arg1 )
	f23_arg0.CharacterYawRotation = (f23_arg0.CharacterYawRotation + f23_arg1 * f23_arg0.CharacterRotationSensitivityCoefficient) % f23_arg0.CharacterRotationMaxValue
end

local f0_local5 = function ( f22_arg0 )
	f22_arg0.CharacterYawRotation = 0
end

local f0_local6 = function ( f21_arg0, f21_arg1, f21_arg2 )
	local f21_local0 = LOOT.GetItemID( OPERATOR.GetCosmeticRefByLootTypeAndIndex( f21_arg1, f21_arg2 ) )
	local f21_local1 = OPERATOR.GetEquippedItemForLootType( f21_arg0._controllerIndex, f21_arg0.operatorInfo.ref, f21_arg1 )
	local f21_local2 = {
		name = LOOT.GetItemClassName( f21_arg1, f21_local1, f21_local0 ),
		desc = LOOT.GetItemClassDesc( f21_arg1, f21_local0 ),
		image = LOOT.GetItemImage( f21_arg1, f21_local1 )
	}
	if LUI.StringIsNilOrEmpty( f21_local2.image ) then
		f21_local2.image = "ui_default_null"
	end
	return f21_local2
end

local f0_local7 = function ( f20_arg0, f20_arg1, f20_arg2 )
	local f20_local0 = LOOT.GetItemRefFromID( f20_arg2 )
	local f20_local1 = {
		name = LOOT.emptyID and LOOT.GetItemClassName( f20_arg1, f20_local0, f20_arg2 ) or "",
		desc = LOOT.emptyID and LOOT.GetItemClassDesc( f20_arg1, f20_arg2 ) or "",
		image = LOOT.emptyID and LOOT.GetItemImage( f20_arg1, f20_local0 ) or ""
	}
	if LUI.StringIsNilOrEmpty( f20_local1.image ) then
		f20_local1.image = "ui_default_null"
	end
	return f20_local1
end

local f0_local8 = function ( f19_arg0 )
	if not f19_arg0._scoped.focusedIndex then
		f19_arg0._scoped.focusedIndex = 1
	end
	local f19_local0 = f19_arg0.CustomizationCategories:GetElementAtIndex( f19_arg0._scoped.focusedIndex )
	f19_arg0.CustomizationCategories:SetDefaultFocus( f19_arg0._scoped.focusedIndex )
	f19_arg0.CustomizationCategories:processEvent( {
		name = "gain_focus",
		child = f19_local0,
		focusType = FocusType.MouseOver
	} )
end

local f0_local9 = function ( f18_arg0 )
	f18_arg0._scoped = LUI.FlowManager.GetScopedData( f18_arg0 )
	if not f18_arg0._scoped.OperatorCustomizationData then
		f18_arg0._scoped.OperatorCustomizationData = {
			CharacterRotationMaxValue = 360,
			CharacterYawRotation = 0,
			CharacterRotationSensitivityCoefficient = 4,
			UpdateRotationValue = f0_local0,
			ResetRotationValue = f0_local0
		}
	end
	f18_arg0.OperatorCustomizationData = f18_arg0._scoped.OperatorCustomizationData
end

local f0_local10 = function ( f17_arg0, f17_arg1 )
	local f17_local0, f17_local1 = nil
	if f17_arg0.persistentOperatorIndex then
		f17_local0 = f17_arg0:GetCategoryDataFromlootID( LOOT.itemTypes.OPERATOR_SKIN, DMZ.GetOperatorSkin( f17_arg1, f17_arg0.persistentOperatorIndex ) )
		f17_local1 = f17_arg0:GetCategoryDataFromlootID( LOOT.itemTypes.OPERATOR_EXECUTION, DMZ.GetOperatorExecution( f17_arg1, f17_arg0.persistentOperatorIndex ) )
	else
		local f17_local2 = LOADOUT.GetCustomizationSetup( f17_arg1 )
		f17_local0 = f17_arg0:GetCategoryData( LOOT.itemTypes.OPERATOR_SKIN, f17_local2.operatorCustomization[f17_arg0.operatorInfo.ref].skin:get() )
		f17_local1 = f17_arg0:GetCategoryData( LOOT.itemTypes.OPERATOR_EXECUTION, f17_local2.operatorCustomization[f17_arg0.operatorInfo.ref].execution:get() )
	end
	return f17_local0, f17_local1
end

local f0_local11 = function ( f16_arg0, f16_arg1 )
	local f16_local0, f16_local1 = f0_local0( f16_arg0, f16_arg1 )
	f16_arg0._categoryButtons = {
		{
			lootType = LOOT.itemTypes.OPERATOR_SKIN,
			button = f16_arg0.SkinsButton,
			name = f16_local0.name,
			desc = f16_local0.desc,
			image = f16_local0.image
		},
		{
			lootType = LOOT.itemTypes.OPERATOR_EXECUTION,
			button = f16_arg0.ExecutionsButton,
			name = f16_local1.name,
			desc = f16_local1.desc,
			image = f16_local1.image
		}
	}
end

local f0_local12 = function ( f15_arg0 )
	f15_arg0.ItemDetails:SetupForOperatorCustomization()
	f15_arg0.ItemDetails:UpdateDetails( {
		localizedName = f15_arg0._categoryButtons[1].name,
		localizedDesc = f15_arg0._categoryButtons[1].desc,
		operatorInfo = f15_arg0.operatorInfo
	} )
end

local f0_local13 = function ( f11_arg0, f11_arg1 )
	f11_arg0.CustomizationCategories:SetSpacing( 16 * _1080p )
	f11_arg0.CustomizationCategories:SetAlignment( LUI.Alignment.Left )
	local f11_local0 = {}
	local f11_local1 = {
		removeTextBacker = false,
		hasEmptyState = false,
		removeEquipBanner = true,
		localizeHeader = false,
		buttonData = {},
		primaryActionText = Engine[0xED84C33EC5F01EA]( "LUA_MENU/SELECT" )
	}
	for f11_local2 = 1, #f11_arg0._categoryButtons, 1 do
		local f11_local5 = f11_arg0._categoryButtons[f11_local2].button
		f11_local1.buttonData.header = f11_arg0._categoryButtons[f11_local2].name
		f11_local1.buttonData.image = f11_arg0._categoryButtons[f11_local2].image
		if f11_arg0._categoryButtons[f11_local2].lootType == LOOT.itemTypes.OPERATOR_SKIN then
			f11_local1.specialLayout = "OpCustomizationCatSkinLayout"
		else
			f11_local1.specialLayout = "OpCustomizationCatLayout"
		end
		f11_local5:SetupButton( f11_local1 )
		f11_arg0:RemoveElement( f11_local5 )
		f11_arg0.CustomizationCategories:addElement( f11_local5 )
		local f11_local6 = LAYOUT.GetElementHeight( f11_local5 )
		f11_local5:SetBottom( 0 )
		f11_local5:SetTop( -f11_local6 )
		local f11_local7 = function ()
			f11_arg0.ItemDetails:UpdateDetails( {
				localizedName = f11_arg0._categoryButtons[f11_arg0].name,
				localizedDesc = f11_arg0._categoryButtons[f11_arg0].desc,
				operatorInfo = f11_arg0.operatorInfo
			} )
			local f14_local0 = OPERATOR.GetUnlockedItemCountForItemType( f11_arg0._categoryButtons[f11_arg0].lootType, f11_arg0, f11_arg0.operatorInfo )
			f11_arg0.ButtonTopLine.UnlockCount:UpdateCount( f14_local0[1], f14_local0[2], false, "MENU/COLLECTED" )
			f11_arg0.ButtonTopLine:SetupPrompts( f11_arg0.operatorRef, LOOT.itemTypes.OPERATOR_SKIN )
		end
		
		local f11_local8 = function ( f13_arg0, f13_arg1 )
			f11_arg0()
		end
		
		f11_local5:addEventHandler( "button_over", f11_local8 )
		f11_local5:addEventHandler( "button_over_disable", f11_local8 )
		f11_local5:addEventHandler( "button_action", function ( f12_arg0, f12_arg1 )
			local f12_local0 = f12_arg0:GetCurrentMenu()
			f12_local0._scoped.customizationCategory = f12_local0._categoryButtons[f11_arg0].lootType
			f12_local0._scoped.name = f12_local0._categoryButtons[f11_arg0].name
			f12_local0._scoped.focusedIndex = f11_arg0
			if f12_local0.persistentOperatorIndex then
				f12_arg0.persistentOperatorIndex = f12_local0.persistentOperatorIndex
			end
			OPERATOR.OpenOperatorSubMenu( f12_local0, f11_arg0, "OperatorCustomizationCategory" )
		end )
		table.insert( f11_local0, f11_local5 )
	end
	if 0 < #f11_local0 then
		MenuUtils.SetupActiveStateOnNonListButtons( f11_arg0, f11_arg1, {
			buttonList = f11_local0,
			defaultFocusButton = f11_local0[1]
		} )
	end
end

local f0_local14 = function ( f9_arg0, f9_arg1, f9_arg2, f9_arg3 )
	if not f9_arg0.operatorData.skinInfo then
		local f9_local0 = OPERATOR.GetEquippedSkinForOperator( f9_arg1, f9_arg2 )
	end
	if f9_arg0.persistentOperatorIndex then
		local f9_local1 = DMZ.GetOperatorDataForOperatorIndex( f9_arg1, f9_arg0.persistentOperatorIndex )
		local f9_local0 = f9_local1.skinInfo
	end
	local f9_local1 = OPERATOR.IntroIdleMalePose
	FrontEndScene.HideAllCharacters()
	STREAMING.RequestModels( f9_arg1, {
		requesterWidget = f9_arg0,
		modelType = STREAMING.ModelTypes.Animation,
		models = {
			f9_local1
		}
	} )
	OPERATOR.UpdateClientCharacter( f9_arg0, f9_arg1, f9_arg3, {
		showCharacter = true,
		omitDefaultAnim = true,
		bodyModel = f9_local0.bodyModel,
		headModel = f9_local0.headModel,
		primaryWeaponModel = ClientCharacter[0x24D8346FF9D35DC]( f9_arg1, f9_arg3 ),
		secondaryWeaponModel = ClientCharacter[0xF2A95FEC11E1817]( f9_arg1, f9_arg3 ),
		operatorPose = f9_local1,
		requiredAnimations = Table.GetValues( f9_arg0.animationTable[f9_arg2] )
	} )
	ClientCharacter[0xB6D1A33AC2622D0]( f9_arg3, 0, f9_arg0.OperatorCustomizationData.CharacterYawRotation, 0 )
	ClientCharacter[0xAA614EB46957F3B]( f9_arg3, f9_local1, 0 )
	f9_arg0.CharacterRotationHandler = function ( f10_arg0, f10_arg1 )
		f9_arg0.OperatorCustomizationData:UpdateRotationValue( f10_arg1 )
		ClientCharacter[0xAA614EB46957F3B]( f10_arg0._modelIndex, f9_arg0 )
		ClientCharacter[0xB6D1A33AC2622D0]( f10_arg0._modelIndex, 0, f9_arg0.OperatorCustomizationData.CharacterYawRotation, 0 )
	end
	
	f9_arg0.CharacterRotator.characterRotationArea.UpdateCharacterRotation = f9_arg0.CharacterRotationHandler
	f9_arg0.CharacterRotator:SetClientCharacterInfo( f9_arg3, f9_arg2 )
	return f9_local0.headModel, f9_local0.bodyModel
end

local f0_local15 = function ( f7_arg0, f7_arg1, f7_arg2 )
	local f7_local0 = nil
	local f7_local1 = "character_faction_select_l_detail"
	local f7_local2 = {}
	if f7_arg0.isSoloOperatorSelect then
		f7_arg0.westSelectedOperator = f7_arg2.operatorData.westSelectedOperator
		f7_local2.head, f7_local2.body = f0_local0( f7_arg0, f7_arg1, f7_arg0.westSelectedOperator, FrontEndScene.ClientCharacters.MainMenuWest )
		if f7_arg2.persistentOperatorIndex then
			f7_local0 = DMZ.GetCosmeticConfigStringForOperatorIndex( f7_arg1, f7_arg2.persistentOperatorIndex )
		else
			f7_local0 = OPERATOR.GetCosmeticConfigString( f7_arg0.westSelectedOperator, f7_arg1 )
		end
	elseif f7_arg0.currentState == OPERATOR.SuperFaction.WEST then
		f7_arg0.westSelectedOperator = f7_arg2.operatorData.westSelectedOperator
		f7_local2.head, f7_local2.body = f0_local0( f7_arg0, f7_arg1, f7_arg0.westSelectedOperator, FrontEndScene.ClientCharacters.MainMenuWest )
		ClientCharacter[0xAA614EB46957F3B]( FrontEndScene.ClientCharacters.MainMenuEast, "iw9_fe_op_male_bundle_idle_01", 0 )
		FrontEndScene.SetCharacterVisible( FrontEndScene.ClientCharacters.MainMenuEast, false )
		f7_local0 = OPERATOR.GetCosmeticConfigString( f7_arg0.westSelectedOperator, f7_arg1 )
	else
		f7_local1 = "character_faction_select_r_detail"
		f7_arg0.eastSelectedOperator = f7_arg2.operatorData.eastSelectedOperator
		f7_local2.head, f7_local2.body = f0_local0( f7_arg0, f7_arg1, f7_arg0.eastSelectedOperator, FrontEndScene.ClientCharacters.MainMenuEast )
		ClientCharacter[0xAA614EB46957F3B]( FrontEndScene.ClientCharacters.MainMenuWest, "iw9_fe_op_male_bundle_idle_01", 0 )
		FrontEndScene.SetCharacterVisible( FrontEndScene.ClientCharacters.MainMenuWest, false )
		f7_local0 = OPERATOR.GetCosmeticConfigString( f7_arg0.eastSelectedOperator, f7_arg1 )
	end
	Engine[0x685AE31DEDA30A4]( f7_local1 )
	local f7_local3 = Engine[0x3B8CFB6758EF57C]()
	f7_arg0:AddGamepadEventCallback( "button_secondary", function ( f8_arg0, f8_arg1 )
		local f8_local0 = f8_arg1.controllerIndex or f8_arg1.controller
		Engine[0xB81A5136C5503E4]( "uploadstats", f8_local0 )
		f8_arg0.OperatorCustomizationData:ResetRotationValue()
		local f8_local1 = nil
		if f8_arg0.currentState == OPERATOR.SuperFaction.WEST or f8_arg0.isSoloOperatorSelect then
			f8_local1 = OPERATOR.GetCosmeticConfigString( f8_arg0.westSelectedOperator, f8_local0 )
			ClientCharacter[0xB6D1A33AC2622D0]( FrontEndScene.ClientCharacters.MainMenuWest, 0, f8_arg0.OperatorCustomizationData.CharacterYawRotation, 0 )
		else
			f8_local1 = OPERATOR.GetCosmeticConfigString( f8_arg0.eastSelectedOperator, f8_local0 )
			ClientCharacter[0xB6D1A33AC2622D0]( FrontEndScene.ClientCharacters.MainMenuEast, 0, f8_arg0.OperatorCustomizationData.CharacterYawRotation, 0 )
		end
		METRICS.OperatorUsageSendDLogEvent( f8_arg0, f8_local0, f7_arg0, f7_arg0, f8_local1 )
		LAYOUT.FadeInAspectRatioFadeFrame( f8_arg0, 300 )
		Engine[0x3DACD106DDC0D71]()
		ACTIONS.LeaveMenu( f8_arg0 )
	end )
end

local f0_local16 = function ( f3_arg0, f3_arg1, f3_arg2 )
	Dvar[0x8EA06EEDB58D872]( 0x51073A10A741504, false )
	f3_arg0.RequestStreamingModels = f0_local0
	f3_arg0.GetEquippedLootItemIndex = f0_local0
	f3_arg0.UpdateSuperfactionDisplay = f0_local0
	f3_arg0.GetCategoryData = f0_local0
	f3_arg0.GetCategoryDataFromlootID = f0_local0
	f3_arg0.ResetFocus = f0_local0
	f3_arg0._controllerIndex = f3_arg1
	f3_arg0.animationTime = 400
	f3_arg0.operatorData = f3_arg2.operatorData
	f3_arg0.currentState = f3_arg2.operatorData.currentState
	f3_arg0.operatorInfo = f3_arg2.operatorData.operatorInfo
	f3_arg0.isSoloOperatorSelect = f3_arg2.isSoloOperatorSelect
	f3_arg0.persistentOperatorIndex = f3_arg2.persistentOperatorIndex
	f3_arg0.isCustomizationMenu = true
	f3_arg0.BG:SetAlpha( 1, 30 )
	local f3_local0 = f3_arg0.BG:Wait( 500 )
	f3_local0.onComplete = function ()
		f3_arg0.BG:SetAlpha( 0, 500 )
	end
	
	f0_local0( f3_arg0 )
	f3_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0xF0150DF52D14A70 ) )
	f3_arg0.MenuTitle:SetupBackButton( f3_arg1 )
	f0_local0( f3_arg0, f3_arg1 )
	f0_local0( f3_arg0 )
	f3_local0 = OPERATOR.GetUnlockedItemCountForItemType( f3_arg0._categoryButtons[1].lootType, f3_arg1, f3_arg0.operatorInfo )
	f3_arg0.ButtonTopLine.UnlockCount:UpdateCount( f3_local0[1], f3_local0[2], false, "MENU/COLLECTED" )
	f3_arg0.ButtonTopLine:SetupPrompts( f3_arg0.operatorRef, LOOT.itemTypes.OPERATOR_SKIN )
	f0_local0( f3_arg0, f3_arg1 )
	f3_arg0.animationTable, f3_arg0.weaponTable = OPERATOR.GetOperatorSelectAnimationAndWeaponTable()
	f0_local0( f3_arg0, f3_arg1, f3_arg2 )
	LAYOUT.FadeOutAspectRatioFadeFrame( f3_arg0, 500, 1.15 )
	f3_arg0.CustomizationCategories:addEventHandler( "lose_focus", function ( f5_arg0, f5_arg1 )
		f3_arg0:ResetFocus()
	end )
	f3_arg0:ResetFocus()
	f3_arg0:addEventHandler( "update_input_type", function ( f4_arg0, f4_arg1 )
		if LUI.IsLastInputMouseNavigation( f4_arg1.controllerIndex ) then
			return 
		else
			f4_arg0:ResetFocus()
		end
	end, {
		controllerIndex = f3_arg1
	} )
end

local f0_local17 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function OperatorCustomizationBase( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "OperatorCustomizationBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "OperatorCustomizationBase", OperatorCustomizationBase )
LockTable( _M )
