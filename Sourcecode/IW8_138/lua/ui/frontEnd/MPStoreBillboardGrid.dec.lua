-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 02-09-2025 10:42
module( ..., package.seeall )
local f0_local0 = 3000
local f0_local1 = true
local f0_local2 = function ( f56_arg0, f56_arg1, f56_arg2 )
	local f56_local0 = {}
	local f56_local1 = f56_arg2.items[1] or {}
	local f56_local2 = nil
	if f56_arg2.isFirstPartyCategory then
		local f56_local3 = {
			name = "MENU/FETCHING_STORE_DATA"
		}
		local f56_local4
		if CONDITIONS.IsWZWipDvarEnabled() then
			f56_local4 = "cw_store_billboard_placeholder"
		else
			f56_local4 = "mw_store_billboard_placeholder"
		end
		f56_local3.asset = f56_local4
		f56_local3.buttonAction = function ( f57_arg0, f57_arg1 )
			if f56_arg0._catalogStatus ~= nil and f56_arg0._catalogStatus ~= InGameStoreCatalogStatus.READY then
				LUI.FlowManager.RequestPopupMenu( nil, "generic_error_popup", false, nil, false, {
					message = f56_arg0._catalogFetchErrorMessage
				}, nil, false, true )
			end
		end
		
		table.insert( f56_local0, f56_local3 )
	elseif f56_arg2.idPubVar and f56_local1.layoutOnlyItem then
		local f56_local3 = Dvar.DHEEJCCJBH( f56_arg2.idPubVar ) or ""
		if f56_arg2.justForYou and f56_arg0._recommendations then
			f56_arg0.recommendationData = {
				items = f56_arg0._recommendations,
				isEnabled = true
			}
			f56_local3 = STORE.FormatRecommendationItems( f56_arg0._recommendations .. "," .. f56_local3 )
		elseif f56_arg2.commsLocationId then
			local f56_local4 = Store.JGBAJAECG( f56_arg2.commsLocationId )
			if f56_local4 then
				f56_local4 = table.concat( STORE.TrimRecommendationsByBlacklistedItems( split( f56_local4, "," ) ), "," )
			end
			f56_local3 = STORE.FormatRecommendationItems( f56_local4 .. "," .. f56_local3 )
		end
		if f56_arg0._storeSchedule and not Dvar.IBEGCHEFE( "OKMSPKPMLO" ) and not f56_arg2.commsLocationId then
			f56_local3 = STORE.GetScheduledProductsForCategory( f56_arg2, f56_arg0._storeSchedule )
		end
		if STORE.CategoryType[f56_arg2.id] == STORE.CategoryType.featured and STORE.ShouldModifyFeaturedItems( f56_arg1 ) then
			f56_local3 = STORE.GetPriorityFeaturedItems() .. "," .. f56_local3
		end
		local f56_local4 = split( f56_local3, "," )
		local f56_local5 = 0
		f56_arg2.hasFirstPartyBundle = false
		for f56_local6 = 1, #f56_local4, 1 do
			local f56_local9 = tonumber( f56_local4[f56_local6] )
			if STORE.BundleAvailable( f56_arg1, f56_local9 ) then
				local f56_local10 = LUI.DeepCopy( f56_local1 )
				f56_local10.emptyCategory = false
				f56_local10.id = f56_local9
				local f56_local11 = CSV.ReadRow( {
					file = CSV.bundleIDs.file,
					cols = CSV.bundleIDs.cols
				}, StringTable.BJJBBCJGEJ( CSV.bundleIDs.file, CSV.bundleIDs.cols.id, f56_local4[f56_local6] ) )
				local f56_local12 = Dvar.IBEGCHEFE( "NPQPKPKRTL" )
				f56_local10.name = f56_local11.name
				f56_local10.asset = f56_local11.image
				f56_local10.description = STORE.GetBundleDescription( f56_local10.id, f56_arg0._totalCP )
				f56_local10.rarity = f56_local11.rarity
				f56_local10.bundleType = f56_local11.bundleType
				f56_local10.titleImage = f56_local11.titleImage
				f56_local10.currencyID = tonumber( f56_local11.currencyID )
				f56_local10.currencyAmount = tonumber( f56_local11.currencyAmount )
				local f56_local13
				if 0 < #f56_local11.firstPartyProductID then
					f56_local13 = f56_local11.firstPartyProductID
					if not f56_local13 then
					
					else
						f56_local10.firstPartyProductID = f56_local13
						f56_local10.purchaseEnd = f56_local11.purchaseEnd and f56_local11.purchaseEnd or nil
						f56_local10.gameSourceID = f56_local11.game
						if f56_local2 then
							if f56_local2 ~= f56_local10.gameSourceID then
								f56_local2 = "mixed"
							end
						else
							f56_local2 = f56_local10.gameSourceID
						end
						if not f56_local12 then
							f56_local10.purchaseEnd = nil
						end
						if f56_local10.purchaseEnd and STORE.SeasonTimestampMapping[f56_local10.purchaseEnd] then
							f56_local10.purchaseEnd = STORE.SeasonTimestampMapping[f56_local10.purchaseEnd]
						end
						if f56_local9 == tonumber( BATTLEPASS.GetTierSkipGiftID() ) and BATTLEPASS.IsTierSkipGiftActive( f56_arg1 ) then
							f56_local10.purchaseEnd = BATTLEPASS.GetTierSkipGiftTimer()
						end
						f56_local13, f56_local14, f56_local15 = STORE.GetCategoryTimeLeft( nil, f56_local10.purchaseEnd )
						if not f56_local10.purchaseEnd or 0 < f56_local13 then
							table.insert( f56_local0, f56_local10 )
							f56_local5 = f56_local5 + 1
						end
						if f56_local10.firstPartyProductID then
							f56_arg2.hasFirstPartyBundle = true
						end
					end
				end
				f56_local13 = nil
			end
			if f56_local5 == f56_arg2.numItemsShown then
				break
			end
		end
	end
	if #f56_local0 == 0 then
		local f56_local3 = LUI.DeepCopy( f56_local1 )
		f56_local3.emptyCategory = true
		f56_local3.titleImage = nil
		f56_local3.purchaseEnd = nil
		local f56_local4
		if CONDITIONS.IsWZWipDvarEnabled() then
			f56_local4 = "cw_store_billboard_placeholder"
		else
			f56_local4 = "mw_store_billboard_placeholder"
		end
		f56_local3.asset = f56_local4
		f56_local3.name = "LUA_MENU/EMPTY"
		table.insert( f56_local0, f56_local3 )
	end
	f56_arg2.rowGameSourceIDOrMixed = f56_local2
	f56_arg2.items = f56_local0
end

local f0_local3 = function ( f55_arg0, f55_arg1 )
	LUI.FlowManager.RequestPopupMenu( f55_arg0, "CreatorCodePopup", true, controllerIndex, false, {
		controllerIndex = f55_arg1
	} )
	Engine.BJDBIAGIDA( SOUND_SETS.default.selectAlt )
end

local f0_local4 = function ( f54_arg0, f54_arg1 )
	LUI.FlowManager.RequestPopupMenu( f54_arg0, "CreatorCodePopup", true, controllerIndex, false, {
		controllerIndex = f54_arg1
	} )
end

local f0_local5 = function ( f53_arg0, f53_arg1, f53_arg2 )
	local f53_local0, f53_local1 = STORE.GetIndexForBundle( f53_arg1, f53_arg0._controllerIndex )
	if f53_local0 and f53_local1 and f53_arg0.BundlesGrid then
		local f53_local2 = f53_arg0._allCategoryData[f53_local0]
		local f53_local3 = LUI.FlowManager.GetPerControllerPersistentData( f53_arg0._controllerIndex )
		f53_arg0._selectedCategory = f53_local0
		f53_local3._selectedCategory = f53_local2.categoryIndex
		f53_arg0._selectedBundle = f53_local1
		f53_arg0.BundlesGrid:SetFocusedPosition( {
			x = 0,
			y = f53_local0 - 1
		}, true )
		f53_arg0:BillboardCategoryButtonAction( element, event, f53_local2 )
	else
		LUI.FlowManager.RequestPopupMenu( f53_arg0, "PopupOK", true, f53_arg0._controllerIndex, false, {
			message = Engine.CBBHFCGDIC( "LUA_MENU/BUNDLE_NOT_AVAILABLE" )
		} )
	end
end

local f0_local6 = function ( f52_arg0, f52_arg1 )
	local f52_local0 = STORE.GetCategoryIndex( f52_arg0._controllerIndex, f52_arg1 )
	if f52_local0 and f52_arg0.BundlesGrid then
		local f52_local1 = f52_arg0._allCategoryData[f52_local0]
		local f52_local2 = LUI.FlowManager.GetPerControllerPersistentData( f52_arg0._controllerIndex )
		f52_arg0._selectedCategory = f52_local0
		f52_local2._selectedCategory = f52_local1.categoryIndex
		f52_arg0.BundlesGrid:SetFocusedPosition( {
			x = 0,
			y = f52_local0 - 1
		}, true )
	end
end

local f0_local7 = function ( f51_arg0, f51_arg1, f51_arg2, f51_arg3 )
	local f51_local0 = f51_arg0._selectedBundle or 1
	local f51_local1 = f51_arg3.items[f51_local0]
	local f51_local2 = f51_local1.id
	if f51_local1.emptyCategory then
		f51_arg0._startPurchaseImmediately = false
		return 
	end
	local f51_local3 = LUI.FlowManager.GetScopedData( f51_arg0 )
	f51_local3.selectedBundleIndex = f51_local0
	if f51_arg3.isFirstPartyCategory then
		f51_local3.firstPartyColumnIndex = f51_local0
		if f51_local1.buttonAction then
			f51_arg0._startPurchaseImmediately = false
			f51_local1.buttonAction( f51_arg1, f51_arg2 )
			return 
		end
	else
		f51_local3.firstPartyColumnIndex = nil
	end
	if not f51_arg0._storeEnterComplete then
		QUARTERMASTER.RecordStoreEnterEvent( f51_arg0._controllerIndex, f51_arg0._storeLayout, f51_arg0.recommendationData, f51_arg0._sourceMenu, f51_arg0._allCategoryData )
		QUARTERMASTER.BeginMenuBrowseEvent( f51_arg0._controllerIndex, f51_arg3, f51_arg3.items[1], f51_arg0._storeLayout, f51_arg0.recommendationData )
		f51_arg0._storeEnterComplete = true
	end
	QUARTERMASTER.RecordMenuBrowseEvent( f51_arg0._controllerIndex, true )
	STORE.MarkItemSeen( f51_arg0._controllerIndex, f51_local2 )
	f51_arg0.BundlesGrid:RefreshContent()
	if f51_local1.firstPartyProductID then
		local f51_local4 = f51_local1.firstPartyProductID
		if STORE.IsGameUpsellBundle( f51_local2 ) then
			LUI.FlowManager.RequestPopupMenu( f51_arg0, "StoreGameUpsellPopup", true, f51_arg0._controllerIndex, false, {
				defaultProductId = f51_local4
			} )
		elseif STORE.IsZeusBundle( f51_local2 ) then
			LUI.FlowManager.RequestPopupMenu( f51_arg0, "StoreGameUpsellPopup", true, f51_arg0._controllerIndex, false, {
				isZeus = true,
				defaultProductId = f51_local4
			} )
		elseif f51_arg0._catalogStatus == InGameStoreCatalogStatus.READY then
			if 0 < STORE.GetNumItemsInBundle( f51_local2 ) then
				local f51_local5 = STORE.GetFirstPartyBundleData( f51_arg0._controllerIndex, f51_local2, f51_local4 )
				f51_local5.bundleIndex = f51_local0
				LUI.FlowManager.RequestAddMenu( "StoreBundlePreview", true, f51_arg0._controllerIndex, false, f51_local5 )
			else
				InGameStore.SelectProduct( f51_arg0._controllerIndex, f51_local4, InGameStorePurchaseType.BROWSE )
			end
		else
			LUI.FlowManager.RequestPopupMenu( nil, "generic_error_popup", false, nil, false, {
				message = f51_arg0._catalogFetchErrorMessage
			}, nil, false, true )
		end
		return 
	end
	local f51_local4 = {
		bundleID = f51_local1.id,
		rarity = f51_local1.rarity,
		description = f51_local1.description,
		bundleType = f51_local1.bundleType,
		titleImage = f51_local1.titleImage,
		currencyID = f51_local1.currencyID,
		currencyAmount = f51_local1.currencyAmount,
		startPurchaseImmediately = f51_arg0._startPurchaseImmediately,
		timerValue = f51_local1.purchaseEnd,
		bundleIndex = f51_local0,
		positionInGrid = f51_arg0._positionInGrid,
		categoryIndex = f51_arg3.categoryIndex,
		categoryName = f51_arg3.id,
		storeLayout = f51_arg0._storeLayout,
		sourceMenu = f51_arg0._sourceMenu,
		recommendationData = f51_arg0.recommendationData
	}
	f51_arg0._startPurchaseImmediately = false
	if not f51_arg3.justForYou then
		f51_local4.timerPubVar = f51_arg3.timerPubVar
	end
	if Dvar.IBEGCHEFE( "SKLSORKTK" ) and not BATTLEPASS.IsOwned( f51_arg0._controllerIndex ) and STORE.BundleContainsBattlePass( f51_local1.id ) then
		LUI.FlowManager.RequestAddMenu( "BattlePassMenuPopup", true, f51_arg0._controllerIndex, false, {
			purchaseBattlePassInStore = true
		} )
	else
		LUI.FlowManager.RequestAddMenu( "StoreBundlePreview", true, f51_arg0._controllerIndex, false, f51_local4 )
	end
end

local f0_local8 = function ( f48_arg0, f48_arg1 )
	local f48_local0 = {
		CODPOINTS = 0,
		CODEPACK = 2,
		PROPACK = 6,
		FRANCHISE = 5,
		MW2R = 3,
		CDLPACK = 1,
		ZEUS = 4,
		HEADSTARTPACK = 7
	}
	local f48_local1 = {
		f48_local0.MW2R,
		f48_local0.CODEPACK,
		f48_local0.CDLPACK
	}
	local f48_local2 = {
		{
			name = "INGAMESTORE/CATEGORY_CODPOINTS",
			titleImage = "mw_store_title_cod_points",
			asset = "mw_store_billboard_cod_points",
			buttonID = f48_local0.CODPOINTS,
			category = STORE.GetActiveCODPointsCategory()
		},
		{
			name = "LUA_MENU/CWL_MODES",
			titleImage = "mw_store_title_cdl",
			asset = "mw_store_billboard_cdl",
			buttonID = f48_local0.CDLPACK,
			category = STORE.CDLCategory
		},
		{
			name = "LUA_MENU_MP/COD_ENDOWMENT",
			titleImage = "ui_icon_mtx_titles_bundle_code",
			asset = "ui_icon_mtx_billboards_code",
			buttonID = f48_local0.CODEPACK,
			category = STORE.MiscCategory
		},
		{
			name = "INGAMESTORE/PRODUCT_MW2R",
			titleImage = "mw_store_title_ghost_pack_oil_rig",
			asset = "mw_store_billboard_ghost_pack_oil_rig",
			buttonID = f48_local0.MW2R,
			category = STORE.TitlesCategory
		},
		{
			name = "INGAMESTORE/CATEGORY_ZEUS",
			titleImage = "mw_store_title_bocw_standard",
			asset = "mw_store_billboard_bocw_standard",
			buttonID = f48_local0.ZEUS,
			category = STORE.ZeusCategory
		},
		{
			name = "LUA_MENU_MP/COD_ENDOWMENT",
			titleImage = "ui_icon_mtx_titles_pro_pack_s02",
			asset = "ui_icon_mtx_billboards_pro_pack_s02",
			buttonID = f48_local0.PROPACK,
			category = STORE.MiscCategory
		},
		{
			name = "LUA_MENU_MP/COD_ENDOWMENT",
			titleImage = "ui_icon_mtx_titles_sony_psplus_season_02",
			asset = "ui_icon_mtx_billboards_sony_psplus_season_02",
			buttonID = f48_local0.HEADSTARTPACK,
			category = STORE.MiscCategory
		},
		{
			name = "MENU/STORE_CAT_FRANCHISE",
			titleImage = "mw_store_title_franchise_store",
			category = 4294967295,
			asset = "mw_store_billboard_franchise_store",
			buttonID = f48_local0.FRANCHISE
		}
	}
	f48_arg0._allCategoryData[#f48_arg0._allCategoryData].items = {}
	for f48_local3 = 1, #f48_local2, 1 do
		local f48_local6 = f48_local2[f48_local3]
		local f48_local7 = nil
		if f48_local6.category == -1 then
			f48_local7 = {
				buttonID = f48_local6.buttonID,
				asset = f48_local6.asset,
				name = f48_local6.name,
				titleImage = f48_local6.titleImage,
				buttonAction = function ( f50_arg0, f50_arg1 )
					local f50_local0 = STORE.GoToStore
					local f50_local1 = f48_arg0
					local f50_local2 = f48_arg0:GetCurrentMenu()
					f50_local0( f50_local1, f50_local2.id, f50_arg0.id )
				end
			}
		else
			local f48_local8 = InGameStore.GetCategoryProducts( f48_arg1, f48_local6.category )
			if f48_local8 and 0 < #f48_local8 then
				local f48_local9 = f48_local6.category == STORE.MiscCategory
				local f48_local10 = f48_local6.category == STORE.TitlesCategory
				local f48_local11 = f48_local6.category == STORE.ZeusCategory
				local f48_local12 = false
				local f48_local13 = false
				local f48_local14 = false
				local f48_local15 = nil
				if f48_local9 then
					for f48_local16 = 1, #f48_local8, 1 do
						if not (f48_local6.buttonID ~= f48_local0.CODEPACK or f48_local8[f48_local16].productId ~= STORE.CODEID and f48_local8[f48_local16].productId ~= STORE.CODE2ID and f48_local8[f48_local16].productId ~= STORE.CODE3ID) or not (f48_local6.buttonID ~= f48_local0.PROPACK or f48_local8[f48_local16].productId ~= STORE.ProPackS02ID) or f48_local6.buttonID == f48_local0.HEADSTARTPACK and f48_local8[f48_local16].productId == STORE.HeadStart7ID then
							local f48_local19 = InGameStore.GetProduct( f48_arg1, f48_local8[f48_local16].productId )
							local f48_local20
							if f48_local19 then
							
							else
								f48_local20 = f48_local19.status ~= InGameStoreProductStatus.NOT_OWNED
							end
							f48_local20 = f48_local19
						end
					end
				end
				if f48_local10 then
					for f48_local16 = 1, #f48_local8, 1 do
						if f48_local8[f48_local16].productId == STORE.MW2RProductID then
							local f48_local19 = InGameStore.GetProduct( f48_arg1, STORE.MW2RProductID )
							local f48_local20
							if f48_local19 then
							
							else
								f48_local20 = f48_local19.status ~= InGameStoreProductStatus.NOT_OWNED
							end
							f48_local20 = f48_local19
						end
					end
				end
				if f48_local11 then
					local f48_local16 = false
					for f48_local17 = 1, #f48_local8, 1 do
						local f48_local20 = InGameStore.GetProduct( f48_arg1, f48_local8[f48_local17].productId )
						local f48_local22
						if f48_local20 then
							f48_local22 = f48_local20
						else
							f48_local22 = f48_local20.status ~= InGameStoreProductStatus.NOT_OWNED
						end
						if not f48_local14 then
							f48_local14 = not f48_local22
						end
						if f48_local14 and not f48_local15 then
							f48_local15 = f48_local8[f48_local17].productId
						end
						if f48_local22 and f48_local8[f48_local17].productId == STORE.ZeusStandardID then
							f48_local16 = true
						end
					end
					if f48_local16 and f48_local14 and Engine.CGABICJHAI() then
						local f48_local17 = InGameStore.GetProduct( f48_arg1, STORE.ZeusUltimateUpgradeID )
						if f48_local17 then
							f48_local18 = f48_local17
						else
							local f48_local18 = f48_local17.status ~= InGameStoreProductStatus.NOT_OWNED
						end
						if not f48_local18 then
							f48_local6.titleImage = "mw_store_title_bocw_ultimate"
							f48_local6.asset = "mw_store_billboard_bocw_ultimate"
						end
					end
				end
				local f48_local16
				if f48_local10 then
					f48_local16 = f48_local10
				else
					f48_local16 = f48_local13
				end
				local f48_local17
				if f48_local9 then
					f48_local17 = f48_local9
				else
					f48_local17 = f48_local12
				end
				local f48_local18
				if f48_local11 then
					f48_local18 = f48_local11
				else
					f48_local18 = f48_local14
				end
				local f48_local21
				if f48_local10 or f48_local9 or f48_local11 then
					if not f48_local16 then
						f48_local21 = f48_local16
					elseif not f48_local17 then
						f48_local21 = f48_local17
					else
						f48_local21 = f48_local18
					end
				else
					f48_local21 = true
				end
				if f48_local21 then
					local f48_local19 = {
						buttonID = f48_local6.buttonID,
						asset = f48_local6.asset,
						name = f48_local6.name,
						titleImage = f48_local6.titleImage,
						buttonAction = function ( f49_arg0, f49_arg1 )
							local f49_local0 = STORE.GoToStore
							local f49_local1 = f48_arg0
							local f49_local2 = f48_arg0:GetCurrentMenu()
							f49_local2 = f49_local2.id
							local f49_local3 = f49_arg0.id
							local f49_local4 = f48_arg0
							if not f49_local4 then
								f49_local4 = f48_arg0[1].productId
							end
							f49_local0( f49_local1, f49_local2, f49_local3, f49_local4 )
						end
					}
				end
			end
		end
		if f48_local7 then
			if f48_local7.buttonID ~= f48_local0.FRANCHISE and 4 <= #f48_arg0._allCategoryData[#f48_arg0._allCategoryData].items then
				for f48_local8 = 1, #f48_local1, 1 do
					local f48_local12 = false
					for f48_local13 = 1, #f48_arg0._allCategoryData[#f48_arg0._allCategoryData].items, 1 do
						if f48_arg0._allCategoryData[#f48_arg0._allCategoryData].items[f48_local13].buttonID == f48_local1[f48_local8] then
							f48_arg0._allCategoryData[#f48_arg0._allCategoryData].items[f48_local13] = f48_local7
							f48_local12 = true
							break
						end
					end
					if f48_local12 then
						
					end
				end
			end
			table.insert( f48_arg0._allCategoryData[#f48_arg0._allCategoryData].items, f48_local7 )
		end
	end
	f48_arg0:dispatchEventToChildren( {
		name = "categoryTimerUpdate"
	} )
	if f48_arg0._allCategoryData[#f48_arg0._allCategoryData].isFirstPartyCategory and f48_arg0._selectedCategory == f48_arg0._allCategoryData[#f48_arg0._allCategoryData].categoryIndex then
		local f48_local3 = f48_arg0.BundlesGrid:GetElementAtPosition( 0, f48_arg0._selectedCategory - 1 )
		if f48_local3 then
			local f48_local4 = LUI.FlowManager.GetScopedData( f48_arg0 )
			local f48_local5 = f48_local3.RowGrid
			if not f48_local4.firstPartyColumnIndex or f48_local4.firstPartyColumnIndex == 1 then
				local f48_local23 = f48_local5:GetElementAtPosition( 0, 0 )
				f48_local23:processEvent( {
					name = "button_over"
				} )
			else
				f48_local5:SetFocusedPosition( {
					y = 0,
					x = f48_local4.firstPartyColumnIndex - 1
				}, true )
			end
		end
	end
end

local f0_local9 = function ( f46_arg0, f46_arg1 )
	local f46_local0 = STORE.GetZeusCategoryIndex()
	local f46_local1 = f46_arg0._allCategoryData[f46_local0]
	if f46_local1 then
		f46_local1 = f46_arg0._allCategoryData[f46_local0].id
	end
	if not f46_local1 or STORE.CategoryType[f46_local1] ~= STORE.CategoryType.zeus_preorder then
		DebugPrint( "Zeus category missing from allCategoryData" )
	end
	f46_arg0._allCategoryData[f46_local0].items = STORE.GetZeusCategoryData( f46_arg1 )
	if #f46_arg0._allCategoryData[f46_local0].items == 0 then
		DebugPrint( "Zeus category contains no items" )
	end
	local f46_local2 = LUI.FlowManager.GetScopedData( f46_arg0 )
	for f46_local3 = 1, #f46_arg0._allCategoryData[f46_local0].items, 1 do
		f46_arg0._allCategoryData[f46_local0].items[f46_local3].buttonAction = function ( f47_arg0, f47_arg1 )
			f46_arg0.openedZeusUpsell = true
			LUI.FlowManager.RequestAddMenu( "StoreGameUpsellPopup", true, f46_arg0, false, {
				preFetched = true,
				isZeus = true,
				defaultProductId = f46_arg0._allCategoryData[f46_arg0].items[f46_arg0].productId
			}, true )
		end
		
	end
	local f46_local3 = f46_arg0._selectedCategory
	if f46_local3 then
		f46_local3 = f46_arg0._selectedCategory - f46_arg0._allCategoryData[f46_local0].categoryIndex
	end
	if f46_local3 == 1 then
		f46_arg0.BundlesGrid:RefreshContent()
	else
		f46_arg0:dispatchEventToChildren( {
			name = "categoryTimerUpdate"
		} )
	end
	if f46_arg0._allCategoryData[f46_local0].isFirstPartyCategory and f46_arg0._selectedCategory == f46_arg0._allCategoryData[f46_local0].categoryIndex then
		local f46_local4 = f46_arg0.BundlesGrid:GetElementAtPosition( 0, f46_arg0._selectedCategory - 1 )
		if f46_local4 then
			local f46_local5 = LUI.FlowManager.GetScopedData( f46_arg0 )
			local f46_local6 = f46_local4.RowGrid
			if not f46_local5.firstPartyColumnIndex or f46_local5.firstPartyColumnIndex == 1 then
				local f46_local7 = f46_local6:GetElementAtPosition( 0, 0 )
				f46_local7:processEvent( {
					name = "button_over"
				} )
			else
				f46_local6:SetFocusedPosition( {
					y = 0,
					x = f46_local5.firstPartyColumnIndex - 1
				}, true )
			end
		end
	end
end

local f0_local10 = function ( f44_arg0, f44_arg1 )
	InGameStore.FetchCatalog( f44_arg1, false, true )
	f44_arg0._catalogStatus = InGameStore.GetCatalogStatus( f44_arg1 )
	f44_arg0._catalogFetchErrorMessage = Engine.CBBHFCGDIC( "MP_FRONTEND_ONLY/STORE_UNAVAILABLE" )
	
	local _refreshTimer = LUI.UITimer.new( {
		interval = -28,
		event = {
			name = "refresh_timer",
			controllerIndex = f44_arg1
		}
	} )
	_refreshTimer.id = "refreshTimer"
	f44_arg0:addElement( _refreshTimer )
	f44_arg0._refreshTimer = _refreshTimer
	
	f44_arg0:registerEventHandler( "refresh_timer", function ( element, event )
		local f45_local0 = InGameStore.GetCatalogStatus( event.controllerIndex )
		local f45_local1 = false
		if f44_arg0._catalogStatus == InGameStoreCatalogStatus.FETCHING and f45_local0 == InGameStoreCatalogStatus.READY then
			f44_arg0:dispatchEventToChildren( {
				catalogFetched = true,
				name = "categoryTimerUpdate"
			} )
		end
		f44_arg0._catalogStatus = f45_local0
		if f44_arg0._catalogStatus == InGameStoreCatalogStatus.READY then
			f44_arg0( f44_arg0, f44_arg0 )
			f44_arg0( f44_arg0, f44_arg0 )
			f45_local1 = true
		elseif f44_arg0._catalogStatus == InGameStoreCatalogStatus.ERROR then
			f45_local1 = true
			if Engine.DBFCJBDJEC() then
				local f45_local2 = Engine.BIAFEJHHDD()
				if f45_local2 ~= nil then
					f44_arg0._catalogFetchErrorMessage = Engine.CBBHFCGDIC( "MP_FRONTEND_ONLY/STORE_UNAVAILABLE_ERROR", Engine.JCBDICCAH( f45_local2 ) )
					Engine.DCFIDJGACA()
				else
					f44_arg0._catalogFetchErrorMessage = Engine.CBBHFCGDIC( "MP_FRONTEND_ONLY/STORE_UNAVAILABLE_PC" )
				end
			else
				f44_arg0._catalogFetchErrorMessage = Engine.CBBHFCGDIC( "MP_FRONTEND_ONLY/STORE_UNAVAILABLE", Engine.JCBDICCAH( Engine.CIHDHDCIBE() ) )
			end
			Engine.DHCGHHBHCH()
			if Commerce.CCIEAECGHB() then
				f44_arg0( f44_arg0, f44_arg0 )
				f44_arg0( f44_arg0, f44_arg0 )
			else
				f44_arg0._allCategoryData[#f44_arg0._allCategoryData].items[1].fetchingDataFailed = true
				f44_arg0:dispatchEventToChildren( {
					name = "categoryTimerUpdate"
				} )
			end
		end
		if f45_local1 then
			element._refreshTimer:closeTree()
			element._refreshTimer = nil
		end
	end )
end

local f0_local11 = function ( f43_arg0 )
	local f43_local0 = {}
	local f43_local1 = "DefaultSequence"
	local f43_local2 = "DefaultSequence"
	if 1 < f43_arg0._selectedCategory then
		for f43_local3 = f43_arg0._selectedCategory - 1, 1, -1 do
			table.insert( f43_local0, f43_arg0._allCategoryData[f43_local3] )
		end
	end
	if f43_arg0._selectedCategory < #f43_arg0._allCategoryData then
		for f43_local3 = f43_arg0._selectedCategory + 1, #f43_arg0._allCategoryData, 1 do
			table.insert( f43_local0, f43_arg0._allCategoryData[f43_local3] )
		end
	end
	for f43_local3 = 1, #f43_local0, 1 do
		local f43_local6 = f43_local0[f43_local3]
		f43_local6.hasNewItems = false
		f43_local6.hasFreeItems = false
		if f0_local0 and Dvar.IBEGCHEFE( "LSOLLKOPQT" ) then
			f43_local6.hasFreeItems = STORE.CategoryHasFreeItems( f43_arg0._controllerIndex, f43_local6 )
		end
		for f43_local7 = 1, #f43_local6.items, 1 do
			local f43_local10 = f43_local6.items[f43_local7]
			if f43_local10.id and not STORE.HasSeenItem( f43_arg0._controllerIndex, f43_local10.id ) then
				f43_local6.hasNewItems = true
				break
			end
		end
		if f43_local6.categoryIndex < f43_arg0._selectedCategory then
			if f43_local6.hasFreeItems then
				f43_local1 = "Free"
			end
			if f43_local1 ~= "Free" and f43_local6.hasNewItems then
				f43_local1 = "New"
			end
		end
		if f43_arg0._selectedCategory < f43_local6.categoryIndex then
			if f43_local6.hasFreeItems then
				f43_local2 = "Free"
			end
			if f43_local2 ~= "Free" and f43_local6.hasNewItems then
				f43_local2 = "New"
			end
		end
	end
	if f43_local1 == "Free" then
		f43_arg0.ArrowUp:SetFreeState()
	else
		f43_arg0.ArrowUp:ClearState()
		ACTIONS.AnimateSequence( f43_arg0.ArrowUp, f43_local1 )
	end
	if f43_local2 == "Free" then
		f43_arg0.ArrowDown:SetFreeState()
	else
		f43_arg0.ArrowDown:ClearState()
		ACTIONS.AnimateSequence( f43_arg0.ArrowDown, f43_local2 )
	end
end

local f0_local12 = function ( f4_arg0, f4_arg1, f4_arg2 )
	f4_arg0.BillboardCategoryButtonAction = f0_local0
	f4_arg0._gridChildMouseFocusCount = 0
	f4_arg0.FocusBundleByID = function ( f42_arg0, f42_arg1, f42_arg2 )
		f4_arg0( f4_arg0, f42_arg1, f42_arg2 )
	end
	
	f4_arg0.FocusButtonByName = function ( f41_arg0, f41_arg1 )
		f4_arg0( f4_arg0, f41_arg1 )
	end
	
	ACTIONS.ScaleFullscreen( f4_arg0.Background )
	Engine.DHFCHIIJCA( "quartermaster" )
	f4_arg0.BundlesGrid:SetMask( f4_arg0.GridMask )
	f4_arg0.FranchiseStorePrompt:SetText( Engine.CBBHFCGDIC( "LUA_MENU/FRANCHISE_STORE_WITH_PROMPT" ) )
	f4_arg0:addElement( LOOT.GetLootFlareMaterialStreamer() )
	f4_arg0._controllerIndex = f4_arg1
	f4_arg0._promotedItems = STORE.ParsePromotedItems( f4_arg1 )
	f4_arg0._chaseItems = STORE.ParseChaseItems( f4_arg1 )
	local f4_local0 = BATTLEPASS.GetCurrentCPRewards( f4_arg1 )
	f4_arg0._totalCP = f4_local0.totalCP
	local f4_local1 = STORE.GetSaleTimer( f4_arg1 )
	if f4_local1 and 0 < #f4_local1 and tonumber( f4_local1 ) > Engine.DEIDGHDBHD() and 0 < STORE.GetHighestDiscountPercentage( f4_arg1 ) then
		f4_arg0.SaleBanner:SetAlpha( 1 )
	else
		f4_arg0.SaleBanner:SetAlpha( 0 )
	end
	if Dvar.IBEGCHEFE( "MLTTQSTKQS" ) then
		f4_arg0.GridMask:setImage( RegisterMaterial( "stencil_mask" ) )
		f4_arg0.GridMask:SetBottom( -70 * _1080p )
	end
	f0_local0( f4_arg0, f4_arg1 )
	if QUARTERMASTER.itemData then
		QUARTERMASTER.itemData = {}
	end
	f4_arg0.BackButtonOverride = function ( f40_arg0, f40_arg1 )
		local f40_local0 = LUI.FlowManager.GetScopedData( f40_arg0 )
		local f40_local1 = LUI.FlowManager.GetPerControllerPersistentData( f4_arg0 )
		f40_local1._selectedCategory = nil
		if f40_local0.useStandaloneStore then
			LUI.FlowManager.RequestLeaveMenu( f40_arg0 )
		else
			local f40_local2
			if f40_arg1.qualifier == "keyboard" or f40_arg1.qualifier == "gamepad" then
				f40_local2 = false
			else
				f40_local2 = true
			end
			local f40_local3
			if f40_local2 then
				f40_local3 = FocusType.MouseOver
				if not f40_local3 then
				
				else
					local f40_local4 = f40_arg0:getParent()
					local f40_local5 = f40_arg1.controller or f4_arg0
					local f40_local6 = TAB.GetIndex( TAB.MP.PLAY )
					if f4_arg0._returnToEventTabFromStore then
						f40_local6 = TAB.GetIndex( TAB.MP.EVENT )
					end
					f40_local4.Tabs:FocusTab( f40_local5, f40_local6, f40_local3 )
				end
			end
			f40_local3 = FocusType.Gamepad
		end
		return false
	end
	
	local f4_local2 = function ( f39_arg0, f39_arg1, f39_arg2, f39_arg3, f39_arg4 )
		local f39_local0 = LUI.FlowManager.GetPerControllerPersistentData( f4_arg0 )
		f4_arg0._categoryData = f39_arg2
		if f4_arg0.DisableAutoScrollTimer and not f4_arg0._autoScroll then
			f4_arg0.DisableAutoScrollTimer()
		end
		if #f39_arg2.items < f39_arg3 then
			f39_arg3 = 1
		end
		local f39_local1 = f39_arg2.items[f39_arg3]
		if f39_arg4 then
			local f39_local2 = f39_arg4:GetFocusPosition( LUI.DIRECTION.horizontal )
			if f39_local2 then
				f39_local1.positionInGrid = f39_local2 + 1
				f4_arg0._positionInGrid = f39_local1.positionInGrid
			end
		end
		if f39_local1.purchaseEnd then
			local f39_local2, f39_local3, f39_local4 = STORE.GetCategoryTimeLeft( nil, f39_local1.purchaseEnd )
			if f39_local2 <= 0 then
				f4_arg0:dispatchEventToChildren( {
					expiredBundle = true,
					name = "categoryTimerUpdate"
				} )
				return 
			end
		end
		f4_arg0.BillboardItem:UpdateBillboard( f39_local1, f39_arg2.isFirstPartyCategory )
		if not f39_arg2.isFirstPartyCategory then
			if QUARTERMASTER.itemData and QUARTERMASTER.itemData.sessionId ~= nil then
				QUARTERMASTER.RecordMenuBrowseEvent( f4_arg0, false, f4_arg0._sourceMenu )
			end
			if f4_arg0._initialBrowse then
				if not f4_arg0._storeEnterComplete then
					QUARTERMASTER.RecordStoreEnterEvent( f4_arg0, f4_arg0._storeLayout, f4_arg0.recommendationData, f4_arg0._sourceMenu, f4_arg0._allCategoryData )
					f4_arg0._storeEnterComplete = true
				end
				QUARTERMASTER.BeginMenuBrowseEvent( f4_arg0, f39_arg2, f39_local1, f4_arg0._storeLayout, f4_arg0.recommendationData )
			else
				f4_arg0._initialBrowse = true
			end
		end
		local f39_local2 = f4_arg0._selectedCategory ~= f39_arg2.categoryIndex
		f4_arg0._selectedCategory = f39_arg2.categoryIndex
		f39_local0._selectedCategory = f39_arg2.categoryIndex
		f4_arg0._selectedBundle = f39_arg3
		if f39_local2 then
			f4_arg0:dispatchEventToChildren( {
				categoryChanged = true,
				name = "categoryTimerUpdate"
			} )
			f4_arg0( f4_arg0 )
		end
	end
	
	local f4_local3 = Engine.EHGIGBJJC( Store.EHGIGBJJC() )
	local f4_local4 = STORE.GetCategoryData( f4_arg1 )
	f4_arg0._allCategoryData = f4_local4
	f4_arg0._recommendations = STORE.CheckForPersonalRecommendations( f4_arg1 )
	if f4_local3.scheduleFilename then
		f4_arg0._storeSchedule = Engine.DBABFCGGIC( f4_local3.scheduleFilename )
	end
	if not f4_arg0._recommendations then
		f4_arg0.recommendationData = {
			isEnabled = false
		}
	end
	local f4_local5 = LUI.FlowManager.GetScopedData( f4_arg0 )
	local f4_local6 = f4_local5.openedZeusUpsell
	if f4_local6 then
		f4_local6 = STORE.IsZeusOwned( f4_arg1 )
	end
	f4_local5.openedZeusUpsell = nil
	if f4_local6 then
		f4_local5.selectedBundleIndex = nil
		f4_local5.firstPartyColumnIndex = nil
	end
	f4_arg0._allCategoryData[#f4_arg0._allCategoryData + 1] = {
		isFirstPartyCategory = true,
		name = "MENU/STORE_CAT_FRANCHISE"
	}
	for f4_local7 = 1, #f4_local4, 1 do
		local f4_local10 = f4_local4[f4_local7]
		f4_local10.items = f4_local10.items or {}
		f0_local0( f4_arg0, f4_arg1, f4_local10 )
		f4_local10.categoryIndex = f4_local7
	end
	f4_arg0._storeLayout = f4_local3.layoutType
	local f4_local8 = nil
	if LUI.FlowManager.IsMenuOnTop( "BRMainMenuStore" ) then
		f4_local8 = "BladeMenu"
	else
		f4_local8 = -1
	end
	f4_arg0._sourceMenu = f4_local8
	f4_arg0._storeEnterComplete = false
	f4_arg0._initialBrowse = false
	local f4_local11 = f4_arg0:Wait( 2000, true )
	f4_local11.onComplete = function ()
		if not f4_arg0._storeEnterComplete then
			QUARTERMASTER.RecordStoreEnterEvent( f4_arg0, f4_arg0, f4_arg0.recommendationData, f4_arg0, f4_arg0._allCategoryData )
			f4_arg0._storeEnterComplete = true
		end
	end
	
	local f4_local10 = function ( f37_arg0, f37_arg1 )
		if f37_arg1.name then
			if f37_arg1.items[1].emptyCategory then
				f37_arg0.CategoryText:setText( ToUpperCase(), Engine.CBBHFCGDIC( "CAS/X_TO_Y", Engine.CBBHFCGDIC( f37_arg1.name ), Engine.CBBHFCGDIC( "MENU/SOLD_OUT" ) ) )
			else
				f37_arg0.CategoryText:setText( ToUpperCase( Engine.CBBHFCGDIC( f37_arg1.name ) ) )
			end
		else
			f37_arg0.CategoryText:setText( ToUpperCase( Engine.CBBHFCGDIC( "MENU/SOLD_OUT" ) ) )
		end
		f37_arg0:UpdateWZSnipeBar( f37_arg1.rowGameSourceIDOrMixed )
	end
	
	f4_arg0.BundlesGrid:SetRefreshChild( function ( f23_arg0, f23_arg1, f23_arg2 )
		local f23_local0 = f4_arg0[f23_arg2 + 1]
		f23_arg0.RowGrid:SetDefaultFocus( function ()
			local f36_local0 = LUI.FlowManager.GetScopedData( f23_arg0 )
			local f36_local1 = f23_arg0._selectedBundle
			if not f36_local1 then
				f36_local1 = f36_local0.selectedBundleIndex or 1
			end
			if #f23_arg0.items < f36_local1 then
				f36_local1 = #f23_arg0.items
			end
			f36_local0.selectedBundleIndex = nil
			return {
				y = 0,
				x = f36_local1 - 1
			}
		end )
		f23_arg0.RowGrid:SetRefreshChild( function ( f25_arg0, f25_arg1, f25_arg2 )
			local f25_local0 = f23_arg0.items[f25_arg1 + 1]
			if not f25_local0 then
				DebugPrint( "STORE SCROLL BUG: Column: " .. f25_arg1 .. ", Row: " .. f25_arg2 )
				f25_arg0:registerEventHandler( "button_over", function ( element, event )
					
				end )
				f25_arg0:registerEventHandler( "button_action", function ( element, event )
					
				end )
				f25_arg0:registerEventHandler( "mouseenter", function ( element, event )
					
				end )
				f25_arg0:registerEventHandler( "mouseleave", function ( element, event )
					
				end )
				f25_arg0:registerEventHandler( "categoryTimerUpdate", function ( element, event )
					
				end )
				f25_arg0:UpdateNewIndicator( 0 )
				return 
			end
			f25_arg0:UpdateButton( f25_local0, f23_arg0._promotedItems, f23_arg0.isFirstPartyCategory )
			f25_arg0:UpdateChaseItem( f25_local0, f23_arg0._chaseItems )
			if not f23_arg0.isFirstPartyCategory then
				if not f25_local0.emptyCategory and f25_arg0.NewItemNotification and not STORE.HasSeenItem( f23_arg0, f25_local0.id ) then
					f25_arg0:UpdateNewIndicator( 1 )
				else
					f25_arg0:UpdateNewIndicator( 0 )
				end
			else
				f25_arg0:UpdateNewIndicator( 0 )
			end
			f25_arg0:registerEventHandler( "button_over", function ( element, event )
				f25_arg0( element, event, f25_arg0, f25_arg0 + 1, f25_arg0.RowGrid )
				f25_arg0._focusedBundle = element
			end )
			f25_arg0:registerEventHandler( "button_action", function ( element, event )
				f25_arg0:BillboardCategoryButtonAction( element, event, f25_arg0 )
			end )
			f25_arg0:registerEventHandler( "mouseenter", function ( element, event )
				f25_arg0._gridChildMouseFocusCount = f25_arg0._gridChildMouseFocusCount + 1
			end )
			f25_arg0:registerEventHandler( "mouseleave", function ( element, event )
				f25_arg0._gridChildMouseFocusCount = math.max( 0, f25_arg0._gridChildMouseFocusCount - 1 )
			end )
			f25_arg0:registerEventHandler( "categoryTimerUpdate", function ( element, event )
				if not event.expiredBundle and f25_arg0.purchaseEnd then
					local f26_local0, f26_local1, f26_local2 = STORE.GetCategoryTimeLeft( nil, f25_arg0.purchaseEnd )
					if f26_local0 <= 0 then
						f25_arg0:dispatchEventToChildren( {
							expiredBundle = true,
							name = "categoryTimerUpdate"
						} )
					end
				end
			end )
			f25_arg0:UpdateWZSnipeBar( f23_arg0.rowGameSourceIDOrMixed and f25_local0.gameSourceID or nil )
		end )
		f23_arg0._timerValue = nil
		f23_arg0._idPubVarString = nil
		f23_arg0:registerEventHandler( "categoryTimerUpdate", function ( element, event )
			local f24_local0 = f23_arg0.categoryIndex == f23_arg0._selectedCategory
			if f23_arg0.isFirstPartyCategory and not event.firstPartyCategoryIgnoreUpdate then
				if not event.categoryChanged then
					f23_arg0.RowGrid:SetNumRows( 1 )
					f23_arg0.RowGrid:SetNumColumns( #f23_arg0.items )
					f23_arg0.RowGrid:RefreshContent()
				end
				if f24_local0 then
					f23_arg0.NoMoreItemsMessage:SetAlpha( 0 )
				end
				return 
			end
			local f24_local1 = f23_arg0.items[1]
			if f24_local0 then
				if f24_local1.emptyCategory then
					f23_arg0.NoMoreItemsMessage:SetAlpha( 1 )
				else
					f23_arg0.NoMoreItemsMessage:SetAlpha( 0 )
				end
			end
			if not f23_arg0.justForYou then
				local f24_local2, f24_local3, f24_local4 = STORE.GetCategoryTimeLeft( f23_arg0.timerPubVar )
				if not f23_arg0._timerValue and f23_arg0.timerPubVar and f24_local4 ~= "" then
					f23_arg0._timerValue = f24_local4
				end
				local f24_local5 = f23_arg0.idPubVar and Dvar.DHEEJCCJBH( f23_arg0.idPubVar ) or ""
				if not f23_arg0._idPubVarString and f24_local5 ~= "" then
					f23_arg0._idPubVarString = f24_local5
				end
				local f24_local6 = event.expiredBundle and f24_local0
				local f24_local7 = event.catalogFetched
				local f24_local8 = f23_arg0._timerValue
				if f24_local8 then
					f24_local8 = f23_arg0._timerValue ~= f24_local4
				end
				local f24_local9 = f23_arg0._idPubVarString
				if f24_local9 then
					f24_local9 = f23_arg0._idPubVarString ~= f24_local5
				end
				local f24_local10 = event.categoryChanged
				local f24_local11
				if not f24_local6 then
					f24_local11 = f24_local6
				elseif not f24_local7 then
					f24_local11 = f24_local7
				elseif not f24_local8 then
					f24_local11 = f24_local8
				else
					f24_local11 = f24_local9
				end
				if f24_local11 or f24_local10 then
					f23_arg0( f23_arg0, f23_arg0, f23_arg0 )
					if f24_local11 then
						f23_arg0.RowGrid:SetNumRows( 1 )
						f23_arg0.RowGrid:SetNumColumns( #f23_arg0.items )
						f23_arg0.RowGrid:RefreshContent()
					end
					f23_arg0._timerValue = f24_local4
					f23_arg0._idPubVarString = f23_arg0.idPubVarString
					if f24_local6 or f24_local7 and f23_arg0.hasFirstPartyBundle then
						f23_arg0.RowGrid:processEvent( {
							name = "lose_focus"
						} )
						f23_arg0.RowGrid:SetFocusedPosition( {
							x = 0,
							y = 0
						}, true )
					end
				end
			end
			f23_arg0( f23_arg0, f23_arg0 )
		end )
		f23_arg0.RowGrid:SetNumRows( 1 )
		f23_arg0.RowGrid:SetNumColumns( #f23_local0.items )
		f23_arg0.RowGrid:RefreshContent()
		f4_arg0( f23_arg0, f23_local0 )
	end )
	f4_arg0.BundlesGrid:SetNumColumns( 1 )
	f4_arg0.BundlesGrid:SetNumRows( #f4_local4 )
	f4_arg0.BundlesGrid:RefreshContent()
	local self = LUI.UITimer.new( {
		interval = 1000,
		event = {
			firstPartyCategoryIgnoreUpdate = true,
			name = "categoryTimerUpdate"
		}
	} )
	self.id = "timer"
	f4_arg0:addElement( self )
	local f4_local13 = LUI.UITimer.new( {
		event = "autoScrollTimerUpdate",
		interval = f0_local0
	} )
	f4_local13.id = "autoScrollTimer"
	f4_arg0:addElement( f4_local13 )
	f4_arg0._autoScrollEnabled = true
	f4_arg0:registerEventHandler( "autoScrollTimerUpdate", function ( element, event )
		local f22_local0 = LUI.IsLastInputMouseNavigation( f4_arg0 )
		if f22_local0 then
			f22_local0 = 0 < f4_arg0._gridChildMouseFocusCount
		end
		if f4_arg0._autoScrollEnabled and not f22_local0 and f4_arg0._selectedCategory and f4_arg0._selectedBundle and 0 < #f4_arg0 then
			local f22_local1 = f4_arg0[f4_arg0._selectedCategory]
			local f22_local2 = f4_arg0._selectedBundle + 1
			if #f22_local1.items < f22_local2 then
				f22_local2 = 1
			end
			local f22_local3 = f4_arg0.BundlesGrid:GetElementAtPosition( 0, f4_arg0._selectedCategory - 1 )
			if f22_local3 then
				local f22_local4 = f22_local3.RowGrid
				f4_arg0._autoScroll = true
				f22_local4:SetFocusedPosition( {
					y = 0,
					x = f22_local2 - 1
				}, false )
				f4_arg0._autoScroll = false
			end
		end
	end )
	f4_arg0._autoScrollEnabledTimerHolder = LUI.UIElement.new()
	f4_arg0:addElement( f4_arg0._autoScrollEnabledTimerHolder )
	f4_arg0.DisableAutoScrollTimer = function ()
		f4_arg0._autoScrollEnabled = false
		local f20_local0 = f4_arg0._autoScrollEnabledTimerHolder:Wait( Dvar.CFHDGABACF( "NPSTPKMPKS" ), true )
		f20_local0.onComplete = function ()
			f20_local0._autoScrollEnabled = true
		end
		
	end
	
	
	local bindButton = LUI.UIBindButton.new()
	bindButton.id = "bindButton"
	f4_arg0:addElement( bindButton )
	f4_arg0.bindButton = bindButton
	
	f4_arg0.bindButton:addEventHandler( "button_alt1", function ( f19_arg0, f19_arg1 )
		if not f4_arg0[f4_arg0._selectedCategory].isFirstPartyCategory then
			f4_arg0._startPurchaseImmediately = true
			f4_arg0:BillboardCategoryButtonAction( nil, nil, f4_arg0[f4_arg0._selectedCategory] )
		end
	end )
	f4_arg0.bindButton:addEventHandler( "button_alt2", function ( f18_arg0, f18_arg1 )
		Engine.BJDBIAGIDA( SOUND_SETS.default.action )
		if not f4_arg0._storeEnterComplete then
			QUARTERMASTER.RecordStoreEnterEvent( f4_arg0, f4_arg0._storeLayout, f4_arg0.recommendationData, f4_arg0._sourceMenu, f4_arg0._allCategoryData )
			QUARTERMASTER.BeginMenuBrowseEvent( f4_arg0._controllerIndex, f4_arg0._categoryData, f4_arg0._categoryData.items[1], f4_arg0._storeLayout, f4_arg0.recommendationData )
			f4_arg0._storeEnterComplete = true
		end
		QUARTERMASTER.RecordMenuBrowseEvent( f4_arg0, true )
		local f18_local0 = STORE.GoToStore
		local f18_local1 = f4_arg0
		local f18_local2 = f4_arg0:GetCurrentMenu()
		f18_local0( f18_local1, f18_local2.id, f18_arg0.id )
	end )
	f4_arg0.bindButton:addEventHandler( "button_left_stick", function ( f17_arg0, f17_arg1 )
		if Dvar.IBEGCHEFE( "OLNMSNSTKS" ) then
			LUI.FlowManager.RequestPopupMenu( f4_arg0, "CreatorCodePopup", true, f4_arg0, false, f4_arg0 )
			Engine.BJDBIAGIDA( SOUND_SETS.default.selectAlt )
		end
	end )
	f4_arg0.bindButton:addEventHandler( "button_left_trigger", function ( f16_arg0, f16_arg1 )
		LUI.FlowManager.RequestAddMenu( "BundleLockerMenu", true, f4_arg0._controllerIndex, false )
	end )
	f4_arg0:addEventHandler( "gamepad_button", function ( f15_arg0, f15_arg1 )
		if f15_arg1.controller ~= f4_arg0 and (f15_arg1.button == "primary" or f15_arg1.button == "alt1" or f15_arg1.button == "alt2" or f15_arg1.button == "left" or f15_arg1.button == "right" or f15_arg1.button == "up" or f15_arg1.button == "down") then
			return true
		else
			
		end
	end )
	local f4_local15 = function ( f14_arg0, f14_arg1 )
		f14_arg0._menu.HelperBar.ButtonHelperText:PopButtonPrompt( {
			button_ref = "button_alt2"
		} )
		if LUI.IsLastInputGamepad( f4_arg0 ) then
			f14_arg0.FranchiseStorePrompt:SetAlpha( 1 )
			if f14_arg0._gridChildMouseFocusCount == 0 and f14_arg0._focusedBundle then
				f14_arg0._focusedBundle:GainFocus( f14_arg1 )
			end
		else
			f14_arg0.FranchiseStorePrompt:SetAlpha( 0 )
			f14_arg0._menu.HelperBar.ButtonHelperText:PushButtonPrompt( {
				kbm_only = true,
				button_ref = "button_alt2",
				helper_text = Engine.CBBHFCGDIC( "MENU/STORE_CAT_FRANCHISE" ),
				container = f14_arg0.FranchisePromptContainer,
				containerAlignment = LUI.Alignment.Right
			} )
		end
	end
	
	f4_arg0.BundlesGrid:addEventHandler( "layout_initialized", function ( f13_arg0, f13_arg1 )
		f4_arg0._menu = f13_arg0:GetCurrentMenu()
		f4_arg0:addAndCallEventHandler( "update_input_type", f4_arg0 )
		local f13_local0 = LUI.FlowManager.GetPerControllerPersistentData( f4_arg0 )
		if f13_local0._selectedCategory then
			f13_arg0:SetFocusedPosition( {
				x = 0,
				y = f13_local0._selectedCategory - 1
			}, false )
		else
			f13_arg0:GainFocus( {
				controllerIndex = f4_arg0
			} )
		end
	end )
	f4_arg0.ArrowUp:addEventHandler( "grid_focus_up_blocked", function ( f12_arg0, f12_arg1 )
		f12_arg0:SetAlpha( 0, 100 )
	end )
	f4_arg0.ArrowUp:addEventHandler( "grid_focus_up_not_blocked", function ( f11_arg0, f11_arg1 )
		f11_arg0:SetAlpha( 1, 200 )
	end )
	f4_arg0.ArrowDown:addEventHandler( "grid_focus_down_blocked", function ( f10_arg0, f10_arg1 )
		f10_arg0:SetAlpha( 0, 100 )
	end )
	f4_arg0.ArrowDown:addEventHandler( "grid_focus_down_not_blocked", function ( f9_arg0, f9_arg1 )
		f9_arg0:SetAlpha( 1, 200 )
	end )
	local f4_local16 = function ( f8_arg0, f8_arg1 )
		if f8_arg1.down and f8_arg1.qualifier == "mousewheel" then
			return f4_arg0.BundlesGrid:processEvent( f8_arg1 )
		else
			
		end
	end
	
	f4_arg0.BillboardItem.Image:SetHandleMouse( true )
	f4_arg0.BillboardItem.Image:registerEventHandler( "leftmousedown", function ( element, event )
		return true
	end )
	f4_arg0.BillboardItem.Image:registerEventHandler( "leftmouseup", function ( element, event )
		f4_arg0:BillboardCategoryButtonAction( element, event, f4_arg0._allCategoryData[f4_arg0._selectedCategory] )
		return true
	end )
	f4_arg0.BillboardItem.Image:addEventHandler( "gamepad_button", f4_local16 )
	f4_arg0.BundlesGrid._showNumbersAndArrowsKBM = true
	f4_arg0.BundlesGrid._updateArrowVisibilityOnRefresh = false
	f4_arg0.BundlesGrid._alwaysTrapMouseWheel = true
	f4_arg0.MouseScrollCatcher:SetHandleMouse( true )
	f4_arg0.MouseScrollCatcher:OverrideMouseCursorType( MouseCursorType.CURSOR_TYPE_ARROW_NORMAL )
	f4_arg0.MouseScrollCatcher:addEventHandler( "gamepad_button", f4_local16 )
	f4_arg0:addEventHandler( "tab_create", function ( f5_arg0, f5_arg1 )
		local f5_local0 = f5_arg0:GetCurrentMenu()
		if f5_local0 then
			local f5_local1 = LUI.FlowManager.GetScopedData( f5_local0 )
			if f5_local1.returnToEventTabFromStore then
				f5_local1.returnToEventTabFromStore = nil
				f5_arg0._returnToEventTabFromStore = true
			end
		end
	end )
end

function MPStoreBillboardGrid( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "MPStoreBillboardGrid"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	local Background = nil
	
	Background = LUI.UIImage.new()
	Background.id = "Background"
	Background:SetRGBFromInt( 0, 0 )
	Background:SetAlpha( 0.95, 0 )
	Background:setImage( RegisterMaterial( "widg_gradient_bottom_to_top" ), 0 )
	Background:SetVMin( 0.5, 0 )
	self:addElement( Background )
	self.Background = Background
	
	local MouseScrollCatcher = nil
	
	MouseScrollCatcher = LUI.UIImage.new()
	MouseScrollCatcher.id = "MouseScrollCatcher"
	MouseScrollCatcher:SetRGBFromInt( 0, 0 )
	MouseScrollCatcher:SetAlpha( 0, 0 )
	MouseScrollCatcher:setImage( RegisterMaterial( "widg_gradient_bottom_to_top" ), 0 )
	MouseScrollCatcher:SetVMin( 0.5, 0 )
	MouseScrollCatcher:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, _1080p * 200, _1080p * -85 )
	self:addElement( MouseScrollCatcher )
	self.MouseScrollCatcher = MouseScrollCatcher
	
	local BillboardItem = nil
	
	BillboardItem = MenuBuilder.BuildRegisteredType( "StoreBillboardItem", {
		controllerIndex = f1_local1
	} )
	BillboardItem.id = "BillboardItem"
	BillboardItem:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, _1080p * 200, _1080p * 780 )
	self:addElement( BillboardItem )
	self.BillboardItem = BillboardItem
	
	local BundlesGrid = nil
	
	BundlesGrid = LUI.UIPeekingGrid.new( {
		scrollingThresholdX = 1,
		buildArrowsLabel = false,
		maxVelocity = 5000,
		adjustSizeToContent = false,
		scrollingThresholdY = 1,
		wrapX = false,
		maxVisibleColumns = 1,
		maxVisibleRows = 2,
		wrapY = false,
		arrowsVerticalOffset = 0,
		springCoefficient = 400,
		controllerIndex = f1_local1,
		buildChild = function ()
			return MenuBuilder.BuildRegisteredType( "MPStoreBillboardGridRow", {
				controllerIndex = menu
			} )
		end,
		refreshChild = function ( f2_arg0, f2_arg1, f2_arg2 )
			
		end,
		spacingX = _1080p * 0,
		spacingY = _1080p * 0,
		columnWidth = _1080p * 1680,
		rowHeight = _1080p * 190,
		horizontalAlignment = LUI.Alignment.Left,
		verticalAlignment = LUI.Alignment.Top
	} )
	BundlesGrid.id = "BundlesGrid"
	BundlesGrid:setUseStencil( true )
	BundlesGrid:SetAnchorsAndPosition( 0, 0, 1, 0, _1080p * 130, _1080p * -140, _1080p * -370, 0 )
	self:addElement( BundlesGrid )
	self.BundlesGrid = BundlesGrid
	
	local GridMask = nil
	
	GridMask = LUI.UIImage.new()
	GridMask.id = "GridMask"
	GridMask:setImage( RegisterMaterial( "store_bundle_grid_mask" ), 0 )
	GridMask:SetAnchorsAndPosition( 0, 0, 1, 0, _1080p * 120, _1080p * -120, _1080p * -370, _1080p * -54 )
	self:addElement( GridMask )
	self.GridMask = GridMask
	
	local VerticalScrollbar = nil
	
	VerticalScrollbar = MenuBuilder.BuildRegisteredType( "VerticalScrollbar", {
		controllerIndex = f1_local1
	} )
	VerticalScrollbar.id = "VerticalScrollbar"
	VerticalScrollbar:SetAnchorsAndPosition( 1, 0, 1, 0, _1080p * -140, _1080p * -129, _1080p * -330, _1080p * -85 )
	self:addElement( VerticalScrollbar )
	self.VerticalScrollbar = VerticalScrollbar
	
	local NoMoreItemsMessage = nil
	
	NoMoreItemsMessage = MenuBuilder.BuildRegisteredType( "NoMoreItemsMessage", {
		controllerIndex = f1_local1
	} )
	NoMoreItemsMessage.id = "NoMoreItemsMessage"
	NoMoreItemsMessage:SetAlpha( 0, 0 )
	NoMoreItemsMessage:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -512, _1080p * 512, _1080p * -90, _1080p * -10 )
	self:addElement( NoMoreItemsMessage )
	self.NoMoreItemsMessage = NoMoreItemsMessage
	
	local StoreEmpty = nil
	
	StoreEmpty = MenuBuilder.BuildRegisteredType( "EventBanner", {
		controllerIndex = f1_local1
	} )
	StoreEmpty.id = "StoreEmpty"
	StoreEmpty:SetAlpha( 0, 0 )
	StoreEmpty.Backer:SetRGBFromTable( SWATCHES.Store.NoItemBGAlt, 0 )
	StoreEmpty.Backer:SetAlpha( 1, 0 )
	StoreEmpty.Node:SetRGBFromTable( SWATCHES.Store.NoItemTimer, 0 )
	StoreEmpty:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 96, _1080p * 246, _1080p * 160, _1080p * 194 )
	self:addElement( StoreEmpty )
	self.StoreEmpty = StoreEmpty
	
	local ArrowDown = nil
	
	ArrowDown = MenuBuilder.BuildRegisteredType( "StoreScrollArrow", {
		controllerIndex = f1_local1
	} )
	ArrowDown.id = "ArrowDown"
	ArrowDown:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * -250, _1080p * 250, _1080p * -110, _1080p * -60 )
	self:addElement( ArrowDown )
	self.ArrowDown = ArrowDown
	
	local ArrowUp = nil
	
	ArrowUp = MenuBuilder.BuildRegisteredType( "StoreScrollArrow", {
		controllerIndex = f1_local1
	} )
	ArrowUp.id = "ArrowUp"
	ArrowUp:SetZRotation( 180, 0 )
	ArrowUp.FreeBundleText:SetZRotation( 180, 0 )
	ArrowUp:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * -250, _1080p * 250, _1080p * -350, _1080p * -300 )
	self:addElement( ArrowUp )
	self.ArrowUp = ArrowUp
	
	local FranchiseStorePrompt = nil
	
	FranchiseStorePrompt = MenuBuilder.BuildRegisteredType( "PromptButton", {
		controllerIndex = f1_local1
	} )
	FranchiseStorePrompt.id = "FranchiseStorePrompt"
	FranchiseStorePrompt:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -270, _1080p * -70, _1080p * 164, _1080p * 196 )
	self:addElement( FranchiseStorePrompt )
	self.FranchiseStorePrompt = FranchiseStorePrompt
	
	local SupportingCreatorCode = nil
	
	SupportingCreatorCode = MenuBuilder.BuildRegisteredType( "SupportingCreatorCode", {
		controllerIndex = f1_local1
	} )
	SupportingCreatorCode.id = "SupportingCreatorCode"
	SupportingCreatorCode:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -761, _1080p * -371, _1080p * 172, _1080p * 196 )
	self:addElement( SupportingCreatorCode )
	self.SupportingCreatorCode = SupportingCreatorCode
	
	local FranchisePromptContainer = nil
	FranchisePromptContainer = MenuBuilder.BuildRegisteredType( "ButtonPromptContainer", {
		controllerIndex = f1_local1
	} )
	FranchisePromptContainer.id = "FranchisePromptContainer"
	if CONDITIONS.AlwaysFalse( self ) then
		FranchisePromptContainer.Label:setText( "", 0 )
	end
	FranchisePromptContainer:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -361, _1080p * -130, _1080p * 165, _1080p * 196 )
	self:addElement( FranchisePromptContainer )
	self.FranchisePromptContainer = FranchisePromptContainer
	
	local SaleBanner = nil
	
	SaleBanner = MenuBuilder.BuildRegisteredType( "StoreSaleBanner", {
		controllerIndex = f1_local1
	} )
	SaleBanner.id = "SaleBanner"
	SaleBanner:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1559, _1080p * 200, _1080p * 237 )
	self:addElement( SaleBanner )
	self.SaleBanner = SaleBanner
	
	local f1_local17 = LUI.UIScrollbar.new
	local f1_local18 = {
		direction = LUI.DIRECTION.vertical,
		eventListener = VerticalScrollbar,
		startCap = VerticalScrollbar.startCap,
		endCap = VerticalScrollbar.endCap,
		sliderArea = VerticalScrollbar.sliderArea
	}
	local f1_local19 = VerticalScrollbar.sliderArea
	if f1_local19 then
		f1_local19 = VerticalScrollbar.sliderArea.slider
	end
	f1_local18.slider = f1_local19
	f1_local19 = VerticalScrollbar.sliderArea
	if f1_local19 then
		f1_local19 = VerticalScrollbar.sliderArea.fixedSizeSlider
	end
	f1_local18.fixedSizeSlider = f1_local19
	BundlesGrid:AddScrollbar( f1_local17( f1_local18 ) )
	BundlesGrid:AddArrow( ArrowUp )
	BundlesGrid:AddArrow( ArrowDown )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "MPStoreBillboardGrid", MPStoreBillboardGrid )
LockTable( _M )
