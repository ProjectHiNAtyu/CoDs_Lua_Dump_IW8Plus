-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:51
module( ..., package.seeall )
local f0_local0 = function ( f7_arg0, f7_arg1, f7_arg2 )
	local f7_local0 = function ()
		ACTIONS.AnimateSequence( f7_arg0, "StopArmorEmptyHint" )
		f7_arg0._emptyHasBeenShown = false
		if f7_arg0._emptyHintKillTimer then
			f7_arg0._emptyHintKillTimer:closeTree()
			f7_arg0._emptyHintKillTimer = nil
		end
	end
	
	f7_arg0._emptyHintHasBeenShown = false
	local f7_local1 = function ()
		local f9_local0 = DataSources.inGame.player.healthEquipment.numCharges:GetValue( f7_arg0 )
		local f9_local1 = (DataSources.inGame.player.BRData.armorHealthRatio:GetValue( f7_arg0 ) or 0) == 0
		local f9_local2 = 0 < f9_local0
		local f9_local3 = DataSources.inGame.player.BRData.PlayerStatusIsDowned:GetValue( f7_arg0 )
		local f9_local4 = DataSources.inGame.MP.currentVehicle:GetValue( f7_arg0 )
		local f9_local5
		if f9_local4 then
			f9_local5 = f9_local4
		else
			f9_local5 = 0 <= f9_local4
		end
		if f9_local3 or f9_local5 or DataSources.inGame.HUD.hints.interactiveObject.popup.shouldShow:GetModel( f7_arg0 ) then
			f7_arg0()
		elseif f9_local1 and f9_local2 then
			if not f7_arg0._emptyHasBeenShown then
				f7_arg0._emptyHasBeenShown = true
				ACTIONS.AnimateSequence( f7_arg0, "ArmorEmptyHint" )
				local f9_local6
				if Engine.BGGJFFFAFG( f7_arg0 ) then
					f9_local6 = "MP_BR_INGAME/USE_ARMOR"
				else
					f9_local6 = "MP_BR_INGAME/USE_ARMOR_KBM"
				end
				f7_arg0.ArmorHint:setText( ToUpperCase( Engine.CBBHFCGDIC( f9_local6 ) ) )
				f7_arg0._emptyHintKillTimer = LUI.UITimer.new( {
					disposable = true,
					interval = BR.ARMOR_EMPTY_HINT_MAX_ANIM_LENGTH,
					event = {
						name = "stop_empty_armor_hint"
					}
				} )
				f7_arg0._emptyHintKillTimer.id = "emptyHintKillTimer"
				f7_arg0:addElement( f7_arg0._emptyHintKillTimer )
				f7_arg0._emptyHintKillTimer:registerEventHandler( "stop_empty_armor_hint", function ( element )
					f9_local0()
				end )
			end
		elseif f7_arg0._emptyHintKillTimer then
			f7_arg0()
		end
	end
	
	local f7_local2 = LUI.DataSourceFromOmnvar.new( "ui_veh_current_seat" )
	f7_arg0:SubscribeToModel( f7_local2:GetModel( f7_arg1 ), f7_local1 )
	f7_arg0:SubscribeToModel( DataSources.inGame.player.healthEquipment.icon:GetModel( f7_arg1 ), f7_local1 )
	f7_arg0:SubscribeToModel( DataSources.inGame.player.healthEquipment.numCharges:GetModel( f7_arg1 ), f7_local1 )
	f7_arg0:SubscribeToModel( DataSources.inGame.MP.spectating.isSpectating:GetModel( f7_arg1 ), f7_local1 )
	f7_arg0:SubscribeToModel( DataSources.inGame.player.BRData.armorHealthRatio:GetModel( f7_arg1 ), f7_local1 )
	f7_arg0:SubscribeToModel( DataSources.inGame.player.BRData.PlayerStatusIsDowned:GetModel( f7_arg1 ), f7_local1 )
	f7_arg0:SubscribeToModel( DataSources.inGame.HUD.hints.interactiveObject.popup.shouldShow:GetModel( f7_arg1 ), f7_local1 )
	local f7_local3 = 0.9
	f7_arg0._fullHintHasBeenShown = false
	local f7_local4 = function ( f8_arg0 )
		if (DataModel.JJEHAEBDF( DataSources.inGame.player.BRData.armorHealthRatio:GetModel( f7_arg0 ) ) or 0) / BRLOOT.MAX_ARMOR == 1 and 0 < DataSources.inGame.player.healthEquipment.numCharges:GetValue( f7_arg0 ) then
			if f7_arg0 <= DataModel.JJEHAEBDF( f8_arg0 ) then
				if not f7_arg0._fullHintHasBeenShown then
					ACTIONS.AnimateSequence( f7_arg0, "ArmorFullHint" )
					f7_arg0._fullHintHasBeenShown = true
				end
			else
				f7_arg0._fullHintHasBeenShown = false
			end
		end
	end
	
	local f7_local5 = LUI.DataSourceInControllerModel.new( "cg.player.currentWeapon.altModeHoldProgress" )
	f7_arg0:SubscribeToModel( f7_local5:GetModel( f7_arg1 ), f7_local4 )
end

function BRArmorHintPopUp( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 600 * _1080p, 0, 32 * _1080p )
	self.id = "BRArmorHintPopUp"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	local ArmorHint = nil
	
	ArmorHint = LUI.UIStyledText.new()
	ArmorHint.id = "ArmorHint"
	ArmorHint:SetRGBFromTable( SWATCHES.HUD.HUDMain, 0 )
	ArmorHint:setText( ToUpperCase( "" ), 0 )
	ArmorHint:SetFont( FONTS.GetFont( FONTS.MainRegular.File ) )
	ArmorHint:SetAlignment( LUI.Alignment.Center )
	ArmorHint:SetTintFontIcons( true )
	ArmorHint:SetShadowMaxDistance( 0.01, 0 )
	ArmorHint:SetShadowUOffset( -0.002, 0 )
	ArmorHint:SetShadowVOffset( -0.001, 0 )
	ArmorHint:SetShadowRGBFromTable( SWATCHES.HUD.HUDShadow, 0 )
	ArmorHint:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -300, _1080p * 300, _1080p * -12, _1080p * 12 )
	self:addElement( ArmorHint )
	self.ArmorHint = ArmorHint
	
	self._sequences.DefaultSequence = function ()
		
	end
	
	self._sequences.Splitscreen = function ()
		
	end
	
	local f1_local4 = nil
	ArmorHint:RegisterAnimationSequence( "ArmorFullHint", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Text,
			value = ToUpperCase( Engine.CBBHFCGDIC( "MP_BR_INGAME/ARMOR_PLATES_FULL" ) )
		},
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			value = 1.9035983712402182E+185,
			duration = 150,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			value = 1.9035983712402182E+185,
			duration = 1950,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			value = 0,
			duration = 150,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.ArmorFullHint = function ()
		menu:AnimateSequence( "ArmorFullHint" )
	end
	
	local f1_local5 = nil
	ArmorHint:RegisterAnimationSequence( "ArmorEmptyHint", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			value = 5.297218497E-315,
			duration = 800,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			value = 5.297218497E-315,
			duration = 1400,
			property = TWEEN_PROPERTY.Alpha
		},
		{
			value = 0,
			duration = 1000,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.ArmorEmptyHint = function ()
		menu:AnimateLoop( "ArmorEmptyHint" )
	end
	
	local f1_local6 = nil
	ArmorHint:RegisterAnimationSequence( "StopArmorEmptyHint", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Text,
			value = ToUpperCase( Engine.CBBHFCGDIC( "MP_BR_INGAME/USE_ARMOR" ) )
		},
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.StopArmorEmptyHint = function ()
		menu:AnimateSequence( "StopArmorEmptyHint" )
	end
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "BRArmorHintPopUp", BRArmorHintPopUp )
LockTable( _M )
