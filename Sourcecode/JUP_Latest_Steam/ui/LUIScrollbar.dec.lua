-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
LUI.UIScrollbar = LUI.Class()
LUI.UIScrollbar.init = function ( f21_arg0, f21_arg1 )
	local f21_local0 = f21_arg0
	if not f21_arg1 then
		f21_arg1 = {}
	end
	f21_arg0._eventListener = f21_arg1.eventListener
	f21_arg0._sliderArea = f21_arg1.sliderArea
	f21_arg0._slider = f21_arg1.slider
	f21_arg0._fixedSizeSlider = f21_arg1.fixedSizeSlider
	f21_arg0._fixedSizeAmount = f21_arg1.fixedSizeAmount
	local f21_local1 = f21_arg1.animationDuration
	if not f21_local1 then
		f21_local1 = 80
	end
	f21_arg0._animationDuration = f21_local1
	f21_local1 = f21_arg1.direction
	if not f21_local1 then
		f21_local1 = LUI.DIRECTION.vertical
	end
	f21_arg0._direction = f21_local1
	f21_local1 = f21_arg1.skipScrollbarResize
	if not f21_local1 then
		f21_local1 = f21_arg1.fixedSizeAmount
	end
	f21_arg0._skipScrollbarResize = f21_local1
	f21_arg0._eventListener:SetNotifyOnLayoutInit( true )
	f21_arg0._eventListener:addEventHandler( "layout_initialized", function ( f36_arg0, f36_arg1 )
		if f21_arg0._source and f21_arg0._fixedSizeAmount then
			f21_arg0:UpdateScrolling()
		end
		f36_arg0:RegisterActionable( f36_arg1 )
	end )
	if f21_arg0._fixedSizeSlider then
		local f21_local1, f21_local2, f21_local3, f21_local4 = f21_arg0._fixedSizeSlider:getLocalRect()
		if f21_arg0._direction == LUI.DIRECTION.horizontal then
			f21_arg0._initialFixedWidth = f21_local3 - f21_local1
		else
			f21_arg0._initialFixedHeight = f21_local4 - f21_local2
		end
		f21_arg0._fixedSizeSlider.m_requireFocusType = FocusType.MouseOver
	end
	if f21_arg0._sliderArea then
		f21_arg0._sliderArea.m_requireFocusType = FocusType.MouseOver
	end
	if f21_arg0._slider then
		f21_arg0._slider.m_requireFocusType = FocusType.MouseOver
	end
	if f21_arg1.startCap then
		f21_arg1.startCap:addEventHandler( "button_action", function ( f35_arg0, f35_arg1 )
			if f21_arg0._source then
				return f21_arg0._source:processEvent( {
					name = "scrollbar_previous",
					scrollbar = f21_arg0
				} )
			else
				
			end
		end )
		f21_arg1.startCap:addEventHandler( "leftmousedown", function ( f34_arg0, f34_arg1 )
			return true
		end )
	end
	if f21_arg1.endCap then
		f21_arg1.endCap:addEventHandler( "button_action", function ( f33_arg0, f33_arg1 )
			if f21_arg0._source then
				return f21_arg0._source:processEvent( {
					name = "scrollbar_next",
					scrollbar = f21_arg0
				} )
			else
				
			end
		end )
		f21_arg1.endCap:addEventHandler( "leftmousedown", function ( f32_arg0, f32_arg1 )
			return true
		end )
	end
	if f21_arg1.sliderArea and (f21_arg1.slider or f21_arg1.fixedSizeSlider) then
		f21_local1 = {
			x = 0,
			y = 0
		}
		local f21_local2 = false
		local f21_local3 = function ( f31_arg0, f31_arg1 )
			if not f21_arg0:IsKBMStyle() then
				return 
			elseif not f31_arg0:IsDisabled() then
				local f31_local0 = f21_arg0._sliderArea:getWidth()
				local f31_local1 = f21_arg0._sliderArea:getHeight()
				local f31_local2, f31_local3, f31_local4, f31_local5 = f21_arg0._sliderArea:getRect()
				f31_local2, f31_local3 = f31_arg1.root:PixelsToUnits( f31_local2, f31_local3 )
				local f31_local6, f31_local7 = f31_arg1.root:PixelsToUnits( f31_arg1.x, f31_arg1.y )
				if f31_arg1.name == "leftmousedown" then
					local f31_local8, f31_local9, f31_local10, f31_local11 = f31_arg0:getRect()
					local f31_local12, f31_local13 = f31_arg1.root:PixelsToUnits( f31_local8, f31_local9 )
					f31_local9 = f31_local13
					f21_arg0.x = f31_local6 - f31_local12
					f21_arg0.y = f31_local7 - f31_local9
				end
				f21_arg0._source:processEvent( {
					name = "scrollbar_drag",
					targetX = LUI.clamp( (f31_local6 - f21_arg0.x - f31_local2) / f31_local0, 0, 1 ),
					targetY = LUI.clamp( (f31_local7 - f21_arg0.y - f31_local3) / f31_local1, 0, 1 ),
					dragStart = f31_arg1.name == "leftmousedown",
					scrollbar = f21_arg0
				} )
				if f31_arg1.name == "mousedrag" then
					f21_arg0 = true
				end
				f31_arg0._isUsingMouseDrag = f21_arg0
				return true
			else
				
			end
		end
		
		local f21_local4 = function ( f30_arg0, f30_arg1 )
			if not f21_arg0:IsKBMStyle() then
				return 
			elseif not f30_arg0:IsDisabled() and f21_arg0._source then
				f21_arg0._source:processEvent( {
					name = "scrollbar_mouse_up",
					scrollbarWasDragged = f21_arg0,
					scrollbar = f21_arg0
				} )
			end
			f21_arg0 = false
			f30_arg0._isUsingMouseDrag = f21_arg0
		end
		
		local f21_local5 = function ( f29_arg0, f29_arg1 )
			if not f21_arg0:IsKBMStyle() then
				return 
			elseif not f29_arg0:IsDisabled() then
				local f29_local0 = f21_arg0._sliderArea:getWidth()
				local f29_local1 = f21_arg0._sliderArea:getHeight()
				local f29_local2, f29_local3, f29_local4, f29_local5 = f21_arg0._sliderArea:getRect()
				f29_local2, f29_local3 = f29_arg1.root:PixelsToUnits( f29_local2, f29_local3 )
				local f29_local6, f29_local7 = f29_arg1.root:PixelsToUnits( f29_arg1.x, f29_arg1.y )
				f21_arg0._source:processEvent( {
					name = "scrollbar_set",
					targetX = LUI.clamp( (f29_local6 - f29_local2) / f29_local0, 0, 1 ),
					targetY = LUI.clamp( (f29_local7 - f29_local3) / f29_local1, 0, 1 ),
					scrollbar = f21_arg0
				} )
				return true
			else
				
			end
		end
		
		local f21_local6 = function ( f28_arg0, f28_arg1 )
			Engine[0xD1619221CBAF878]( true )
			f21_arg0( f28_arg0, f28_arg1 )
			return true
		end
		
		local f21_local7 = function ( f27_arg0, f27_arg1 )
			Engine[0xD1619221CBAF878]( false )
			f21_arg0( f27_arg0, f27_arg1 )
			return true
		end
		
		local f21_local8 = f21_arg1.slider
		if not f21_local8 then
			f21_local8 = f21_arg1.fixedSizeSlider
		end
		local f21_local9 = f21_arg1.sliderArea
		local f21_local10 = f21_local9:getParent()
		f21_local8:registerEventHandler( "leftmousedown", f21_local6 )
		f21_local8:registerEventHandler( "leftmouseup", f21_local7 )
		f21_local8:registerEventHandler( "mouse_capture_lost", f21_local7 )
		f21_local8:registerEventHandler( "mousedrag", f21_local3 )
		f21_local9:registerEventHandler( "leftmousedown", f21_local5 )
		f21_local8:addEventHandler( "gamepad_button", function ( f26_arg0, f26_arg1 )
			if CONDITIONS.IsMouseWheelEvent( f26_arg1 ) and f26_arg0.mouseWheelTarget then
				return f26_arg0.mouseWheelTarget:processEventNoDispatch( f26_arg1 )
			end
			CONDITIONS.IsDirectionalInput( f26_arg0, f26_arg1 )
			if f21_arg0 then
				f26_arg0.m_leftMouseDown = nil
			end
		end )
		if f21_local10 then
			f21_local10:addEventHandler( "leftmousedown", function ( f25_arg0, f25_arg1 )
				f25_arg0:dispatchEventToAllChildren( f25_arg1 )
			end )
			f21_local10:addEventHandler( "leftmouseup", function ( f24_arg0, f24_arg1 )
				f24_arg0:dispatchEventToAllChildren( f24_arg1 )
			end )
			f21_local10:addEventHandler( "mouse_capture_lost", function ( f23_arg0, f23_arg1 )
				f23_arg0:dispatchEventToAllChildren( f23_arg1 )
			end )
			f21_local10:addEventHandler( "mousedrag", function ( f22_arg0, f22_arg1 )
				f22_arg0:dispatchEventToAllChildren( f22_arg1 )
			end )
		end
	end
end

LUI.UIScrollbar.ResizeScrollbar = function ( f19_arg0 )
	if f19_arg0._skipScrollbarResize then
		
	else
		
	end
	if f19_arg0._direction == LUI.DIRECTION.vertical then
		local f19_local0, f19_local1, f19_local2, f19_local3 = f19_arg0._eventListener:getCurrentGlobalRect()
		local f19_local4, f19_local5, f19_local6, f19_local7 = f19_arg0._source:getCurrentGlobalRect()
		local f19_local8 = f19_arg0._source:GetScale()
		local f19_local9 = function ( f20_arg0, f20_arg1, f20_arg2, f20_arg3, f20_arg4 )
			local f20_local0 = {
				x = f20_arg0,
				y = f20_arg2
			}
			local f20_local1 = {
				x = f20_arg1,
				y = f20_arg2
			}
			local f20_local2 = {
				x = f20_arg0 + math.abs( f20_arg0 - f20_arg1 ) / 2,
				y = f20_arg2 - math.abs( f20_arg2 - f20_arg3 ) / 2
			}
			local f20_local3 = math.sqrt( math.pow( f20_local1.x - f20_local2.x, 2 ) + math.pow( f20_local1.y - f20_local2.y, 2 ) ) * f20_arg4
			return f20_arg0 - f20_local3, f20_arg1 + f20_local3
		end
		
		if f19_local4 ~= nil and f19_local0 ~= nil and (not f19_arg0._cachedGridWidth or math.abs( f19_arg0._cachedGridWidth - f19_local6 - f19_local4 ) > LUI.UIGrid.GRID_EPSILON) then
			f19_arg0._cachedGridWidth = f19_local6 - f19_local4
			f19_local4, f19_local6 = f19_local9( f19_local4, f19_local6, f19_local5, f19_local7, f19_local8 )
			local f19_local10, f19_local11, f19_local12, f19_local13 = f19_arg0._eventListener:getLocalRect()
			local f19_local14 = f19_local12 - f19_local10
			local f19_local15 = f19_local0 < f19_local4
			if f19_local15 then
				f19_arg0._eventListener:SetRight( f19_local12 + f19_local4 - f19_local2 )
			else
				f19_arg0._eventListener:SetLeft( f19_local10 - f19_local0 - f19_local6 )
			end
			f19_arg0:UpdateSliderAreaVertical( f19_local15 )
		end
	end
	f19_arg0:UpdateScrolling()
end

LUI.UIScrollbar.UpdateSliderAreaVertical = function ( f18_arg0, f18_arg1 )
	local f18_local0, f18_local1, f18_local2, f18_local3 = f18_arg0._sliderArea:getLocalRect()
	if f18_arg1 then
		f18_arg0._sliderArea:SetAnchorsAndPosition( 0, 1, 0, 0, 0, math.abs( f18_local2 ) + math.abs( f18_local0 ), 0, 0 )
	else
		f18_arg0._sliderArea:SetAnchorsAndPosition( 1, 0, 0, 0, -(math.abs( f18_local2 ) + math.abs( f18_local0 )), 0, 0, 0 )
	end
end

LUI.UIScrollbar.UpdateScrolling = function ( f17_arg0 )
	f17_arg0:UpdateSlider()
	if f17_arg0._eventListener then
		local f17_local0 = 0
		local f17_local1 = f17_arg0._source
		local f17_local2 = f17_arg0._direction
		local f17_local3 = f17_local1:GetContentSizeByAxis( f17_local2 )
		if f17_local3 then
			f17_local0 = f17_local1:GetContentVisibleSize( f17_local2 )
		end
		local f17_local4 = false
		local f17_local5 = f17_arg0._source.useSingleRowHeightForScrollbars
		if f17_local3 and (f17_local0 < f17_local3 or f17_local5) then
			local f17_local6 = f17_local0 < f17_local3
			if f17_local5 and f17_local3 * 2 < f17_local0 then
				f17_local6 = true
			end
			if f17_local6 then
				f17_local4 = true
			end
		end
		if f17_local4 then
			f17_arg0._eventListener:processEvent( {
				name = "scrollbar_not_all_visible"
			} )
			f17_arg0._eventListener:SetMouseFocusBlocker( false )
			f17_arg0.isVisible = true
		else
			f17_arg0._eventListener:processEvent( {
				name = "scrollbar_all_visible"
			} )
			f17_arg0._eventListener:SetMouseFocusBlocker( true )
			f17_arg0.isVisible = false
		end
	end
end

LUI.UIScrollbar.ShowScrollbar = function ( f16_arg0, f16_arg1 )
	if f16_arg0._sliderArea then
		f16_arg0._sliderArea:processEvent( {
			name = "expand",
			controller = f16_arg1.controller or f16_arg1.controllerIndex,
			focusType = FocusType.MouseOver
		} )
	end
end

LUI.UIScrollbar.HideScrollbar = function ( f15_arg0, f15_arg1 )
	if f15_arg0._sliderArea then
		f15_arg0._sliderArea:processEvent( {
			name = "shrink",
			controller = f15_arg1.controller or f15_arg1.controllerIndex,
			focusType = FocusType.MouseOver
		} )
	end
end

LUI.UIScrollbar.UpdateInputType = function ( f14_arg0, f14_arg1, f14_arg2 )
	if f14_arg0._isMouseInside and LUI.IsLastInputMouseNavigation( f14_arg2.controllerIndex ) then
		f14_arg0:ShowScrollbar( f14_arg2 )
	else
		f14_arg0:HideScrollbar( f14_arg2 )
	end
end

LUI.UIScrollbar.LinkTo = function ( f7_arg0, f7_arg1 )
	f7_arg0._source = f7_arg1
	if not CONDITIONS.IsMobileOrMobileSim() then
		f7_arg1:addEventHandler( "mouseenter", function ( f13_arg0, f13_arg1 )
			f7_arg0._isMouseInside = true
			f7_arg0:HideScrollbar( f13_arg1 )
		end )
		f7_arg1:addEventHandler( "gain_focus", function ( f12_arg0, f12_arg1 )
			if LUI.IsLastInputMouseNavigation( f12_arg1.controller or f12_arg0._controllerIndex ) then
				f7_arg0:HideScrollbar( f12_arg1 )
			end
		end )
		f7_arg1:addEventHandler( "mouseleave", function ( f11_arg0, f11_arg1 )
			f7_arg0._isMouseInside = false
		end )
		f7_arg0._eventListener:addEventHandler( "mouseleave", function ( f10_arg0, f10_arg1 )
			f7_arg0:HideScrollbar( f10_arg1 )
		end )
		f7_arg1:addEventHandler( "lose_focus", function ( f9_arg0, f9_arg1 )
			f7_arg0:HideScrollbar( f9_arg1 )
		end )
		f7_arg1:addEventHandler( "grid_size_updated", function ()
			f7_arg0:ResizeScrollbar()
		end )
		f7_arg0:ResizeScrollbar()
	end
end

LUI.UIScrollbar.GetDirection = function ( f6_arg0 )
	return f6_arg0._direction
end

LUI.UIScrollbar.GetWidget = function ( f5_arg0 )
	return f5_arg0._eventListener
end

LUI.UIScrollbar.SetLinkedGridDataSource = function ( f4_arg0, f4_arg1 )
	
end

LUI.UIScrollbar.IsKBMStyle = function ( f3_arg0 )
	local f3_local0 = f3_arg0._KBMStyle
	if not f3_local0 then
		if f3_arg0._fixedSizeSlider then
			f3_local0 = f3_arg0._source._controllerIndex
			if f3_local0 then
				f3_local0 = LUI.IsLastInputKeyboardMouse( f3_arg0._source._controllerIndex )
			end
		else
			f3_local0 = true
		end
	end
	return f3_local0
end

LUI.UIScrollbar.SetKBMStyle = function ( f2_arg0, f2_arg1 )
	f2_arg0._KBMStyle = f2_arg1
end

LUI.UIScrollbar.UpdateSlider = function ( f1_arg0 )
	local f1_local0 = f1_arg0._slider or f1_arg0._fixedSizeSlider
	if not f1_local0 then
		return 
	end
	local f1_local1 = f1_arg0._direction
	local f1_local2 = f1_arg0._source:GetContentSizeByAxis( f1_local1 )
	if not f1_local2 or f1_local2 == 0 then
		return 
	end
	local f1_local3 = math.min( f1_arg0._source:GetContentVisibleSize( f1_local1 ), f1_local2 )
	local f1_local4, f1_local5 = nil
	local f1_local6 = f1_arg0._source._controllerIndex
	if not (not f1_arg0:IsKBMStyle() or f1_arg0._KBMStyle ~= nil) or f1_arg0._KBMStyle == true then
		local f1_local7 = f1_arg0._source:GetContentOffset( f1_local1 )
		if not f1_local7 then
			f1_local7 = 0
			f1_local3 = 1
			f1_local2 = 1
		end
		f1_local4 = f1_local7 / f1_local2
		local f1_local8 = nil
		if not f1_arg0._skipScrollbarResize then
			f1_local8 = f1_local3 / f1_local2
		elseif f1_arg0._fixedSizeAmount then
			f1_local8 = f1_arg0._fixedSizeAmount
			local f1_local9 = 1 - f1_local3 / f1_local2
			if 0 < f1_local9 then
				f1_local4 = (1 - f1_local8) / f1_local9 * f1_local4
			end
		else
			f1_local8 = LUI.clamp( f1_local3 / f1_local2, 0.1, 0.9 )
			f1_arg0._fixedSizeAmount = f1_local8
		end
		f1_local5 = f1_local4 + f1_local8
		f1_local4 = LUI.clamp( f1_local4, 0, 1 - f1_local8 )
		f1_local5 = LUI.clamp( f1_local5, f1_local8, 1 )
	else
		local f1_local7 = f1_arg0._source:GetFocusPosition( f1_arg0._direction )
		if not f1_local7 or f1_local7 < 0 then
			f1_local7 = 0
		end
		f1_local2 = f1_arg0._source:GetContentCount( f1_arg0._direction )
		local f1_local8 = f1_arg0._sliderArea
		if not f1_local8 then
			f1_local8 = f1_local0:getParent()
		end
		local f1_local9
		if f1_local1 == LUI.DIRECTION.horizontal then
			f1_local9 = f1_local8:getWidth()
			if not f1_local9 then
			
			else
				local f1_local10 = nil
				if f1_arg0._source.useSingleRowHeightForScrollbars then
					if f1_local2 * f1_arg0._source:GetRowHeight() <= f1_local3 then
						f1_local10 = f1_local3
					else
						f1_local10 = f1_local3 / f1_local2
					end
				else
					if f1_local1 == LUI.DIRECTION.horizontal then
						local f1_local11 = f1_arg0._initialFixedWidth
						if not f1_local11 then
							f1_local10 = f1_local11
						else
							f1_local10 = f1_arg0._initialFixedHeight
						end
					end
					f1_local10 = f1_arg0._initialFixedHeight
				end
				if f1_local2 <= 1 or f1_local9 <= 1 then
					f1_local4 = 0
					f1_local5 = 0
				else
					f1_local4 = f1_local7 / (f1_local2 - 1) * (f1_local9 - f1_local10) / f1_local9
					f1_local5 = f1_local4 + f1_local10 / f1_local9
				end
			end
		end
		f1_local9 = f1_local8:getHeight()
	end
	local f1_local7 = false
	if not f1_arg0._lastContentSize or not f1_arg0._lastContentVisibleSize or f1_arg0._lastContentSize <= f1_arg0._lastContentVisibleSize then
		f1_local7 = true
	end
	local f1_local8
	if f1_local7 then
		f1_local8 = 0
	else
		f1_local8 = f1_arg0._animationDuration
	end
	if f1_local1 == LUI.DIRECTION.horizontal then
		f1_local0:SetLeftAnchor( f1_local4, f1_local8, LUI.EASING.outCubic )
		f1_local0:SetRightAnchor( 1 - f1_local5, f1_local8, LUI.EASING.outCubic )
		f1_local0:SetLeft( 0, f1_local8 )
		f1_local0:SetRight( 0, f1_local8 )
	else
		f1_local0:SetTopAnchor( f1_local4, f1_local8, LUI.EASING.outCubic )
		f1_local0:SetBottomAnchor( 1 - f1_local5, f1_local8, LUI.EASING.outCubic )
		f1_local0:SetTop( 0, f1_local8 )
		f1_local0:SetBottom( 0, f1_local8 )
	end
	f1_arg0._lastContentSize = f1_local2
	f1_arg0._lastContentVisibleSize = f1_local3
end

