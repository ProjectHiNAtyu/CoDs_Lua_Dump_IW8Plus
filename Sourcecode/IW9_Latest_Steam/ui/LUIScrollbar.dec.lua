-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:48
LUI.UIScrollbar = LUI.Class()
LUI.UIScrollbar.init = function ( f20_arg0, f20_arg1 )
	local f20_local0 = f20_arg0
	if not f20_arg1 then
		f20_arg1 = {}
	end
	f20_arg0._eventListener = f20_arg1.eventListener
	f20_arg0._sliderArea = f20_arg1.sliderArea
	f20_arg0._slider = f20_arg1.slider
	f20_arg0._fixedSizeSlider = f20_arg1.fixedSizeSlider
	f20_arg0._fixedSizeAmount = f20_arg1.fixedSizeAmount
	local f20_local1 = f20_arg1.animationDuration
	if not f20_local1 then
		f20_local1 = 80
	end
	f20_arg0._animationDuration = f20_local1
	f20_local1 = f20_arg1.direction
	if not f20_local1 then
		f20_local1 = LUI.DIRECTION.vertical
	end
	f20_arg0._direction = f20_local1
	f20_local1 = f20_arg1.skipScrollbarResize
	if not f20_local1 then
		f20_local1 = f20_arg1.fixedSizeAmount
	end
	f20_arg0._skipScrollbarResize = f20_local1
	f20_local1 = assert
	local f20_local2
	if f20_arg0._direction ~= LUI.DIRECTION.vertical and f20_arg0._direction ~= LUI.DIRECTION.horizontal then
		f20_local2 = false
	else
		f20_local2 = true
	end
	f20_local1( f20_local2 )
	f20_local1 = assert
	if f20_arg0._fixedSizeAmount and (0 >= f20_arg0._fixedSizeAmount or f20_arg0._fixedSizeAmount >= 1) then
		f20_local2 = false
	else
		f20_local2 = true
	end
	f20_local1( f20_local2 )
	f20_arg0._eventListener:SetNotifyOnLayoutInit( true )
	f20_arg0._eventListener:addEventHandler( "layout_initialized", function ()
		if f20_arg0._source then
			if f20_arg0._fixedSizeAmount then
				f20_arg0:UpdateScrolling()
			end
			f20_arg0:ResizeScrollbar()
		end
	end )
	if f20_arg0._fixedSizeSlider then
		f20_local1, f20_local3, f20_local2, f20_local4 = f20_arg0._fixedSizeSlider:getLocalRect()
		if f20_arg0._direction == LUI.DIRECTION.horizontal then
			f20_arg0._initialFixedWidth = f20_local2 - f20_local1
		else
			f20_arg0._initialFixedHeight = f20_local4 - f20_local3
		end
		f20_arg0._fixedSizeSlider.m_requireFocusType = FocusType.MouseOver
	end
	if f20_arg0._sliderArea then
		f20_arg0._sliderArea.m_requireFocusType = FocusType.MouseOver
	end
	if f20_arg0._slider then
		f20_arg0._slider.m_requireFocusType = FocusType.MouseOver
	end
	if f20_arg1.startCap then
		f20_arg1.startCap:addEventHandler( "button_action", function ( f30_arg0, f30_arg1 )
			if f20_arg0._source then
				return f20_arg0._source:processEvent( {
					name = "scrollbar_previous",
					scrollbar = f20_arg0
				} )
			else
				
			end
		end )
		f20_arg1.startCap:addEventHandler( "leftmousedown", function ( f29_arg0, f29_arg1 )
			return true
		end )
	end
	if f20_arg1.endCap then
		f20_arg1.endCap:addEventHandler( "button_action", function ( f28_arg0, f28_arg1 )
			if f20_arg0._source then
				return f20_arg0._source:processEvent( {
					name = "scrollbar_next",
					scrollbar = f20_arg0
				} )
			else
				
			end
		end )
		f20_arg1.endCap:addEventHandler( "leftmousedown", function ( f27_arg0, f27_arg1 )
			return true
		end )
	end
	if f20_arg1.sliderArea and (f20_arg1.slider or f20_arg1.fixedSizeSlider) then
		f20_local1 = {
			x = 0,
			y = 0
		}
		local f20_local3 = false
		f20_local2 = function ( f26_arg0, f26_arg1 )
			if not f20_arg0:IsKBMStyle() then
				return 
			elseif not f26_arg0:IsDisabled() then
				local f26_local0 = f20_arg0._sliderArea:getWidth()
				local f26_local1 = f20_arg0._sliderArea:getHeight()
				local f26_local2, f26_local3, f26_local4, f26_local5 = f20_arg0._sliderArea:getRect()
				f26_local2, f26_local3 = f26_arg1.root:PixelsToUnits( f26_local2, f26_local3 )
				local f26_local6, f26_local7 = f26_arg1.root:PixelsToUnits( f26_arg1.x, f26_arg1.y )
				if f26_arg1.name == "leftmousedown" then
					local f26_local8, f26_local9, f26_local10, f26_local11 = f26_arg0:getRect()
					local f26_local12, f26_local13 = f26_arg1.root:PixelsToUnits( f26_local8, f26_local9 )
					f26_local9 = f26_local13
					f20_arg0.x = f26_local6 - f26_local12
					f20_arg0.y = f26_local7 - f26_local9
				end
				f20_arg0._source:processEvent( {
					name = "scrollbar_drag",
					targetX = LUI.clamp( (f26_local6 - f20_arg0.x - f26_local2) / f26_local0, 0, 1 ),
					targetY = LUI.clamp( (f26_local7 - f20_arg0.y - f26_local3) / f26_local1, 0, 1 ),
					dragStart = f26_arg1.name == "leftmousedown",
					scrollbar = f20_arg0
				} )
				if f26_arg1.name == "mousedrag" then
					f20_arg0 = true
				end
				f26_arg0._isUsingMouseDrag = f20_arg0
				return true
			else
				
			end
		end
		
		local f20_local4 = function ( f25_arg0, f25_arg1 )
			if not f20_arg0:IsKBMStyle() then
				return 
			elseif not f25_arg0:IsDisabled() and f20_arg0._source then
				f20_arg0._source:processEvent( {
					name = "scrollbar_mouse_up",
					scrollbarWasDragged = f20_arg0,
					scrollbar = f20_arg0
				} )
			end
			f20_arg0 = false
			f25_arg0._isUsingMouseDrag = f20_arg0
		end
		
		local f20_local5 = function ( f24_arg0, f24_arg1 )
			if not f20_arg0:IsKBMStyle() then
				return 
			elseif not f24_arg0:IsDisabled() then
				local f24_local0 = f20_arg0._sliderArea:getWidth()
				local f24_local1 = f20_arg0._sliderArea:getHeight()
				local f24_local2, f24_local3, f24_local4, f24_local5 = f20_arg0._sliderArea:getRect()
				f24_local2, f24_local3 = f24_arg1.root:PixelsToUnits( f24_local2, f24_local3 )
				local f24_local6, f24_local7 = f24_arg1.root:PixelsToUnits( f24_arg1.x, f24_arg1.y )
				f20_arg0._source:processEvent( {
					name = "scrollbar_set",
					targetX = LUI.clamp( (f24_local6 - f24_local2) / f24_local0, 0, 1 ),
					targetY = LUI.clamp( (f24_local7 - f24_local3) / f24_local1, 0, 1 ),
					scrollbar = f20_arg0
				} )
				return true
			else
				
			end
		end
		
		local f20_local6 = function ( f23_arg0, f23_arg1 )
			Engine[0xD1619221CBAF878]( true )
			f20_arg0( f23_arg0, f23_arg1 )
			return true
		end
		
		local f20_local7 = function ( f22_arg0, f22_arg1 )
			Engine[0xD1619221CBAF878]( false )
			f20_arg0( f22_arg0, f22_arg1 )
			return true
		end
		
		local f20_local8 = f20_arg1.slider
		if not f20_local8 then
			f20_local8 = f20_arg1.fixedSizeSlider
		end
		f20_local8:registerEventHandler( "leftmousedown", f20_local6 )
		f20_local8:registerEventHandler( "leftmouseup", f20_local7 )
		f20_local8:registerEventHandler( "mouse_capture_lost", f20_local7 )
		f20_local8:registerEventHandler( "mousedrag", f20_local2 )
		f20_arg1.sliderArea:registerEventHandler( "leftmousedown", f20_local5 )
		f20_local8:addEventHandler( "gamepad_button", function ( f21_arg0, f21_arg1 )
			if CONDITIONS.IsMouseWheelEvent( f21_arg1 ) and f21_arg0.mouseWheelTarget then
				return f21_arg0.mouseWheelTarget:processEvent( f21_arg1 )
			end
			CONDITIONS.IsDirectionalInput( f21_arg0, f21_arg1 )
			if f20_arg0 then
				f21_arg0.m_leftMouseDown = nil
			end
		end )
	end
end

LUI.UIScrollbar.ResizeScrollbar = function ( f18_arg0 )
	if f18_arg0._skipScrollbarResize then
		
	else
		
	end
	if f18_arg0._direction == LUI.DIRECTION.vertical then
		local f18_local0, f18_local1, f18_local2, f18_local3 = f18_arg0._eventListener:getCurrentGlobalRect()
		local f18_local4, f18_local5, f18_local6, f18_local7 = f18_arg0._source:getCurrentGlobalRect()
		local f18_local8 = f18_arg0._source:GetScale()
		local f18_local9 = function ( f19_arg0, f19_arg1, f19_arg2, f19_arg3, f19_arg4 )
			local f19_local0 = {
				x = f19_arg0,
				y = f19_arg2
			}
			local f19_local1 = {
				x = f19_arg1,
				y = f19_arg2
			}
			local f19_local2 = {
				x = f19_arg0 + math.abs( f19_arg0 - f19_arg1 ) / 2,
				y = f19_arg2 - math.abs( f19_arg2 - f19_arg3 ) / 2
			}
			local f19_local3 = math.sqrt( math.pow( f19_local1.x - f19_local2.x, 2 ) + math.pow( f19_local1.y - f19_local2.y, 2 ) ) * f19_arg4
			return f19_arg0 - f19_local3, f19_arg1 + f19_local3
		end
		
		if f18_local4 ~= nil and f18_local0 ~= nil and (not f18_arg0._cachedGridWidth or math.abs( f18_arg0._cachedGridWidth - f18_local6 - f18_local4 ) > LUI.UIGrid.GRID_EPSILON) then
			f18_arg0._cachedGridWidth = f18_local6 - f18_local4
			f18_local4, f18_local6 = f18_local9( f18_local4, f18_local6, f18_local5, f18_local7, f18_local8 )
			local f18_local10, f18_local11, f18_local12, f18_local13 = f18_arg0._eventListener:getLocalRect()
			local f18_local14 = f18_local12 - f18_local10
			local f18_local15 = f18_local0 < f18_local4
			if f18_local15 then
				f18_arg0._eventListener:SetRight( f18_local12 + f18_local4 - f18_local2 )
			else
				f18_arg0._eventListener:SetLeft( f18_local10 - f18_local0 - f18_local6 )
			end
			f18_arg0:UpdateSliderAreaVertical( f18_local15 )
		end
	end
	f18_arg0:UpdateScrolling()
end

LUI.UIScrollbar.UpdateSliderAreaVertical = function ( f17_arg0, f17_arg1 )
	local f17_local0, f17_local1, f17_local2, f17_local3 = f17_arg0._sliderArea:getLocalRect()
	if f17_arg1 then
		f17_arg0._sliderArea:SetAnchorsAndPosition( 0, 1, 0, 0, 0, math.abs( f17_local2 ) + math.abs( f17_local0 ), 0, 0 )
	else
		f17_arg0._sliderArea:SetAnchorsAndPosition( 1, 0, 0, 0, -(math.abs( f17_local2 ) + math.abs( f17_local0 )), 0, 0, 0 )
	end
end

LUI.UIScrollbar.UpdateScrolling = function ( f16_arg0 )
	assert( f16_arg0._source )
	f16_arg0:UpdateSlider()
	if f16_arg0._eventListener then
		local f16_local0 = 0
		local f16_local1 = f16_arg0._source:GetContentSizeByAxis( f16_arg0._direction )
		if f16_local1 ~= nil then
			f16_local0 = f16_arg0._source:GetContentVisibleSize( f16_arg0._direction )
			assert( f16_local0 )
		end
		if f16_local1 == nil or f16_local1 <= f16_local0 then
			f16_arg0._eventListener:processEvent( {
				name = "scrollbar_all_visible"
			} )
			f16_arg0._eventListener:SetMouseFocusBlocker( true )
			f16_arg0.isVisible = false
		else
			f16_arg0._eventListener:processEvent( {
				name = "scrollbar_not_all_visible"
			} )
			f16_arg0._eventListener:SetMouseFocusBlocker( false )
			f16_arg0.isVisible = true
		end
	end
end

LUI.UIScrollbar.ShowScrollbar = function ( f15_arg0, f15_arg1 )
	if f15_arg0._sliderArea then
		f15_arg0._sliderArea:processEvent( {
			name = "expand",
			controller = f15_arg1.controller or f15_arg1.controllerIndex,
			focusType = FocusType.MouseOver
		} )
	end
end

LUI.UIScrollbar.HideScrollbar = function ( f14_arg0, f14_arg1 )
	if f14_arg0._sliderArea then
		f14_arg0._sliderArea:processEvent( {
			name = "shrink",
			controller = f14_arg1.controller or f14_arg1.controllerIndex,
			focusType = FocusType.MouseOver
		} )
	end
end

LUI.UIScrollbar.UpdateInputType = function ( f13_arg0, f13_arg1, f13_arg2 )
	if f13_arg0._isMouseInside and LUI.IsLastInputMouseNavigation( f13_arg2.controllerIndex ) then
		f13_arg0:ShowScrollbar( f13_arg2 )
	else
		f13_arg0:HideScrollbar( f13_arg2 )
	end
end

LUI.UIScrollbar.LinkTo = function ( f7_arg0, f7_arg1 )
	f7_arg0._source = f7_arg1
	if not CONDITIONS.IsMobileOrMobileSim() then
		f7_arg1:addEventHandler( "mouseenter", function ( f12_arg0, f12_arg1 )
			f7_arg0._isMouseInside = true
			f7_arg0:HideScrollbar( f12_arg1 )
		end )
		f7_arg1:addEventHandler( "gain_focus", function ( f11_arg0, f11_arg1 )
			if LUI.IsLastInputMouseNavigation( f11_arg1.controller or f11_arg0._controllerIndex ) then
				f7_arg0:HideScrollbar( f11_arg1 )
			end
		end )
		f7_arg1:addEventHandler( "mouseleave", function ( f10_arg0, f10_arg1 )
			f7_arg0._isMouseInside = false
			if not f7_arg0._eventListener:IsPositionInside( f10_arg1.x, f10_arg1.y ) then
				f7_arg0:HideScrollbar( f10_arg1 )
			end
		end )
		f7_arg1:addEventHandler( "lose_focus", function ( f9_arg0, f9_arg1 )
			f7_arg0:HideScrollbar( f9_arg1 )
		end )
		f7_arg1:addEventHandler( "grid_size_updated", function ()
			f7_arg0:ResizeScrollbar()
		end )
		f7_arg0:ResizeScrollbar()
	end
end

LUI.UIScrollbar.GetDirection = function ( f6_arg0 )
	return f6_arg0._direction
end

LUI.UIScrollbar.GetWidget = function ( f5_arg0 )
	return f5_arg0._eventListener
end

LUI.UIScrollbar.SetLinkedGridDataSource = function ( f4_arg0, f4_arg1 )
	
end

LUI.UIScrollbar.IsKBMStyle = function ( f3_arg0 )
	local f3_local0 = f3_arg0._KBMStyle
	if not f3_local0 then
		if f3_arg0._fixedSizeSlider then
			f3_local0 = f3_arg0._source._controllerIndex
			if f3_local0 then
				f3_local0 = LUI.IsLastInputKeyboardMouse( f3_arg0._source._controllerIndex )
			end
		else
			f3_local0 = true
		end
	end
	return f3_local0
end

LUI.UIScrollbar.SetKBMStyle = function ( f2_arg0, f2_arg1 )
	f2_arg0._KBMStyle = f2_arg1
end

LUI.UIScrollbar.UpdateSlider = function ( f1_arg0 )
	local f1_local0 = f1_arg0._slider or f1_arg0._fixedSizeSlider
	if not f1_local0 then
		return 
	end
	local f1_local1 = f1_arg0._source:GetContentSizeByAxis( f1_arg0._direction )
	if not f1_local1 or f1_local1 == 0 then
		return 
	end
	local f1_local2 = f1_arg0._source:GetContentVisibleSize( f1_arg0._direction )
	assert( f1_local2 )
	f1_local2 = math.min( f1_local2, f1_local1 )
	local f1_local3, f1_local4 = nil
	local f1_local5 = f1_arg0._source._controllerIndex
	if not (not f1_arg0:IsKBMStyle() or f1_arg0._KBMStyle ~= nil) or f1_arg0._KBMStyle == true then
		local f1_local6 = f1_arg0._source:GetContentOffset( f1_arg0._direction )
		if not f1_local6 then
			f1_local6 = 0
			f1_local2 = 1
			f1_local1 = 1
		end
		f1_local3 = f1_local6 / f1_local1
		local f1_local7 = nil
		if not f1_arg0._skipScrollbarResize then
			f1_local7 = f1_local2 / f1_local1
		elseif f1_arg0._fixedSizeAmount then
			f1_local7 = f1_arg0._fixedSizeAmount
			local f1_local8 = 1 - f1_local2 / f1_local1
			if 0 < f1_local8 then
				f1_local3 = (1 - f1_local7) / f1_local8 * f1_local3
			end
		else
			f1_local7 = LUI.clamp( f1_local2 / f1_local1, 0.1, 0.9 )
			f1_arg0._fixedSizeAmount = f1_local7
		end
		f1_local4 = f1_local3 + f1_local7
		f1_local3 = LUI.clamp( f1_local3, 0, 1 - f1_local7 )
		f1_local4 = LUI.clamp( f1_local4, f1_local7, 1 )
	else
		local f1_local6 = f1_arg0._source:GetFocusPosition( f1_arg0._direction )
		if not f1_local6 or f1_local6 < 0 then
			f1_local6 = 0
		end
		f1_local1 = f1_arg0._source:GetContentCount( f1_arg0._direction )
		local f1_local7 = assert
		local f1_local9
		if f1_local6 - f1_local1 >= 0.01 and f1_local1 ~= 0 then
			f1_local9 = false
		else
			f1_local9 = true
		end
		f1_local7( f1_local9 )
		f1_local7 = f1_arg0._direction
		local f1_local8 = LUI.DIRECTION.horizontal
		f1_local7 = REG15 and f1_arg0._initialFixedWidth or f1_arg0._initialFixedHeight
		f1_local8 = f1_arg0._sliderArea
		if not f1_local8 then
			f1_local8 = f1_local0:getParent()
		end
		if f1_arg0._direction == LUI.DIRECTION.horizontal then
			f1_local9 = f1_local8:getWidth()
			if not f1_local9 then
			
			elseif f1_local1 <= 1 or f1_local9 <= 1 then
				f1_local3 = 0
				f1_local4 = 0
			else
				f1_local3 = f1_local6 / (f1_local1 - 1) * (f1_local9 - f1_local7) / f1_local9
				f1_local4 = f1_local3 + f1_local7 / f1_local9
			end
		end
		f1_local9 = f1_local8:getHeight()
	end
	local f1_local6 = false
	if not f1_arg0._lastContentSize or not f1_arg0._lastContentVisibleSize or f1_arg0._lastContentSize <= f1_arg0._lastContentVisibleSize then
		f1_local6 = true
	end
	local f1_local7
	if f1_local6 then
		f1_local7 = 0
	else
		f1_local7 = f1_arg0._animationDuration
	end
	if f1_arg0._direction == LUI.DIRECTION.horizontal then
		f1_local0:SetLeftAnchor( f1_local3, f1_local7, LUI.EASING.outCubic )
		f1_local0:SetRightAnchor( 1 - f1_local4, f1_local7, LUI.EASING.outCubic )
		f1_local0:SetLeft( 0, f1_local7 )
		f1_local0:SetRight( 0, f1_local7 )
	else
		f1_local0:SetTopAnchor( f1_local3, f1_local7, LUI.EASING.outCubic )
		f1_local0:SetBottomAnchor( 1 - f1_local4, f1_local7, LUI.EASING.outCubic )
		f1_local0:SetTop( 0, f1_local7 )
		f1_local0:SetBottom( 0, f1_local7 )
	end
	f1_arg0._lastContentSize = f1_local1
	f1_arg0._lastContentVisibleSize = f1_local2
end

