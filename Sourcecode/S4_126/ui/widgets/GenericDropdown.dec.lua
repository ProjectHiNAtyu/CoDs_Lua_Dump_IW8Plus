-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
module( ..., package.seeall )
local f0_local0 = 9
local f0_local1 = 4
local f0_local2 = 7
local f0_local3 = _1080p * 10
local f0_local4 = function ( f34_arg0, f34_arg1, f34_arg2 )
	f34_arg0._dropdownState = false
	local f34_local0 = LUI.FlowManager.GetScopedData( f34_arg0 )
	f34_local0._dropdownPreviousFocusedPosition = nil
	if f34_arg2.parent.dropdownButtonList and f34_arg2.parent.listBackground and f34_arg2.parent.closingBackground then
		f34_arg2.parent.dropdownButtonList:dispatchEventToParent( {
			name = "redirect_button_event_to_target"
		} )
		f34_arg2.parent.dropdownButtonList:closeTree()
		f34_arg2.parent.dropdownButtonList = nil
		f34_arg2.parent.listBackground:closeTree()
		f34_arg2.parent.listBackground = nil
		f34_arg2.parent.closingBackground:closeTree()
		f34_arg2.parent.closingBackground = nil
		f34_arg2.parent.buttonListVScrollbar:closeTree()
		f34_arg2.parent.buttonListVScrollbar = nil
	end
end

local f0_local5 = function ( f33_arg0, f33_arg1, f33_arg2 )
	f33_arg2.action( f33_arg0, {
		index = f33_arg0.defaultValue
	}, f33_arg1 )
	f33_arg0.initialValue = f33_arg0.valueGetter( f33_arg1 )
end

local f0_local6 = function ( f32_arg0, f32_arg1, f32_arg2, f32_arg3, f32_arg4 )
	f0_local0( f32_arg0, f32_arg1, f32_arg2 )
	f32_arg0:dispatchEventToParent( {
		name = "dropdown_closed",
		target = f32_arg0,
		optionSelected = f32_arg4
	} )
	local f32_local0 = f32_arg0:getParent()
	f32_local0:processEvent( {
		name = "gain_focus",
		controller = f32_arg1,
		focusType = FocusType.MenuFlow
	} )
	if f32_arg0.onRefresh then
		f32_arg0:onRefresh( f32_arg1, f32_arg0.defaultValue, f32_arg3 )
	end
end

local f0_local7 = function ( f31_arg0, f31_arg1 )
	local f31_local0, f31_local1, f31_local2, f31_local3 = f31_arg0.dropdownButton:getCurrentGlobalRect()
	local f31_local4, f31_local5, f31_local6, f31_local7 = f31_arg1.parent:getCurrentGlobalRect()
	local f31_local8 = f31_arg0.dropdownButton:getHeight() * math.min( f31_arg0._maxVisibleRows, #f31_arg0.labels ) + f0_local0
	if f31_local7 < f31_local3 + f31_local8 then
		f31_local3 = f31_local1
		f31_local1 = f31_local1 - f31_local8
		f31_arg0._isOpenTop = true
	else
		f31_local1 = f31_local1 + f31_arg0.dropdownButton:getHeight()
		f31_local3 = f31_local3 + f31_local8
		f31_arg0._isOpenTop = false
	end
	return f31_local0 - f31_local4, f31_local2 + f0_local0 - f31_local4, f31_local1 - f31_local5, f31_local3 - f31_local5
end

local f0_local8 = function ( f30_arg0, f30_arg1, f30_arg2, f30_arg3 )
	if not f30_arg0.applyable == true then
		f30_arg3.action( f30_arg0, {
			index = f30_arg1.row
		}, f30_arg2 )
	end
	f30_arg0.defaultValue = f30_arg1.value
	f30_arg0.dropdownButton.Text:setText( f30_arg1.Text:getText() )
	f0_local0( f30_arg0, f30_arg2, f30_arg3, true, true )
end

local f0_local9 = function ( f29_arg0, f29_arg1, f29_arg2, f29_arg3, f29_arg4, f29_arg5 )
	local f29_local0, f29_local1, f29_local2, f29_local3 = nil
	if f29_arg2 == "up" then
		f29_local2 = LUI.DIRECTION.vertical
		f29_local3 = -1
	elseif f29_arg2 == "down" then
		f29_local2 = LUI.DIRECTION.vertical
		f29_local3 = 1
	elseif f29_arg2 == "left" then
		f29_local2 = LUI.DIRECTION.horizontal
		f29_local3 = -1
	elseif f29_arg2 == "right" then
		f29_local2 = LUI.DIRECTION.horizontal
		f29_local3 = 1
	end
	if f29_local2 and f29_local3 then
		f29_local0, f29_local1 = f29_arg0:GetNextFocusablePosition( f29_local2, f29_local3 )
	end
	if f29_local0 then
		f29_arg0:AdjustFocusedTargetPosition( f29_local0, f29_arg2, f29_local1 )
		local f29_local4 = f29_arg0._alwaysSnap
		if not f29_local4 then
			if f29_local1 then
				f29_local4 = f29_local1
			else
				f29_local4 = f29_arg0._snapOnWrap
			end
		end
		f29_arg0:SetFocusedPosition( f29_local0, f29_local4 == true, nil, f29_local1 )
		f29_arg0:FocusMoved( f29_arg2 )
		f29_arg0:saveState()
		return true
	else
		return false
	end
end

local f0_local10 = function ( f28_arg0, f28_arg1 )
	if f28_arg1.down and f28_arg1.qualifier ~= "mousewheel" and CoD.IsDirectionalInput( f28_arg1.button ) and not f28_arg0._childInFocus then
		local f28_local0 = LUI.FlowManager.GetScopedData( f28_arg0 )
		f28_arg0:SetFocusedPosition( f28_local0._dropdownPreviousFocusedPosition or {
			x = 0,
			y = 0
		}, f28_arg0._alwaysSnap, nil, false )
	end
	return true
end

local f0_local11 = function ( f26_arg0, f26_arg1 )
	local f26_local0 = f26_arg0
	local f26_local1 = f26_arg1
	return function ( f27_arg0, f27_arg1 )
		local f27_local0, f27_local1 = nil
		f27_local0 = f26_arg0( f27_arg0, f27_arg1 )
		f27_local1 = f26_arg0( f27_arg0, f27_arg1 )
		local f27_local2
		if not f27_local0 then
			f27_local2 = f27_local0
		else
			f27_local2 = f27_local1
		end
		return f27_local2
	end
	
end

local f0_local12 = function ( f19_arg0, f19_arg1, f19_arg2 )
	f19_arg0._maxVisibleRows = 5
	local self = LUI.UIGrid.new( {
		adjustSizeToContent = true,
		maxVisibleColumns = 1,
		wrapY = false,
		maxRows = -28,
		maxVisibleRows = f19_arg0._maxVisibleRows,
		controllerIndex = f19_arg1
	} )
	self.FocusNextElement = f0_local0
	local f19_local1 = self.m_eventHandlers.gamepad_button
	if f19_local1 then
		self:registerEventHandler( "gamepad_button", f0_local0( f0_local0, f19_local1 ) )
	else
		self:registerEventHandler( "gamepad_button", f0_local0 )
	end
	local f19_local2, f19_local3, f19_local4, f19_local5 = f0_local0( f19_arg0, f19_arg2 )
	if IsLanguageArabic() then
		f19_local2 = f19_local2 - _1080p * 11
		f19_local3 = f19_local3 - _1080p * 11
	end
	for f19_local6 = 1, #f19_arg0.labels, 1 do
		local f19_local9 = MenuBuilder.BuildRegisteredType( f19_arg2.buttonListType, {
			controllerIndex = f19_arg1
		} )
		f19_local9.id = "DropdownButton" .. f19_local6
		f19_local9.Text:setText( f19_arg0.labels[f19_local6] )
		f19_local9.row = f19_local6
		f19_local9.value = f19_local6
		f19_local9.Text:SetAlignment( LUI.Alignment.Left )
		f19_local9:SetLeft( f19_local2 + f0_local0 )
		f19_local9:SetRight( f19_local3 - f0_local0 )
		f19_local9:SetBottom( f19_arg0.dropdownButton:getHeight() )
		if f19_local6 == f19_arg0.defaultValue then
			self:SetDefaultFocus( {
				x = 0,
				y = f19_local6 - 1
			} )
			f19_local9._selected = true
			if not IsLanguageArabic() then
				ACTIONS.AnimateSequence( f19_local9, "Selected" )
			else
				ACTIONS.AnimateSequence( f19_local9, "SelectedAR" )
			end
		else
			f19_local9._selected = false
			ACTIONS.AnimateSequence( f19_local9, "NotSelected" )
		end
		f19_local9:addEventHandler( "button_action", function ( f25_arg0, f25_arg1 )
			f19_arg0( f19_arg0, f25_arg0, f19_arg0, f19_arg0 )
			return true
		end )
		f19_local9:addEventHandler( "button_up", function ( f24_arg0, f24_arg1 )
			f19_arg0:RemoveFocusFromChild( f19_arg0._alwaysSnap )
			if f24_arg0._selected then
				ACTIONS.AnimateSequence( f24_arg0, "ButtonUpSelected" )
			else
				ACTIONS.AnimateSequence( f24_arg0, "ButtonUp" )
			end
		end )
		f19_local9:addEventHandler( "button_over", function ( f23_arg0, f23_arg1 )
			local f23_local0 = LUI.FlowManager.GetScopedData( f23_arg0 )
			local f23_local1 = {
				x = 0,
				y = f23_arg0.row - 1
			}
			f23_local0._dropdownPreviousFocusedPosition = f23_local1
			f19_arg0:SetFocusedPosition( f23_local1, f19_arg0._alwaysSnap, f23_arg1.focusType ~= FocusType.MouseOver, false )
			if f19_arg0.onRefresh then
				f19_arg0:onRefresh( f19_arg0, f23_arg0.row )
			end
		end )
		self:AddElement( f19_local9 )
	end
	local f19_local6 = MenuBuilder.BuildRegisteredType( "GenericButton", {
		controllerIndex = f19_arg1
	} )
	f19_local6.id = "closingBackground"
	f19_local6:SetAlpha( 0 )
	f19_local6:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	ACTIONS.ScaleFullscreen( f19_local6 )
	f19_arg2.parent:addElement( f19_local6 )
	f19_arg2.parent.closingBackground = f19_local6
	f19_arg2.parent.closingBackground:setActionSFX( nil )
	f19_arg2.parent.closingBackground:addEventHandler( "button_action", function ( f22_arg0, f22_arg1 )
		f19_arg0( f19_arg0, f19_arg0, f19_arg0 )
		return true
	end )
	local f19_local7 = nil
	f19_local7 = MenuBuilder.BuildRegisteredType( "GenericDropdownBackground", {
		controllerIndex = f19_arg1
	} )
	f19_local7.id = "ListBackground"
	f19_local7:SetAnchorsAndPosition( 0, 1, 0, 1, f19_local2, f19_local3, f19_local4, f19_local5 )
	f19_arg2.parent:addElement( f19_local7 )
	f19_arg2.parent.listBackground = f19_local7
	self.id = "DropdownButtonList"
	self:setUseStencil( true )
	self:SetAnchorsAndPosition( 0, 1, 0, 1, f19_local2 + f0_local0, f19_local3 - f0_local0, f19_local4 + f0_local0 / 2, f19_local5 - f0_local0 / 2 )
	f19_arg2.parent:addElement( self )
	f19_arg2.parent.dropdownButtonList = self
	f19_arg2.parent.dropdownButtonList:SetActiveParentBehavior()
	self:SetHandleMouse( true )
	self:dispatchEventToParent( {
		name = "redirect_button_event_to_target",
		target = self
	} )
	self:registerEventHandler( "button_secondary", function ( self, event )
		f19_arg0( f19_arg0, f19_arg0, f19_arg0 )
		return true
	end )
	self:addEventHandler( "gamepad_button", function ( f20_arg0, f20_arg1 )
		if f20_arg1.button == "shoulderl" or f20_arg1.button == "shoulderr" then
			f19_arg0( f19_arg0, f19_arg0, f19_arg0 )
		elseif f20_arg1.button == "secondary" then
			f19_arg0( f19_arg0, f19_arg0, f19_arg0 )
			return true
		end
	end )
	local f19_local8 = nil
	f19_local8 = MenuBuilder.BuildRegisteredType( "VerticalMinimalScrollbar", {
		controllerIndex = f19_arg1
	} )
	f19_local8.id = "buttonListDropdownVScrollbar"
	f19_local8:SetAnchorsAndPosition( 0, 1, 0, 1, f19_local3 - f0_local0, f19_local3, f19_local4, f19_local5 )
	f19_arg2.parent:addElement( f19_local8 )
	f19_arg2.parent.buttonListVScrollbar = f19_local8
	local f19_local10 = LUI.UIScrollbar.new
	local f19_local11 = {
		direction = LUI.DIRECTION.vertical,
		eventListener = f19_local8,
		startCap = f19_local8.startCap,
		endCap = f19_local8.endCap,
		sliderArea = f19_local8.sliderArea
	}
	local f19_local12 = f19_local8.sliderArea
	if f19_local12 then
		f19_local12 = f19_local8.sliderArea.slider
	end
	f19_local11.slider = f19_local12
	f19_local12 = f19_local8.sliderArea
	if f19_local12 then
		f19_local12 = f19_local8.sliderArea.fixedSizeSlider
	end
	f19_local11.fixedSizeSlider = f19_local12
	f19_local11.mouseWheelTarget = f19_arg2.parent.dropdownButtonList
	f19_arg2.parent.dropdownButtonList:AddScrollbar( f19_local10( f19_local11 ) )
end

local f0_local13 = function ( f18_arg0, f18_arg1, f18_arg2 )
	f18_arg0._dropdownState = true
	f18_arg0:dispatchEventToParent( {
		name = "dropdown_opened",
		target = f18_arg0
	} )
	f0_local0( f18_arg0, f18_arg1, f18_arg2 )
	local f18_local0 = f18_arg0:getParent()
	f18_local0:processEvent( {
		name = "lose_focus",
		controller = f18_arg1
	} )
	f18_arg2.parent.dropdownButtonList:processEvent( {
		name = "gain_focus",
		shouldPlayButtonSound = false,
		controller = f18_arg1
	} )
end

local f0_local14 = function ( f17_arg0 )
	return f17_arg0._dropdownState
end

local f0_local15 = function ( f16_arg0, f16_arg1, f16_arg2 )
	if not f16_arg0._dropdownState then
		f0_local0( f16_arg0, f16_arg1, f16_arg2 )
	else
		f0_local0( f16_arg0, f16_arg1, f16_arg2 )
	end
end

local f0_local16 = function ( f15_arg0, f15_arg1 )
	f15_arg0.labels = f15_arg1
	local f15_local0 = f15_arg0:GetCurrentMenu()
	for f15_local1 = 1, #f15_arg0.labels, 1 do
		if f15_local1 == f15_arg0.defaultValue then
			f15_arg0.dropdownButton.Text:setText( f15_arg0.labels[f15_local1] )
		end
		if f15_local0 and f15_local0.dropdownButtonList then
			local f15_local4 = f15_local0.dropdownButtonList:GetElementAtPosition( 0, f15_local1 - 1 )
			if f15_local4 then
				f15_local4.Text:setText( f15_arg0.labels[f15_local1] )
			end
		end
	end
end

local f0_local17 = function ( f14_arg0, f14_arg1 )
	f14_arg0.labels = f14_arg1
end

local f0_local18 = function ( f3_arg0, f3_arg1, f3_arg2 )
	local dropdownButton = MenuBuilder.BuildRegisteredType( f3_arg2.buttonType, {
		controllerIndex = f3_arg1
	} )
	dropdownButton.id = "DropdownButton"
	f3_arg0.defaultValueGetter = f3_arg2.defaultValueGetter
	f3_arg0.valueGetter = f3_arg2.valueGetter
	f3_arg0.onRefresh = f3_arg2.onRefresh
	f3_arg0.onReset = f3_arg2.onReset
	f3_arg0.labels = f3_arg2.labels
	f3_arg0.defaultValue = f3_arg2.defaultValue
	f3_arg0.onDependencyParentRefresh = f3_arg2.onDependencyParentRefresh
	f3_arg0.initialValue = f3_arg0.valueGetter( f3_arg1 )
	f3_arg0.applyable = f3_arg2.applyable == true
	local f3_local1 = ""
	for f3_local2 = 1, #f3_arg0.labels, 1 do
		if f3_local2 == f3_arg0.defaultValue then
			f3_local1 = f3_arg0.labels[f3_local2]
			break
		end
	end
	dropdownButton.Text:setText( f3_local1 )
	dropdownButton:setActionSFX( nil )
	if IsLanguageArabic() then
		dropdownButton.Text:SetLeft( _1080p * 40 )
		dropdownButton.Text:SetRight( _1080p * -10 )
	else
		dropdownButton.Text:SetLeft( _1080p * 10 )
		dropdownButton.Text:SetRight( _1080p * -35 )
	end
	dropdownButton.Text:SetAlignment( LUI.Alignment.Left )
	dropdownButton:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	f3_arg0:addElement( dropdownButton )
	f3_arg0.dropdownButton = dropdownButton
	
	f3_arg0.dropdownButton:addEventHandler( "button_action", function ( f13_arg0, f13_arg1 )
		if f13_arg1.mouse == true then
			f3_arg0.mouse = true
		else
			f3_arg0.mouse = false
		end
		f3_arg0( f3_arg0, f3_arg0, f3_arg0 )
		return true
	end )
	f3_arg0.SetCurrentValue = function ( f12_arg0, f12_arg1, f12_arg2, f12_arg3 )
		for f12_local0 = 1, #f12_arg0.labels, 1 do
			if f12_local0 == f12_arg2 then
				f12_arg0.dropdownButton.Text:setText( f12_arg0.labels[f12_arg2] )
				if f12_arg0.applyable == false then
				
				else
					f12_arg0.defaultValue = f12_local0
					if f12_arg0.onRefresh then
						f12_arg0:onRefresh( f12_arg1, f12_local0, f12_arg3 )
						break
					end
				end
				f3_arg0.action( f12_arg0, {
					index = f12_local0
				}, f12_arg1 )
			end
		end
	end
	
	f3_arg0:addEventHandler( "refresh_values", function ( f11_arg0, f11_arg1 )
		f11_arg0:SetCurrentValue( f11_arg1.controller, f11_arg0.defaultValue )
		return true
	end )
	f3_arg0:addEventHandler( "seek_value", function ( f10_arg0, f10_arg1 )
		if f10_arg0.valueGetter then
			f10_arg0:SetCurrentValue( f10_arg1.controllerIndex or f3_arg0, f10_arg0.valueGetter( f10_arg1.controllerIndex or f3_arg0 ) )
			f10_arg0:processEvent( {
				name = "update_initial_value"
			} )
		end
	end )
	f3_arg0:addEventHandler( "reset_value", function ( f9_arg0, f9_arg1 )
		if f9_arg0.defaultValueGetter then
			f9_arg0:SetCurrentValue( f9_arg1.controllerIndex or f3_arg0, f9_arg0.defaultValueGetter( f9_arg1.controllerIndex or f3_arg0 ) )
			f9_arg0:onReset( f9_arg1.controllerIndex )
		end
	end )
	f3_arg0:addEventHandler( "apply_value", function ( f8_arg0, f8_arg1 )
		if f8_arg0.applyable then
			f3_arg0( f3_arg0, f8_arg1.controllerIndex or f3_arg0, f3_arg0 )
		end
	end )
	f3_arg0:addEventHandler( "update_initial_value", function ( f7_arg0, f7_arg1 )
		f3_arg0.initialValue = f3_arg0:valueGetter()
	end )
	f3_arg0:addEventHandler( "parent_value_changed", function ( f6_arg0, f6_arg1 )
		if f6_arg0.onDependencyParentRefresh then
			local f6_local0 = f6_arg0:onDependencyParentRefresh( f6_arg1.controllerIndex or f3_arg0, f3_arg0.defaultValue, f6_arg1.parentId, f6_arg1.parentValue )
			if f6_local0 == true then
				f6_arg0:onRefresh( f6_arg1.controllerIndex, f3_arg0.defaultValue )
			elseif f6_local0 ~= nil then
				f6_arg0:SetCurrentValue( f6_arg1.controllerIndex or f3_arg0, f6_local0 )
			end
		end
	end )
	f3_arg0:addEventHandler( "refresh_option", function ( f5_arg0, f5_arg1 )
		f5_arg0:onRefresh( f5_arg1.controllerIndex, f3_arg0.defaultValue )
	end )
	f3_arg0:addEventHandler( "remove_overlays", function ( f4_arg0, f4_arg1 )
		f3_arg0( f4_arg0, f3_arg0, f3_arg0 )
	end )
	dropdownButton.Pip:SetAlpha( 0 )
	f3_arg0:dispatchEventToParent( {
		name = "setup_button_data_completed"
	} )
end

local f0_local19 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.labels = {}
	f2_arg0._dropdownState = false
	f2_arg0.SetupButtonData = f0_local0
	f2_arg0.UpdateCurrentTextDropdown = f0_local0
	f2_arg0.UpdateLabels = f0_local0
	f2_arg0.ChangeDropdownState = f0_local0
	f2_arg0.DropdownIsOpened = f0_local0
end

function GenericDropdown( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 201 * _1080p, 0, 150 * _1080p )
	self.id = "GenericDropdown"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine[0x12586A3F4FB490E]() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1, "Missing controllerIndex!" )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "GenericDropdown", GenericDropdown )
LockTable( _M )
