-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:51
module( ..., package.seeall )
local f0_local0 = function ( f13_arg0 )
	if f13_arg0._statusSub then
		f13_arg0:UnsubscribeFromModel( f13_arg0._statusSub )
		f13_arg0._statusSub = nil
	end
end

local f0_local1 = function ( f12_arg0 )
	if f12_arg0._countSub then
		f12_arg0:UnsubscribeFromModel( f12_arg0._countSub )
		f12_arg0._countSub = nil
	end
end

local f0_local2 = function ( f10_arg0, f10_arg1, f10_arg2, f10_arg3 )
	f10_arg0.currentWeaponClass = nil
	local f10_local0 = function ( f11_arg0 )
		local f11_local0 = nil
		if f10_arg0 then
			f11_local0 = WEAPON.GetWeaponAmmoClass( f10_arg0 )
			if not f11_local0 or f11_local0 == "" then
				local f11_local1 = LUI.Split( f10_arg0, "+" )
				local f11_local2 = f11_local1[1]
				local f11_local3 = nil
				f11_local3 = LUI.FindLast( f11_local2, "_mp" )
				if f11_local3 then
					f11_local0 = StringTable.DIFCHIGDFB( CSV.MPWeapons.file, CSV.MPWeapons.cols.asset, string.sub( f11_local2, 0, f11_local3 + 2 ), CSV.MPWeapons.cols.class )
				end
			end
		else
			f11_local0 = DataModel.JJEHAEBDF( f11_arg0 )
		end
		if f10_arg0.currentWeaponClass ~= f11_local0 then
			f10_arg0.currentWeaponClass = f11_local0
			local f11_local4 = BRLOOT.weaponClassData[f11_local0]
			if f11_local4 then
				f11_local4 = BRLOOT.weaponClassData[f11_local0].ammoData
			end
			if f11_local4 then
				f10_arg0.AmmoImage:setImage( RegisterMaterial( f11_local4.ammoImage ) )
				local f11_local1 = DataSources.inGame.player.currentWeapon.isDualWielding
				local f11_local2 = DataSources.inGame.player.currentWeapon.ammoWarningStateLeft
				local f11_local3 = DataSources.inGame.player.currentWeapon.ammoWarningStateRight
				local f11_local5 = f11_local3:GetValue( f10_arg0 )
				local f11_local6 = f11_local2:GetValue( f10_arg0 )
				local f11_local7 = nil
				if not f11_local1:GetValue( f10_arg0 ) then
					f11_local7 = f11_local5
				end
				if f11_local6 and f11_local5 then
					if math.min( f11_local6, f11_local5 ) == f11_local6 and not f11_local2 then
						f11_local7 = f11_local2
					else
						f11_local7 = f11_local3
					end
				end
				if f11_local7 then
					f10_arg0:SetAmmoCountDS( f11_local7:GetModel( f10_arg0 ), f11_local4.maxAmmo )
				end
			else
				f10_arg0:ClearAmmoCountDS()
				ACTIONS.AnimateSequence( f10_arg0, "NoWeapon" )
			end
		end
	end
	
	f10_arg0:ClearAmmoStatusDS()
	f10_arg0._statusSub = f10_arg0:SubscribeToModel( f10_arg1, f10_local0 )
end

local f0_local3 = function ( f8_arg0, f8_arg1, f8_arg2 )
	local f8_local0 = function ( f9_arg0 )
		local f9_local0 = DataModel.JJEHAEBDF( f9_arg0 )
		local f9_local1 = "NoAmmo"
		if f8_arg0 ~= nil and f8_arg0 <= f9_local0 then
			f9_local1 = "HasAmmo"
		elseif 0 < f9_local0 then
			f9_local1 = "HasAmmo"
		end
		ACTIONS.AnimateSequence( f8_arg0, f9_local1 )
	end
	
	f8_arg0:ClearAmmoCountDS()
	f8_arg0._countSub = f8_arg0:SubscribeToModel( f8_arg1, f8_local0 )
end

local f0_local4 = function ( f7_arg0, f7_arg1, f7_arg2 )
	f7_arg0.ClearAmmoCountDS = f0_local0
	f7_arg0.ClearAmmoStatusDS = f0_local0
	f7_arg0.SetAmmoCountDS = f0_local0
	f7_arg0.SetAmmoStatusDS = f0_local0
end

function BRAmmoTypeNoCount( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 64 * _1080p, 0, 64 * _1080p )
	self.id = "BRAmmoTypeNoCount"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	local AmmoImage = nil
	
	AmmoImage = LUI.UIImage.new()
	AmmoImage.id = "AmmoImage"
	AmmoImage:setImage( RegisterMaterial( "ui_mp_br_loot_icon_ammo_mid" ), 0 )
	AmmoImage:SetAnchorsAndPosition( 0, 0, 0, 0, _1080p * 1, _1080p * -3, _1080p * 2, _1080p * -2 )
	self:addElement( AmmoImage )
	self.AmmoImage = AmmoImage
	
	AmmoImage:RegisterAnimationSequence( "DefaultSequence", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.RGB,
			value = SWATCHES.HUD.bradleyAmmo
		},
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.DefaultSequence = function ()
		menu:AnimateSequence( "DefaultSequence" )
	end
	
	AmmoImage:RegisterAnimationSequence( "HasAmmo", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.RGB,
			value = SWATCHES.HUD.HUDMain
		},
		{
			value = 1,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.HasAmmo = function ()
		menu:AnimateSequence( "HasAmmo" )
	end
	
	AmmoImage:RegisterAnimationSequence( "NoAmmo", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.RGB,
			value = SWATCHES.HUD.warning
		},
		{
			value = 1,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.NoAmmo = function ()
		menu:AnimateSequence( "NoAmmo" )
	end
	
	AmmoImage:RegisterAnimationSequence( "NoWeapon", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.NoWeapon = function ()
		menu:AnimateSequence( "NoWeapon" )
	end
	
	AmmoImage:RegisterAnimationSequence( "MaxAmmo", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.RGB,
			value = SWATCHES.HUD.overcharged
		},
		{
			value = 1,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.MaxAmmo = function ()
		menu:AnimateSequence( "MaxAmmo" )
	end
	
	f0_local0( self, f1_local1, controller )
	ACTIONS.AnimateSequence( self, "DefaultSequence" )
	return self
end

MenuBuilder.registerType( "BRAmmoTypeNoCount", BRAmmoTypeNoCount )
LockTable( _M )
