-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 02-09-2025 10:42
module( ..., package.seeall )
FenceGamerProfile = LUI.Class( LUI.Fence )
FenceGamerProfile.init = function ( f11_arg0 )
	LUI.Fence.init( f11_arg0 )
end

FenceGamerProfile.Start = function ( f10_arg0 )
	DebugPrint( "FenceGamerProfile.Start" )
	f10_arg0._openedBrightnessMenu = false
	f10_arg0._setScreenBounds = false
	f10_arg0._openedEULA = false
end

FenceGamerProfile.Stop = function ( f9_arg0 )
	DebugPrint( "FenceGamerProfile.Stop" )
end

FenceGamerProfile.OnBackOut = function ( f8_arg0 )
	Engine.BJBBFIGDGI()
	Engine.DCIDFCJAEI()
end

FenceGamerProfile.OnPass = function ( f7_arg0 )
	if Dvar.IBEGCHEFE( "NQROMTQPMT" ) then
		for f7_local0 = 0, Engine.DCJGJDDEHE() - 1, 1 do
			if Engine.BBHAECABBD( f7_local0 ) and Engine.BFDACIJIAD( f7_local0 ) then
				COLOR_BLIND.UpdateAllSwatches( f7_local0 )
			end
		end
	end
end

FenceGamerProfile.UpdateState = function ( f6_arg0 )
	assert( f6_arg0._state ~= LUI.Fence.STATE.fail )
	f6_arg0._state = LUI.Fence.STATE.pass
	local f6_local0 = nil
	for f6_local1 = 0, Engine.DCJGJDDEHE() - 1, 1 do
		if Engine.BBHAECABBD( f6_local1 ) then
			if Engine.BFDACIJIAD( f6_local1 ) then
				f6_local0 = f6_local1
			end
			if Engine.CIEGIACHAE() and Engine.CBGJIDFIDE( f6_local1 ) then
				if not LUI.FlowManager.IsInStack( "popup_corrupt_data" ) then
					LUI.FlowManager.RequestPopupMenu( nil, "popup_corrupt_data", true, f6_local1, false, {}, nil, false, true )
				end
				f6_arg0._state = LUI.Fence.STATE.block
				return 
			elseif Engine.BGGFCBBEC( f6_local1 ) == #Languages then
				Engine.CEHDAACIJA( f6_local1, Engine.DGAIDIEIAC() )
				if not Engine.CGABICJHAI() then
					Engine.DAGFFDGFII( "updategamerprofile" )
				end
			end
		end
	end
	if Engine.DBFCJBDJEC() and not Engine.JBIHDJBH() then
		return 
	elseif f6_local0 and Engine.CDCCDDJAJJ( f6_local0 ) and not Engine.CIFGGDIGBE( f6_local0 ) then
		local f6_local1 = Engine.BGGFCBBEC( f6_local0 )
		local f6_local2 = Engine.DGAIDIEIAC()
		if Dvar.IBEGCHEFE( "LKSQOLNKLP" ) and Engine.BECCFCBIAA( "acceptedEULA_Version", f6_local0 ) < Dvar.CFHDGABACF( "QOMKPKKTP" ) then
			Engine.DAGFFDGFII( "profile_SetAcceptedEULA" )
			Engine.DAGFFDGFII( "profile_SetHasEverPlayed_MainMenu" )
			Engine.DAGFFDGFII( "updategamerprofile" )
		end
		if Dvar.IBEGCHEFE( "unattended" ) then
			return 
		elseif Dvar.IBEGCHEFE( "NNPRNQMTQO" ) == true then
			LUI.FlowManager.RequestPopupMenu( nil, "live_dialog_text_box", false, nil, false, {
				title = Engine.CBBHFCGDIC( "MENU/NOTICE" ),
				message = Engine.CBBHFCGDIC( "PLATFORM/TU_REQUIRED" )
			}, nil, false, true )
		elseif not Engine.CGABICJHAI() and f6_local1 < #Languages and f6_local2 ~= f6_local1 then
			if Engine.CGFGDJCJHI( f6_local1 ) then
				LUI.FlowManager.RequestPopupMenu( unused, "PopupLanguageRestart", true, f6_local0, false, {
					currentLanguage = f6_local2,
					preferredLanguage = f6_local1
				}, nil, true, true )
			end
		elseif Engine.BECCFCBIAA( "acceptedEULA_Version", f6_local0 ) < Dvar.CFHDGABACF( "QOMKPKKTP" ) then
			f6_arg0._state = LUI.Fence.STATE.block
			if not f6_arg0._openedEULA then
				f6_arg0._openedEULA = true
				BOOT.InitializeLegalBootPopupsSequence()
				f6_local3 = BOOT.GetCurrentLegalBootPopupName()
				if f6_local3 then
					LUI.FlowManager.RequestPopupMenu( unused, f6_local3, false, f6_local0, false, {}, nil, true, true )
				else
					f6_arg0._state = LUI.Fence.STATE.fail
				end
			end
			f6_local3 = BOOT.GetCurrentLegalBootPopupName()
			if f6_local3 and not LUI.FlowManager.IsInStack( f6_local3 ) then
				f6_arg0._state = LUI.Fence.STATE.fail
			end
		elseif not Engine.BECCFCBIAA( "hasEverPlayed_MainMenu", f6_local0 ) then
			if Engine.GEHBEDCEC() then
				Engine.DAGFFDGFII( "profile_SetHasEverPlayed_MainMenu" )
				return 
			end
			f6_arg0._state = LUI.Fence.STATE.block
			local f6_local3 = LUI.FlowManager.IsInStack( "BootBrightness" )
			if not f6_local3 then
				f6_local3 = LUI.FlowManager.IsInStack( "BootHDRBlackPoint" )
				if not f6_local3 then
					f6_local3 = LUI.FlowManager.IsInStack( "BootHDRWhitePoint" )
				end
			end
			local f6_local4 = LUI.FlowManager.IsInStack( "ScreenMargins" )
			local f6_local5 = LUI.FlowManager.IsInStack( "BootOptions" )
			local f6_local6 = LUI.FlowManager.IsInStack( "BootAudioMixPreset" )
			if not f6_arg0._openedBrightnessMenu and not Engine.CGABICJHAI() then
				if Engine.DJDAJEJDE() then
					if not Engine.EBFEGIICEF() then
						Engine.DAGFFDGFII( "profile_UpdateProfileMenuOptionsHDRLumDvars" )
						LUI.FlowManager.RequestPopupMenu( unused, "BootHDRBlackPoint", false, f6_local0, false, {
							isBootOption = true
						}, nil, true, true )
					end
				else
					LUI.FlowManager.RequestPopupMenu( unused, "BootBrightness", false, f6_local0, false, {
						isBootOption = true
					}, nil, true, true )
				end
				f6_arg0._openedBrightnessMenu = true
				return 
			elseif not f6_arg0._setScreenBounds and not Engine.CGABICJHAI() and not f6_local3 then
				LUI.FlowManager.RequestPopupMenu( unused, "ScreenMargins", false, f6_local0, false, {
					isBootOption = true
				}, nil, true, true )
				f6_arg0._setScreenBounds = true
				return 
			elseif not f6_arg0._openedAudioMixPreset and not f6_local3 and not f6_local4 then
				LUI.FlowManager.RequestPopupMenu( unused, "BootAudioMixPreset", false, f6_local0, false, {}, nil, true, true )
				f6_arg0._openedAudioMixPreset = true
				return 
			elseif not f6_arg0._openedBootOptions and not f6_local6 and not f6_local3 and not f6_local4 then
				LUI.FlowManager.RequestPopupMenu( unused, "BootOptions", false, f6_local0, false, {}, nil, true, true )
				f6_arg0._openedBootOptions = true
				return 
			elseif not f6_local6 and not f6_local5 and not f6_local3 and not f6_local4 then
				f6_arg0._state = LUI.Fence.STATE.pass
				Engine.DAGFFDGFII( "profile_SetHasEverPlayed_MainMenu" )
				if not Engine.CGABICJHAI() then
					Engine.DAGFFDGFII( "updategamerprofile" )
				end
				if IsLanguageSubtitleOnByDefault() then
					Engine.BGDAJBJBFF( f6_local0, true )
				end
			end
		end
	end
end

function PopupCorruptData( f4_arg0, f4_arg1 )
	local f4_local0 = MenuBuilder.BuildRegisteredType( "generic_confirmation_popup", {
		popup_title = Engine.CBBHFCGDIC( "MENU/CORRUPT_SAVEDATA_TITLE" ),
		message_text = Engine.CBBHFCGDIC( "MENU/CORRUPT_SAVEDATA_MESSAGE" ),
		button_text = Engine.CBBHFCGDIC( "MENU/OK" ),
		confirmation_action = function ( f5_arg0, f5_arg1 )
			Engine.EBHEBCCBFD( f5_arg1.controller )
			LUI.FlowManager.RequestLeaveMenuByName( "popup_corrupt_data", true )
		end
	} )
	f4_local0.id = "popup_corrupt_data"
	return f4_local0
end

MenuBuilder.registerType( "PopupLanguageRestart", function ( f1_arg0, f1_arg1 )
	assert( f1_arg1.controllerIndex )
	assert( f1_arg1.currentLanguage )
	assert( f1_arg1.preferredLanguage )
	local f1_local0 = MenuBuilder.BuildRegisteredType( "PopupYesNo", {
		title = Engine.CBBHFCGDIC( "MENU/NOTICE" ),
		message = Engine.CBBHFCGDIC( "LANGUAGE_SELECT/MISMATCH", GetLanguageDisplayName( f1_arg1.currentLanguage ), GetLanguageDisplayName( f1_arg1.preferredLanguage ) ),
		yesAction = function ( f3_arg0, f3_arg1 )
			DCache.EAEHIJBBCD( f1_arg0.preferredLanguage )
			Engine.BHIJFFCAEB( "" )
		end,
		noAction = function ( f2_arg0, f2_arg1 )
			Engine.CEHDAACIJA( f1_arg0.controllerIndex, f1_arg0.currentLanguage )
			Engine.DAGFFDGFII( "updategamerprofile" )
		end
	} )
	f1_local0.id = "PopupLanguageRestart"
	return f1_local0
end )
MenuBuilder.registerType( "popup_corrupt_data", PopupCorruptData )
LUI.Fence.Register( "gamerProfile", FenceGamerProfile )
LockTable( _M )
