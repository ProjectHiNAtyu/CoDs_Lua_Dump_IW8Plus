-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
module( ..., package.seeall )
require( "ui.frontEnd.ProgressionChallengeContainer" )
require( "ui.frontEnd.SeasonalChallengeStatus" )
require( "ui.frontEnd.SeasonalChallengeMasteryProgress" )
require( "ui.frontEnd.SeasonalProgressionStatus" )
require( "ui.widgets.MPPlayerDetails" )
require( "ui.widgets.MenuTitle" )
local f0_local0 = "CHALLENGE/SEASON_X_MASTERY"
local f0_local1 = function ( f16_arg0 )
	local f16_local0
	if f16_arg0._displayedGameMode == Challenge.ChallengeGameMode.zm then
		f16_local0 = "CHALLENGE/SHOW_MULTIPLAYER"
	else
		f16_local0 = "CHALLENGE/SHOW_ZOMBIES"
	end
	return f16_local0
end

local f0_local2 = function ( f15_arg0, f15_arg1, f15_arg2 )
	local f15_local0 = Challenge.GetChallengeByAEID( f15_arg2, f15_arg0._seasonalChallenges )
	if f15_local0 then
		if PROGRESSION.GetPlayerSeasonRank( f15_arg1, f15_arg0._currentSeason ) < f15_local0.unlockLevel and not CONDITIONS.IsSunsetEnabled() then
			f15_arg0.SeasonalChallengeStatus.RewardImage:setImage( RegisterMaterial( "ui_default_white" ), 0 )
			ACTIONS.AnimateSequence( f15_arg0.SeasonalChallengeStatus, "ShowClassified" )
			f15_arg0.SeasonalChallengeStatus.ClassifiedUnlockReqLabel:setText( Engine[0xED84C33EC5F01EA]( "CHALLENGE/PRESTIGE_CHALLENGE_UNLOCK_LEVEL", f15_local0.unlockLevel + 1, tonumber( f15_local0.season ) ) )
			return 
		end
		ACTIONS.AnimateSequence( f15_arg0.SeasonalChallengeStatus, "HideClassified" )
		local f15_local1 = LOOT.GetItemRef( LOOT.itemTypes.PLAYERCARD, Challenge.GetLootIDForHighestRewardOfType( f15_local0, LOOT.itemTypes.PLAYERCARD ) )
		local f15_local2 = Engine[0xED84C33EC5F01EA]( "CHALLENGE/CHALLENGE_DETAILS" )
		local f15_local3 = Engine[0xED84C33EC5F01EA]( f15_local0.description, f15_local0.cumulativeProgressMax )
		f15_arg0.SeasonalChallengeStatus:SetAlpha( 1 )
		f15_arg0.SeasonalChallengeStatus:Setup( f15_local0, f15_local2, f15_local3, f15_local1 )
	else
		ACTIONS.AnimateSequence( f15_arg0, "HideChallengeStatus" )
	end
end

local f0_local3 = function ( f14_arg0, f14_arg1 )
	if f14_arg0._currentSeason ~= SEASON.GetCurrentSeason() and not PROGRESSION.PlayerReachedSeasonMasteryRank( f14_arg0._controllerIndex, f14_arg0._currentSeason ) then
		f14_arg0.ChallengeMasteryProgress:SetVisibility( LUI.Visibility.Hidden )
		return 
	end
	f14_arg0.ChallengeMasteryProgress:SetVisibility( LUI.Visibility.Visible )
	local f14_local0 = Challenge.GetChallengeItemDisplayDataForTier( f14_arg1, f14_arg1.activeTier )
	f14_local0.title = nil
	local f14_local1 = Challenge.GetRewardDataForTier( f14_arg0._controllerIndex, f14_arg1, f14_arg1.activeTier )
	local f14_local2 = LOOT.GetItemRef( LOOT.itemTypes.PLAYERCARD, Challenge.GetLootIDForHighestRewardOfType( f14_arg1, LOOT.itemTypes.PLAYERCARD ) )
	local f14_local3 = Engine[0xED84C33EC5F01EA]( f14_arg1.name )
	local f14_local4 = Engine[0xED84C33EC5F01EA]( f14_arg1.description, f14_arg1.cumulativeProgressMax )
	f14_arg0.ChallengeMasteryProgress:Setup( f14_arg0._controllerIndex, f0_local0, f14_arg0._currentSeason, f14_local0, f14_local1, f14_local2 )
	if not IsLanguageArabic() then
		f14_arg0.ChallengeMasteryProgress.Header.Title:SetRight( 300 * _1080p )
	end
end

local f0_local4 = function ( f13_arg0 )
	f13_arg0.SeasonalProgressionStatus:RemoveButtonHelperText( "button_alt1", "left" )
	local f13_local0 = SEASON.GetCurrentSeason()
	local f13_local1, f13_local2, f13_local3 = PROGRESSION.GetSeasonCurrentMinMaxXPForMilestone( f13_arg0._controllerIndex, PROGRESSION.GetPlayerSeasonMilestoneLevel( f13_arg0._controllerIndex, f13_local0, false ) + 1, f13_local0 )
	local f13_local4 = f13_local3 - f13_local1
	if f13_local4 == 0 or f13_arg0._currentSeason ~= f13_local0 then
		if f13_local4 == 0 then
			f13_arg0.SeasonalProgressionStatus.Title:setText( Engine[0xED84C33EC5F01EA]( "CHALLENGE/MAXIMUM_LEVEL_XP_REACHED" ) )
			f13_arg0.SeasonalProgressionStatus.CompletedMessage:setText( Engine[0xED84C33EC5F01EA]( "CHALLENGE/MAXIMUM_LEVEL_XP_REACHED_DESC" ) )
		else
			f13_arg0.SeasonalProgressionStatus.Title:setText( Engine[0xED84C33EC5F01EA]( "CHALLENGE/SEASON_FINISHED", f13_arg0._currentSeason ) )
			f13_arg0.SeasonalProgressionStatus.CompletedMessage:setText( Engine[0xED84C33EC5F01EA]( "CHALLENGE/SEASON_FINISHED_DESCRIPTION" ) )
		end
		ACTIONS.AnimateSequence( f13_arg0.SeasonalProgressionStatus, "ShowSeasonComplete" )
		f13_arg0.SeasonalProgressionStatus.seasonComplete = true
		f13_arg0.SeasonalProgressionStatus:SetupBlueprintPreview( f13_arg0._controllerIndex, f13_arg0._currentSeason )
		return 
	else
		f13_arg0.SeasonalProgressionStatus:SetupBlueprintPreview( f13_arg0._controllerIndex, f13_arg0._currentSeason )
		f13_arg0.HelperBar._xpNotificationPrompt = f13_arg0.SeasonalProgressionStatus:GetPromptContainer()
		f13_arg0.SeasonalProgressionStatus:AddButtonHelperText( {
			button_ref = "button_alt1",
			helper_text = Engine[0xED84C33EC5F01EA]( "CHALLENGE/PREVIEW" ),
			container = f13_arg0.HelperBar._xpNotificationPrompt,
			containerAlignment = LUI.Alignment.Left
		} )
	end
end

local f0_local5 = function ( f11_arg0, f11_arg1, f11_arg2 )
	if not f11_arg2 then
		local f11_local0 = f11_arg2
	else
		local f11_local1 = CONDITIONS.IsThirdGameMode()
		local f11_local2 = Challenge.ChallengeGameMode.zm
		local f11_local3 = Challenge.ChallengeGameMode.mp
	end
	local f11_local0 = f11_local1 and f11_local2 or f11_local3
	f11_arg0._displayedGameMode = f11_local0
	local f11_local4 = LUI.FlowManager.GetScopedData( f11_arg0 )
	f11_local4.displayedGameMode = f11_local0
	f11_arg0._seasonalChallenges = Challenge.GetChallengesAndProgress( f11_arg1, AEKinds.S4_AE_KIND_SEASONAL_CHALLENGE, function ( f12_arg0, f12_arg1 )
		local f12_local0 = f11_arg0._currentSeason
		local f12_local1 = CSV.ReadRow( f12_arg0, f12_arg1 )
		local f12_local2
		if f11_arg0 ~= Challenge.ChallengeGameMode.both and f11_arg0 ~= f12_local1.isZombieAchievement then
			f12_local2 = false
		else
			f12_local2 = true
		end
		local f12_local3 = f12_local0 == tonumber( f12_local1.season )
		local f12_local4
		if f12_local2 then
			f12_local4 = f12_local2
		else
			f12_local4 = f12_local3
		end
		return f12_local4
	end )
	if f11_arg0._seasonalChallenges and 0 < #f11_arg0._seasonalChallenges then
		table.sort( f11_arg0._seasonalChallenges, Challenge.SeasonalChallengeSortFn )
		local f11_local5 = f11_arg0._seasonalChallenges
		for f11_local9, f11_local10 in ipairs( f11_local5 ) do
			if f11_local10.completionDependencies == "1" then
				table.remove( f11_local5, f11_local9 )
				break
			end
		end
		f11_arg0.ProgressionChallengeContainer:UpdateContentForSeason( f11_arg1, f11_local5, f11_arg0._currentSeason, false, f11_arg0._displayedGameMode )
	else
		f11_arg0.ProgressionChallengeContainer:HideChallengeGrid()
	end
end

local f0_local6 = function ( f7_arg0, f7_arg1, f7_arg2 )
	Engine[0x685AE31DEDA30A4]( "squad_lobby_detail" )
	f7_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( "CHALLENGE/SEASONAL_PROGRESSION", f7_arg2.season ) )
	f7_arg0._currentSeason = f7_arg2.season
	local f7_local0 = PROGRESSION.GetPlayerSeasonRank( f7_arg1, f7_arg0._currentSeason )
	f7_arg0.SeasonalProgressionStatus:HideAll()
	f7_arg0.SeasonalProgressionStatus:Setup( f7_arg1, f7_arg0._currentSeason )
	f7_arg0._controllerIndex = f7_arg1
	local f7_local1 = LUI.FlowManager.GetScopedData( f7_arg0 )
	local f7_local2 = f0_local0
	local f7_local3 = f7_arg0
	local f7_local4 = f7_arg1
	local f7_local5
	if f7_local1 then
		f7_local5 = f7_local1.displayedGameMode
		if not f7_local5 then
		
		else
			f7_local2( f7_local3, f7_local4, f7_local5 )
			f7_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
				side = "left",
				button_ref = "button_alt2",
				priority = 5,
				helper_text = Engine[0xED84C33EC5F01EA]( f0_local0( f7_arg0 ) )
			} )
			f7_arg0.ProgressionChallengeContainer.PrestigeProgressBar:UpdateContentForSeason( f7_arg0._controllerIndex, f7_arg0._currentSeason )
			f7_arg0.ProgressionChallengeContainer:processEvent( {
				name = "lose_focus",
				controller = f7_arg0._controllerIndex
			} )
			f7_arg0._shouldShowSeasonal = true
			local f7_local6 = Challenge.GetSeasonalMasteryChallenges( f7_arg1, f7_local1.displayedGameMode )
			f7_local6 = f7_local6[f7_arg0._currentSeason or 1]
			if f7_local6 then
				f0_local0( f7_arg0, f7_local6 )
			else
				ACTIONS.AnimateSequence( f7_arg0, "HideChallengeMasteryProgress" )
			end
			f7_arg0:registerEventHandler( "challenge_item_focused", function ( element, event )
				f7_arg0( element, element._controllerIndex, event.challengeData and event.challengeData.aeID or nil )
			end )
			f7_arg0:addEventHandler( "menu_create", function ( f9_arg0, f9_arg1 )
				f7_arg0( f7_arg0 )
			end )
			f7_arg0.bindButton:registerEventHandler( "button_alt2", function ( element, event )
				local f8_local0 = Challenge.ChallengeGameMode.zm
				local f8_local1 = Challenge.ChallengeGameMode.mp
				local f8_local2 = nil
				if f7_arg0._displayedGameMode == f8_local0 then
					f8_local2 = f8_local1
				elseif f7_arg0._displayedGameMode == f8_local1 then
					f8_local2 = f8_local0
				else
					return 
				end
				f7_arg0( f7_arg0, event.controller, f8_local2 )
				local f8_local3 = Challenge.GetSeasonalMasteryChallenges( event.controller, f8_local2 )
				f8_local3 = f8_local3[f7_arg0._currentSeason or 1]
				assert( f8_local3 )
				local f8_local4 = f7_arg0.ProgressionChallengeContainer.CardGrid:GetBuiltChildren()
				f8_local4 = f8_local4[1]
				f7_arg0( f7_arg0, event.controller, f8_local4._challengeData and f8_local4._challengeData.aeID or nil )
				f7_arg0( f7_arg0, f8_local3 )
				f7_arg0( f7_arg0 )
				f7_arg0 = f7_arg0( f7_arg0 )
				f7_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
					button_ref = "button_alt2"
				} )
				f7_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
					side = "left",
					button_ref = "button_alt2",
					priority = 5,
					helper_text = Engine[0xED84C33EC5F01EA]( f7_arg0 )
				} )
			end )
			f7_arg0.UpdateSeasonalProgressionStatus = f0_local0
			if Engine[0xFB1B6E36ABE59B8]() then
				ACTIONS.AnimateSequence( f7_arg0, "SafeAreaAdjustment" )
			end
			SEQUENCEPRESETS.RegisterAnimation( f7_arg0, LUI.Transition.TransFrom, "OutDepthForward", 0 )
			SEQUENCEPRESETS.RegisterAnimation( f7_arg0, LUI.Transition.TransTo, "InDepthForward", 0 )
			SEQUENCEPRESETS.RegisterAnimation( f7_arg0, LUI.Transition.TransBackFrom, "OutDepthBack", 0 )
			SEQUENCEPRESETS.RegisterAnimation( f7_arg0, LUI.Transition.TransBackTo, "InDepthBack", 0 )
		end
	end
	f7_local5 = nil
end

function SeasonalChallengesProgressionMenu( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "SeasonalChallengesProgressionMenu"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	self._sequenceLengths = self._sequenceLengths or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	self.HelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	self.HelperBar.id = "HelperBar"
	self.HelperBar:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -85, 0 )
	self.HelperBar:setPriority( 10 )
	self:addElement( self.HelperBar )
	local f1_local2 = self
	local ProgressionChallengeContainer = nil
	
	ProgressionChallengeContainer = MenuBuilder.BuildRegisteredType( "ProgressionChallengeContainer", {
		controllerIndex = f1_local1
	} )
	ProgressionChallengeContainer.id = "ProgressionChallengeContainer"
	ProgressionChallengeContainer:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 130, _1080p * 1334, _1080p * 136, _1080p * 816 )
	self:addElement( ProgressionChallengeContainer )
	self.ProgressionChallengeContainer = ProgressionChallengeContainer
	
	local SeasonalChallengeStatus = nil
	
	SeasonalChallengeStatus = MenuBuilder.BuildRegisteredType( "SeasonalChallengeStatus", {
		controllerIndex = f1_local1
	} )
	SeasonalChallengeStatus.id = "SeasonalChallengeStatus"
	SeasonalChallengeStatus.Rewards:SetAlpha( 0.75, 0 )
	SeasonalChallengeStatus:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 130, _1080p * 1334, _1080p * 854, _1080p * 1002 )
	self:addElement( SeasonalChallengeStatus )
	self.SeasonalChallengeStatus = SeasonalChallengeStatus
	
	local ChallengeMasteryProgress = nil
	
	ChallengeMasteryProgress = MenuBuilder.BuildRegisteredType( "SeasonalChallengeMasteryProgress", {
		controllerIndex = f1_local1
	} )
	ChallengeMasteryProgress.id = "ChallengeMasteryProgress"
	ChallengeMasteryProgress:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1375, _1080p * 1811, _1080p * 540, _1080p * 1002 )
	self:addElement( ChallengeMasteryProgress )
	self.ChallengeMasteryProgress = ChallengeMasteryProgress
	
	local SeasonalProgressionStatus = nil
	
	SeasonalProgressionStatus = MenuBuilder.BuildRegisteredType( "SeasonalProgressionStatus", {
		controllerIndex = f1_local1
	} )
	SeasonalProgressionStatus.id = "SeasonalProgressionStatus"
	SeasonalProgressionStatus:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1375, _1080p * 1811, _1080p * 168, _1080p * 531 )
	self:addElement( SeasonalProgressionStatus )
	self.SeasonalProgressionStatus = SeasonalProgressionStatus
	
	local Divider = nil
	
	Divider = LUI.UIImage.new()
	Divider.id = "Divider"
	Divider:SetRGBFromTable( SWATCHES.text.vTextOffWhite, 0 )
	Divider:SetAlpha( 0.25, 0 )
	Divider:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1354, _1080p * 1355, _1080p * 168, _1080p * 979 )
	self:addElement( Divider )
	self.Divider = Divider
	
	local MPPlayerDetails = nil
	
	MPPlayerDetails = MenuBuilder.BuildRegisteredType( "MPPlayerDetails", {
		controllerIndex = f1_local1
	} )
	MPPlayerDetails.id = "MPPlayerDetails"
	MPPlayerDetails:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1324, _1080p * 1824, _1080p * 57, _1080p * 97 )
	self:addElement( MPPlayerDetails )
	self.MPPlayerDetails = MPPlayerDetails
	
	local MenuTitle = nil
	
	MenuTitle = MenuBuilder.BuildRegisteredType( "MenuTitle", {
		controllerIndex = f1_local1
	} )
	MenuTitle.id = "MenuTitle"
	MenuTitle.MenuTitle:SetAlpha( 0.15, 0 )
	MenuTitle.MenuTitle:setText( "", 0 )
	MenuTitle.Line:SetLeft( 0, 0 )
	MenuTitle:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1024, 0, _1080p * 100 )
	self:addElement( MenuTitle )
	self.MenuTitle = MenuTitle
	
	self._sequences.DefaultSequence = function ()
		
	end
	
	self._sequenceLengths.DefaultSequence = 0
	local f1_local10 = nil
	SeasonalChallengeStatus:RegisterAnimationSequence( "HideChallengeStatus", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.HideChallengeStatus = function ()
		menu:AnimateSequence( "HideChallengeStatus" )
	end
	
	self._sequenceLengths.HideChallengeStatus = 0
	local f1_local11 = nil
	ChallengeMasteryProgress:RegisterAnimationSequence( "HideChallengeMasteryProgress", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.HideChallengeMasteryProgress = function ()
		menu:AnimateSequence( "HideChallengeMasteryProgress" )
	end
	
	self._sequenceLengths.HideChallengeMasteryProgress = 0
	local f1_local12 = nil
	ProgressionChallengeContainer:RegisterAnimationSequence( "SafeAreaAdjustment", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * 112
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 792
		}
	} )
	SeasonalChallengeStatus:RegisterAnimationSequence( "SafeAreaAdjustment", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * 807
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 955
		}
	} )
	ChallengeMasteryProgress:RegisterAnimationSequence( "SafeAreaAdjustment", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * 501
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 963
		}
	} )
	SeasonalProgressionStatus:RegisterAnimationSequence( "SafeAreaAdjustment", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * 128
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 489
		}
	} )
	Divider:RegisterAnimationSequence( "SafeAreaAdjustment", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * 144
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 955
		}
	} )
	self._sequences.SafeAreaAdjustment = function ()
		menu:AnimateSequence( "SafeAreaAdjustment" )
		menu:AnimateSequence( "SafeAreaAdjustment" )
		menu:AnimateSequence( "SafeAreaAdjustment" )
		menu:AnimateSequence( "SafeAreaAdjustment" )
		menu:AnimateSequence( "SafeAreaAdjustment" )
	end
	
	self._sequenceLengths.SafeAreaAdjustment = 0
	self.HelperBar.ButtonHelperText:PushButtonPrompt( {
		side = "left",
		button_ref = "button_secondary",
		helper_text = Engine[0xED84C33EC5F01EA]( "MENU/BACK" )
	} )
	if not self.bindButton then
		local f1_local13 = LUI.UIBindButton.new()
		f1_local13.id = "selfBindButton"
		self:addElement( f1_local13 )
		self.bindButton = f1_local13
	end
	self.bindButton:addEventHandler( "button_secondary", function ( f2_arg0, f2_arg1 )
		local f2_local0 = f2_arg1.controller or menu
		ACTIONS.LeaveMenu( menu, true )
	end )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "SeasonalChallengesProgressionMenu", SeasonalChallengesProgressionMenu )
LockTable( _M )
