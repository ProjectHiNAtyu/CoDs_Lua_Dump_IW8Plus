-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 27-09-2025 22:41
module( ..., package.seeall )
local f0_local0 = function ( f6_arg0, f6_arg1 )
	local f6_local0 = LUI.FlowManager.GetScopedData( f6_arg0 )
	local f6_local1 = {}
	if 0 < #f6_arg1.messageTable then
		f6_local1[#f6_local1 + 1] = {
			menuName = "CRMMessages",
			name = ToUpperCase( Engine.CBBHFCGDIC( "LUA_MENU_MP/LATEST" ) )
		}
	end
	if not f6_arg0._hasRedeemMessage or not f6_arg1.forceOpen then
		f6_local1[#f6_local1 + 1] = {
			menuName = "CRMPatchNotes",
			name = ToUpperCase( Engine.CBBHFCGDIC( "LUA_MENU_MP/PATCH_NOTES" ) )
		}
	end
	if #f6_local1 == 1 then
		f6_arg0.Tabs:SetAlpha( 0 )
	end
	local f6_local2 = {}
	for f6_local6, f6_local7 in ipairs( f6_local1 ) do
		table.insert( f6_local2, {
			name = f6_local7.name,
			disabled = f6_local7.disabled,
			hasDefaultFocus = f6_local6 == f6_local0.activeTabIndex,
			focusFunction = function ( f7_arg0, f7_arg1, f7_arg2, f7_arg3 )
				f6_arg0.popupContainer = f6_arg0
				if f6_arg0.activeTabIndex and f7_arg2 == f6_arg0.activeTabIndex and f6_arg0.activeTabWidget then
					return 
				end
				TAB.UpdateBuiltWidgetOnTabChange( f6_arg0, f6_arg0.activeTabIndex, "activeTabWidget", f7_arg2, f7_arg3, f6_arg0.menuName, f6_arg0 )
				f6_arg0.activeTabIndex = f7_arg2
				Engine.BJDBIAGIDA( SOUND_SETS.default.tabHighlight )
				if f6_arg0.menuName == "CRMPatchNotes" then
					f6_arg0:RemoveButtonHelperTextFromElement( f6_arg0.ButtonHelperBar, "button_alt2", "left" )
					f6_arg0:AddButtonHelperTextToElement( f6_arg0.ButtonHelperBar, {
						side = "left",
						button_ref = "button_secondary",
						priority = 0,
						helper_text = Engine.CBBHFCGDIC( "LUA_MENU/CLOSE" )
					} )
					f6_arg0:AddButtonHelperTextToElement( f6_arg0.ButtonHelperBar, {
						side = "left",
						button_ref = "button_primary",
						priority = 1,
						helper_text = Engine.CBBHFCGDIC( "LUA_MENU/SELECT" )
					} )
				else
					f6_arg0:RemoveButtonHelperTextFromElement( f6_arg0.ButtonHelperBar, "button_primary", "left" )
				end
			end
		} )
	end
	assert( 0 < #f6_local2 )
	f6_arg0.Tabs:SetTabs( f6_local2 )
	f6_arg0.Tabs:SetAlignment( LUI.Alignment.Left )
end

local f0_local1 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg2.messageTable = {}
	f3_arg2.patchNoteTable = {}
	local f3_local0 = "MENU/NOTICE"
	if f3_arg2.messageData then
		table.insert( f3_arg2.messageTable, f3_arg2.messageData )
	else
		f3_arg2.messageTable = CRM.GetMenuMessageData()
		f3_arg2.patchNoteTable = CRM.GetPatchNoteMessageData()
		if 0 < #f3_arg2.messageTable then
			f3_local0 = "LUA_MENU/MOTD_CAPS"
		elseif 0 < #f3_arg2.patchNoteTable then
			f3_local0 = "LUA_MENU_MP/PATCH_NOTES"
		end
	end
	f3_arg0.MenuTitle:SetTitle( Engine.CBBHFCGDIC( f3_local0 ) )
	f3_arg0._hasRedeemMessage = false
	for f3_local4, f3_local5 in ipairs( f3_arg2.messageTable ) do
		if f3_local5.action and f3_local5.action == "redeem" then
			f3_arg0._hasRedeemMessage = true
			break
		end
	end
	f0_local0( f3_arg0, f3_arg2 )
	f3_arg0:addEventHandler( "lose_focus", function ( f5_arg0, f5_arg1 )
		f3_arg0:SetAlpha( 0 )
	end )
	f3_arg0:addEventHandler( "restore_focus", function ( f4_arg0, f4_arg1 )
		f3_arg0:SetAlpha( 1 )
	end )
	f3_arg0:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	ACTIONS.ScaleFullscreen( f3_arg0.DarkenBackground )
end

function CRMContainer( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "CRMContainer"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	local DarkenBackground = nil
	
	DarkenBackground = LUI.UIImage.new()
	DarkenBackground.id = "DarkenBackground"
	DarkenBackground:SetRGBFromTable( SWATCHES.text.overText, 0 )
	DarkenBackground:SetAlpha( 0.9, 0 )
	self:addElement( DarkenBackground )
	self.DarkenBackground = DarkenBackground
	
	local ButtonHelperBar = nil
	
	ButtonHelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	ButtonHelperBar.id = "ButtonHelperBar"
	ButtonHelperBar:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -85, 0 )
	self:addElement( ButtonHelperBar )
	self.ButtonHelperBar = ButtonHelperBar
	
	local MenuTitle = nil
	
	MenuTitle = MenuBuilder.BuildRegisteredType( "MenuTitle", {
		controllerIndex = f1_local1
	} )
	MenuTitle.id = "MenuTitle"
	MenuTitle.MenuTitle:setText( Engine.CBBHFCGDIC( "LUA_MENU/MOTD_CAPS" ), 0 )
	MenuTitle.Line:SetLeft( 0, 0 )
	MenuTitle:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1024, 0, _1080p * 100 )
	self:addElement( MenuTitle )
	self.MenuTitle = MenuTitle
	
	local Tabs = nil
	
	Tabs = LUI.TabManager.new( {
		spacing = 4,
		wrap = true,
		tabHeight = _1080p * 52,
		buildTab = function ()
			return MenuBuilder.BuildRegisteredType( "SubMenuTab", {
				controllerIndex = menu
			} )
		end,
		controllerIndex = f1_local1
	} )
	Tabs.id = "Tabs"
	Tabs:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 90, _1080p * 1087, _1080p * 108, _1080p * 160 )
	self:addElement( Tabs )
	self.Tabs = Tabs
	
	local f1_local7 = nil
	if CONDITIONS.IsUserSignedInDemonware( f1_local1 ) then
		f1_local7 = MenuBuilder.BuildRegisteredType( "MPPlayerDetails", {
			controllerIndex = f1_local1
		} )
		f1_local7.id = "MPPlayerDetails"
		f1_local7:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -596, _1080p * -96, _1080p * 54, _1080p * 114 )
		self:addElement( f1_local7 )
		self.MPPlayerDetails = f1_local7
	end
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "CRMContainer", CRMContainer )
LockTable( _M )
