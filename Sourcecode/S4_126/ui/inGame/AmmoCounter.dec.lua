-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
module( ..., package.seeall )
local f0_local0 = SWATCHES.HUD.vHUDDefault
local f0_local1 = SWATCHES.HUD.HUDSecondary
local f0_local2 = SWATCHES.highlight.vRedNegative
local f0_local3 = SWATCHES.HUD.overcharged
local f0_local4 = function ( f8_arg0, f8_arg1, f8_arg2 )
	local f8_local0 = Engine[0x74423E76DECE3E4]()
	local f8_local1 = Engine[0x9258F49F515F97B]()
	local f8_local2 = CONDITIONS.IsFtueGametype()
	f8_arg0._currentStockValue = 0
	local f8_local3 = function ( f17_arg0, f17_arg1 )
		f17_arg0._currentStockValue = f17_arg1
		f17_arg0.StockCount:setText( Engine[0x7D3158A9539A355]( f17_arg1 ) )
	end
	
	local f8_local4 = function ()
		if f8_arg0.ticking then
			
		else
			
		end
		f8_arg0.ticking = true
		local f14_local0 = nil
		local f14_local1 = function ()
			local f15_local0 = f14_local0._targetValue - f14_local0._currentStockValue
			if f15_local0 <= 0 then
				f14_local0( f14_local0, f14_local0._targetValue )
				f14_local0.ticking = false
			else
				f14_local0( f14_local0, f14_local0._currentStockValue + math.ceil( f15_local0 * 0.1 ) )
				local f15_local1 = f14_local0:Wait( 45 )
				f15_local1.onComplete = function ()
					f15_local0()
				end
				
			end
		end
		
		f14_local1()
	end
	
	local f8_local5 = function ( f13_arg0 )
		f8_arg0._targetValue = DataModel[0x614D394F6F9A18D]( f13_arg0 )
		local f13_local0 = DataSources.inGame.player.currentWeapon.name:GetValue( f8_arg0 )
		if f8_arg0 then
			f8_arg0.StockCount:SetVisible( false )
		elseif f8_arg0 then
			if f8_arg0._currentStockValue < f8_arg0._targetValue and f13_local0 == f8_arg0._previousWeapon and not f8_arg0._wasInAltMode then
				f8_arg0()
			else
				f8_arg0( f8_arg0, f8_arg0._targetValue )
			end
		elseif f8_arg0 then
			if f8_arg0._currentStockValue < f8_arg0._targetValue and f13_local0 == f8_arg0._previousWeapon and not f8_arg0._wasInAltMode and Game[0x28624DEF6F708C8]( f8_arg0, "damage_feedback_other" ) == "scavenger" then
				f8_arg0()
			else
				f8_arg0( f8_arg0, f8_arg0._targetValue )
			end
		end
		f8_arg0._wasInAltMode = DataSources.inGame.player.currentWeapon.inAltMode:GetValue( f8_arg0 )
		f8_arg0._previousWeapon = f13_local0
		if f8_arg0._targetValue == 0 then
			f8_arg0.StockCount:SetRGBFromTable( f8_arg0 )
		else
			f8_arg0.StockCount:SetRGBFromTable( f8_arg0 )
		end
	end
	
	local f8_local6 = function ()
		local f12_local0 = DataSources.inGame.player.currentWeapon.ammoWarningStateRight:GetValue( f8_arg0 )
		local f12_local1 = DataSources.inGame.player.currentWeapon.ammoWarningStateLeft:GetValue( f8_arg0 )
		local f12_local2 = DataSources.inGame.player.currentWeapon.clipAmmoRightDisplay:GetValue( f8_arg0 )
		local f12_local3 = f8_arg0
		if f8_arg0 then
			if DataSources.inGame.player.perk.overcharge:GetValue( f8_arg0 ) then
				f12_local3 = f8_arg0
			end
			if f12_local0 == AmmoWarningState.OK then
				f8_arg0.ClipCountR:SetRGBFromTable( f12_local3 )
			else
				f8_arg0.ClipCountR:SetRGBFromTable( f8_arg0 )
			end
			if f12_local1 == AmmoWarningState.OK then
				f8_arg0.ClipCountL:SetRGBFromTable( f12_local3 )
			else
				f8_arg0.ClipCountL:SetRGBFromTable( f8_arg0 )
			end
		else
			if f12_local0 == AmmoWarningState.OK then
				f8_arg0.ClipCountR:SetRGBFromTable( f12_local3 )
			else
				f8_arg0.ClipCountR:SetRGBFromTable( f8_arg0 )
			end
			if f12_local1 == AmmoWarningState.OK then
				f8_arg0.ClipCountL:SetRGBFromTable( f12_local3 )
			else
				f8_arg0.ClipCountL:SetRGBFromTable( f8_arg0 )
			end
		end
		if f12_local2 and 9 < f12_local2 then
			ACTIONS.AnimateSequence( f8_arg0, "Double" )
		else
			ACTIONS.AnimateSequence( f8_arg0, "Single" )
		end
	end
	
	f8_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.stockAmmoDisplay:GetModel( f8_arg1 ), f8_local5 )
	f8_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoRightDisplay:GetModel( f8_arg1 ), f8_local6 )
	f8_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoLeftDisplay:GetModel( f8_arg1 ), f8_local6 )
	f8_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.displayName:GetModel( f8_arg1 ), f8_local6 )
	if f8_local1 then
		f8_arg0:SubscribeToModel( DataSources.inGame.player.perk.overcharge:GetModel( f8_arg1 ), f8_local6 )
	end
	f8_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.isDualWielding:GetModel( f8_arg1 ), function ( f11_arg0 )
		local f11_local0 = DataModel[0x614D394F6F9A18D]( f11_arg0 )
		f8_arg0.ClipCountL:SetVisible( f11_local0 )
		f8_arg0.Divider:SetVisible( f11_local0 )
	end )
	local f8_local7 = LUI.DataSourceInControllerModel.new( "cg.player.currentWeapon.clipAmmoVisible" )
	f8_arg0:SubscribeToModel( f8_local7:GetModel( f8_arg1 ), function ( f10_arg0 )
		f8_arg0.ClipCountR:SetVisible( DataModel[0x614D394F6F9A18D]( f10_arg0 ) )
	end )
	local f8_local8 = LUI.DataSourceInControllerModel.new( "cg.player.currentWeapon.stockAmmoVisible" )
	f8_arg0:SubscribeToModel( f8_local8:GetModel( f8_arg1 ), function ( f9_arg0 )
		if f8_arg0 then
			return 
		else
			f8_arg0.StockCount:SetVisible( DataModel[0x614D394F6F9A18D]( f9_arg0 ) )
		end
	end )
	if IsLanguageJapanese() then
		ACTIONS.AnimateSequence( f8_arg0, "JP" )
	end
end

function AmmoCounter( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 100 * _1080p, 0, 75 * _1080p )
	self.id = "AmmoCounter"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	self._sequenceLengths = self._sequenceLengths or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local StockCount = nil
	
	StockCount = LUI.UIStyledText.new()
	StockCount.id = "StockCount"
	StockCount:SetRGBFromTable( SWATCHES.HUD.vHUDTertiary, 0 )
	StockCount:setText( "145", 0 )
	StockCount:SetFont( FONTS.GetFont( FONT_STYLES.fontStyle_MHeaderBold.font.File ) )
	StockCount:SetFontSize( FONT_STYLES.fontStyle_MHeaderBold.size )
	StockCount:SetMinFontSize( FONT_STYLES.fontStyle_MHeaderBold.minSize )
	StockCount:SetWordWrap( false )
	StockCount:SetAlignment( LUI.Alignment.Right )
	StockCount:SetOutlineMinDistance( -0.2, 0 )
	StockCount:SetOutlineMaxDistance( -0.1, 0 )
	StockCount:SetOutlineRGBFromTable( SWATCHES.HUD.vHUDMediumDarkOutline, 0 )
	StockCount:SetAnchorsAndPosition( 1, 0, 1, 0, _1080p * -51, _1080p * -6, _1080p * -38, _1080p * -8 )
	self:addElement( StockCount )
	self.StockCount = StockCount
	
	local ClipCountR = nil
	
	ClipCountR = LUI.UIStyledText.new()
	ClipCountR.id = "ClipCountR"
	ClipCountR:SetRGBFromTable( SWATCHES.HUD.vHUDDefault, 0 )
	ClipCountR:SetFont( FONTS.GetFont( FONT_STYLES.fontStyle_LHeaderBold.font.File ) )
	ClipCountR:SetFontSize( FONT_STYLES.fontStyle_LHeaderBold.size )
	ClipCountR:SetMinFontSize( FONT_STYLES.fontStyle_LHeaderBold.minSize )
	ClipCountR:SetWordWrap( false )
	ClipCountR:SetLeading( -2 * _1080p, 0 )
	ClipCountR:SetAlignment( LUI.Alignment.Right )
	ClipCountR:SetOutlineMinDistance( -0.2, 0 )
	ClipCountR:SetOutlineMaxDistance( -0.1, 0 )
	ClipCountR:SetOutlineRGBFromTable( SWATCHES.HUD.vHUDMediumDarkOutline, 0 )
	ClipCountR:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -106, _1080p * -6, _1080p * -6, _1080p * 37 )
	ClipCountR:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoRightDisplay:GetModel( f1_local1 ), function ()
		local f7_local0 = DataSources.inGame.player.currentWeapon.clipAmmoRightDisplay:GetValue( menu )
		if f7_local0 ~= nil then
			menu:setText( MarkLocalized( f7_local0 ), 0 )
		end
	end )
	self:addElement( ClipCountR )
	self.ClipCountR = ClipCountR
	
	local ClipCountL = nil
	
	ClipCountL = LUI.UIStyledText.new()
	ClipCountL.id = "ClipCountL"
	ClipCountL:SetRGBFromTable( SWATCHES.HUD.vHUDDefault, 0 )
	ClipCountL:SetFont( FONTS.GetFont( FONT_STYLES.fontStyle_LHeaderBold.font.File ) )
	ClipCountL:SetFontSize( FONT_STYLES.fontStyle_LHeaderBold.size )
	ClipCountL:SetMinFontSize( FONT_STYLES.fontStyle_LHeaderBold.minSize )
	ClipCountL:SetWordWrap( false )
	ClipCountL:SetLeading( -2 * _1080p, 0 )
	ClipCountL:SetAlignment( LUI.Alignment.Right )
	ClipCountL:SetOutlineMinDistance( -0.2, 0 )
	ClipCountL:SetOutlineMaxDistance( -0.1, 0 )
	ClipCountL:SetOutlineRGBFromTable( SWATCHES.HUD.vHUDMediumDarkOutline, 0 )
	ClipCountL:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -151, _1080p * -51, _1080p * -6, _1080p * 37 )
	ClipCountL:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoLeftDisplay:GetModel( f1_local1 ), function ()
		local f6_local0 = DataSources.inGame.player.currentWeapon.clipAmmoLeftDisplay:GetValue( menu )
		if f6_local0 ~= nil then
			menu:setText( MarkLocalized( f6_local0 ), 0 )
		end
	end )
	self:addElement( ClipCountL )
	self.ClipCountL = ClipCountL
	
	local Divider = nil
	
	Divider = LUI.UIStyledText.new()
	Divider.id = "Divider"
	Divider:SetRGBFromTable( SWATCHES.HUD.vHUDDefault, 0 )
	Divider:setText( "/", 0 )
	Divider:SetFont( FONTS.GetFont( FONT_STYLES.fontStyle_SHeaderBold.font.File ) )
	Divider:SetFontSize( FONT_STYLES.fontStyle_SHeaderBold.size )
	Divider:SetMinFontSize( FONT_STYLES.fontStyle_SHeaderBold.minSize )
	Divider:SetWordWrap( false )
	Divider:SetAlignment( LUI.Alignment.Center )
	Divider:SetOutlineMinDistance( -0.2, 0 )
	Divider:SetOutlineMaxDistance( -0.1, 0 )
	Divider:SetOutlineRGBFromTable( SWATCHES.HUD.vHUDMediumDarkOutline, 0 )
	Divider:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -87, _1080p * 13, _1080p * -3, _1080p * 40 )
	self:addElement( Divider )
	self.Divider = Divider
	
	self._sequences.DefaultSequence = function ()
		
	end
	
	self._sequenceLengths.DefaultSequence = 0
	local f1_local7 = nil
	StockCount:RegisterAnimationSequence( "JP", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * -34
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * -4
		}
	} )
	ClipCountR:RegisterAnimationSequence( "JP", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 46
		}
	} )
	ClipCountL:RegisterAnimationSequence( "JP", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 46
		}
	} )
	self._sequences.JP = function ()
		menu:AnimateSequence( "JP" )
		menu:AnimateSequence( "JP" )
		menu:AnimateSequence( "JP" )
	end
	
	self._sequenceLengths.JP = 0
	local f1_local8 = nil
	ClipCountR:RegisterAnimationSequence( "Single", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -106
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -6
		}
	} )
	ClipCountL:RegisterAnimationSequence( "Single", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -151
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -51
		}
	} )
	Divider:RegisterAnimationSequence( "Single", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -87
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 13
		}
	} )
	self._sequences.Single = function ()
		menu:AnimateSequence( "Single" )
		menu:AnimateSequence( "Single" )
		menu:AnimateSequence( "Single" )
	end
	
	self._sequenceLengths.Single = 0
	local f1_local9 = nil
	ClipCountL:RegisterAnimationSequence( "Double", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -162
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -62
		}
	} )
	Divider:RegisterAnimationSequence( "Double", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -98
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 2
		}
	} )
	self._sequences.Double = function ()
		menu:AnimateSequence( "Double" )
		menu:AnimateSequence( "Double" )
	end
	
	self._sequenceLengths.Double = 0
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "AmmoCounter", AmmoCounter )
LockTable( _M )
