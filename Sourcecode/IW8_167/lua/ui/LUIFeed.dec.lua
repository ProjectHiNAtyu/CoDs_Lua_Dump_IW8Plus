-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:51
LUI.BaseUIFeed = LUI.Class( LUI.UIGrid )
LUI.UIFeed = LUI.Class( LUI.BaseUIFeed )
LUI.UIDataSourceFeed = LUI.Class( LUI.BaseUIFeed )
LUI.BaseUIFeed.init = function ( f18_arg0, f18_arg1 )
	assert( f18_arg1 )
	local f18_local0 = assert
	local f18_local1
	if f18_arg1.TTL ~= nil and type( f18_arg1.TTL ) ~= "number" then
		f18_local1 = false
	else
		f18_local1 = true
	end
	f18_local0( f18_local1 )
	f18_local0 = assert
	if f18_arg1.maxVisibleColumns ~= 1 and f18_arg1.maxVisibleRows ~= 1 then
		f18_local1 = false
	else
		f18_local1 = true
	end
	f18_local0( f18_local1 )
	f18_arg1.numChildren = 0
	if f18_arg1.maxVisibleColumns == 1 then
		f18_arg1.numColumns = 1
		f18_arg1.numRows = nil
	else
		f18_arg1.numColumns = nil
		f18_arg1.numRows = 1
	end
	f18_arg1.defaultFocus = nil
	f18_arg1.ensureClampedTargetLineOnDimensionsUpdate = false
	LUI.BaseUIFeed.super.init( f18_arg0, f18_arg1 )
	f18_arg0._numData = 0
	f18_arg0._TTL = f18_arg1.TTL or 4000
	f18_arg0._numScrolled = 0
	f18_arg0._numVisible = 0
	f18_arg0._numAlive = 0
	f18_arg0._maxActive = math.max( f18_arg1.maxVisibleColumns, f18_arg1.maxVisibleRows )
	f18_arg0._tickOnExpiration = f18_arg1.tickOnExpiration
	f18_arg0._numAliveDataSource = f18_arg1.numAliveDataSource
	f18_arg0._numVisibleDataSource = f18_arg1.numVisibleDataSource
	f18_arg0._resetCounter = 0
	f18_local0 = f18_arg1.childVisibilityNotifyFunc
	if not f18_local0 then
		f18_local0 = LUI.BaseUIFeed.OnElementNotifyVisible
	end
	f18_arg0._childVisibilityNotifyFunc = f18_local0
	if f18_arg0._tickOnExpiration == nil then
		if f18_arg1.maxVisibleColumns == 1 and f18_arg0._verticalAlignment == LUI.Alignment.Bottom then
			f18_arg0._tickOnExpiration = false
		elseif f18_arg1.maxVisibleRows == 1 and f18_arg0._horizontalAlignment == LUI.Alignment.Right then
			f18_arg0._tickOnExpiration = false
		else
			f18_arg0._tickOnExpiration = true
		end
	end
	f18_arg0:addEventHandler( "position_visible", f18_arg0._childVisibilityNotifyFunc )
end

LUI.BaseUIFeed.OnNewData = function ( f16_arg0, f16_arg1 )
	f16_arg0._numData = f16_arg0._numData + 1
	local f16_local0 = f16_arg0:GetTargetColumn()
	local f16_local1 = f16_arg0:GetTargetRow()
	f16_arg0:SetNumChildren( f16_arg0._numData )
	f16_arg0:SetTargetColumn( f16_local0, false, true )
	f16_arg0:SetTargetRow( f16_local1, false, true )
	f16_arg0._numVisible = f16_arg0._numVisible + 1
	f16_arg0._numAlive = f16_arg0._numAlive + 1
	local f16_local2 = f16_arg0:GetPrimaryAxis()
	local f16_local3 = f16_arg0._maxActive < f16_arg0._numVisible
	if not f16_local3 then
		if f16_local2 ~= LUI.DIRECTION.vertical or f16_arg0._verticalAlignment ~= LUI.Alignment.Bottom then
			f16_local3 = false
		else
			f16_local3 = true
		end
	end
	if not f16_local3 then
		if f16_local2 ~= LUI.DIRECTION.horizontal or f16_arg0._horizontalAlignment ~= LUI.Alignment.Right then
			f16_local3 = false
		else
			f16_local3 = true
		end
	end
	if f16_local3 then
		f16_arg0:Tick()
	end
	f16_arg0:UpdateTrackerDataSources()
	local f16_local4
	if not f16_arg1 then
		f16_local4 = f16_arg1
	else
		f16_local4 = f16_arg0._TTL
	end
	if f16_local4 then
		local f16_local5 = f16_arg0:Wait( f16_local4 )
		local f16_local6 = f16_arg0._numData
		local f16_local7 = f16_arg0._resetCounter
		f16_local5.onComplete = function ()
			if f16_arg0 == f16_arg0._resetCounter then
				local f17_local0, f17_local1 = f16_arg0:GetGridLocation( f16_arg0 - 1 )
				local f17_local2 = f16_arg0:GetElementAtPosition( f17_local1, f17_local0 )
				if f17_local2 ~= nil then
					f17_local2:processEvent( {
						name = "feed_expiration"
					} )
				else
					f16_arg0:NotifyWhenPositionIsVisible( f17_local1, f17_local0 )
				end
				if f16_arg0._numScrolled < f16_arg0 and f16_arg0._tickOnExpiration then
					f16_arg0:Tick()
				end
				f16_arg0._numAlive = f16_arg0._numAlive - 1
				f16_arg0:UpdateTrackerDataSources()
			end
		end
		
	end
end

LUI.BaseUIFeed.Tick = function ( f15_arg0 )
	f15_arg0._numScrolled = f15_arg0._numScrolled + 1
	f15_arg0._numVisible = f15_arg0._numVisible - 1
	if f15_arg0:GetPrimaryAxis() == LUI.DIRECTION.vertical then
		local f15_local0 = f15_arg0._verticalAlignment
		local f15_local1 = LUI.Alignment.Bottom
		f15_local0 = REG8 and f15_arg0._numScrolled + f15_arg0._numVisible - 1 or f15_arg0._numScrolled
		f15_arg0:SetTargetRow( f15_local0 - 1, false, true )
		f15_arg0:SetTargetRow( f15_local0, false, false )
	else
		local f15_local0 = f15_arg0._horizontalAlignment
		local f15_local1 = LUI.Alignment.Right
		f15_local0 = REG11 and f15_arg0._numScrolled + f15_arg0._numVisible - 1 or f15_arg0._numScrolled
		f15_arg0:SetTargetColumn( f15_local0 - 1, false, true )
		f15_arg0:SetTargetColumn( f15_local0, false, false )
	end
end

LUI.BaseUIFeed.GetDataIndex = function ( f14_arg0, f14_arg1, f14_arg2 )
	if f14_arg0:GetPrimaryAxis() == LUI.DIRECTION.horizontal then
		return f14_arg1 + f14_arg2 * f14_arg0:GetMaxVisibleColumns()
	else
		return f14_arg2 + f14_arg1 * f14_arg0:GetMaxVisibleRows()
	end
end

LUI.BaseUIFeed.GetGridLocation = function ( f13_arg0, f13_arg1 )
	local f13_local0, f13_local1 = nil
	if f13_arg0:GetPrimaryAxis() == LUI.DIRECTION.horizontal then
		f13_local0 = math.floor( f13_arg1 / f13_arg0:GetMaxVisibleColumns() )
		f13_local1 = f13_arg1 % f13_arg0:GetMaxVisibleColumns()
	else
		f13_local1 = math.floor( f13_arg1 / f13_arg0:GetMaxVisibleRows() )
		f13_local0 = f13_arg1 % f13_arg0:GetMaxVisibleRows()
	end
	return f13_local0, f13_local1
end

LUI.BaseUIFeed.GainFocus = function ( f12_arg0, f12_arg1 )
	return false
end

LUI.BaseUIFeed.UpdateTrackerDataSources = function ( f11_arg0 )
	if f11_arg0._numAliveDataSource then
		DataModel.DBEBGEAJHJ( f11_arg0._numAliveDataSource:GetModel( f11_arg0._controllerIndex ), f11_arg0._numAlive )
	end
	if f11_arg0._numVisibleDataSource then
		DataModel.DBEBGEAJHJ( f11_arg0._numVisibleDataSource:GetModel( f11_arg0._controllerIndex ), f11_arg0._numVisible )
	end
end

LUI.BaseUIFeed.OnElementNotifyVisible = function ( f10_arg0, f10_arg1 )
	assert( f10_arg1 )
	assert( f10_arg1.child )
	f10_arg1.child:processEvent( {
		name = "feed_expiration"
	} )
end

LUI.UIFeed.init = function ( f8_arg0, f8_arg1 )
	assert( f8_arg1 )
	local f8_local0 = assert
	local f8_local1
	if f8_arg1.bufferPadding ~= nil and type( f8_arg1.bufferPadding ) ~= "number" then
		f8_local1 = false
	else
		f8_local1 = true
	end
	f8_local0( f8_local1 )
	f8_local0 = LUI.ShallowCopy( f8_arg1 )
	local f8_local2 = f8_local0.refreshChild
	f8_local0.refreshChild = function ( f9_arg0, f9_arg1, f9_arg2 )
		local f9_local0 = f8_arg0:GetDataAtIndex( f8_arg0:GetDataIndex( f9_arg1, f9_arg2 ) )
		assert( type( f9_local0 ) == "table" )
		f8_arg0( f9_arg0, f9_local0 )
	end
	
	LUI.UIFeed.super.init( f8_arg0, f8_local0 )
	f8_arg0._dataBufferLength = math.max( 2, f8_local0.bufferPadding or 2 ) + math.max( f8_local0.maxVisibleColumns, f8_local0.maxVisibleRows )
	f8_arg0._dataBuffer = {}
	f8_arg0._nextBufferWriteIndex = 1
end

LUI.UIFeed.PushData = function ( f7_arg0, f7_arg1 )
	assert( type( f7_arg1 ) == "table" )
	f7_arg0._dataBuffer[f7_arg0._nextBufferWriteIndex] = f7_arg1
	f7_arg0._nextBufferWriteIndex = 1 + f7_arg0._nextBufferWriteIndex % f7_arg0._dataBufferLength
	f7_arg0:OnNewData()
end

LUI.UIFeed.Reset = function ( f6_arg0 )
	f6_arg0._resetCounter = f6_arg0._resetCounter + 1
	f6_arg0._numData = 0
	f6_arg0._numScrolled = 0
	f6_arg0._numVisible = 0
	f6_arg0._numAlive = 0
	f6_arg0:SetNumChildren( 0 )
	f6_arg0._dataBuffer = {}
	f6_arg0._nextBufferWriteIndex = 1
	f6_arg0:RefreshContent()
end

LUI.UIFeed.GetDataAtIndex = function ( f5_arg0, f5_arg1 )
	return f5_arg0._dataBuffer[1 + f5_arg1 % f5_arg0._dataBufferLength]
end

LUI.UIDataSourceFeed.init = function ( f3_arg0, f3_arg1 )
	assert( f3_arg1 )
	assert( type( f3_arg1.dataSource ) == "table" )
	assert( f3_arg1.controllerIndex )
	f3_arg1.refreshChild = function ( f4_arg0, f4_arg1, f4_arg2 )
		f4_arg0:SetDataSource( f3_arg0._feedDataSource:GetDataSourceAtIndex( f3_arg0:GetDataIndex( f4_arg1, f4_arg2 ), f3_arg0._controllerIndex ), f3_arg0._controllerIndex )
	end
	
	f3_arg0._controllerIndex = f3_arg1.controllerIndex
	LUI.UIDataSourceFeed.super.init( f3_arg0, f3_arg1 )
	f3_arg0:SetFeedDataSource( f3_arg1.dataSource )
end

LUI.UIDataSourceFeed.SetFeedDataSource = function ( f1_arg0, f1_arg1 )
	assert( type( f1_arg1 ) == "table" )
	assert( type( f1_arg1.GetPushModel ) == "function" )
	assert( type( f1_arg1.GetTTLModel ) == "function" )
	assert( type( f1_arg1.GetDataSourceAtIndex ) == "function" )
	if f1_arg0._feedDataSource == f1_arg1 then
		
	else
		
	end
	f1_arg0._feedDataSource = f1_arg1
	if f1_arg0._pushSubscription then
		f1_arg0:UnsubscribeFromModel( f1_arg0._pushSubscription )
		f1_arg0._pushSubscription = nil
	end
	f1_arg0._pushSubscription = f1_arg0:SubscribeToModel( f1_arg0._feedDataSource:GetPushModel( f1_arg0._controllerIndex ), function ( f2_arg0 )
		if DataModel.JJEHAEBDF( f2_arg0 ) == true then
			local f2_local0 = f1_arg0._feedDataSource:GetTTLModel( f1_arg0._controllerIndex )
			local f2_local1
			if f2_local0 then
				f2_local1 = DataModel.JJEHAEBDF( f2_local0 )
				if not f2_local1 then
				
				else
					f1_arg0:OnNewData( f2_local1 )
				end
			end
			f2_local1 = nil
		end
	end )
end

