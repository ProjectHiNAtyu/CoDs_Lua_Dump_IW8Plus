-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.aar.aarunlockdescription" )
local f0_local0 = 2
local f0_local1 = 400
local f0_local2 = 350
local f0_local3 = 434
local f0_local4 = 250
local f0_local5 = function ( f13_arg0 )
	if f13_arg0.ContentRows[f13_arg0.focusRow]:FocusLeft() then
		f13_arg0:RepositionRows( false, f0_local0 )
	end
	f13_arg0.DontAcceptInput = true
end

local f0_local6 = function ( f12_arg0 )
	if f12_arg0.ContentRows[f12_arg0.focusRow]:FocusRight() then
		f12_arg0:RepositionRows( false, f0_local0 )
	end
	f12_arg0.DontAcceptInput = true
end

local f0_local7 = function ( f11_arg0 )
	if 1 < f11_arg0.focusRow then
		local f11_local0 = f11_arg0.ContentRows[f11_arg0.focusRow]:GetRowFocusIndex() - f11_arg0.ContentRows[f11_arg0.focusRow]:GetLeftReward()
		f11_arg0.ContentRows[f11_arg0.focusRow]:Unfocus()
		f11_arg0.focusRow = f11_arg0.focusRow - 1
		f11_arg0.ContentRows[f11_arg0.focusRow]:Focus( f11_local0 )
		f11_arg0:RepositionRows( true, f0_local0 )
	end
	f11_arg0.DontAcceptInput = true
end

local f0_local8 = function ( f10_arg0 )
	if f10_arg0.focusRow < f10_arg0._rowCount then
		local f10_local0 = f10_arg0.ContentRows[f10_arg0.focusRow]:GetRowFocusIndex() - f10_arg0.ContentRows[f10_arg0.focusRow]:GetLeftReward()
		f10_arg0.ContentRows[f10_arg0.focusRow]:Unfocus()
		f10_arg0.focusRow = f10_arg0.focusRow + 1
		f10_arg0.ContentRows[f10_arg0.focusRow]:Focus( f10_local0 )
		f10_arg0:RepositionRows( true, f0_local0 )
	end
	f10_arg0.DontAcceptInput = true
end

local f0_local9 = function ( f9_arg0, f9_arg1, f9_arg2 )
	if not f9_arg1 then
		local f9_local0 = f9_arg0.ContentRows[f9_arg0.focusRow]
		local f9_local1 = f9_arg0.focusRow
		local f9_local2 = f9_local0:GetLeftReward() - 2
		f9_local0:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * -((f9_local2 + 1) * f0_local0), _1080p * -(f9_local2 * f0_local0), _1080p * f0_local0, _1080p * (f0_local0 + f0_local0), f9_arg2 )
		return 
	end
	for f9_local0 = 1, f9_arg0._rowCount, 1 do
		local f9_local3 = f9_arg0.ContentRows[f9_local0]
		local f9_local4 = f9_arg0.focusRow
		local f9_local5 = f9_local3:GetLeftReward() - 2
		f9_local3:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * -((f9_local5 + 1) * f0_local0), _1080p * -(f9_local5 * f0_local0), _1080p * ((f9_local0 - f9_local4) * f0_local0 + f0_local0), _1080p * ((f9_local0 - f9_local4 + 1) * f0_local0 + f0_local0), f9_arg2 )
	end
end

local f0_local10 = function ( f8_arg0, f8_arg1, f8_arg2 )
	local f8_local0 = #f8_arg1
	for f8_local1 = 1, f8_local0, 1 do
		local f8_local4 = {}
		f8_arg0._rowCount = f8_arg0._rowCount + 1
		local f8_local5 = {
			weaponRef = f8_arg1[f8_local1].weaponRef,
			startXP = f8_arg1[f8_local1].startXP,
			currentXP = f8_arg1[f8_local1].currentXP
		}
		local f8_local6 = PROGRESSION.GetMaxWeaponLevel( f8_local5.weaponRef )
		local f8_local7 = 0
		if PROGRESSION.GetWeaponLevelMinXP( f8_arg2, f8_local5.weaponRef, 1 ) < f8_local5.startXP then
			
		else
			
		end
		f8_local5.startLevel = LUI.clamp( f8_local7, 0, f8_local6 )
		f8_local7 = 0
		if PROGRESSION.GetWeaponLevelMinXP( f8_arg2, f8_local5.weaponRef, 1 ) < f8_local5.currentXP then
			
		else
			
		end
		f8_local5.currentLevel = LUI.clamp( f8_local7, 0, f8_local6 )
		if f8_local5.startLevel ~= f8_local5.currentLevel then
			local f8_local8 = 0
			for f8_local9 = f8_local5.startLevel + 1, f8_local5.currentLevel, 1 do
				f8_local8 = f8_local8 + 1
				local f8_local12 = PROGRESSION.GetRewardUnlockedAtWeaponLevel( f8_local5.weaponRef, f8_local9 )
				f8_local4[f8_local8] = {}
				for f8_local13 = 1, #f8_local12, 1 do
					f8_local4[f8_local8][f8_local13] = AAR.GetUnlockData( f8_arg2, f8_local12[f8_local13] )
				end
				f8_local4[f8_local8].rowItemTitle = Engine[0xED84C33EC5F01EA]( 0xAE32986DB481228, tostring( f8_local9 + 1 ) )
			end
			if 0 < f8_local8 then
				f8_local4.ranksEarned = f8_local8
				local f8_local9 = LUI.clamp( f8_local6 - f8_local5.currentLevel, 0, f0_local0 )
				for f8_local10 = 1, f8_local9, 1 do
					f8_local8 = f8_local8 + 1
					local f8_local13 = PROGRESSION.GetRewardUnlockedAtWeaponLevel( f8_local5.weaponRef, f8_local5.currentLevel + f8_local10 )
					f8_local4[f8_local8] = {}
					for f8_local14 = 1, #f8_local13, 1 do
						f8_local4[f8_local8][f8_local14] = AAR.GetUnlockData( f8_arg2, f8_local13[f8_local14] )
					end
					f8_local4[f8_local8].unlockRequirements = Engine[0xED84C33EC5F01EA]( 0x2A6AE585105DC35, tostring( f8_local5.currentLevel + f8_local10 + 1 ) )
					f8_local4[f8_local8].rowItemTitle = Engine[0xED84C33EC5F01EA]( 0xAE32986DB481228, tostring( f8_local5.currentLevel + f8_local10 + 1 ) )
				end
				local f8_local10 = MenuBuilder.BuildRegisteredType( "AARUnlockRow", {
					controllerIndex = f8_arg2,
					title = WEAPON.GetName( f8_local5.weaponRef ),
					rankData = f8_local4
				} )
				f8_local10:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, _1080p * ((f8_arg0._rowCount - 1) * f0_local0 + f0_local0), _1080p * (f8_arg0._rowCount * f0_local0 + f0_local0) )
				f8_local10:SetMask( f8_arg0.Mask )
				f8_arg0:addElement( f8_local10 )
				f8_local10.rowNumber = f8_arg0._rowCount
				f8_arg0.ContentRows[f8_arg0._rowCount] = f8_local10
			end
			f8_arg0._rowCount = f8_arg0._rowCount - 1
		end
	end
end

local f0_local11 = function ( f7_arg0, f7_arg1, f7_arg2 )
	local f7_local0 = f7_arg1.curRank
	f7_arg0._rowCount = f7_arg0._rowCount + 1
	local f7_local1 = 0
	local f7_local2 = {}
	for f7_local3 = f7_arg1.preRank + 1, f7_arg1.curRank, 1 do
		f7_local1 = f7_local1 + 1
		f7_local2[f7_local1] = AAR.GetRankupUnlockPackage( f7_arg2, f7_local3 )
		f7_local2[f7_local1].rowItemTitle = Engine[0xED84C33EC5F01EA]( 0x9D70A6AEE96B2E6, tostring( f7_local3 + 1 ) )
	end
	f7_local2.ranksEarned = f7_local1
	local f7_local3 = LUI.clamp( PROGRESSION.GetMaxRank() - f7_local0, 0, f0_local0 )
	for f7_local4 = 1, f7_local3, 1 do
		f7_local1 = f7_local1 + 1
		f7_local2[f7_local1] = AAR.GetRankupUnlockPackage( f7_arg2, f7_local0 + f7_local4 )
		f7_local2[f7_local1].rowItemTitle = Engine[0xED84C33EC5F01EA]( 0x9D70A6AEE96B2E6, tostring( f7_local0 + f7_local4 + 1 ) )
		f7_local2[f7_local1].unlockRequirements = Engine[0xED84C33EC5F01EA]( 0x2A6AE585105DC35, tostring( f7_local0 + f7_local4 + 1 ) )
	end
	local f7_local4 = MenuBuilder.BuildRegisteredType( "AARUnlockRow", {
		title = 0x75450862EB592EC,
		controllerIndex = f7_arg2,
		rankData = f7_local2
	} )
	f7_local4:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, _1080p * ((f7_arg0._rowCount - 1) * f0_local0 + f0_local0), _1080p * (f7_arg0._rowCount * f0_local0 + f0_local0) )
	f7_local4:SetMask( f7_arg0.Mask )
	f7_arg0:addElement( f7_local4 )
	f7_local4.rowNumber = f7_arg0._rowCount
	f7_arg0.ContentRows[f7_arg0._rowCount] = f7_local4
end

local f0_local12 = function ( f6_arg0, f6_arg1, f6_arg2 )
	local f6_local0 = f6_arg1.challenges
	f6_arg0._rowCount = f6_arg0._rowCount + 1
	local f6_local1 = {}
	local f6_local2 = #f6_local0
	local f6_local3 = 0
	for f6_local4 = 1, f6_local2, 1 do
		if f6_local0[f6_local4].type ~= PROGRESSION.GetPlayerProgressionChallengeKind() then
			local f6_local7 = Challenge.GetDesc( f6_local0[f6_local4].ID, f6_local0[f6_local4].type )
			local f6_local8 = Challenge.GetName( f6_local0[f6_local4].ID, f6_local0[f6_local4].type )
			local f6_local9 = Challenge.GetLootID( f6_local0[f6_local4].ID, f6_local0[f6_local4].type, f6_arg2 )
			local f6_local10 = ""
			local f6_local11 = ""
			local f6_local12 = nil
			if f6_local9 ~= "" then
				local f6_local13 = LOOT.GetItemImage( LOOT.GetTypeForID( f6_local9 ), LOOT.GetItemRef( f6_local9 ), f6_local9 )
			end
			f6_local1[f6_local4] = {
				{
					lootTypeName = nil,
					name = f6_local8,
					desc = f6_local7,
					icon = f6_local12
				},
				rowItemTitle = Engine[0xED84C33EC5F01EA]( 0x5332A9FFF97A8D7 )
			}
			f6_local3 = f6_local3 + 1
		end
	end
	f6_local1.ranksEarned = f6_local2
	local f6_local4 = MenuBuilder.BuildRegisteredType( "AARUnlockRow", {
		controllerIndex = f6_arg2,
		rankData = f6_local1
	} )
	f6_local4:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, _1080p * ((f6_arg0._rowCount - 1) * f0_local0 + f0_local0), _1080p * (f6_arg0._rowCount * f0_local0 + f0_local0) )
	f6_local4:SetMask( f6_arg0.Mask )
	f6_arg0:addElement( f6_local4 )
	f6_local4.rowNumber = f6_arg0._rowCount
	f6_arg0.ContentRows[f6_arg0._rowCount] = f6_local4
end

function PostLoadFunc( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.FocusLeft = f0_local0
	f2_arg0.FocusRight = f0_local0
	f2_arg0.RepositionRows = f0_local0
	f2_arg0.ScrollDown = f0_local0
	f2_arg0.ScrollUp = f0_local0
	f2_arg0.BuildWeaponRows = f0_local0
	f2_arg0.BuildProgressionRankRow = f0_local0
	f2_arg0.BuildChallengeProgressionRow = f0_local0
	f2_arg0.handleMouseMove = true
	f2_arg0.handleMouseButton = true
	local f2_local0 = f2_arg2.matchDataPackage
	local f2_local1 = f2_local0.preRank ~= f2_local0.curRank
	if f2_local0.challenges then
		local f2_local2 = 0 < #f2_local0.challenges
	end
	local f2_local3 = f2_local0.weaponDataPackage
	if f2_local3 then
		f2_local3 = #f2_local0.weaponDataPackage
	end
	f2_arg0._rowCount = 0
	f2_arg0.ContentRows = {}
	if f2_local1 then
		f2_arg0:BuildProgressionRankRow( f2_local0, f2_arg1 )
	end
	if f2_local3 then
		f2_arg0:BuildWeaponRows( f2_local0.weaponDataPackage, f2_arg1 )
	end
	if 0 < #f2_arg0.ContentRows then
		f2_arg0.focusRow = 1
		f2_arg0.AARUnlockDescription:SetupDescription( f2_arg0.ContentRows[f2_arg0.focusRow]:GetRowFocusData() )
		f2_arg0.ContentRows[f2_arg0.focusRow]:Focus( 0 )
	end
	f2_arg0:registerEventHandler( "AAR_UNLOCKS_ROW_ITEM", function ( element, event )
		if element.MousePrevention then
			return true
		end
		element.AARUnlockDescription:SetupDescription( event.element:GetRowItemData() )
		local f5_local0 = false
		local f5_local1 = false
		if event.parent.rowNumber ~= element.focusRow then
			element.focusRow = event.parent.rowNumber
			f5_local0 = true
			f5_local1 = true
		end
		if event.element.itemNumber ~= event.parent:GetRowFocusIndex() then
			event.parent:FocusSpecificIndex( event.element.itemNumber )
			f5_local0 = true
		end
		if f5_local0 then
			element:RepositionRows( f5_local1, f2_arg0 )
		end
	end )
	f2_arg0:addEventHandler( "gamepad_button", function ( f3_arg0, f3_arg1 )
		if f3_arg0.DontAcceptInput or not f3_arg1.down then
			
		end
		if f3_arg1.qualifier == "gamepad" then
			if f3_arg1.button == "right" or f3_arg1.button == "rs_right" then
				f3_arg0:FocusRight()
			elseif f3_arg1.button == "left" or f3_arg1.button == "rs_left" then
				f3_arg0:FocusLeft()
			elseif f3_arg1.button == "up" or f3_arg1.button == "rs_up" then
				f3_arg0:ScrollUp()
			elseif f3_arg1.button == "down" or f3_arg1.button == "rs_down" then
				f3_arg0:ScrollDown()
			end
		elseif f3_arg1.qualifier == "dpad" then
			if f3_arg1.button == "right" then
				f3_arg0:FocusRight()
			elseif f3_arg1.button == "left" then
				f3_arg0:FocusLeft()
			elseif f3_arg1.button == "up" then
				f3_arg0:ScrollUp()
			elseif f3_arg1.button == "down" then
				f3_arg0:ScrollDown()
			end
		elseif f3_arg1.qualifier == "keyboard" then
			if f3_arg1.button == "left" then
				f3_arg0:FocusLeft()
			elseif f3_arg1.button == "right" then
				f3_arg0:FocusRight()
			elseif f3_arg1.button == "up" then
				f3_arg0:ScrollUp()
			elseif f3_arg1.button == "down" then
				f3_arg0:ScrollDown()
			end
		elseif f3_arg1.qualifier == "mousewheel" then
			if f3_arg1.button == "up" then
				f3_arg0:ScrollUp()
			elseif f3_arg1.button == "down" then
				f3_arg0:ScrollDown()
			end
		end
		if f3_arg0.DontAcceptInput == true then
			local f3_local0 = f3_arg0:Wait( 250 )
			f3_local0.onComplete = function ()
				f3_arg0.DontAcceptInput = false
			end
			
		end
	end )
end

function AARUnlocks( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 920 * _1080p )
	self.id = "AARUnlocks"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	self:setUseStencil( true )
	local AARUnlockDescription = nil
	
	AARUnlockDescription = MenuBuilder.BuildRegisteredType( "AARUnlockDescription", {
		controllerIndex = f1_local1
	} )
	AARUnlockDescription.id = "AARUnlockDescription"
	AARUnlockDescription:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, _1080p * 25, _1080p * 435 )
	self:addElement( AARUnlockDescription )
	self.AARUnlockDescription = AARUnlockDescription
	
	local Mask = nil
	
	Mask = LUI.UIImage.new()
	Mask.id = "Mask"
	Mask:setImage( RegisterMaterial( 0xBD4EDDE06081392 ), 0 )
	Mask:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, _1080p * 400, _1080p * 1060 )
	self:addElement( Mask )
	self.Mask = Mask
	
	PostLoadFunc( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "AARUnlocks", AARUnlocks )
LockTable( _M )
