-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:02
module( ..., package.seeall )
local f0_local0 = "<unknown>"
MenuBuilder.registerType( "LeaderboardFilterPopup", function ( f32_arg0, f32_arg1 )
	local f32_local0 = MenuBuilder.BuildRegisteredType( "LeaderboardFilterFlyout", f32_arg1 )
	f32_local0.id = "LeaderboardFilterPopup"
	return f32_local0
end )
MenuBuilder.registerType( "LeaderboardGamemodeSelectPopup", function ( f31_arg0, f31_arg1 )
	local f31_local0 = MenuBuilder.BuildRegisteredType( "LeaderboardGamemodeSelectFlyout", f31_arg1 )
	f31_local0.id = "LeaderboardGamemodeSelectFlyout"
	return f31_local0
end )
local f0_local1 = function ( f30_arg0, f30_arg1 )
	f30_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( Leaderboards.GetLeaderboardTitle( f30_arg1 ) ) )
end

local f0_local2 = function ( f29_arg0, f29_arg1, f29_arg2 )
	f29_arg0.Filter:setText( Engine[0xED84C33EC5F01EA]( 0x8FB188C0D20C95, f29_arg1.Title, f29_arg2.Title ) )
end

local f0_local3 = function ( f28_arg0 )
	if not f28_arg0._populatedPlayerRow then
		f28_arg0.PlayerRow:SetAlpha( 0 )
		return 
	end
	local f28_local0, f28_local1 = f28_arg0.LeaderboardContent:GetRowBoundaries()
	if not f28_local0 or not f28_local1 then
		f28_local0 = 1
		f28_local1 = f28_arg0.LeaderboardContent:GetMaxVisibleRows()
	end
	f28_local0 = math.floor( f28_local0 )
	f28_local1 = math.ceil( f28_local1 )
	local f28_local2 = false
	if f28_arg0.PlayerRow and f28_arg0.PlayerRow._data then
		local f28_local3 = Leaderboards[0x5BFCE0E5086A07E]()
		if f28_local3 then
			if f28_local0 >= f28_local3 or f28_local3 > f28_local1 then
				f28_local2 = false
			else
				f28_local2 = true
			end
		end
	end
	local f28_local3 = f28_arg0.PlayerRow
	local f28_local4 = f28_local3
	f28_local3 = f28_local3.SetAlpha
	local f28_local5
	if f28_local2 then
		f28_local5 = 0
	else
		f28_local5 = 1
	end
	f28_local3( f28_local4, f28_local5 )
end

local f0_local4 = function ( f27_arg0, f27_arg1, f27_arg2, f27_arg3 )
	local f27_local0
	if f27_arg0._leaderboard == leaderboard and f27_arg0._filter == f27_arg1 and f27_arg0._platformFilter == f27_arg2 and f27_arg0._isHardcore == f27_arg3 then
		f27_local0 = false
	else
		f27_local0 = true
	end
	return f27_local0
end

local f0_local5 = function ( f26_arg0, f26_arg1, f26_arg2, f26_arg3, f26_arg4, f26_arg5 )
	if not f0_local0( f26_arg0, f26_arg3, f26_arg4, f26_arg5 ) then
		return 
	end
	f26_arg0._leaderboard = f26_arg2
	f26_arg0._filter = f26_arg3
	f26_arg0._platformFilter = f26_arg4
	f26_arg0._isHardcore = f26_arg5
	f26_arg0._autoScrolledToPlayer = false
	f26_arg0._populatedPlayerRow = false
	Leaderboards.SetSelectedFilters( f26_arg1, {
		[Leaderboards.FilterCategory.Player] = f26_arg0._filter,
		[Leaderboards.FilterCategory.Platform] = f26_arg0._platformFilter
	} )
	local f26_local0 = f26_arg0.HardcoreText
	local f26_local1 = f26_local0
	f26_local0 = f26_local0.SetAlpha
	local f26_local2
	if f26_arg5 then
		f26_local2 = 1
	else
		f26_local2 = 0
	end
	f26_local0( f26_local1, f26_local2 )
	f26_local0 = f26_arg0.LeaderboardContent:GetMaxVisibleRows()
	Leaderboards[0x531F89544A910A2]()
	Leaderboards.OpenLeaderboard( f26_arg0._leaderboard, f26_arg0._isHardcore )
	Leaderboards[0xF00B829466B6C0C]( f26_arg1, f26_arg0._filter.Value, 0, f26_local0, f26_arg0._platformFilter.Value ~= Leaderboards.PlatformFilters.None.Value )
	f26_arg0._isInitialFetch = true
	f0_local0( f26_arg0, f26_arg0._leaderboard )
	f0_local0( f26_arg0, f26_arg0._filter, f26_arg0._platformFilter )
	f26_arg0.HeaderRow:CreateExtraColumns( f26_arg1, f26_arg2 )
	f26_arg0.PlayerRow:Populate( f26_arg1, f26_arg0._leaderboard, {
		rowIndex = Leaderboards[0x5BFCE0E5086A07E]()
	} )
end

local f0_local6 = function ( f25_arg0, f25_arg1 )
	local f25_local0 = Leaderboards[0x4DC337F02F7FD58]()
	f25_arg0.numRows = f25_local0
	if not f25_local0 or f25_local0 == 0 then
		f25_arg0.LeaderboardContent:SetNumRows( 0 )
		f25_arg0.LeaderboardContent:SetAlpha( 0 )
		f25_arg0.PlayerRow:SetAlpha( 0 )
		return 
	end
	f25_arg0.LeaderboardContent:SetAlpha( 1 )
	if f25_local0 ~= f25_arg0.LeaderboardContent:GetNumRows() then
		f25_arg0.LeaderboardContent:SetNumRows( f25_local0 )
		f25_arg0.LeaderboardContent:processEvent( {
			name = "gain_focus",
			controller = f25_arg1
		} )
	end
	f25_arg0.LeaderboardContent:RefreshContent()
	f25_arg0._shouldTriggerDownload = true
	if not f25_arg0._autoScrolledToPlayer then
		local f25_local1 = Leaderboards[0x5BFCE0E5086A07E]()
		if f25_local1 then
			f25_arg0._autoScrolledToPlayer = true
			f25_arg0.LeaderboardContent:SetFocusedPosition( {
				x = 0,
				y = f25_local1
			}, true, true )
		end
	end
	if not f25_arg0._populatedPlayerRow then
		local f25_local1 = Leaderboards[0x4628AFEB6D64A9A]( f25_arg1 )
		if f25_local1 then
			f25_local1.Gamertag = Engine[0x5A049446C78B2A4]( f25_arg1 )
			local f25_local2 = f25_local1.Rank
			if f25_local2 then
				f25_local2 = 0 < #f25_local1.Rank
			end
			f25_arg0._populatedPlayerRow = f25_local2
			f25_local1.rowIndex = Leaderboards[0x5BFCE0E5086A07E]()
			f25_arg0.PlayerRow:Populate( f25_arg1, f25_arg0._leaderboard, f25_local1 )
		end
	end
	f0_local0( f25_arg0 )
end

local f0_local7 = function ( f24_arg0 )
	f24_arg0.LeaderboardContent:FocusFirstItem()
end

local f0_local8 = function ( f23_arg0, f23_arg1 )
	if Leaderboards[0x4DC337F02F7FD58]() <= 0 then
		return 
	elseif f23_arg0._pendingUpdate then
		return 
	end
	local f23_local0 = f23_arg0.LeaderboardContent:GetRowBoundaries()
	if f23_local0 then
		local f23_local1 = f23_local0 + f23_arg1
		if f23_arg0.LeaderboardContent:IsPositionFocusable( {
			x = 0,
			y = f23_local1
		} ) then
			f23_arg0.LeaderboardContent:SetTargetRow( f23_local1, true, true )
			f23_arg0.LeaderboardContent:SetFocusedPosition( {
				x = 0,
				y = f23_local1
			}, true, false )
		end
	end
end

local f0_local9 = function ( f22_arg0 )
	f0_local0( f22_arg0, f22_arg0.LeaderboardContent:GetMaxVisibleRows() )
end

local f0_local10 = function ( f21_arg0 )
	f0_local0( f21_arg0, -f21_arg0.LeaderboardContent:GetMaxVisibleRows() )
end

local f0_local11 = function ( f18_arg0, f18_arg1 )
	if not f18_arg0.playercardDownloadWait then
		f18_arg0.playercardDownloadWait = f18_arg0:Wait( 1000, true )
		f18_arg0.playercardDownloadWait.onComplete = function ()
			Leaderboards[0x21EB1B9CDE4F86C]( f18_arg0._controllerIndex )
			f18_arg0.playercardDownloadWait = nil
		end
		
	end
	f18_arg0.LeaderboardPlayerCard:SetAlpha( 0 )
	local f18_local0 = nil
	local f18_local1 = function ()
		local f19_local0 = f18_arg0:GetPlayerCardData()
		if f19_local0 and f19_local0.gamerTag ~= f18_arg0 then
			f18_arg0.LeaderboardPlayerCard:SetData( f19_local0 )
			f18_arg0.LeaderboardPlayerCard:SetAlpha( 1 )
		else
			local f19_local1 = f18_arg0.LeaderboardPlayerCard:Wait( 200, true )
			f19_local1.onComplete = f18_arg0
		end
	end
	
	f18_local1()
end

local f0_local12 = function ( f3_arg0, f3_arg1, f3_arg2 )
	assert( f3_arg0.PlayerRow )
	assert( f3_arg0.bindButton )
	if not CONDITIONS.IsMobileOrMobileSim() then
		assert( f3_arg0.ButtonHelperBar )
	end
	f3_arg0._controllerIndex = f3_arg1
	f3_arg0._pageSize = 60
	f3_arg0._maxNumberOfEntries = 10000
	f3_arg0._oldFrom = 0
	f3_arg0._oldTo = 0
	f3_arg0._isInitialFetch = true
	local f3_local0 = Leaderboards.Filters.Friends
	local f3_local1 = Leaderboards.PlatformFilters.None
	local f3_local2 = Leaderboards.GetSelectedFilters( f3_arg1 )
	if f3_local2 then
		local f3_local3 = f3_local2[Leaderboards.FilterCategory.Player]
		if not f3_local3 then
			f3_local0 = f3_local3
		else
			
		end
		f3_local3 = f3_local2[Leaderboards.FilterCategory.Platform]
		if not f3_local3 then
			f3_local1 = f3_local3
		else
			
		end
	end
	f0_local0( f3_arg0, f3_arg1, f3_arg2.leaderboardType or "Score", f3_local0, f3_local1, f3_arg2.isHardcore or false )
	f3_arg0._canSwitchLeaderboard = f3_arg2.canSwitchLeaderboard
	f3_arg0._boardsToUse = f3_arg2.boardsToUse
	if f3_arg0._canSwitchLeaderboard and not CONDITIONS.IsMobileOrMobileSim() then
		f3_arg0:AddButtonHelperTextToElement( f3_arg0.ButtonHelperBar, {
			side = "left",
			button_ref = "button_alt2",
			priority = 1,
			helper_text = Engine[0xED84C33EC5F01EA]( 0xF6BEA63D0E3A04F )
		} )
	end
	f3_arg0.LeaderboardContent:SetSnapOnWrapEnabled( true )
	f3_arg0.LeaderboardContent:SetNumColumns( 1 )
	f3_arg0.LeaderboardContent:SetNumRows( 1 )
	f3_arg0.LeaderboardContent.PositionChanged = function ( f17_arg0 )
		LUI.UIGrid.PositionChanged( f17_arg0 )
		local f17_local0, f17_local1 = f17_arg0:GetRowBoundaries()
		if not f17_local0 or not f17_local1 then
			f17_local0 = 0
			f17_local1 = f3_arg0.LeaderboardContent:GetMaxVisibleRows()
		end
		f3_arg0._pendingUpdate = not Leaderboards[0xF00B829466B6C0C]( f3_arg0, f3_arg0._filter.Value, math.floor( f17_local0 ), math.floor( f17_local1 ) - 1, f3_arg0._platformFilter.Value ~= Leaderboards.PlatformFilters.None.Value )
		f3_arg0( f3_arg0 )
	end
	
	f3_arg0:addElement( LUI.UITimer.new( {
		interval = 50,
		event = "refresh_leaderboard"
	} ) )
	f3_arg0:registerEventHandler( "refresh_leaderboard", function ( element, event )
		if element._pendingUpdate then
			element.LeaderboardContent:PositionChanged()
		end
	end )
	f3_arg0.LeaderboardContent:SetRefreshChild( function ( f15_arg0, f15_arg1, f15_arg2 )
		assert( f15_arg0.Row )
		if not f3_arg0.numRows or f3_arg0.numRows == 0 then
			f3_arg0.LeaderboardContent:SetAlpha( 0 )
			f3_arg0.LeaderboardContent:SetNumRows( 0 )
			return 
		else
			f3_arg0.LeaderboardContent:SetAlpha( 1 )
			local f15_local0 = Leaderboards[0xC750D492E46E105]( f3_arg0, f15_arg2 )
			f15_local0.rowIndex = f15_arg2
			f15_arg0.Row:Populate( f3_arg0, f3_arg0._leaderboard, f15_local0 )
		end
	end )
	f3_arg0:registerEventHandler( "leaderboard_fetch_complete", function ( element, event )
		f3_arg0( element, f3_arg0 )
	end )
	f3_arg0.bindButton:addEventHandler( "button_shoulderl", function ( f13_arg0, f13_arg1 )
		f3_arg0( f3_arg0 )
	end )
	f3_arg0.bindButton:addEventHandler( "button_alt1", function ( f11_arg0, f11_arg1 )
		local f11_local0 = f11_arg1.controller or f3_arg0
		local f11_local1 = {
			controllerIndex = f11_local0,
			filter = f3_arg0._filter,
			platformFilter = f3_arg0._platformFilter,
			playlistFilter = f3_arg0._isHardcore,
			showPlaylistFilter = Leaderboards.GetLeaderboardHasHardcoreMode( f3_arg0._leaderboard ),
			setFilterOptions = function ( f12_arg0, f12_arg1, f12_arg2 )
				f11_arg0( f11_arg0, f11_arg0, f11_arg0._leaderboard, f12_arg0, f12_arg1, f12_arg2 )
			end
		}
		LUI.FlowManager.RequestPopupMenu( nil, "FlyInPopup", true, f11_local0, false, {
			widget = MenuBuilder.BuildRegisteredType( "LeaderboardFilterPopup", f11_local1 ),
			backButtonOverride = f11_local1.backButtonOverride,
			closePopupOverride = f11_local1.backButtonOverride
		} )
	end )
	if f3_arg0.ButtonHelperBar then
		f3_arg0:AddButtonHelperTextToElement( f3_arg0.ButtonHelperBar, {
			kbm_only = true,
			priority = 3,
			side = "left",
			button_ref = "button_alt1",
			helper_text = Engine[0xED84C33EC5F01EA]( 0x194FE86EC9AD893 )
		} )
	end
	f3_arg0.bindButton:addEventHandler( "button_alt2", function ( f9_arg0, f9_arg1 )
		local f9_local0 = f3_arg0._canSwitchLeaderboard or false
		f9_local0 = f9_arg1.controller or f3_arg0
		LUI.FlowManager.RequestPopupMenu( nil, "FlyInPopup", true, f9_local0, false, {
			widget = MenuBuilder.BuildRegisteredType( "LeaderboardGamemodeSelectPopup", {
				controllerIndex = f9_local0,
				leaderboard = f3_arg0._leaderboard,
				isHardcore = f3_arg0._isHardcore,
				boardsToUse = f3_arg0._boardsToUse,
				changeLeaderboard = function ( f10_arg0 )
					f9_arg0( f9_arg0, f9_arg0, f10_arg0, f9_arg0._filter, f9_arg0._platformFilter, f9_arg0._isHardcore )
				end
				
			} )
		} )
	end )
	f3_arg0.bindButton:addEventHandler( "button_left_trigger", function ( f8_arg0, f8_arg1 )
		f3_arg0( f3_arg0 )
	end )
	f3_arg0.bindButton:addEventHandler( "button_right_trigger", function ( f7_arg0, f7_arg1 )
		local f7_local0 = f7_arg1.controller or f3_arg0
		f3_arg0( f3_arg0 )
	end )
	f3_arg0:addEventHandler( "gamepad_button", function ( f6_arg0, f6_arg1 )
		if not f6_arg1.down then
			return 
		else
			local f6_local0 = f6_arg1.button == "page_up"
			local f6_local1 = f6_arg1.button == "page_down"
			if f6_local0 then
				return f3_arg0( f3_arg0 )
			elseif f6_local1 then
				return f3_arg0( f3_arg0 )
			elseif f6_arg1.button == "home" then
				f3_arg0( f3_arg0 )
				return true
			else
				return false
			end
		end
	end )
	local f3_local4 = f3_arg0.Filter
	f3_local4:SetShadowUOffset( -0.001 )
	f3_local4:SetShadowVOffset( -0.001 )
	if Engine[0xD151EC5B41223B5]() then
		local self = LUI.UIElement.new( {
			worldBlur = 5
		} )
		self:setupWorldBlur()
		self.id = "blur"
		f3_arg0:addElement( self )
	end
	f3_arg0:addEventHandler( "leaderboard_row_on_button_over", function ( f5_arg0, f5_arg1 )
		f3_arg0( f5_arg0, f5_arg1.row )
		return true
	end )
	FRIENDS.RegisterPlatformIdForViewProfileEventOnMenu( f3_arg0, f3_arg1 )
	f3_arg0:addAndCallEventHandler( "update_input_type", function ( f4_arg0, f4_arg1 )
		if LUI.IsLastInputKeyboardMouse( f4_arg0._controllerIndex ) then
			ACTIONS.AnimateSequence( f4_arg0, "KBM" )
		else
			ACTIONS.AnimateSequence( f4_arg0, "Gamepad" )
		end
	end )
	ACTIONS.ScaleFullscreen( f3_arg0.Darken )
	if f3_arg0.TabBacker then
		ACTIONS.ScaleStretchAnchorFullscreen( f3_arg0.TabBacker )
	end
	f3_arg0.LeaderboardContent:SetScrollbarKBMStyle( false )
end

local f0_local13 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function LeaderboardMenuBase( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "LeaderboardMenuBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "LeaderboardMenuBase", LeaderboardMenuBase )
LockTable( _M )
