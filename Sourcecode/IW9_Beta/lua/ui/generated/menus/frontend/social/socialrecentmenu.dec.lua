-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:01
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.social.socialmenulayout" )
require( "ui.generated.widgets.frontend.social.socialmenulayoutnew" )
local f0_local0 = function ( f7_arg0 )
	if not CONDITIONS.IsNewSocialScreenEnabled() then
		return f7_arg0.MenuLayout.PlayersGrid
	else
		return f7_arg0.SocialMenuLayoutNew.PlayersGrid
	end
end

local f0_local1 = function ( f6_arg0 )
	local f6_local0 = LUI.FlowManager.GetScopedData( f6_arg0 )
	f6_arg0.SocialMenuLayoutNew:UpdateFilteringLabel( Engine[0xED84C33EC5F01EA]( 0x9ADAC0AA6B81B29, FRIENDS.RecentPlayersSortingStrings[f6_local0.activeSorting] ) )
end

local f0_local2 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.GetPlayerGrid = f0_local0
	f2_arg0.UpdateSortingLabel = f0_local0
	local f2_local0 = f2_arg0.MenuLayout
	if CONDITIONS.IsNewSocialScreenEnabled() then
		f2_local0 = f2_arg0.SocialMenuLayoutNew
	end
	f2_local0:UpdateNoFriends( 0 )
	f2_local0:SetPlayerGridWrapping( nil, false )
	if CONDITIONS.IsNewSocialScreenEnabled() then
		local f2_local1 = MenuBuilder.BuildRegisteredType( "SocialRecentActionButtons", {
			controllerIndex = f2_arg1
		} )
		f2_local1.id = "SocialRecentActionButtons"
		SOCIAL.SetupSocialMenuLayout( f2_local0, f2_arg1, "USERLISTS", 0x5494CCBD50E97EB, 0x6955973075E6791, 0x8633B95DBD4CBF7, f2_local1, FRIENDS.TabIDs.RECENT_PLAYERS, true )
		if not f2_arg0.bindButton then
			local self = LUI.UIBindButton.new()
			self.id = "selfBindButton"
			f2_arg0:addElement( self )
			f2_arg0.bindButton = self
		end
		f2_local0:SetStaticGridHeaderText( 0x28226760A25BD10 )
		SOCIAL.AddPlayerGridStaticLabelUpdater( f2_arg0.SocialMenuLayoutNew, 0xF1D6BAEC502926A )
		f2_local0.PlayersGrid.showOfflineFriends = true
		local self = function ( f5_arg0 )
			f2_arg0:UpdateSortingLabel()
		end
		
		Social[0x8D0F02DE1743108]( f2_arg1, "" )
		f2_arg0.SocialMenuLayoutNew:SetSearchBoxCallback( function ( f4_arg0, f4_arg1 )
			local f4_local0 = LUI.FlowManager.GetScopedData( f2_arg0 )
			local f4_local1 = Social[0x8D0F02DE1743108]
			local f4_local2 = f2_arg0
			local f4_local3
			if not f4_arg1 then
				f4_local3 = f4_arg1
			else
				f4_local3 = ""
			end
			f4_local1( f4_local2, f4_local3 )
			FRIENDS.RefreshData( FRIENDS.TabIDs.RECENT_PLAYERS, f2_arg0.SocialMenuLayoutNew.PlayersGrid, f2_arg0, f4_local0.activeFilter )
		end )
		FRIENDS.AddSortingEventHandler( f2_arg0.bindButton, f2_arg0.SocialMenuLayoutNew, self )
		f2_arg0.SocialMenuLayoutNew:SetActiveSorting( FRIENDS.RecentPlayersSorting.RECENCY, self )
		local f2_local3 = LUI.FlowManager.GetScopedData( f2_arg0 )
		f2_local3.activeFilter = nil
	else
		LUI.DeferredFence.Attach( f2_arg0, f2_arg1, "USERLISTS", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f3_arg0, f3_arg1 )
			if f2_arg0.NoFriendsLabel and f3_arg1.fenceState ~= LUI.Fence.FenceObjectState.PASSING then
				f2_arg0.NoFriendsLabel:setText( Fences[0xEE24D1971822EE5]( f2_arg0, "USERLISTS" ) )
			end
			if not LUI.DeferredFence.IsFenceComplete( f3_arg1.fenceState ) then
				return 
			else
				f2_arg0:SetRefreshChildFuncByTab( FRIENDS.TabIDs.RECENT_PLAYERS )
			end
		end, true )
	end
end

function SocialRecentMenu( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "SocialRecentMenu"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local f1_local3 = nil
	if not CONDITIONS.IsNewSocialScreenEnabled() then
		f1_local3 = MenuBuilder.BuildRegisteredType( "SocialMenuLayout", {
			controllerIndex = f1_local1
		} )
		f1_local3.id = "MenuLayout"
		f1_local3:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, 0, _1080p * 1080 )
		self:addElement( f1_local3 )
		self.MenuLayout = f1_local3
	end
	local f1_local4 = nil
	if CONDITIONS.IsNewSocialScreenEnabled() then
		f1_local4 = MenuBuilder.BuildRegisteredType( "SocialMenuLayoutNew", {
			controllerIndex = f1_local1
		} )
		f1_local4.id = "SocialMenuLayoutNew"
		f1_local4:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
		self:addElement( f1_local4 )
		self.SocialMenuLayoutNew = f1_local4
	end
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "SocialRecentMenu", SocialRecentMenu )
LockTable( _M )
