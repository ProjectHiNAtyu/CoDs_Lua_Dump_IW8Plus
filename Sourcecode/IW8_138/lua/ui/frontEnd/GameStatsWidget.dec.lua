-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 02-09-2025 10:42
module( ..., package.seeall )
AVERAGETRACKERTHICKNESS = 2
local f0_local0 = function ( f3_arg0, f3_arg1 )
	local f3_local0 = 0
	local f3_local1 = -1
	for f3_local2 = 1, #f3_arg1, 1 do
		f3_local0 = f3_local0 + tonumber( f3_arg1[f3_local2] )
		if f3_local1 < f3_arg1[f3_local2] then
			f3_local1 = f3_arg1[f3_local2]
		end
	end
	local f3_local2 = RECORDS.GetNumberOfPlayerMatches( f3_arg0._controllerIndex )
	if 5 <= f3_local2 then
		f3_local2 = 5
	end
	local f3_local3 = f3_local0 / f3_local2
	f3_arg0.AverageIndicatorLeft.AvgText:setText( string.format( "%.2f", f3_local3 ) )
	if 0 < f3_local3 then
		local f3_local4 = (f3_local1 - f3_local3) / f3_local1 * f3_arg0.height
		f3_arg0.AverageTracker:SetTop( f3_local4 + AVERAGETRACKERTHICKNESS / 2 )
		f3_arg0.AverageTracker:SetBottom( f3_local4 - AVERAGETRACKERTHICKNESS / 2 )
		f3_arg0.AverageIndicatorLeft:SetTop( f3_local4 - f3_arg0._indicatorHeight / 2 )
		f3_arg0.AverageIndicatorLeft:SetBottom( f3_local4 + f3_arg0._indicatorHeight / 2 )
	else
		f3_arg0.AverageTracker:SetAlpha( 0 )
		f3_arg0.AverageIndicatorLeft:SetAlpha( 0 )
	end
	for f3_local4 = 1, #f3_arg0._Bars, 1 do
		local f3_local7 = tonumber( f3_arg1[f3_local4] )
		local f3_local8 = f3_arg0._Bars[f3_local4]
		f3_local8.Label:setText( Engine.JCBDICCAH( string.format( "%.2f", f3_local7 ) ) )
		if f3_local7 <= 0 then
			f3_local8:SetTop( f3_arg0.height - f3_arg0.backerHeight )
		else
			f3_local8:SetTop( math.min( f3_arg0.height - f3_arg0.backerHeight, (f3_local1 - f3_local7) / f3_local1 * f3_arg0.height ) )
		end
	end
end

local f0_local1 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.UpdateGameStatBars = f0_local0
	f2_arg0._controllerIndex = f2_arg1
	local f2_local0, f2_local1, f2_local2, f2_local3 = f2_arg0:getLocalRect()
	local f2_local4, f2_local5, f2_local6, f2_local7 = f2_arg0.AverageIndicatorLeft:getLocalRect()
	local f2_local8, f2_local9, f2_local10, f2_local11 = f2_arg0.LastMatchBar.Backer:getLocalRect()
	f2_arg0.backerHeight = f2_local11 - f2_local9
	f2_arg0.height = f2_local3 - f2_local1
	f2_arg0._indicatorHeight = f2_local7 - f2_local5
	f2_arg0._Bars = {
		f2_arg0.LastMatchBar,
		f2_arg0.Match2Bar,
		f2_arg0.Match3Bar,
		f2_arg0.Match4Bar,
		f2_arg0.Match5Bar
	}
	f2_arg0._Labels = {
		f2_arg0.LastMatchBar.MatchLabel,
		f2_arg0.Match2Bar.MatchLabel,
		f2_arg0.Match3Bar.MatchLabel,
		f2_arg0.Match4Bar.MatchLabel,
		f2_arg0.Match5Bar.MatchLabel
	}
	f2_arg0._Labels[1]:setText( Engine.CBBHFCGDIC( "LUA_MENU/LAST_MATCH" ) )
	for f2_local12 = 2, #f2_arg0._Labels, 1 do
		f2_arg0._Labels[f2_local12]:setText( Engine.CBBHFCGDIC( "LUA_MENU/MATCH_NUM", f2_local12 ) )
	end
end

function GameStatsWidget( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1210 * _1080p, 0, 300 * _1080p )
	self.id = "GameStatsWidget"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	local Background = nil
	
	Background = LUI.UIImage.new()
	Background.id = "Background"
	Background:SetRGBFromTable( SWATCHES.CAC.panelBacker, 0 )
	Background:SetAlpha( 0.4, 0 )
	Background:SetPixelGridEnabled( true )
	Background:SetPixelGridContrast( 0.5, 0 )
	Background:SetPixelGridBlockWidth( 2, 0 )
	Background:SetPixelGridBlockHeight( 2, 0 )
	Background:SetPixelGridGutterWidth( 1, 0 )
	Background:SetPixelGridGutterHeight( 1, 0 )
	self:addElement( Background )
	self.Background = Background
	
	local AvgLabel = nil
	
	AvgLabel = LUI.UIText.new()
	AvgLabel.id = "AvgLabel"
	AvgLabel:SetRGBFromTable( SWATCHES.genericMenu.mainTitle, 0 )
	AvgLabel:setText( Engine.CBBHFCGDIC( "LUA_MENU_MP/AVG" ), 0 )
	AvgLabel:SetFont( FONTS.GetFont( FONTS.MainRegular.File ) )
	AvgLabel:SetAlignment( LUI.Alignment.Center )
	AvgLabel:SetOptOutRightToLeftAlignmentFlip( true )
	AvgLabel:SetAnchorsAndPosition( 1, 0, 1, 0, _1080p * -180, _1080p * -45, _1080p * 5, _1080p * 33 )
	self:addElement( AvgLabel )
	self.AvgLabel = AvgLabel
	
	local LastMatchBar = nil
	
	LastMatchBar = MenuBuilder.BuildRegisteredType( "GameStatBar", {
		controllerIndex = f1_local1
	} )
	LastMatchBar.id = "LastMatchBar"
	LastMatchBar:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 845, _1080p * 965, 0, _1080p * 300 )
	self:addElement( LastMatchBar )
	self.LastMatchBar = LastMatchBar
	
	local Match2Bar = nil
	
	Match2Bar = MenuBuilder.BuildRegisteredType( "GameStatBar", {
		controllerIndex = f1_local1
	} )
	Match2Bar.id = "Match2Bar"
	Match2Bar:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 645, _1080p * 765, 0, _1080p * 300 )
	self:addElement( Match2Bar )
	self.Match2Bar = Match2Bar
	
	local Match3Bar = nil
	
	Match3Bar = MenuBuilder.BuildRegisteredType( "GameStatBar", {
		controllerIndex = f1_local1
	} )
	Match3Bar.id = "Match3Bar"
	Match3Bar:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 445, _1080p * 565, 0, _1080p * 300 )
	self:addElement( Match3Bar )
	self.Match3Bar = Match3Bar
	
	local Match4Bar = nil
	
	Match4Bar = MenuBuilder.BuildRegisteredType( "GameStatBar", {
		controllerIndex = f1_local1
	} )
	Match4Bar.id = "Match4Bar"
	Match4Bar:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 245, _1080p * 365, 0, _1080p * 300 )
	self:addElement( Match4Bar )
	self.Match4Bar = Match4Bar
	
	local Match5Bar = nil
	
	Match5Bar = MenuBuilder.BuildRegisteredType( "GameStatBar", {
		controllerIndex = f1_local1
	} )
	Match5Bar.id = "Match5Bar"
	Match5Bar:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 45, _1080p * 165, 0, _1080p * 300 )
	self:addElement( Match5Bar )
	self.Match5Bar = Match5Bar
	
	local AverageTracker = nil
	
	AverageTracker = LUI.UIImage.new()
	AverageTracker.id = "AverageTracker"
	AverageTracker:SetRGBFromTable( SWATCHES.AAR.AARdescription, 0 )
	AverageTracker:SetAlpha( 0.6, 0 )
	AverageTracker:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 4, _1080p * 1076, _1080p * 149, _1080p * 151 )
	self:addElement( AverageTracker )
	self.AverageTracker = AverageTracker
	
	local AverageIndicatorLeft = nil
	
	AverageIndicatorLeft = MenuBuilder.BuildRegisteredType( "AverageIndicatorLeft", {
		controllerIndex = f1_local1
	} )
	AverageIndicatorLeft.id = "AverageIndicatorLeft"
	AverageIndicatorLeft:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -180, _1080p * -45, _1080p * 132, _1080p * 168 )
	self:addElement( AverageIndicatorLeft )
	self.AverageIndicatorLeft = AverageIndicatorLeft
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "GameStatsWidget", GameStatsWidget )
LockTable( _M )
