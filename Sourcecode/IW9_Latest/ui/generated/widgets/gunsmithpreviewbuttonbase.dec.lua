-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
module( ..., package.seeall )
local f0_local0 = function ( f7_arg0, f7_arg1, f7_arg2, f7_arg3, f7_arg4 )
	f7_arg0:registerEventHandler( "button_action", function ( element, event )
		LUI.FlowManager.RequestAddMenu( "MobileAttachmentPreview", true, f7_arg0, false, {
			weaponRef = f7_arg0,
			weaponVariantID = f7_arg0,
			attachmentData = f7_arg0
		} )
	end )
end

local f0_local1 = function ( f6_arg0, f6_arg1, f6_arg2, f6_arg3 )
	local f6_local0 = ATTACHMENT.GetCategory( f6_arg3.ref )
	if CONDITIONS.ShouldShowAttachmentLines() then
		GUNSMITH.SetupAttachLine( f6_arg0, f6_arg2, 0, f6_local0 )
		GUNSMITH.SetupAttachPoint( f6_arg0, f6_arg2, 0, f6_local0 )
		if f6_arg0._attachLine then
			f6_arg0._attachLine:SetAlpha( 0.12 )
			local f6_local1 = f6_arg0:GetAnchorsAndPosition()
			f6_arg0._attachLine:SetVertexPosition( LUI.UILine.START, 0, 0, 10 * _1080p, 20 * _1080p )
		end
		if f6_arg0._attachPoint then
			f6_arg0._attachPoint:SetAlpha( 0.12 )
		end
	end
	local f6_local1 = Engine[0xED84C33EC5F01EA]( ATTACHMENT.GetAttachmentCategoryName( f6_local0 ) )
	local f6_local2 = Engine[0xED84C33EC5F01EA]( 0x905E03005927C0F, f6_local1 )
	local f6_local3 = f6_arg0.Category
	local f6_local4 = f6_local3
	f6_local3 = f6_local3.setText
	local f6_local5
	if f6_arg0._variantID and f6_arg0._variantID > WEAPON.baseVariant and not f6_local2 then
		f6_local5 = f6_local2
	else
		f6_local5 = f6_local1
	end
	f6_local3( f6_local4, f6_local5 )
	f6_arg0.AttachmentName:setText( ATTACHMENT.GetName( f6_arg3.ref ) )
	if f6_arg0.Icon then
		f6_arg0.Icon:setImage( RegisterMaterial( ATTACHMENT.GetImage( f6_arg3.ref ) ) )
	end
	f6_local3 = Engine[0xFC084BF31D917C5]( GL_HACK.GetWeaponMPRef( f6_arg2 ), f6_arg3.ref, f6_arg3.variantID )
	local f6_local6
	if f6_local3 then
		f6_local6 = f6_local3
	else
		f6_local6 = f6_local3[0x2EAB902F6509817]
	end
	f6_local4 = GUNSMITH.GetBrandingSmallMaterialName( f6_local6 )
	if String.IsNilOrEmpty( f6_local4 ) then
		f6_arg0.Brand:SetVisible( false )
	else
		f6_arg0.Brand:SetVisible( true )
		f6_arg0.Brand:setImage( RegisterMaterial( f6_local4 ) )
		f6_local5 = f6_arg0.Brand:GetAnchorsAndPosition()
		f6_arg0._brandingImageRightPos = f6_local5.left + GUNSMITH.GetBrandingSmallMaterialWidth( f6_local6 ) * 0.75
		f6_arg0.Brand:SetRight( f6_arg0._brandingImageRightPos )
	end
end

local f0_local2 = function ( f5_arg0, f5_arg1, f5_arg2, f5_arg3, f5_arg4 )
	local f5_local0 = LOOT.typeNameStrings[f5_arg4]
	local f5_local1 = WEAPON.GetWeaponModelName( f5_arg2.weapon, f5_arg2, {
		includeCamos = true,
		includeAttachments = true,
		includeStickers = true,
		controllerIndex = f5_arg1
	} )
	local f5_local2, f5_local3 = nil
	if f5_arg4 == LOOT.itemTypes.CAMO then
		f5_local2 = "receiver"
	elseif f5_arg4 == LOOT.itemTypes.CHARM then
		f5_local2 = "charm"
	elseif f5_arg4 == LOOT.itemTypes.STICKER then
		Engine[0xE27E71847C5A944]( f5_arg1, f5_local1, ClientWeapon[0x5DD69014A9C290]( FrontEndScene.ClientWeapons.Preview ), "" )
		f5_local2 = "tag_barrel_attach"
		f5_local3 = "tag_barrel_attach"
	else
		f5_local2 = "receiver"
	end
	if CONDITIONS.ShouldShowAttachmentLines() then
		GUNSMITH.SetupAttachLine( f5_arg0, f5_arg2.weapon, 0, f5_local2, f5_local3 )
		GUNSMITH.SetupAttachPoint( f5_arg0, f5_arg2.weapon, 0, f5_local2, f5_local3 )
		if f5_arg0._attachLine then
			f5_arg0._attachLine:SetAlpha( 0.4 )
			local f5_local4 = f5_arg0:GetAnchorsAndPosition()
			f5_arg0._attachLine:SetVertexPosition( LUI.UILine.START, 0, 0, 10 * _1080p, 20 * _1080p )
		end
		if f5_arg0._attachPoint then
			f5_arg0._attachPoint:SetAlpha( 0.4 )
		end
	end
	f5_arg0.Category:setText( Engine[0xED84C33EC5F01EA]( f5_local0 ) )
	f5_arg0.AttachmentName:setText( LOOT.GetItemName( f5_arg4, f5_arg3, nil, f5_arg1 ) )
end

local f0_local3 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.SetupAttachment = f0_local0
	f3_arg0.SetupCustomization = f0_local0
	if CONDITIONS.IsMobileOrMobileSim() then
		f3_arg0.SetupHandlers = f0_local0
	end
	f3_arg0:registerEventHandler( "toggle_attachment_icons", function ( element, event )
		if f3_arg0.Icon then
			f3_arg0.Icon:SetVisible( event.showIcon )
		end
	end )
end

local f0_local4 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function GunsmithPreviewButtonBase( menu, controller )
	local self = LUI.UIButton.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "GunsmithPreviewButtonBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f0_local0( self, LUI.ValidateControllerIndex( self, f1_local1 ), controller )
	return self
end

MenuBuilder.registerType( "GunsmithPreviewButtonBase", GunsmithPreviewButtonBase )
LockTable( _M )
