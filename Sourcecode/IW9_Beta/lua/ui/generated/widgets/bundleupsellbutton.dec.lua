-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:01
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.aar.aarcontentheader" )
require( "ui.generated.widgets.frontend.depot.limitedtimeitem" )
require( "ui.generated.widgets.buttonhighlightbar" )
local f0_local0 = function ( f26_arg0 )
	f26_arg0._isVisible = false
	f26_arg0:SetAlpha( 0 )
	f26_arg0:SetMouseFocusBlocker( true )
	f26_arg0:processEvent( {
		name = "on_upsell_button_hidden"
	} )
end

local f0_local1 = function ( f25_arg0, f25_arg1 )
	f25_arg0._isVisible = true
	f25_arg0:SetAlpha( 1 )
	f25_arg0:SetMouseFocusBlocker( false )
	f25_arg0.BundleTypeLabel.Text:setText( Engine[0xED84C33EC5F01EA]( f25_arg1.bundleType ) )
	f25_arg0.BundleImage:setImage( RegisterMaterial( f25_arg1.image ) )
	f25_arg0.BundleNameImage:setImage( RegisterMaterial( f25_arg1.titleImage ) )
	f25_arg0.LimitedTime:SetupTimeLimit( nil )
	f25_arg0.LimitedTime:SetAlpha( 0 )
	f25_arg0:processEvent( {
		name = "on_upsell_button_shown"
	} )
end

local f0_local2 = function ( f24_arg0, f24_arg1 )
	local f24_local0 = "hiddenItem"
	for f24_local1 = 1, f24_arg0.numHiddenItems, 1 do
		if tonumber( f24_arg0[f24_local0 .. f24_local1] ) == f24_arg1 then
			return true
		end
	end
	f24_local0 = "item"
	for f24_local1 = 1, f24_arg0.numItems, 1 do
		if tonumber( f24_arg0[f24_local0 .. f24_local1] ) == f24_arg1 then
			return true
		end
	end
	return false
end

local f0_local3 = function ( f23_arg0, f23_arg1 )
	local f23_local0 = {}
	local f23_local1 = LOOT.emptyID
	if f23_arg1.type and f23_arg1.ref then
		f23_local1 = LOOT.GetItemID( f23_arg1.type, f23_arg1.ref )
	elseif f23_arg1.lootID then
		f23_local1 = f23_arg1.lootID
	end
	local f23_local2 = StringTable[0xFD4E49A34DD43AE]( CSV.bundleIDs.file )
	for f23_local3 = 0, f23_local2 - 1, 1 do
		local f23_local6 = CSV.ReadRow( CSV.bundleIDs, f23_local3 )
		local f23_local7 = f0_local0( f23_local6, f23_local1 )
		local f23_local8 = f23_local6.id
		if f23_local7 and STORE.BundleAvailable( f23_arg0, f23_local8 ) and not STORE.IsFirstPartyBundle( f23_local8 ) then
			f23_local0[f23_local8] = f23_local6
		end
	end
	return f23_local0
end

local f0_local4 = function ( f22_arg0, f22_arg1 )
	local f22_local0 = f0_local0( f22_arg0, f22_arg1 )
	for f22_local4, f22_local5 in ipairs( split( table.concat( {
		Engine[0x8B495DC361731F7]( f22_arg0 ) and Dvar[0x54084D7CA2317BB]( 0x7EC0DB7A7C8E1BE ) or Dvar[0x54084D7CA2317BB]( 0x9B9857BFFD14325 ) or "",
		Engine[0x8B495DC361731F7]( f22_arg0 ) and Dvar[0x54084D7CA2317BB]( 0x23D7B8AAF90167A ) or Dvar[0x54084D7CA2317BB]( 0xC242A7F87575441 ) or "",
		Engine[0x8B495DC361731F7]( f22_arg0 ) and Dvar[0x54084D7CA2317BB]( 0x73E3DC9E920E65C ) or Dvar[0x54084D7CA2317BB]( 0x979E423FDB37FB3 ) or ""
	}, "," ), "," ) ) do
		if f22_local0[f22_local5] then
			return f22_local0[f22_local5]
		end
	end
end

local f0_local5 = function ( f21_arg0, f21_arg1 )
	if f21_arg1.type == LOOT.itemTypes.OPERATOR then
		return f0_local0( f21_arg0, f21_arg1 )
	else
		local f21_local0 = f0_local0( f21_arg0, f21_arg1 )
		local f21_local1 = next( f21_local0 )
		if f21_local1 then
			return f21_local0[f21_local1]
		else
			
		end
	end
end

local f0_local6 = function ( f19_arg0, f19_arg1, f19_arg2 )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xBBF84FBDC361CAF ) then
		f19_arg0._bundleData = f19_arg2
		if not f19_arg2 then
			f19_arg0:HideButton()
		else
			f19_arg0:ShowButton( f19_arg2 )
			local f19_local0 = function ( f20_arg0 )
				if f20_arg0._bundleData and f20_arg0._isVisible then
					if f20_arg0._preOpenStoreBundlePreviewFunc then
						f20_arg0:_preOpenStoreBundlePreviewFunc()
					end
					LUI.FlowManager.RequestAddMenu( "StoreBundlePreview", true, f19_arg0, false, {
						displayUpsellPopup = true,
						bundleID = tonumber( f20_arg0._bundleData.id ),
						rarity = tonumber( f20_arg0._bundleData.rarity ),
						description = f20_arg0._bundleData.description,
						bundleType = f20_arg0._bundleData.bundleType,
						titleImage = f20_arg0._bundleData.titleImage,
						currencyID = tonumber( f20_arg0._bundleData.currencyID ),
						currencyAmount = tonumber( f20_arg0._bundleData.currencyAmount ),
						timerPubVar = f20_arg0._timePubVar
					} )
				end
			end
			
			if not f19_arg0._eventHandlersAdded then
				f19_arg0:addEventHandler( "button_action", f19_local0 )
				f19_arg0:addEventHandler( "view_bundle", f19_local0 )
				f19_arg0._eventHandlersAdded = true
			end
		end
	else
		f19_arg0:HideButton()
	end
end

local f0_local7 = function ( f18_arg0, f18_arg1, f18_arg2, f18_arg3 )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xBBF84FBDC361CAF ) then
		f0_local0( f18_arg0, f18_arg1, f0_local0( f18_arg1, {
			type = f18_arg2,
			ref = f18_arg3
		} ) )
	else
		f18_arg0:HideButton()
	end
end

local f0_local8 = function ( f17_arg0, f17_arg1, f17_arg2 )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xBBF84FBDC361CAF ) then
		f0_local0( f17_arg0, f17_arg1, f0_local0( f17_arg1, {
			lootID = f17_arg2
		} ) )
	else
		f17_arg0:HideButton()
	end
end

local f0_local9 = function ( f16_arg0, f16_arg1, f16_arg2 )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xBBF84FBDC361CAF ) then
		local f16_local0 = StringTable[0x8073B436CDE1BF]( CSV.bundleIDs.file, CSV.bundleIDs.cols.id, f16_arg2 )
		if f16_local0 and 0 <= f16_local0 then
			f0_local0( f16_arg0, f16_arg1, CSV.ReadRow( CSV.bundleIDs, f16_local0 ) )
			return 
		end
	end
	f16_arg0:HideButton()
end

local f0_local10 = function ( f15_arg0, f15_arg1, f15_arg2 )
	assert( f15_arg0._bundleItems, "Attempt to setup bundle with key before calling CacheBundleItems." )
	if f15_arg0._bundleItems and f15_arg0._bundleItems[f15_arg2] then
		f0_local0( f15_arg0, f15_arg1, f15_arg0._bundleItems[f15_arg2].bundleID )
		return 
	else
		f15_arg0:HideButton()
	end
end

local f0_local11 = function ( f14_arg0, f14_arg1, f14_arg2 )
	f14_arg0._bundleItems = STORE.GetAllItemsInStore( f14_arg1, f14_arg2 )
end

local f0_local12 = function ( f13_arg0, f13_arg1 )
	f13_arg0._preOpenStoreBundlePreviewFunc = f13_arg1
end

local f0_local13 = function ( f12_arg0, f12_arg1 )
	f12_arg0._usePrimary = f12_arg1
	local f12_local0
	if f12_arg1 then
		f12_local0 = 0x851C8AFC5D1B021
		if not f12_local0 then
		
		else
			f12_arg0.ViewBundleLabel:setText( Engine[0xED84C33EC5F01EA]( f12_local0 ) )
		end
	end
	f12_local0 = 0xCA4644856E4CF60
end

local f0_local14 = function ( f11_arg0, f11_arg1, f11_arg2 )
	if f11_arg0._isVisible and f11_arg0._bundleData then
		if not f11_arg2 then
			f11_arg2 = {}
		end
		if f11_arg0._preOpenStoreBundlePreviewFunc then
			f11_arg0:_preOpenStoreBundlePreviewFunc()
		end
		LUI.FlowManager.RequestAddMenu( "StoreBundlePreview", true, f11_arg1, false, {
			displayUpsellPopup = true,
			bundleID = tonumber( f11_arg0._bundleData.id ),
			rarity = tonumber( f11_arg0._bundleData.rarity ),
			description = f11_arg0._bundleData.description,
			bundleType = f11_arg0._bundleData.bundleType,
			titleImage = f11_arg0._bundleData.titleImage,
			currencyID = tonumber( f11_arg0._bundleData.currencyID ),
			currencyAmount = tonumber( f11_arg0._bundleData.currencyAmount ),
			timerPubVar = f11_arg0._timePubVar,
			oneModBlueprintStore = f11_arg2.oneModBlueprintStore,
			upsellMenu = f11_arg0._upsellMenu
		} )
	end
end

local f0_local15 = function ( f10_arg0, f10_arg1 )
	f10_arg0._upsellMenu = f10_arg1
end

local f0_local16 = function ( f6_arg0, f6_arg1, f6_arg2 )
	f6_arg0.SetupUpsellButton = f0_local0
	f6_arg0.SetupUpsellButtonWithLootID = f0_local0
	f6_arg0.SetPreOpenStoreBundlePreviewFunc = f0_local0
	f6_arg0.SetButtonPrimary = f0_local0
	f6_arg0.OpenBundle = f0_local0
	f6_arg0.SetupUpsellButtonWithBundleID = f0_local0
	f6_arg0.SetupUpsellButtonWithKey = f0_local0
	f6_arg0.CacheBundleItems = f0_local0
	f6_arg0.HideButton = f0_local0
	f6_arg0.ShowButton = f0_local0
	f6_arg0.SetUpsellMenu = f0_local0
	f6_arg0:HideButton()
	f6_arg0.BundleImage:SetMask( f6_arg0.Mask )
	f6_arg0:addEventHandler( "gamepad_button", function ( f9_arg0, f9_arg1 )
		local f9_local0
		if f9_arg0._usePrimary then
			f9_local0 = "primary"
		else
			f9_local0 = "alt1"
		end
		if f9_arg1.button == f9_local0 and f9_arg1.down then
			f9_arg0:OpenBundle( f6_arg0 )
		end
	end )
	f6_arg0:addEventHandler( "on_close", function ( f8_arg0 )
		f8_arg0._preOpenStoreBundlePreviewFunc = nil
	end )
	f6_arg0:addAndCallEventHandler( "update_input_type", function ( f7_arg0, f7_arg1 )
		if LUI.IsLastInputKeyboardMouse( f7_arg1.controllerIndex or f6_arg0 ) then
			f7_arg0:SetFocusable( true )
		else
			f7_arg0:SetFocusable( false )
			f7_arg0:processEvent( {
				name = "lose_focus"
			} )
		end
	end )
	if IsLanguageChinese() or IsLanguageArabic() then
		ACTIONS.AnimateSequence( f6_arg0, "LimitedTimeCHTAR" )
	end
	if not IsLanguageArabic() then
		f6_arg0.LimitedTime:SetIsShort( true )
	end
end

function BundleUpsellButton( menu, controller )
	local self = LUI.UIButton.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 450 * _1080p, 0, 204 * _1080p )
	self.id = "BundleUpsellButton"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	self._sequenceLengths = self._sequenceLengths or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local BundleImage = nil
	
	BundleImage = LUI.UIImage.new()
	BundleImage.id = "BundleImage"
	BundleImage:SetScale( 0.35, 0 )
	BundleImage:setImage( RegisterMaterial( "mw_store_billboard_mother_russia" ), 0 )
	BundleImage:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, _1080p * 20, _1080p * 156 )
	self:addElement( BundleImage )
	self.BundleImage = BundleImage
	
	local BundleNameImage = nil
	
	BundleNameImage = LUI.UIImage.new()
	BundleNameImage.id = "BundleNameImage"
	BundleNameImage:setImage( RegisterMaterial( "mw_store_title_mother_russia" ), 0 )
	BundleNameImage:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 10, _1080p * 240, _1080p * 55, _1080p * 170 )
	self:addElement( BundleNameImage )
	self.BundleNameImage = BundleNameImage
	
	local TitleDarkener = nil
	
	TitleDarkener = LUI.UIImage.new()
	TitleDarkener.id = "TitleDarkener"
	TitleDarkener:SetRGBFromTable( SWATCHES.genericMenu.blackBackground, 0 )
	TitleDarkener:SetAlpha( 0.6, 0 )
	TitleDarkener:setImage( RegisterMaterial( "widg_gradient_left_to_right" ), 0 )
	TitleDarkener:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, _1080p * 50 )
	self:addElement( TitleDarkener )
	self.TitleDarkener = TitleDarkener
	
	local BundleTypeLabel = nil
	
	BundleTypeLabel = MenuBuilder.BuildRegisteredType( "AARContentHeader", {
		controllerIndex = f1_local1
	} )
	BundleTypeLabel.id = "BundleTypeLabel"
	BundleTypeLabel.Divider:SetRGBFromTable( SWATCHES.MPArmory.bundleTextFocus, 0 )
	BundleTypeLabel.Text:SetRGBFromTable( SWATCHES.MPArmory.bundleTextFocus, 0 )
	BundleTypeLabel.Text:setText( Engine[0xED84C33EC5F01EA]( 0x2A77A67667D1C74 ), 0 )
	BundleTypeLabel:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, _1080p * 50 )
	self:addElement( BundleTypeLabel )
	self.BundleTypeLabel = BundleTypeLabel
	
	local ViewBundleLabel = nil
	
	ViewBundleLabel = LUI.UIText.new()
	ViewBundleLabel.id = "ViewBundleLabel"
	ViewBundleLabel:SetRGBFromTable( SWATCHES.HUD.HUDMain, 0 )
	ViewBundleLabel:setText( Engine[0xED84C33EC5F01EA]( 0xCA4644856E4CF60 ), 0 )
	ViewBundleLabel:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
	ViewBundleLabel:SetFontSize( 24 * _PT )
	ViewBundleLabel:SetMinFontSize( 18 * _PT )
	ViewBundleLabel:SetWordWrap( true )
	ViewBundleLabel:SetAlignment( LUI.Alignment.Left )
	ViewBundleLabel:SetTintFontIcons( true )
	ViewBundleLabel:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, _1080p * 186, _1080p * 210 )
	self:addElement( ViewBundleLabel )
	self.ViewBundleLabel = ViewBundleLabel
	
	local LimitedTime = nil
	
	LimitedTime = MenuBuilder.BuildRegisteredType( "LimitedTimeItem", {
		controllerIndex = f1_local1
	} )
	LimitedTime.id = "LimitedTime"
	LimitedTime:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 299, _1080p * 540, _1080p * 10, _1080p * 40 )
	self:addElement( LimitedTime )
	self.LimitedTime = LimitedTime
	
	local HighlightBarBottom = nil
	
	HighlightBarBottom = MenuBuilder.BuildRegisteredType( "ButtonHighlightBar", {
		controllerIndex = f1_local1
	} )
	HighlightBarBottom.id = "HighlightBarBottom"
	HighlightBarBottom:SetAlpha( 0, 0 )
	HighlightBarBottom:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, _1080p * 175, _1080p * 178 )
	self:addElement( HighlightBarBottom )
	self.HighlightBarBottom = HighlightBarBottom
	
	local Mask = nil
	
	Mask = LUI.UIImage.new()
	Mask.id = "Mask"
	Mask:setImage( RegisterMaterial( "stencil_mask" ), 0 )
	Mask:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 450, 0, _1080p * 176 )
	self:addElement( Mask )
	self.Mask = Mask
	
	self._sequences.DefaultSequence = function ()
		
	end
	
	self._sequenceLengths.DefaultSequence = 0
	local f1_local11 = nil
	HighlightBarBottom:RegisterAnimationSequence( "ButtonOver", {
		{
			value = 1,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.ButtonOver = function ()
		menu:AnimateSequence( "ButtonOver" )
	end
	
	self._sequenceLengths.ButtonOver = 0
	local f1_local12 = nil
	HighlightBarBottom:RegisterAnimationSequence( "ButtonUp", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	self._sequences.ButtonUp = function ()
		menu:AnimateSequence( "ButtonUp" )
	end
	
	self._sequenceLengths.ButtonUp = 0
	local f1_local13 = nil
	LimitedTime:RegisterAnimationSequence( "LimitedTimeCHTAR", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 253
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 494
		}
	} )
	self._sequences.LimitedTimeCHTAR = function ()
		menu:AnimateSequence( "LimitedTimeCHTAR" )
	end
	
	self._sequenceLengths.LimitedTimeCHTAR = 0
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "BundleUpsellButton", BundleUpsellButton )
LockTable( _M )
