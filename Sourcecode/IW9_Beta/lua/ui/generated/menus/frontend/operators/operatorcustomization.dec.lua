-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:02
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.menutitle" )
require( "ui.generated.widgets.caccommon.characterrotator" )
require( "ui.generated.widgets.buttons.buttonmedium" )
require( "ui.generated.widgets.frontend.itemdetails" )
local f0_local0 = {
	[LOOT.itemTypes.OPERATOR_SKIN] = 0xE4C971F5FABCBB6,
	[LOOT.itemTypes.OPERATOR_EXECUTION] = 0x93AB6D39B9B7FAD,
	[LOOT.itemTypes.OPERATOR_TAUNT] = 0x5AAD33E29C5AFC
}
local f0_local1 = function ( f12_arg0, f12_arg1, f12_arg2, f12_arg3, f12_arg4 )
	local f12_local0 = {}
	local f12_local1 = {}
	local f12_local2 = f12_arg0.OperatorlootGrid:GetFocusableIndicesFromPosition( {
		x = f12_arg1,
		y = f12_arg2
	} )
	for f12_local3 = 1, #f12_local2, 1 do
		local f12_local6 = f12_arg0._lootData[f12_local2[f12_local3]]
		if f12_arg0._currentLootType == LOOT.itemTypes.OPERATOR_SKIN then
			local f12_local7 = OPERATOR.GetOperatorSkin( f12_arg3, f12_local6.lootIndex, f12_arg4 )
			if f12_local7.bodyModel and 0 < #f12_local7.bodyModel then
				table.insert( f12_local0, f12_local7.bodyModel )
			end
			if f12_local7.headModel and 0 < #f12_local7.headModel then
				table.insert( f12_local1, f12_local7.headModel )
			end
		end
		if f12_arg0._currentLootType == LOOT.itemTypes.OPERATOR_EXECUTION then
			local f12_local7 = OPERATOR.GetExecutionPet( f12_local6.lootIndex )
			if f12_local7 and 0 < #f12_local7 then
				table.insert( f12_local0, OPERATOR.GetPetModel( f12_local7 ) )
			end
		end
	end
	local f12_local4 = OPERATOR.GetOperatorSkin( f12_arg3, OPERATOR.GetEquippedItemForLootType( f12_arg3, f12_arg4, LOOT.itemTypes.OPERATOR_SKIN ), f12_arg4 )
	if f12_local4.bodyModel and 0 < #f12_local4.bodyModel then
		table.insert( f12_local0, f12_local4.bodyModel )
	end
	if f12_local4.headModel and 0 < #f12_local4.headModel then
		table.insert( f12_local1, f12_local4.headModel )
	end
	local f12_local5 = OPERATOR.GetPetForOperator( f12_arg3, f12_arg4 )
	if f12_local5 and 0 < #f12_local5 then
		table.insert( f12_local0, OPERATOR.GetPetModel( f12_local5 ) )
	end
	if 0 < #f12_local0 and 0 < #f12_local1 then
		FrontEndScene.RequestBodyModels( f12_local0 )
		FrontEndScene.RequestHeadModels( f12_local1 )
	end
end

local f0_local2 = function ( f11_arg0, f11_arg1 )
	local f11_local0 = PLAYER_DATA.IO( f11_arg1, LOADOUT.GetLoadoutStatsGroup() )
	f11_local0 = f11_local0.customizationSetup
	if f11_local0.operators[f11_arg0.currentState]:get() ~= f11_arg0.operatorRef then
		f11_local0.operators[f11_arg0.currentState]:set( f11_arg0.operatorRef )
		LUI.ToastManager.CreateToast( f11_arg1, LUI.ToastManager.StandardEmphasisToast( Engine[0xED84C33EC5F01EA]( 0x4001E7BD10C7068 ), Engine[0xED84C33EC5F01EA]( OPERATOR.GetName( f11_arg0.operatorRef ) ), LUI.ToastManager.ToastNotificationType.Gear ) )
	end
end

local f0_local3 = function ( f10_arg0, f10_arg1, f10_arg2 )
	for f10_local0 = 1, #f10_arg1, 1 do
		if f10_arg1[f10_local0].ref == f10_arg2 then
			return f10_local0
		end
	end
	return 1
end

local f0_local4 = function ( f9_arg0, f9_arg1 )
	local f9_local0 = PLAYER_DATA.IO( f9_arg1, LOADOUT.GetLoadoutStatsGroup() )
	f9_local0 = f9_local0.customizationSetup
	if f9_arg0.currentState == OPERATOR.SuperFaction.EAST then
		local f9_local1 = f9_arg0.eastSelectedOperator
		if not f9_local1 then
			f9_local1 = f9_local0.operators[f9_arg0.currentState]:get()
		end
		f9_arg0.operatorRef = f9_local1
	else
		local f9_local1 = f9_arg0.westSelectedOperator
		if not f9_local1 then
			f9_local1 = f9_local0.operators[f9_arg0.currentState]:get()
		end
		f9_arg0.operatorRef = f9_local1
	end
end

local f0_local5 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.RequestStreamingModels = f0_local0
	f2_arg0.GetEquippedLootItemIndex = f0_local0
	f2_arg0.UpdateSuperfactionDisplay = f0_local0
	f2_arg0._controllerIndex = f2_arg1
	f2_arg0.animationTime = 400
	f2_arg0.currentState = f2_arg2.operatorData.currentState
	f2_arg0.isCustomizationMenu = true
	f2_arg0._scoped = LUI.FlowManager.GetScopedData( f2_arg0 )
	f2_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0xF0150DF52D14A70 ) )
	f2_arg0.MenuTitle:SetupBackButton( f2_arg1 )
	f2_arg0.operatorInfo = f2_arg2.operatorData.operatorInfo
	local f2_local0 = PLAYER_DATA.IO( f2_arg1, LOADOUT.GetLoadoutStatsGroup() )
	f2_local0 = f2_local0.customizationSetup
	local f2_local1 = f2_local0.operatorCustomization[f2_arg0.operatorInfo.ref].skin:get()
	local f2_local2 = f2_local0.operatorCustomization[f2_arg0.operatorInfo.ref].execution:get()
	local f2_local3 = f2_local0.operatorCustomization[f2_arg0.operatorInfo.ref].taunt:get()
	local f2_local4 = OPERATOR.GetCosmeticRefByLootTypeAndIndex( LOOT.itemTypes.OPERATOR_SKIN, f2_local1 )
	local f2_local5 = OPERATOR.GetCosmeticRefByLootTypeAndIndex( LOOT.itemTypes.OPERATOR_EXECUTION, f2_local2 )
	local f2_local6 = OPERATOR.GetCosmeticRefByLootTypeAndIndex( LOOT.itemTypes.OPERATOR_TAUNT, f2_local3 )
	local f2_local7 = LOOT.GetItemID( LOOT.itemTypes.OPERATOR, f2_arg0.operatorInfo.ref )
	local f2_local8 = LOOT.GetItemID( LOOT.itemTypes.OPERATOR_SKIN, f2_local4 )
	local f2_local9 = LOOT.GetItemID( LOOT.itemTypes.OPERATOR_EXECUTION, f2_local5 )
	local f2_local10 = LOOT.GetItemID( LOOT.itemTypes.OPERATOR_TAUNT, f2_local6 )
	local f2_local11 = LOOT.GetItemName( LOOT.itemTypes.OPERATOR_SKIN, f2_local4 )
	local f2_local12 = LOOT.GetItemName( LOOT.itemTypes.OPERATOR_EXECUTION, f2_local5 )
	local f2_local13 = LOOT.GetItemName( LOOT.itemTypes.OPERATOR_TAUNT, f2_local6 )
	f2_arg0.ItemDetails:SetupForOperatorCustomization()
	local f2_local14 = OPERATOR.GetEquippedItemForLootType( f2_arg0._controllerIndex, f2_arg0.operatorInfo.ref, LOOT.itemTypes.OPERATOR_SKIN )
	f2_arg0._categoryButtons = {
		{
			lootType = LOOT.itemTypes.OPERATOR_SKIN,
			button = f2_arg0.SkinsButton,
			name = LOOT.GetItemClassName( LOOT.itemTypes.OPERATOR_SKIN ),
			desc = LOOT.GetItemClassDesc( LOOT.itemTypes.OPERATOR_SKIN ),
			image = LOOT.GetItemImage( LOOT.itemTypes.OPERATOR_SKIN, f2_local14 )
		},
		{
			locked = true,
			lootType = LOOT.itemTypes.OPERATOR_TAUNT,
			button = f2_arg0.QuipsButton,
			name = LOOT.GetItemClassName( LOOT.itemTypes.OPERATOR_TAUNT ),
			desc = LOOT.GetItemClassDesc( LOOT.itemTypes.OPERATOR_TAUNT ),
			image = LOOT.GetItemImage( LOOT.itemTypes.OPERATOR_TAUNT, OPERATOR.GetEquippedItemForLootType( f2_arg0._controllerIndex, f2_arg0.operatorInfo.ref, LOOT.itemTypes.OPERATOR_TAUNT ) )
		},
		{
			locked = true,
			lootType = LOOT.itemTypes.OPERATOR_EXECUTION,
			button = f2_arg0.ExecutionsButton,
			name = LOOT.GetItemClassName( LOOT.itemTypes.OPERATOR_EXECUTION ),
			desc = LOOT.GetItemClassDesc( LOOT.itemTypes.OPERATOR_EXECUTION ),
			image = LOOT.GetItemImage( LOOT.itemTypes.OPERATOR_EXECUTION, OPERATOR.GetEquippedItemForLootType( f2_arg0._controllerIndex, f2_arg0.operatorInfo.ref, LOOT.itemTypes.OPERATOR_EXECUTION ) )
		}
	}
	f2_arg0.ItemDetails:UpdateDetails( {
		localizedName = f2_arg0._categoryButtons[1].name,
		localizedDesc = f2_arg0._categoryButtons[1].desc,
		operatorInfo = f2_arg0.operatorInfo
	} )
	f2_arg0.CustomizationCategories:SetSpacing( 16 * _1080p )
	f2_arg0.CustomizationCategories:SetAlignment( LUI.Alignment.Left )
	local f2_local15 = {
		removeTextBacker = true,
		hasEmptyState = true,
		specialLayout = "OpCustomizationCatLayout",
		localizeHeader = false,
		removeEquipBanner = true,
		buttonData = {
			image = LOOT.GetItemImage( LOOT.itemTypes.OPERATOR_SKIN, f2_local14 )
		},
		primaryActionText = Engine[0xED84C33EC5F01EA]( "LUA_MENU/SELECT" )
	}
	for f2_local16 = 1, #f2_arg0._categoryButtons, 1 do
		local f2_local19 = f2_arg0._categoryButtons[f2_local16].button
		f2_local15.buttonData.header = f2_arg0._categoryButtons[f2_local16].name
		if f2_arg0._categoryButtons[f2_local16].lootType == LOOT.itemTypes.OPERATOR_SKIN then
			f2_local15.specialLayout = "OpCustomizationCatSkinLayout"
		end
		f2_local19:SetupButton( f2_local15 )
		f2_arg0:RemoveElement( f2_local19 )
		f2_arg0.CustomizationCategories:addElement( f2_local19 )
		local f2_local20 = LAYOUT.GetElementHeight( f2_local19 )
		f2_local19:SetBottom( 0 )
		f2_local19:SetTop( -f2_local20 )
		local f2_local21 = function ()
			f2_arg0.ItemDetails:UpdateDetails( {
				localizedName = f2_arg0._categoryButtons[f2_arg0].name,
				localizedDesc = f2_arg0._categoryButtons[f2_arg0].desc,
				operatorInfo = f2_arg0.operatorInfo
			} )
		end
		
		f2_local19:addEventHandler( "button_over", function ( f7_arg0, f7_arg1 )
			f2_arg0()
		end )
		f2_local19:addEventHandler( "button_over_disable", function ( f6_arg0, f6_arg1 )
			f2_arg0()
		end )
		f2_local19:addEventHandler( "button_action", function ( f5_arg0, f5_arg1 )
			f2_arg0._scoped.customizationCategory = f2_arg0._categoryButtons[f2_arg0].lootType
			OPERATOR.OpenOperatorSubMenu( f2_arg0, f2_arg0, "OperatorCustomizationCategory" )
		end )
		if not f2_arg0._categoryButtons[f2_local16].locked then
			f2_local19:SetImage( f2_arg0._categoryButtons[f2_local16].image )
		end
		f2_local19:SetDisabled( f2_arg0._categoryButtons[f2_local16].locked )
		f2_local19:SetEmpty( f2_arg0._categoryButtons[f2_local16].locked )
	end
	f2_arg0.CustomizationCategories:processEvent( {
		name = "gain_focus"
	} )
	local f2_local16 = function ( f4_arg0 )
		local f4_local0 = StringTable[0x2DCF0973239E909]( CSV.operatorTurnAnimations.file, CSV.operatorTurnAnimations.cols.gender, StringTable[0x2DCF0973239E909]( CSV.operators.file, CSV.operators.cols.ref, f4_arg0, CSV.operators.cols.gender ), CSV.operatorTurnAnimations.cols.idleFront )
		local f4_local1 = assert
		local f4_local2
		if f4_local0 then
			f4_local2 = f4_local0
		else
			f4_local2 = f4_local0 ~= ""
		end
		f4_local1( f4_local2 )
		f4_local1 = OPERATOR.GetClientCharacterForSuperFaction( f2_arg0.currentState )
		f4_local2, f4_local3, f4_local4 = OPERATOR.GetTransitionInfoFromAnimation( ClientCharacter[0xC4D5E9810D26F7E]( f4_local1 ) )
		ClientCharacter[0x524D4D5B140E36E]( f4_local1, f4_local0, f4_local4, f4_local2, f4_local3 )
		f2_arg0.CharacterRotator:SetClientCharacterInfo( f4_local1, f4_arg0 )
	end
	
	local f2_local17 = Engine[0x3B8CFB6758EF57C]()
	local f2_local18 = nil
	if f2_arg0.currentState == OPERATOR.SuperFaction.WEST then
		f2_arg0.westSelectedOperator = f2_arg2.operatorData.westSelectedOperator
		f2_local16( f2_arg0.westSelectedOperator )
		Engine[0x685AE31DEDA30A4]( "character_faction_select_l_detail" )
		FrontEndScene.SetCharacterVisible( FrontEndScene.ClientCharacters.MainMenuEast, false )
		f2_local18 = OPERATOR.GetCosmeticConfigString( f2_arg0.westSelectedOperator, f2_arg1 )
	else
		f2_arg0.eastSelectedOperator = f2_arg2.operatorData.eastSelectedOperator
		f2_local16( f2_arg0.eastSelectedOperator )
		Engine[0x685AE31DEDA30A4]( "character_faction_select_r_detail" )
		FrontEndScene.SetCharacterVisible( FrontEndScene.ClientCharacters.MainMenuWest, false )
		f2_local18 = OPERATOR.GetCosmeticConfigString( f2_arg0.eastSelectedOperator, f2_arg1 )
	end
	local bindButton = LUI.UIBindButton.new()
	bindButton.id = "bindButton"
	f2_arg0:addElement( bindButton )
	f2_arg0.bindButton = bindButton
	
	f2_arg0.bindButton:addEventHandler( "button_secondary", function ( f3_arg0, f3_arg1 )
		Engine[0xB81A5136C5503E4]( "uploadstats", f2_arg0 )
		local f3_local0 = nil
		if f2_arg0.currentState == OPERATOR.SuperFaction.WEST then
			f3_local0 = OPERATOR.GetCosmeticConfigString( f2_arg0.westSelectedOperator, f2_arg0 )
		else
			f3_local0 = OPERATOR.GetCosmeticConfigString( f2_arg0.eastSelectedOperator, f2_arg0 )
		end
		METRICS.OperatorUsageSendDLogEvent( f2_arg0, f2_arg0, f2_arg0, f2_arg0, f3_local0 )
		LAYOUT.FadeInAspectRatioFadeFrame( f2_arg0, 300 )
		if f2_arg0.currentState == OPERATOR.SuperFaction.WEST then
			f2_arg0.operatorData.westSelectedOperator = f2_arg0.operatorRef
		else
			f2_arg0.operatorData.eastSelectedOperator = f2_arg0.operatorRef
		end
		f2_arg0.operatorData.currentState = f2_arg0.currentState
		Engine[0x3DACD106DDC0D71]()
		ACTIONS.LeaveMenu( f2_arg0 )
	end )
	LAYOUT.FadeOutAspectRatioFadeFrame( f2_arg0, 500, 1.15 )
end

function OperatorCustomization( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "OperatorCustomization"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local MenuTitle = nil
	
	MenuTitle = MenuBuilder.BuildRegisteredType( "MenuTitle", {
		controllerIndex = f1_local1
	} )
	MenuTitle.id = "MenuTitle"
	MenuTitle.MenuTitle:setText( Engine[0xED84C33EC5F01EA]( 0xF0150DF52D14A70 ), 0 )
	MenuTitle:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, _1080p * 80 )
	self:addElement( MenuTitle )
	self.MenuTitle = MenuTitle
	
	local CharacterRotator = nil
	
	CharacterRotator = MenuBuilder.BuildRegisteredType( "CharacterRotator", {
		controllerIndex = f1_local1
	} )
	CharacterRotator.id = "CharacterRotator"
	CharacterRotator:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -440, _1080p * 500, _1080p * -540, _1080p * 540 )
	self:addElement( CharacterRotator )
	self.CharacterRotator = CharacterRotator
	
	local SkinsButton = nil
	
	SkinsButton = MenuBuilder.BuildRegisteredType( "ButtonMedium", {
		controllerIndex = f1_local1
	} )
	SkinsButton.id = "SkinsButton"
	SkinsButton:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 88, _1080p * 292, _1080p * -324, _1080p * -120 )
	self:addElement( SkinsButton )
	self.SkinsButton = SkinsButton
	
	local QuipsButton = nil
	
	QuipsButton = MenuBuilder.BuildRegisteredType( "ButtonMedium", {
		controllerIndex = f1_local1
	} )
	QuipsButton.id = "QuipsButton"
	QuipsButton:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 316, _1080p * 520, _1080p * -324, _1080p * -120 )
	self:addElement( QuipsButton )
	self.QuipsButton = QuipsButton
	
	local ExecutionsButton = nil
	
	ExecutionsButton = MenuBuilder.BuildRegisteredType( "ButtonMedium", {
		controllerIndex = f1_local1
	} )
	ExecutionsButton.id = "ExecutionsButton"
	ExecutionsButton:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 548, _1080p * 752, _1080p * -324, _1080p * -120 )
	self:addElement( ExecutionsButton )
	self.ExecutionsButton = ExecutionsButton
	
	local CustomizationCategories = nil
	
	CustomizationCategories = LUI.UIHorizontalList.new( {
		controller = f1_local1,
		direction = LUI.DIRECTION.horizontal,
		horizontalAlignment = LUI.Alignment.Left
	} )
	CustomizationCategories.id = "CustomizationCategories"
	CustomizationCategories:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 88, _1080p * 752, _1080p * -324, _1080p * -120 )
	self:addElement( CustomizationCategories )
	self.CustomizationCategories = CustomizationCategories
	
	local ItemDetails = nil
	
	ItemDetails = MenuBuilder.BuildRegisteredType( "ItemDetails", {
		controllerIndex = f1_local1
	} )
	ItemDetails.id = "ItemDetails"
	ItemDetails:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 88, _1080p * 776, _1080p * -628.13, _1080p * -400.13 )
	self:addElement( ItemDetails )
	self.ItemDetails = ItemDetails
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "OperatorCustomization", OperatorCustomization )
LockTable( _M )
