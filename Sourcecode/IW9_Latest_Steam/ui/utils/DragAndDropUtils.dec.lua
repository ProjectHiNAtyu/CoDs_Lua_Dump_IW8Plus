-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:48
DragAndDrop = DragAndDrop or {}
DragAndDrop.TargetStates = {
	ElementOverlapsTarget = BitwiseOperators.lshift( 1, 0 ),
	ElementInsideTarget = BitwiseOperators.lshift( 1, 1 ),
	MovePointInsideTarget = BitwiseOperators.lshift( 1, 2 ),
	Invalid = BitwiseOperators.lshift( 1, 3 )
}
local f0_local0 = function ( f15_arg0, f15_arg1, f15_arg2 )
	local f15_local0 = f15_arg0._dragAndDrop
	if not f15_local0 or not DragAndDrop.CanDrag( f15_local0 ) then
		return 
	elseif not f15_local0.initialUnitsX or not f15_local0.initialUnitsY then
		return 
	end
	local f15_local1 = f15_local0.options
	f15_local0.currentUnitsX = f15_arg1
	f15_local0.currentUnitsY = f15_arg2
	local f15_local2 = f15_local0.currentUnitsX - f15_local0.initialUnitsX
	local f15_local3 = f15_local0.currentUnitsY - f15_local0.initialUnitsY
	if not f15_local0.inProgress then
		if math.abs( f15_local2 ) < (f15_local1.minUnitsMovementThresholdX or f15_local1.minUnitsMovementThreshold) and math.abs( f15_local3 ) < (f15_local1.minUnitsMovementThresholdY or f15_local1.minUnitsMovementThreshold) then
			return 
		end
		local f15_local4 = f15_local1.getDragDummyFunction and f15_local1.getDragDummyFunction() or f15_arg0
		local f15_local5
		if f15_local1.useDummyInitialAnchorsAndPos then
			f15_local5 = f15_local4:GetAnchorsAndPosition()
			if not f15_local5 then
			
			else
				f15_local0.initialAnchorsAndPos = f15_local5
				if f15_local1.gridAnchorsAndPos then
					f15_local0.initialAnchorsAndPos.leftAnchor = f15_local1.gridAnchorsAndPos.leftAnchor
					f15_local0.initialAnchorsAndPos.rightAnchor = f15_local1.gridAnchorsAndPos.rightAnchor
					f15_local0.initialAnchorsAndPos.left = f15_local0.initialAnchorsAndPos.left + f15_local1.gridAnchorsAndPos.left
					f15_local0.initialAnchorsAndPos.right = f15_local0.initialAnchorsAndPos.right + f15_local1.gridAnchorsAndPos.right
					f15_local0.initialAnchorsAndPos.top = f15_local0.initialAnchorsAndPos.top + f15_local1.gridAnchorsAndPos.top
					f15_local0.initialAnchorsAndPos.bottom = f15_local0.initialAnchorsAndPos.bottom + f15_local1.gridAnchorsAndPos.bottom
				end
				f15_local0.draggedElement = f15_local4
				f15_local0.inProgress = true
				f15_arg0:processEventNoDispatch( {
					name = "drag_and_drop_begin"
				} )
			end
		end
		f15_local5 = f15_arg0:GetAnchorsAndPosition()
	end
	local f15_local6 = f15_local0.draggedElement
	local f15_local7 = f15_local1.maxUnitsMovementTable
	if f15_local7 then
		if f15_local7.left then
			f15_local2 = math.max( -f15_local7.left, f15_local2 )
		end
		if f15_local7.right then
			f15_local2 = math.min( f15_local2, f15_local7.right )
		end
		if f15_local7.top then
			f15_local3 = math.max( -f15_local7.top, f15_local3 )
		end
		if f15_local7.bottom then
			f15_local3 = math.min( f15_local3, f15_local7.bottom )
		end
	end
	local f15_local4 = f15_local0.initialAnchorsAndPos
	f15_local6:SetAnchorsAndPosition( f15_local4.leftAnchor, f15_local4.rightAnchor, f15_local4.topAnchor, f15_local4.bottomAnchor, f15_local4.left + f15_local2, f15_local4.right + f15_local2, f15_local4.top + f15_local3, f15_local4.bottom + f15_local3 )
end

local f0_local1 = function ( f14_arg0 )
	local f14_local0 = f14_arg0._dragAndDrop
	if not f14_local0 or not DragAndDrop.CanDrag( f14_local0 ) or not f14_local0.inProgress or not f14_local0.targets then
		return 
	end
	local f14_local1, f14_local2, f14_local3, f14_local4 = f14_local0.draggedElement:getCurrentGlobalRect()
	if not f14_local1 or not f14_local2 or not f14_local3 or not f14_local4 then
		return 
	end
	local f14_local5 = f14_local0.currentUnitsX
	local f14_local6 = f14_local0.currentUnitsY
	for f14_local15, f14_local16 in pairs( f14_local0.targets ) do
		local f14_local17 = f14_local16.state
		local f14_local14 = 0
		local f14_local18, f14_local19, f14_local20, f14_local21 = f14_local15:getCurrentGlobalRect()
		local f14_local10
		if f14_local18 >= f14_local1 or f14_local1 >= f14_local20 then
			f14_local10 = false
		else
			f14_local10 = true
		end
		local f14_local11
		if f14_local18 >= f14_local3 or f14_local3 >= f14_local20 then
			f14_local11 = false
		else
			f14_local11 = true
		end
		local f14_local12
		if f14_local19 >= f14_local2 or f14_local2 >= f14_local21 then
			f14_local12 = false
		else
			f14_local12 = true
		end
		local f14_local13
		if f14_local19 >= f14_local4 or f14_local4 >= f14_local21 then
			f14_local13 = false
		else
			f14_local13 = true
		end
		if f14_local10 and f14_local11 and f14_local12 and f14_local13 then
			f14_local14 = DragAndDrop.TargetStates.ElementInsideTarget
		elseif (f14_local10 or f14_local11) and (f14_local12 or f14_local13) then
			f14_local14 = DragAndDrop.TargetStates.ElementOverlapsTarget
		end
		if f14_local18 < f14_local5 and f14_local5 < f14_local20 and f14_local19 < f14_local6 and f14_local6 < f14_local21 then
			f14_local14 = BitwiseOperators.bor( f14_local14, DragAndDrop.TargetStates.MovePointInsideTarget )
		end
		if f14_local14 ~= f14_local17 then
			f14_local0.targets[f14_local15].state = f14_local14
			f14_arg0:processEventNoDispatch( {
				name = "drag_and_drop_target_state",
				target = f14_local15,
				state = f14_local14
			} )
		end
	end
end

DragAndDrop.SetupForTouch = function ( f8_arg0, f8_arg1 )
	local f8_local0 = f8_arg0._dragAndDrop or {}
	local f8_local1
	if not f8_arg1 then
		f8_local1 = f8_arg1
	else
		f8_local1 = {}
	end
	f8_local0.options = f8_local1
	f8_local0.inProgress = false
	f8_local0.enabled = true
	f8_local0.isScrolling = false
	f8_arg0._dragAndDrop = f8_local0
	f8_arg0:registerEventHandler( "grid_scroll_begin", function ( element, event )
		element._dragAndDrop.isScrolling = true
	end )
	f8_arg0:registerEventHandler( "grid_scroll_end", function ( element, event )
		element._dragAndDrop.isScrolling = false
	end )
	if not f8_arg0._dragAndDrop.touchEventHandlersAdded then
		f8_local1 = CONDITIONS.IsMacWithMouse()
		local f8_local2 = f8_arg0
		local f8_local3 = f8_arg0.addEventHandler
		local f8_local4
		if f8_local1 then
			f8_local4 = "leftmousedown"
		else
			f8_local4 = "touchbegin"
		end
		f8_local3( f8_local2, f8_local4, function ( f11_arg0, f11_arg1 )
			local f11_local0 = f11_arg0._dragAndDrop
			if not f11_local0 or not DragAndDrop.CanDrag( f11_local0 ) then
				return false
			else
				f11_local0.initialUnitsX, f11_local0.initialUnitsY = f11_arg1.root:GetInputEventUnits( f11_arg1 )
			end
		end )
		f8_local2 = f8_arg0
		f8_local3 = f8_arg0.addEventHandler
		if f8_local1 then
			f8_local4 = "mousemove"
		else
			f8_local4 = "touchmove"
		end
		f8_local3( f8_local2, f8_local4, function ( f10_arg0, f10_arg1 )
			local f10_local0 = f10_arg0._dragAndDrop
			if not f10_local0 or not DragAndDrop.CanDrag( f10_local0 ) then
				return false
			elseif not f10_local0.initialUnitsX or not f10_local0.initialUnitsY then
				return false
			end
			local f10_local1, f10_local2 = f10_arg1.root:GetInputEventUnits( f10_arg1 )
			f8_arg0( f10_arg0, f10_local1, f10_local2 )
			if f10_local0.inProgress then
				f8_arg0( f10_arg0 )
				if f8_arg0.inProgressCallback then
					f8_arg0.inProgressCallback( f10_arg0, f10_arg0._dragAndDropDummy, f10_arg1 )
				end
			end
			return f10_local0.inProgress
		end )
		f8_local2 = f8_arg0
		f8_local3 = f8_arg0.addEventHandler
		if f8_local1 then
			f8_local4 = "leftmouseup"
		else
			f8_local4 = "touchend"
		end
		f8_local3( f8_local2, f8_local4, function ( f9_arg0, f9_arg1 )
			local f9_local0 = f9_arg0._dragAndDrop
			if not f9_local0 or not f9_local0.enabled or not f9_local0.inProgress then
				return false
			else
				DragAndDrop.EndInProgress( f9_arg0, f9_arg1.x, f9_arg1.y )
				return true
			end
		end )
		f8_arg0._dragAndDrop.touchEventHandlersAdded = true
	end
end

DragAndDrop.AddTarget = function ( f7_arg0, f7_arg1 )
	f7_arg0._dragAndDrop = f7_arg0._dragAndDrop or {}
	f7_arg0._dragAndDrop.targets = f7_arg0._dragAndDrop.targets or {}
	if not f7_arg0._dragAndDrop.targets[f7_arg1] then
		f7_arg0._dragAndDrop.targets[f7_arg1] = {}
	end
end

DragAndDrop.RemoveTarget = function ( f6_arg0, f6_arg1 )
	if f6_arg0._dragAndDrop and f6_arg0._dragAndDrop.targets then
		f6_arg0._dragAndDrop.targets[f6_arg1] = nil
	end
end

DragAndDrop.GetTargetState = function ( f5_arg0, f5_arg1 )
	if f5_arg0._dragAndDrop and f5_arg0._dragAndDrop.targets and f5_arg0._dragAndDrop.targets[f5_arg1] then
		return f5_arg0._dragAndDrop.targets[f5_arg1].state
	else
		
	end
end

DragAndDrop.EndInProgress = function ( f4_arg0, f4_arg1, f4_arg2 )
	local f4_local0 = f4_arg0._dragAndDrop
	if f4_local0 then
		f4_local0.initialUnitsX = nil
		f4_local0.initialUnitsY = nil
	end
	if not f4_local0 or not f4_local0.enabled or not f4_local0.inProgress then
		return 
	elseif f4_local0.options.restoreInitialPosAtEnd then
		local f4_local1 = f4_local0.draggedElement.initialAnchorsAndPos
		f4_local0.draggedElement:SetAnchorsAndPosition( f4_local1.leftAnchor, f4_local1.rightAnchor, f4_local1.topAnchor, f4_local1.bottomAnchor, f4_local1.left, f4_local1.right, f4_local1.top, f4_local1.bottom )
	end
	f4_local0.inProgress = false
	local f4_local1 = {
		name = "drag_and_drop_end"
	}
	if f4_arg1 and f4_arg2 then
		f4_local1.endPosX = f4_arg1
		f4_local1.endPosY = f4_arg2
	end
	f4_arg0:processEventNoDispatch( f4_local1 )
end

DragAndDrop.Enable = function ( f3_arg0 )
	if f3_arg0._dragAndDrop then
		f3_arg0._dragAndDrop.enabled = true
	end
end

DragAndDrop.Disable = function ( f2_arg0 )
	if f2_arg0._dragAndDrop then
		DragAndDrop.EndInProgress( f2_arg0 )
		f2_arg0._dragAndDrop.enabled = false
	end
end

DragAndDrop.CanDrag = function ( f1_arg0 )
	local f1_local0 = f1_arg0.enabled
	if f1_local0 then
		f1_local0 = not f1_arg0.isScrolling
	end
	return f1_local0
end

