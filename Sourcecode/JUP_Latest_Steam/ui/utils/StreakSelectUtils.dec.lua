-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:02
StreakSelectUtils = StreakSelectUtils or {}
local f0_local0 = "button_right_trigger"
StreakSelectUtils.EquippedStreaks = {}
StreakSelectUtils.EQUIP_TYPE = {
	REPLACE = 2,
	EQUIP = 0,
	TOGGLE = 1,
	ADD = 3
}
if Engine[0x12586A3F4FB490E]() then
	LUI.FlowManager.RegisterFenceGroup( "StreakSelect", {
		nil,
		"StatsGroup"
	} )
end
local f0_local1 = function ( f74_arg0, f74_arg1 )
	local f74_local0 = nil
	local f74_local1 = STREAK.GetBundleByRef( f74_arg1.data.ref )
	f74_local0 = f74_local1[0xE19C41B5A516BD9]
	f74_arg0.Showcase:SetAlpha( 0 )
	if CONDITIONS.StreaksTabletEnabled() then
		f74_arg0[0x5AAE984100A52B8]:UpdateMaterial( f74_local0 )
	else
		local f74_local2 = 150
		local f74_local3 = f74_local2 + 50
		local f74_local4 = f74_arg0.FadeCover:Wait( f74_local2 )
		f74_local4.onComplete = function ()
			local f75_local0 = f74_arg0.scaleAdjust or 0
			f74_arg0.FrontEndMenuBackground:setImage( RegisterMaterial( f74_arg0 ) )
			f74_arg0.FrontEndMenuBackground:SetScale( f75_local0, 0 )
			f74_arg0.FrontEndMenuBackground:SetScale( f75_local0 + 0.015, 2500, LUI.EASING.outQuadratic )
			f74_arg0.Vignette:SetScale( f75_local0, 0 )
			f74_arg0.Vignette:SetScale( f75_local0 + 0.015, 2500, LUI.EASING.outQuadratic )
			f74_arg0.FadeCover:SetAlpha( 0, f74_arg0, LUI.EASING.outQuadratic )
		end
		
	end
end

local f0_local2 = function ( f73_arg0, f73_arg1, f73_arg2 )
	local f73_local0 = STREAK.GetStreakDetails( f73_arg1, f73_arg2.data.ref )
	if f73_arg0.UpdateDetailsDataSources then
		f73_arg0:UpdateDetailsDataSources( f73_arg1, f73_local0 )
	end
	if f73_arg2._isUnequipped then
		f73_local0.isEquipped = not f73_arg2._isUnequipped
	end
	f73_arg0.ItemDetails:UpdateDetails( f73_local0 )
end

local f0_local3 = function ( f72_arg0 )
	if f72_arg0.buttonOver then
		f72_arg0:dispatchEventToChildren( {
			name = "update_cost_type",
			showKills = f72_arg0.showKills,
			cost = f72_arg0.showKills and f72_arg0.buttonOver.data.kills or f72_arg0.buttonOver.data.scoreCost
		} )
	end
end

local f0_local4 = function ( f71_arg0, f71_arg1, f71_arg2, f71_arg3 )
	if f71_arg3 then
		if f71_arg2 then
			ACTIONS.AnimateSequence( f71_arg0, "SwapOn" )
			ACTIONS.AnimateSequence( f71_arg1, "SwapIconOn" )
			f71_arg1:SetPrimaryPromptText( 0xAA4B3526A3C0AC4, false )
		else
			ACTIONS.AnimateSequence( f71_arg0, "SwapOff" )
		end
	end
end

local f0_local5 = function ( f69_arg0, f69_arg1 )
	if not Engine[0x12586A3F4FB490E]() and not CONDITIONS.IsMobileOrMobileSim() then
		f69_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			clickable = true,
			priority = 5,
			side = "left",
			kbmTooltipPromptOverload = "button_dismiss_pause_menu",
			button_ref = "button_start",
			helper_text = Engine[0xED84C33EC5F01EA]( 0xEF0F75B0AB08E35 )
		} )
		f69_arg0:AddGamepadEventCallback( "button_start", function ( f70_arg0, f70_arg1 )
			if Engine[0x74423E76DECE3E4]() then
				ACTIONS.ResumeGame( f69_arg0 )
			end
			LUI.FlowManager.RequestCloseAllMenus()
			return true
		end )
		MenuUtils.AddDismissPauseMenuKBMHandler( f69_arg0 )
	end
end

local f0_local6 = function ( f68_arg0, f68_arg1, f68_arg2, f68_arg3 )
	f68_arg1.swapVisible = false
	if f68_arg1.selectedButtons then
		for f68_local0 = 1, #f68_arg1.selectedButtons, 1 do
			local f68_local3 = f68_arg1.selectedButtons[f68_local0]
			if f68_local3 and f68_local3.equipped then
				local f68_local4 = f68_local3.data.kills == f68_arg2.data.kills
				local f68_local5 = f68_local3.data.ref == f68_arg2.data.ref
				local f68_local6 = true
				local f68_local7
				if f68_arg0 then
					f68_local7 = f68_arg0
				elseif f68_local4 then
					f68_local7 = f68_local4
				elseif not f68_local5 then
					f68_local7 = f68_arg2.data.isUnlocked
				else
					f68_local7 = false
				end
				if f68_local7 then
					f68_arg1.swapVisible = true
				end
				f0_local0( f68_local3, f68_arg2, f68_local7, f68_local6, false )
				if f68_arg1.StreakEquippedStack then
					f68_arg1.StreakEquippedStack:UpdateSwapPulse( f68_local3.data.ref, f68_local7 )
				end
			end
		end
	end
	f0_local0( f68_arg1, f68_arg3 )
end

local f0_local7 = function ( f67_arg0 )
	if CONDITIONS.InFrontend() then
		local f67_local0 = 0
		for f67_local4, f67_local5 in ipairs( StreakSelectUtils.EquippedStreaks ) do
			if f67_local5.isActive then
				f67_local0 = f67_local0 + 1
			end
		end
		if CONDITIONS.IsThirdGameMode() or f67_local0 == f67_arg0._maxEquipStreaks then
			StreakSelectUtils.SaveEquipStreaksToPlayerData( f67_arg0, f67_arg0._controllerIndex )
			if f67_arg0.DeselectWarning then
				f67_arg0.DeselectWarning:SetAlpha( 0 )
			end
			if f67_arg0.StreakEquippedStack then
				ACTIONS.AnimateSequence( f67_arg0.StreakEquippedStack, "EquippedUnselected" )
			end
		end
		if f67_arg0.StreakEquippedStack then
			f67_arg0.StreakEquippedStack:Update( StreakSelectUtils.EquippedStreaks, not f67_arg0.showKills )
		end
	end
end

local f0_local8 = function ( f66_arg0, f66_arg1 )
	f0_local0( false, f66_arg0, f66_arg0.buttonOver )
	f66_arg0.selectedButtons = {}
	for f66_local3, f66_local4 in ipairs( StreakSelectUtils.EquippedStreaks ) do
		f66_local4.isActive = false
	end
	f66_arg0.buttonOver:dispatchEventToCurrentMenu( {
		name = "update_buttons"
	} )
	if f66_arg0.buttonOver.data.isUnlocked then
		f66_arg0.buttonOver:SetPrimaryPromptText( 0xCA07A93FADF9E95, false )
	end
	f0_local0( f66_arg0 )
	f0_local0( f66_arg0, f66_arg1 )
	if f66_arg0.DeselectWarning then
		f66_arg0.DeselectWarning:SetAlpha( 1 )
	end
	if f66_arg0.StreakEquippedStack then
		f66_arg0.StreakEquippedStack:DeselectAll()
	end
end

local f0_local9 = function ( f64_arg0, f64_arg1 )
	f64_arg0._currentFocusGridIndex = 1
	f64_arg0._previousFocusGridIndex = 1
	f64_arg0.CategoryGrid:addEventHandler( "gamepad_button", function ( f65_arg0, f65_arg1 )
		if not f65_arg1.down then
			return 
		elseif f65_arg1.button == "secondary" then
			ACTIONS.LeaveMenu( f65_arg0 )
		end
		if f65_arg1.button == "left_stick" then
			if LUI.IsLastInputKeyboardMouse( f64_arg0 ) then
				if f65_arg1.qualifier then
					Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
				end
				f64_arg0( f64_arg0, f65_arg1.controller )
			else
				return false
			end
		end
		if f65_arg1.button == "right_trigger" and not GL_HACK.IsInfluencerBuild() and CONDITIONS.ShowScorestreakValues() and not CONDITIONS.IsT10() and not CONDITIONS.IsLeaguePlay() then
			StreakSelectUtils.ToggleStreakLabels( f64_arg0, f64_arg0, false )
			if f65_arg1.qualifier then
				Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
			end
		end
		local f65_local0 = f64_arg0.CategoryGrid:GetWidgetAtIndex( f64_arg0._currentFocusGridIndex )
		if not f65_local0 or not f65_local0.StreakGrid then
			return 
		end
		local f65_local1 = f65_local0.StreakGrid
		local f65_local2 = f64_arg0.CategoryGrid
		if f65_arg1.button == "left" then
			if f65_local1:GetFocusPosition( LUI.DIRECTION.horizontal ) == 0 then
				local f65_local3 = 0
				if f64_arg0._currentFocusGridIndex <= f65_local3 then
					return 
				elseif f65_local3 < f64_arg0._currentFocusGridIndex then
					local f65_local4 = f64_arg0._currentFocusGridIndex - 1
					local f65_local5 = f65_local2:GetWidgetAtIndex( f65_local4 )
					if f65_local5 then
						local f65_local6 = f65_local5.StreakGrid
						f64_arg0._currentFocusedSubGrid:processEvent( {
							name = "request_inactive"
						} )
						f64_arg0._currentFocusedSubGrid = f65_local6
						StreakSelectUtils.SetCurrentGridIndex( f64_arg0, f65_local4 )
						f65_local2:SetFocusedPosition( {
							y = 0,
							x = f65_local4
						}, true, true )
						f65_local6:SetFocusedPosition( {
							y = 0,
							x = f65_local6:GetNumColumns() - 1
						}, true, true )
					end
				end
				return true
			end
			return f65_local1:GamepadButton( f65_arg1 )
		elseif f65_arg1.button == "right" then
			if f65_local1:GetFocusPosition( LUI.DIRECTION.horizontal ) == f65_local1:GetNumColumns() - 1 then
				local f65_local3 = f65_local2:GetNumChildren() - 1
				if f65_local3 <= f64_arg0._currentFocusGridIndex then
					return 
				elseif f64_arg0._currentFocusGridIndex < f65_local3 then
					local f65_local4 = f64_arg0._currentFocusGridIndex + 1
					local f65_local5 = f64_arg0.CategoryGrid:GetWidgetAtIndex( f65_local4 )
					f65_local5 = f65_local5.StreakGrid
					f64_arg0._currentFocusedSubGrid:processEvent( {
						name = "request_inactive"
					} )
					f64_arg0._currentFocusedSubGrid = f65_local5
					StreakSelectUtils.SetCurrentGridIndex( f64_arg0, f65_local4 )
					f65_local2:SetFocusedPosition( {
						y = 0,
						x = f65_local4
					}, true, true )
					f65_local5:SetFocusedPosition( {
						x = 0,
						y = 0
					}, true, true )
				end
				return true
			end
			return f65_local1:GamepadButton( f65_arg1 )
		end
		return f65_local1:GamepadButton( f65_arg1 )
	end )
end

StreakSelectUtils.SaveEquipStreaksToPlayerData = function ( f63_arg0, f63_arg1 )
	local f63_local0 = LOADOUT.GetLoadoutSquadMember( f63_arg1 )
	local f63_local1 = 0
	for f63_local5, f63_local6 in ipairs( StreakSelectUtils.EquippedStreaks ) do
		if f63_local6.isActive then
			f63_local0.killstreakSetups[f63_local1].killstreak:set( f63_local6.ref )
			f63_local0.killstreakSetups[f63_local1].blueprintIndex:set( f63_local6.blueprintIndex and f63_local6.blueprintIndex or 0 )
			f63_local1 = f63_local1 + 1
		end
	end
	ACTIONS.UploadStats( f63_arg0, f63_arg1 )
end

StreakSelectUtils.ToggleStreakLabels = function ( f62_arg0, f62_arg1, f62_arg2 )
	if not f62_arg2 then
		f62_arg0.showKills = not f62_arg0.showKills
		local f62_local0 = LOADOUT.GetLoadoutSquadMember( f62_arg1 )
		f62_local0 = f62_local0.scoreStreak
		if f62_local0:get() == 0 then
			f62_local0:set( 1 )
		else
			f62_local0:set( 0 )
		end
	end
	if CONDITIONS.IsMobileOrMobileSim() then
		local f62_local0 = STREAK.GetStreaksData( f62_arg1 )
		StreakSelectUtils.SetFirstStreakFromCostValue( f62_local0 )
		f62_arg0.StreakGrid:SetNumChildren( #f62_local0 )
		f62_arg0.StreakGrid:RefreshContent()
	else
		local f62_local0 = f62_arg0.HelperBar
		if f62_local0 then
			f62_local0.ButtonHelperText:TogglePromptByButtonRef( f0_local0, not f62_arg0.showKills, false )
		end
		if f62_arg0.streakCategories and not Table.IsEmpty( f62_arg0.streakCategories ) then
			for f62_local4, f62_local5 in pairs( f62_arg0.streakCategories ) do
				f62_local5.Text:setText( STREAK.GetStreakCategoryTextFromStreakData( f62_local5.data, f62_arg0.showKills ) )
			end
		end
	end
	f0_local0( f62_arg0, f62_arg1 )
	if Engine[0x12586A3F4FB490E]() then
		f0_local0( f62_arg0 )
	end
	if f62_arg0.StreakEquippedStack then
		f62_arg0.StreakEquippedStack:ShowKills( f62_arg0.showKills )
	end
end

local f0_local10 = function ( f59_arg0, f59_arg1 )
	local f59_local0 = false
	f59_arg0._currentFocusedSubGrid = nil
	for f59_local1 = 0, f59_arg0.CategoryGrid:GetNumChildren() - 1, 1 do
		local f59_local4 = f59_arg0.CategoryGrid:GetWidgetAtIndex( f59_local1 )
		f59_local4.StreakGrid:addEventHandler( "mouseenter", function ( f61_arg0, f61_arg1 )
			if not f59_arg0._currentFocusedSubGrid then
				local f61_local0 = f59_arg0.CategoryGrid:GetWidgetAtIndex( f59_arg0._previousFocusGridIndex )
				f59_arg0._currentFocusedSubGrid = f61_local0 and f61_local0.StreakGrid
			end
			if f61_arg0 ~= f59_arg0._currentFocusedSubGrid and f59_arg0._currentFocusedSubGrid then
				f59_arg0._currentFocusedSubGrid:processEvent( {
					name = "request_inactive"
				} )
				f59_arg0._currentFocusedSubGrid = f61_arg0
			end
			StreakSelectUtils.SetCurrentGridIndex( f59_arg0, f59_arg0 )
		end )
	end
	f59_arg0.CategoryGrid:addEventHandler( "restore_focus", function ( f60_arg0, f60_arg1 )
		Engine[0x685AE31DEDA30A4]( CONDITIONS.IsMultiplayer( f60_arg0 ) and "loadout_showcase_field_upgrade" )
		f60_arg0:processEvent( {
			name = "gain_focus",
			controller = f59_arg0
		} )
		return true
	end )
end

local f0_local11 = function ( f56_arg0, f56_arg1, f56_arg2, f56_arg3 )
	local f56_local0 = nil
	local f56_local1 = {}
	local f56_local2 = {}
	local f56_local3 = 0
	local f56_local4 = {}
	if not f56_arg0._streakEarnType then
		f56_arg0._streakEarnType = GAMEMODE_SCRIPTBUNDLE_UTILS.StreakEarnType()
	end
	local f56_local5 = function ( f58_arg0, f58_arg1 )
		if f56_arg0._streakEarnType == STREAK[0x1AB95B4EB9070FF][0x10E63FBE7F624F5] then
			return f58_arg0.scoreCost == f58_arg1
		else
			return f58_arg0.kills == f58_arg1
		end
	end
	
	local f56_local6 = function ( f57_arg0 )
		if f56_arg0._streakEarnType == STREAK[0x1AB95B4EB9070FF][0x10E63FBE7F624F5] then
			return f57_arg0.scoreCost or 0
		else
			return f57_arg0.kills or 0
		end
	end
	
	for f56_local7 = 1, #f56_arg1, 1 do
		if not f56_local0 or not f56_local5( f56_arg1[f56_local7], f56_local0 ) then
			f56_local3 = f56_local3 + 1
			f56_local0 = f56_local6( f56_arg1[f56_local7] )
			f56_local4[f56_local3] = {
				kills = f56_arg1[f56_local7].kills,
				scoreCost = f56_arg1[f56_local7].scoreCost
			}
			f56_local1[f56_local3] = 1
			f56_local2[f56_local3] = {}
			f56_local2[f56_local3][1] = f56_local7
		else
			f56_local1[f56_local3] = f56_local1[f56_local3] + 1
			f56_local2[f56_local3][f56_local1[f56_local3]] = f56_local7
		end
	end
	f56_arg0.streakCategories = {}
	for f56_local10, f56_local11 in ipairs( f56_local4 ) do
		if not f56_arg0._maxKills then
			f56_arg0._maxKills = f56_local11.kills
		else
			f56_arg0._maxKills = math.max( f56_arg0._maxKills, f56_local11.kills )
		end
		if not f56_arg0._minKills then
			f56_arg0._minKills = f56_local11.kills
		else
			f56_arg0._minKills = math.min( f56_arg0._minKills, f56_local11.kills )
		end
		f56_arg0.CategoryGrid:AddWidget( "StreakCategory", {
			adjustContentToFit = true,
			refreshGrid = false,
			widgetOptions = {
				amount = f56_local1[f56_local10],
				categoryData = f56_local11,
				streakIndices = f56_local2[f56_local10],
				streakTable = f56_arg1,
				streakPlayerData = f56_arg2,
				menu = f56_arg0,
				controllerIndex = f56_arg3
			}
		} )
	end
	f56_arg0.CategoryGrid:RefreshGrid()
	f0_local0( f56_arg0, f56_arg3 )
	f0_local0( f56_arg0, f56_arg3 )
end

local f0_local12 = function ( f55_arg0, f55_arg1 )
	if f55_arg0.CategoryGrid then
		f55_arg0.CategoryGrid:RemoveAllWidgets()
		f0_local0( f55_arg0, STREAK.GetStreaksData( f55_arg1 ), STREAK.GetStreakPlayerData( f55_arg1 ), f55_arg1 )
	end
end

local f0_local13 = function ( f54_arg0, f54_arg1 )
	LUI.ToastManager.CreateToast( f54_arg0, LUI.ToastManager.StandardEmphasisToast( CONDITIONS.IsT10() and Engine[0xED84C33EC5F01EA]( 0x6F493C97330DEB7 ) or Engine[0xED84C33EC5F01EA]( 0x57B72B78A480AAB ), Engine[0xED84C33EC5F01EA]( f54_arg1 ), LUI.ToastManager.ToastNotificationType.Gear ) )
end

local f0_local14 = function ( f53_arg0, f53_arg1 )
	local f53_local0 = {
		x = 0,
		y = 0
	}
	f53_arg0.CategoryGrid:SetFocusedPosition( f53_local0, true )
	StreakSelectUtils.SetCurrentGridIndex( f53_arg0, f53_local0.x )
	local f53_local1 = f53_arg0.CategoryGrid:GetWidgetAtIndex( f53_local0.x )
	f53_local1 = f53_local1.StreakGrid
	f53_local1:SetFocusedPosition( f53_local0, true )
	f53_arg0._currentFocusedSubGrid = f53_local1
end

local f0_local15 = function ( f52_arg0, f52_arg1, f52_arg2, f52_arg3 )
	STREAK.SortStreaksByEarnType( StreakSelectUtils.EquippedStreaks, f52_arg0._streakEarnType )
	f52_arg0:dispatchEventToCurrentMenu( {
		name = "update_buttons"
	} )
	if MLG.IsCDLActive( f52_arg1 ) and Restrictions.IsKillstreakRestricted( f52_arg2.ref ) then
		ACTIONS.AnimateSequence( f52_arg0, "CDLEquipped" )
	end
	if CONDITIONS.IsMobileOrMobileSim() then
		f52_arg0.EquippedStreaksGrid:RefreshContent()
	end
	f0_local0( f52_arg0, f52_arg1 )
	f0_local0( f52_arg0 )
	if f52_arg3 then
		f0_local0( f52_arg0, f52_arg1 )
	end
end

StreakSelectUtils.SetCurrentSelectedGrid = function ( f51_arg0, f51_arg1 )
	f51_arg0._previousFocusGridIndex = f51_arg0._currentFocusGridIndex
	f51_arg0._currentFocusGridIndex = f51_arg1 - 1
end

StreakSelectUtils.SetCurrentGridIndex = function ( f50_arg0, f50_arg1 )
	f50_arg0._previousFocusGridIndex = f50_arg0._currentFocusGridIndex
	f50_arg0._currentFocusGridIndex = f50_arg1
end

StreakSelectUtils.SetupActiveState = function ( f49_arg0, f49_arg1, f49_arg2, f49_arg3 )
	for f49_local0 = 0, f49_arg2:GetNumChildren() - 1, 1 do
		local f49_local3 = f49_arg2:GetElementAtPosition( f49_local0, 0 )
		if f49_local3 and f49_local3.data.isActive then
			f49_arg2:SetDefaultFocus( {
				y = 0,
				x = f49_local0
			} )
			f49_arg2:TouchMouseSetActiveToDefaultFocusMenuCreate( f49_arg1 )
			f49_arg0._currentFocusedSubGrid = f49_arg2
			return true
		end
	end
end

StreakSelectUtils.InitEquippedStreaksAnim = function ( f48_arg0 )
	ACTIONS.AnimateSequence( f48_arg0, STREAK.GetStreaksStackAnimation( STREAK.GetMaxEquipStreaks() ) )
end

StreakSelectUtils.GetStreakIsEquipped = function ( f47_arg0 )
	local f47_local0 = GAMEMODE_SCRIPTBUNDLE_UTILS.StreakEarnType()
	local f47_local1 = STREAK.GetMaxEquipStreaks()
	local f47_local2 = false
	local f47_local3 = false
	for f47_local7, f47_local8 in ipairs( StreakSelectUtils.EquippedStreaks ) do
		if f47_local8.ref == f47_arg0.ref then
			f47_local2 = true
		end
		if STREAK.IsInSameStreakGroup( f47_local0, f47_local8, f47_arg0 ) then
		
		elseif not f47_local2 then
			if f47_local3 then
				break
			end
		end
		f47_local3 = true
	end
	return f47_local2, f47_local3
end

StreakSelectUtils.GetStreakEquipSlot = function ( f46_arg0 )
	if CoD.IsDMZMatch() then
		return 1
	end
	local f46_local0 = GAMEMODE_SCRIPTBUNDLE_UTILS.StreakEarnType()
	local f46_local1 = STREAK.GetMaxEquipStreaks()
	local f46_local2, f46_local3 = StreakSelectUtils.GetStreakIsEquipped( f46_arg0 )
	local f46_local4 = nil
	for f46_local5 = #StreakSelectUtils.EquippedStreaks, 1, -1 do
		local f46_local8 = StreakSelectUtils.EquippedStreaks[f46_local5]
		local f46_local9 = STREAK.IsInSameStreakGroup( f46_local0, f46_local8, f46_arg0 )
		if f46_local8.isActive then
			if f46_local8.ref == f46_arg0.ref then
				return f46_local5
			elseif f46_local9 then
				return f46_local5
			end
		end
		if f46_local8.ref == f46_arg0.ref then
			return f46_local5
		elseif f46_local9 and not f46_local2 then
			return f46_local5
		elseif not f46_local9 and not f46_local3 then
			return f46_local5
		end
	end
	if f46_local1 > #StreakSelectUtils.EquippedStreaks then
		return #StreakSelectUtils.EquippedStreaks + 1
	end
	return nil
end

StreakSelectUtils.GetStreakEquipType = function ( f45_arg0 )
	if CoD.IsDMZMatch() then
		return StreakSelectUtils.EQUIP_TYPE.EQUIP
	end
	local f45_local0 = GAMEMODE_SCRIPTBUNDLE_UTILS.StreakEarnType()
	local f45_local1 = STREAK.GetMaxEquipStreaks()
	local f45_local2, f45_local3 = StreakSelectUtils.GetStreakIsEquipped( f45_arg0 )
	for f45_local4 = #StreakSelectUtils.EquippedStreaks, 1, -1 do
		local f45_local7 = StreakSelectUtils.EquippedStreaks[f45_local4]
		local f45_local8 = STREAK.IsInSameStreakGroup( f45_local0, f45_local7, f45_arg0 )
		if f45_local7.isActive then
			if f45_local7.ref == f45_arg0.ref then
				return StreakSelectUtils.EQUIP_TYPE.TOGGLE
			elseif f45_local8 then
				return StreakSelectUtils.EQUIP_TYPE.EQUIP
			end
		end
		if f45_local7.ref == f45_arg0.ref then
			return StreakSelectUtils.EQUIP_TYPE.TOGGLE
		elseif f45_local8 and not f45_local2 then
			return StreakSelectUtils.EQUIP_TYPE.EQUIP
		elseif not f45_local8 and not f45_local3 then
			return StreakSelectUtils.EQUIP_TYPE.EQUIP
		end
	end
	if f45_local1 > #StreakSelectUtils.EquippedStreaks then
		return StreakSelectUtils.EQUIP_TYPE.ADD
	end
	return StreakSelectUtils.EQUIP_TYPE.REPLACE
end

StreakSelectUtils.TryEquipStreak = function ( f44_arg0, f44_arg1, f44_arg2 )
	local f44_local0
	if f44_arg2 then
		f44_local0 = f44_arg2
	else
		f44_local0 = f44_arg2.ignoreToggles
	end
	local f44_local1 = GAMEMODE_SCRIPTBUNDLE_UTILS.StreakEarnType()
	if CoD.IsDMZMatch() then
		local f44_local2 = StreakSelectUtils.EquippedStreaks[1]
		if f44_local2 then
			f44_local2 = f44_arg1.ref ~= StreakSelectUtils.EquippedStreaks[1].ref
		end
		StreakSelectUtils.EquippedStreaks[1] = LUI.DeepCopy( f44_arg1 )
		StreakSelectUtils.EquippedStreaks[1].isActive = f44_local2
		return StreakSelectUtils.EQUIP_TYPE.EQUIP
	elseif f44_arg1.isUnlocked then
		local f44_local2 = StreakSelectUtils.GetStreakEquipSlot( f44_arg1 )
		local f44_local3 = StreakSelectUtils.GetStreakEquipType( f44_arg1 )
		if f44_local3 == StreakSelectUtils.EQUIP_TYPE.TOGGLE and f44_local0 ~= true then
			StreakSelectUtils.EquippedStreaks[f44_local2].isActive = not StreakSelectUtils.EquippedStreaks[f44_local2].isActive
		end
		if f44_local3 == StreakSelectUtils.EQUIP_TYPE.EQUIP then
			LOOT.SendDlogLootEquipped( f44_arg0, LOOT.itemTypes.STREAK, nil, nil, StreakSelectUtils.EquippedStreaks[f44_local2].ref, f44_arg1.ref )
			StreakSelectUtils.EquippedStreaks[f44_local2] = LUI.DeepCopy( f44_arg1 )
			StreakSelectUtils.EquippedStreaks[f44_local2].isActive = true
		end
		if f44_local3 == StreakSelectUtils.EQUIP_TYPE.ADD then
			local f44_local4 = #StreakSelectUtils.EquippedStreaks + 1
			StreakSelectUtils.EquippedStreaks[f44_local4] = LUI.DeepCopy( f44_arg1 )
			StreakSelectUtils.EquippedStreaks[f44_local4].isActive = true
		end
		if f44_local3 == StreakSelectUtils.EQUIP_TYPE.REPLACE then
			
		else
			
		end
		return f44_local3
	else
		return nil
	end
end

StreakSelectUtils.TryEquipSkin = function ( f43_arg0, f43_arg1 )
	for f43_local3, f43_local4 in ipairs( StreakSelectUtils.EquippedStreaks ) do
		if f43_local4.ref == f43_arg0 then
			StreakSelectUtils.EquippedStreaks[f43_local3].blueprintIndex = f43_arg1
		end
	end
end

StreakSelectUtils.RequestKillstreakReplacePopup = function ( f40_arg0, f40_arg1, f40_arg2 )
	if f40_arg2 then
		local f40_local0 = f40_arg2
	else
		local f40_local0 = f40_arg2.button
	end
	if f40_arg2 then
		local f40_local1 = f40_arg2
	else
		local f40_local1 = f40_arg2.doToast
	end
	local f40_local2
	if f40_arg2 then
		f40_local2 = f40_arg2
	else
		f40_local2 = f40_arg2.menu
	end
	if f40_arg2 then
		local f40_local3 = f40_arg2
	else
		local f40_local3 = f40_arg2.leaveMenu
	end
	if f40_arg2 then
		local f40_local4 = f40_arg2
	else
		local f40_local4 = f40_arg2.blueprintIndex
	end
	local f40_local5 = {
		streaks = StreakSelectUtils.EquippedStreaks,
		selection = f40_arg1,
		menu = f40_local2,
		maxEquipStreaks = STREAK.GetMaxEquipStreaks(),
		onReplace = function ( f42_arg0 )
			local f42_local0 = false
			for f42_local4, f42_local5 in ipairs( StreakSelectUtils.EquippedStreaks ) do
				if f42_local5.ref == f42_arg0 then
					LOOT.SendDlogLootEquipped( f40_arg0, LOOT.itemTypes.STREAK, nil, nil, f42_local5.ref, f40_arg0.ref )
					f42_local0 = StreakSelectUtils.EquippedStreaks[f42_local4].isRestricted
					StreakSelectUtils.EquippedStreaks[f42_local4] = LUI.DeepCopy( f40_arg0 )
					StreakSelectUtils.EquippedStreaks[f42_local4].isActive = true
					StreakSelectUtils.EquippedStreaks[f42_local4].blueprintIndex = f40_arg0 and f40_arg0 or 0
					break
				end
			end
			if f40_arg0 then
				ACTIONS.AnimateSequence( f40_arg0, "ShowGlow" )
			end
			if f40_arg0 then
				f40_arg0( f40_arg0, f40_arg0.name )
			end
			if f40_arg0 then
				f40_arg0( f40_arg0, f40_arg0, f40_arg0, f42_local0 )
			end
		end,
		onLeave = function ( f41_arg0 )
			if f40_arg0 and f40_arg0.parent then
				if not LUI.IsLastInputMouseNavigation( f40_arg0 ) then
					if f40_arg0 then
						f40_arg0.CategoryGrid:GainFocus( f41_arg0 )
					end
					f40_arg0.parent.StreakGrid:GainFocus( f41_arg0 )
				end
				f40_arg0.parent.StreakGrid:SetFocusedPosition( f40_arg0.position, true )
			end
			if f40_arg0 then
				StreakSelectUtils.SaveEquipStreaksToPlayerData( self, f40_arg0 )
				LUI.FlowManager.RequestLeaveMenu()
			end
		end
	}
	if f40_local2 then
		ACTIONS.AnimateSequence( f40_local2, "Hide" )
	end
	LUI.FlowManager.RequestPopupMenu( nil, "StreakReplacePopup", true, f40_arg0, false, f40_local5, nil, true, false )
end

StreakSelectUtils.AddSkinsInformation = function ( f39_arg0, f39_arg1 )
	if f39_arg0[0x700071878F4EF34] then
		return 
	else
		local self = nil
		self = LUI.UIHorizontalStackedLayout.new()
		f39_arg0[0x700071878F4EF34] = self
		self[0x8B72E07B55C3AC0] = "SkinsContainer"
		self:SetVisible( false )
		self:SetAnchorsAndPosition( 1, 0, 0, 1, -78, -5, 5, 31 )
		self:SetAlignment( LUI.Alignment.Right )
		self:SetVerticalAlignment( LUI.Alignment.Top )
		self:SetIgnoreInvisibleChildren( true )
		f39_arg0:addElement( self )
		self.NumberOfSkins = LUI.UIStyledText.new()
		self.NumberOfSkins[0x8B72E07B55C3AC0] = "SkinsContainer.NumberOfSkins"
		self[0xF183F825FCE0E6D]:SetVisible( false )
		self[0xF183F825FCE0E6D]:SetRGB( SWATCHES[0x2B125210C0B2BB1][0xF5C0139BA6F896C], 0 )
		self[0xF183F825FCE0E6D]:SetAlpha( 0.8, 0 )
		self[0xF183F825FCE0E6D]:setText( MarkLocalized( "6" ), 0 )
		self[0xF183F825FCE0E6D]:SetFont( FONTS.GetFont( FONTS.SecondaryRegular.File ) )
		self[0xF183F825FCE0E6D]:SetFontSize( 20 * _PT )
		self[0xF183F825FCE0E6D]:SetMinFontSize( 20 * _PT )
		self[0xF183F825FCE0E6D]:SetWordWrap( false )
		self[0xF183F825FCE0E6D]:SetAlignment( LUI.Alignment.Left )
		self[0xF183F825FCE0E6D]:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 24, 0, 24 )
		f39_arg0[0x700071878F4EF34][0xF183F825FCE0E6D] = self.NumberOfSkins
		f39_arg0[0xF183F825FCE0E6D] = self[0xF183F825FCE0E6D]
		self:addElement( self[0xF183F825FCE0E6D] )
		self.SkinsIcon = LUI.UIImage.new()
		self.SkinsIcon[0x8B72E07B55C3AC0] = "SkinsContainer.SkinsIcon"
		self[0xF426945ED61E79C]:SetVisible( false )
		self[0xF426945ED61E79C]:SetRGB( SWATCHES[0x2B125210C0B2BB1][0xF5C0139BA6F896C], 0 )
		self[0xF426945ED61E79C]:SetAlpha( 0.8, 0 )
		self[0xF426945ED61E79C]:setImage( RegisterMaterial( 0x9E47D9025C3384 ), 0 )
		self[0xF426945ED61E79C]:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 22, 0, 22 )
		f39_arg0[0x700071878F4EF34][0xF426945ED61E79C] = self.SkinsIcon
		f39_arg0[0xF426945ED61E79C] = self[0xF426945ED61E79C]
		self:addElement( self[0xF426945ED61E79C] )
		self:SetChildMargin( self[0xF426945ED61E79C], 6, 1, 2, 0 )
	end
end

local f0_local16 = 11
local f0_local17 = 34
local f0_local18 = 20
StreakSelectUtils.SetupStreakButton = function ( f26_arg0, f26_arg1, f26_arg2, f26_arg3, f26_arg4 )
	local f26_local0 = LOOT.GetItemID( f26_arg3.ref )
	f26_arg3.isNew = false
	f26_arg3.isRestricted = Restrictions.IsKillstreakRestricted( f26_arg3.ref )
	f26_arg3.image = f26_arg3.icon
	f26_arg3.header = f26_arg3.name
	local f26_local1
	if LUI.IsItemInArray( LOOT.mobileComingSoonItemIds, f26_local0 ) ~= nil then
		f26_local1 = not Dvar[0x9E5BE3B4BBA4E0E]( 0x400E64D176DA3A4 )
	else
		f26_local1 = false
	end
	local f26_local2 = Challenge.IsWinChallengeItem( f26_arg1, f26_local0 )
	local f26_local3 = function ( f38_arg0, f38_arg1 )
		if not f38_arg0[0x700071878F4EF34] then
			return 
		end
		local f38_local0 = 0 < f38_arg1
		f38_arg0.SkinsContainer:SetVisible( f38_local0 )
		f38_arg0.SkinsContainer.SkinsIcon:SetVisible( f38_local0 )
		f38_arg0.SkinsContainer.NumberOfSkins:SetVisible( f38_local0 )
		f38_arg0.SkinsContainer.NumberOfSkins:setText( tostring( f38_arg1 ) )
		if f38_arg0.SwapIcon then
			if f38_local0 then
				f38_arg0.SwapIcon:SetTop( f26_arg0 )
				f38_arg0.SwapIcon:SetBottom( f26_arg0 + f26_arg0 )
			else
				f38_arg0.SwapIcon:SetTop( f26_arg0 )
				f38_arg0.SwapIcon:SetBottom( f26_arg0 + f26_arg0 )
			end
		end
	end
	
	if CONDITIONS.IsMobileOrMobileSim() then
		if f26_local1 then
			f26_arg2:SetHandleTouchInput( false )
		else
			f26_arg2:SetHandleTouchInput( true )
		end
	end
	local f26_local4 = {
		usesGlow = true,
		removeTextBacker = true,
		usesSwapIcon = true,
		imageSize = "1x1",
		buttonData = f26_arg3
	}
	local f26_local5
	if CONDITIONS.IsMobileOrMobileSim() then
		f26_local5 = "Medium"
	else
		f26_local5 = "SmallTall"
	end
	f26_local4.buttonSize = f26_local5
	f26_local4.isComingSoon = f26_local1
	f26_local4.isWinChallengeItem = f26_local2
	f26_arg2._buttonConfig = f26_local4
	if f26_local2 and not Challenge.IsWinChallengeComplete( f26_arg1, f26_local2.challengeID ) then
		if not f26_arg2[0xF3BFF364D494A02] then
			f26_local4 = MenuBuilder.BuildRegisteredType( "WinChallengeItemTag", {
				controllerIndex = f26_arg1
			} )
			f26_arg2:addElement( f26_local4 )
			f26_arg2[0xF3BFF364D494A02] = f26_local4
			f26_local4:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 128, 107, 131 )
		end
		f26_local5 = function ( f37_arg0, f37_arg1, f37_arg2 )
			local f37_local0, f37_local1 = Challenge.WinChallengeListFind( f37_arg1, f37_arg2 )
			f37_arg0[0xF3BFF364D494A02]:SetWinChallengeLabelType( f37_local1 )
		end
		
		f26_arg2.UpdateWinChallengeLabel = f26_local5
		f26_arg2.winChallengeData = f26_local2
		f26_local5( f26_arg2, f26_arg1, f26_local2.challengeID )
	end
	f26_arg2:RemoveGamepadEventCallback( "button_alt1" )
	f26_arg2.gamepadEventHandlerAdded = false
	f26_arg2._equipmentData = f26_arg3
	f26_local4 = LOOT.GetLootSkins( f26_arg1, f26_arg3.ref, f26_arg3.lootID )
	f26_local5 = 1 < #f26_local4
	if f26_local5 then
		f26_arg2._equipmentData.skinVariants = f26_local4
		local f26_local6 = {
			equipmentData = f26_arg2._equipmentData,
			lootItemType = LOOT.itemTypes.STREAK
		}
		f26_arg2._buttonConfig.doubleAction = {
			text = 0xD4463A566EAB153,
			prompt = 0x21E44BE45534168,
			callback = function ()
				LUI.FlowManager.RequestAddMenu( "EquipmentSkinSelect", true, f26_arg0, nil, f26_arg0, true )
			end
		}
		if not f26_arg2.gamepadEventHandlerAdded then
			f26_arg2:AddGamepadEventCallback( "button_alt1", function ( f35_arg0, f35_arg1 )
				if f35_arg0:isInFocus() then
					f35_arg0._buttonConfig.doubleAction.callback()
				end
			end )
			f26_arg2.gamepadEventHandlerAdded = true
		end
		StreakSelectUtils.AddSkinsInformation( f26_arg2 )
		f26_local3( f26_arg2, #f26_local4 - 1 )
	end
	f26_local3( f26_arg2, 0 )
	if f26_local5 and not f26_arg3.isUnlocked then
		f26_arg2.ButtonHighlight:KeepSecondPromptActiveIfLocked()
		f26_arg2.ButtonHighlight:SetSecondaryAltColor( SWATCHES[0x4DF62CF810D16C2][0xFA3959A397AABFC] )
	end
	f26_arg2:SetupButton( f26_arg2._buttonConfig )
	f26_arg2:SetRestricted( f26_arg3.isRestricted )
	local f26_local6
	if f26_arg3.isUnlocked then
		f26_local6 = f26_arg3.isRestricted
	else
		f26_local6 = true
	end
	f26_arg2:SetDisabled( f26_local6 )
	local f26_local7 = nil
	if CONDITIONS.IsWinTokenPurchasingEnabled() and f26_local6 and f26_arg3.winTokenCost and 0 < f26_arg3.winTokenCost then
		f26_arg2:SetDisabledText( Engine[0xED84C33EC5F01EA]( 0xCE02384D077C5BD, f26_arg3.winTokenCost ) )
	elseif CONDITIONS.IsPerpetualInventoryEnabled() then
		f26_local7 = UNLOCK_CRITERIA.GetUnlockActionInfo( f26_arg1, f26_local0 )
		if f26_local7 ~= nil then
			if f26_arg2[0x4AA903119F4FA7B] then
				f26_arg2[0x4AA903119F4FA7B]:KeepPrimaryPromptActiveIfLocked()
				f26_arg2[0x4AA903119F4FA7B]:SetIsPromptShownForDisabled( true )
			end
			f26_arg2:SetDisabledText( f26_local7.GetUnlockActionText( f26_arg1 ) )
		end
	end
	local f26_local8 = function ( f34_arg0, f34_arg1 )
		f26_arg0.buttonOver = f34_arg0
		local f34_local0 = false
		f26_arg0( f26_arg0, f26_arg0, f34_arg0 )
		if f26_arg0.StreakEquippedStack then
			f26_arg0.StreakEquippedStack:UpdateHighlightedState( f34_arg0.data.ref, f34_arg0.equipped )
		end
		f34_arg0:SetPrimaryPromptText( f34_arg0.equipped and 0x11A42B3B7868280 or 0xCA07A93FADF9E95, false )
		if Engine[0x12586A3F4FB490E]() then
			f26_arg0( f26_arg0, f34_arg0 )
		end
		if Engine[0x12586A3F4FB490E]() then
			f26_arg0.Showcase:setImage( RegisterMaterial( f34_arg0.data.fullImage ) )
			f26_arg0( f26_arg0 )
		end
		local f34_local1 = f34_arg1.controller or f26_arg0
		f26_arg0( true, f26_arg0, f34_arg0, f34_local1 )
		f26_arg0( f26_arg0, f34_local1 )
		local f34_local2 = Restrictions.IsKillstreakRestricted( f34_arg0.data.ref )
		if MatchRules[0x1A6D0B2E15DF8CF] and IsPrivateMatch() and not f34_local2 then
			f34_local2 = f34_arg0.data.customCost == -1
		end
		if MLG.IsCDLActive( f34_local1 ) or f34_local2 then
			ACTIONS.AnimateSequence( f26_arg0, "CDLRestricted" )
			if f34_arg0.equipped or f26_arg0.swapVisible or f26_arg0.isNew then
				ACTIONS.AnimateSequence( f26_arg0, "CDLEquipped" )
			else
				ACTIONS.AnimateSequence( f26_arg0, "CDLUnequipped" )
			end
		else
			ACTIONS.AnimateSequence( f26_arg0, "CDLUnrestricted" )
		end
		if f34_arg0:IsDisabled() and f26_arg0.HelperBar then
			f26_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
				button_ref = "button_primary"
			} )
		end
		if Engine[0x12586A3F4FB490E]() and not Onboarding.Killstreaks.WasCompleted( f26_arg0, f34_local1 ) then
			LUI.FlowManager.RequestPopupMenu( f26_arg0, "onboardingpopup", true, f34_local1, false, ONBOARDING_DATA.GetOnboardingKillstreaksData() )
			Onboarding.Killstreaks.MarkCompleted( f26_arg0, f34_local1 )
		end
	end
	
	if CONDITIONS.IsMobileOrMobileSim() then
		f26_arg2:addEventHandler( "button_over_active", f26_local8 )
		f26_arg2:addEventHandler( "button_active", f26_local8 )
		f26_arg2:addEventHandler( "button_disable_active", f26_local8 )
		f26_arg2:addEventHandler( "button_over_disable_active", f26_local8 )
	else
		f26_arg2:addEventHandler( "button_over", f26_local8 )
		f26_arg2:addEventHandler( "button_over_disable", f26_local8 )
	end
	f26_arg2:addEventHandler( "button_up", function ( f33_arg0, f33_arg1 )
		f26_arg0( false, f26_arg0, f33_arg0, f33_arg1.controller )
		ACTIONS.AnimateSequence( f33_arg0, "SwapIconOff" )
	end )
	if CONDITIONS.IsWinTokenPurchasingEnabled() then
		f26_arg2:addEventHandler( "button_action_disable", function ( f30_arg0, f30_arg1 )
			local f30_local0 = function ()
				f30_arg0( f30_arg0, f30_arg0 )
			end
			
			local f30_local1 = function ()
				LUI.FlowManager.RequestPopupMenu( f30_arg0, "PopupOK", true, f30_arg0, false, {
					title = Engine[0xED84C33EC5F01EA]( 0x1CCA5C59ECE1EA6 ),
					message = Engine[0xED84C33EC5F01EA]( 0x7D2DEC35B43660 )
				} )
			end
			
			if f26_arg0 then
				LOOT.PurchaseWithWinTokens( f26_arg0, f30_arg0._config.buttonData.lootID, f30_arg0._config.buttonData.winTokenCost, f30_local0, f30_local1 )
			end
			return true
		end )
	elseif f26_local7 ~= nil then
		f26_arg2:addEventHandler( "button_action_disable", function ( f29_arg0, f29_arg1 )
			f26_arg0:UnlockAction( f29_arg0, f26_arg0 )
			return true
		end )
		MenuUtils.SetupWinChallengeButtonEvents( f26_arg1, f26_arg2, f26_local0, false )
	end
	local f26_local9 = function ( f28_arg0, f28_arg1 )
		local f28_local0 = f28_arg0.data.ref
		local f28_local1 = false
		for f28_local5, f28_local6 in ipairs( StreakSelectUtils.EquippedStreaks ) do
			if f28_local0 == f28_local6.ref and f28_local6.isActive then
				f28_arg0:SetEquipped( true )
				if f26_arg0.selectedButtons then
				
				else
					f28_arg0:SetDisabled( f28_local6.isRestricted )
					f28_local1 = true
					break
				end
				f26_arg0.selectedButtons[f28_local5] = f28_arg0
			end
		end
		if not f28_local1 then
			f28_arg0:SetEquipped( false )
		end
	end
	
	f26_local9( f26_arg2 )
	f26_arg2:registerEventHandler( "update_buttons", f26_local9 )
	f26_arg2:registerEventHandler( "button_action", function ( element, event )
		local f27_local0 = element.data
		local f27_local1 = false
		if CONDITIONS.IsMobileOrMobileSim() then
			f26_arg0( element, event )
		end
		if not f27_local0.isUnlocked and CONDITIONS.IsPerpetualInventoryEnabled() then
			UNLOCK_CRITERIA.RedirectToUnlockSource( f26_arg0, element, f26_arg0 )
			return true
		end
		local f27_local2 = false
		local f27_local3 = StreakSelectUtils.GetStreakEquipSlot( f26_arg0 )
		local f27_local4 = StreakSelectUtils.GetStreakEquipType( f26_arg0 )
		local f27_local5
		if f27_local3 ~= nil then
			f27_local5 = StreakSelectUtils.EquippedStreaks[f27_local3]
		else
			f27_local5 = false
		end
		local f27_local6
		if f27_local5 then
			f27_local6 = f27_local5.isActive
			if not f27_local6 then
			
			else
				local f27_local7 = StreakSelectUtils.TryEquipStreak( f26_arg0, f26_arg0 )
				if f27_local7 ~= nil then
					if CoD.IsDMZMatch() then
						f27_local2 = not element.equipped
					else
						f26_arg0.selectedButtons = {}
						f26_arg0( false, f26_arg0, element, event.controller )
					end
				end
				if f27_local7 == StreakSelectUtils.EQUIP_TYPE.EQUIP then
					if f27_local6 then
						ACTIONS.AnimateSequence( element, "ShowGlow" )
					end
					f27_local1 = f27_local5.isRestricted
					element._isUnequipped = false
					if not element.equipped then
						f27_local2 = not CONDITIONS.IsMobileOrMobileSim()
					else
						f27_local2 = false
					end
					element:SetPrimaryPromptText( 0x11A42B3B7868280, false )
				end
				if f27_local7 == StreakSelectUtils.EQUIP_TYPE.TOGGLE then
					if f27_local6 then
						if f26_arg0.StreakEquippedStack then
							f26_arg0.StreakEquippedStack:UpdateHighlightedState( nil, false )
						end
						if f26_arg0.DeselectWarning then
							f26_arg0.DeselectWarning:SetAlpha( 1 )
						end
					elseif f26_arg0.StreakEquippedStack then
						f26_arg0.StreakEquippedStack:UpdateHighlightedState( f27_local5.ref, true )
					end
					element._isUnequipped = not f27_local6
					local f27_local8 = f27_local5.isActive
					if f27_local8 then
						f27_local2 = f27_local8
					elseif not element.equipped then
						f27_local2 = not CONDITIONS.IsMobileOrMobileSim()
					else
						f27_local2 = false
					end
					element:SetPrimaryPromptText( f27_local5.isActive and 0x11A42B3B7868280 or 0xCA07A93FADF9E95, false )
				end
				if f27_local7 == StreakSelectUtils.EQUIP_TYPE.ADD then
					f27_local2 = true
				end
				if f27_local7 == StreakSelectUtils.EQUIP_TYPE.REPLACE then
					StreakSelectUtils.RequestKillstreakReplacePopup( event.controller, f27_local0, {
						button = element,
						doToast = f27_local2,
						menu = f26_arg0
					} )
				end
				f26_arg0( f26_arg0, f26_arg0, f27_local0, f27_local1 )
				if f27_local2 then
					f26_arg0( event.controller, f27_local0.name )
				end
				if CoD.IsDMZMatch() then
					ACTIONS.LeaveMenu()
				end
				f26_arg0( f26_arg0, f26_arg0, element )
				return true
			end
		end
		f27_local6 = false
	end )
	MenuUtils.SetupItemButtonTags( f26_arg1, f26_arg2, f26_local0 )
end

StreakSelectUtils.SetupCategoryDynamicList = function ( f23_arg0, f23_arg1, f23_arg2 )
	f23_arg1:SetupList( {
		maxVisibleColumns = 25,
		spacingX = 0,
		wrapY = false,
		maxVisibleRows = 1,
		activeBehaviorOnMenuCreate = false,
		rowHeight = 256,
		useStencil = true,
		spacingY = 0,
		wrapX = false,
		controllerIndex = f23_arg0,
		primaryAxis = LUI.DIRECTION.horizontal,
		scrollType = Enum[0x92A69278394394][0xEDF5C0F5CCFACE1],
		sideArrowsOptions = {
			sideArrowsStep = 3
		}
	}, f23_arg2 )
	f23_arg1.childButtonWidth = 160
	f23_arg1.childButtonHeight = 204
	f23_arg1.childGridSpacing = 16
	f23_arg1:RegisterWidgetType( "StreakCategory", function ()
		return MenuBuilder.BuildRegisteredType( "StreakCategory", {
			controllerIndex = f23_arg0
		} )
	end, function ( f24_arg0, f24_arg1, f24_arg2 )
		f24_arg0.index = f24_arg1
		if f24_arg0._gridCreated and f24_arg0.StreakGrid then
			f24_arg0._gridCreated = false
			f24_arg0:RemoveElement( f24_arg0.StreakGrid )
		end
		local f24_local0 = f24_arg0:GetAnchorsAndPosition()
		f24_arg0:SetAnchorsAndPosition( f24_local0.leftAnchor, f24_local0.rightAnchor, f24_local0.topAnchor, f24_local0.bottomAnchor, 0, f24_arg2.amount * (f23_arg0.childButtonWidth + f23_arg0.childGridSpacing), f24_local0.top, f24_local0.bottom )
		f24_arg0:CreateGrid( f23_arg0, f24_arg2.amount, f24_arg2.categoryData, f24_arg2.streakIndices, f24_arg2.streakTable, f24_arg2.streakPlayerData, f24_arg2.menu, f24_arg2.controllerIndex )
		f24_arg2.menu.streakCategories[f24_arg2.categoryData.kills] = f24_arg0.StreakKillCategory
	end )
end

StreakSelectUtils.SetupItemDetails = function ( f22_arg0, f22_arg1, f22_arg2 )
	if CONDITIONS.IsMobileOrMobileSim() then
		f22_arg1:SetDataSource( f22_arg0.detailsDataSource, f22_arg2 )
	else
		f22_arg1:SetupForKillstreaks()
	end
end

StreakSelectUtils.SetupStreakCategories = function ( f21_arg0, f21_arg1 )
	local f21_local0 = STREAK.GetStreakPlayerData( f21_arg1 )
	local f21_local1 = STREAK.GetStreaksData( f21_arg1 )
	StreakSelectUtils.EquippedStreaks = STREAK.GetEquippedStreaksData( f21_arg1 )
	f0_local0( f21_arg0, f21_local1, f21_local0, f21_arg1 )
end

StreakSelectUtils.OnMenuCreate = function ( f20_arg0, f20_arg1 )
	local f20_local0 = STREAK.GetStreaksData( f20_arg1 )
	f20_arg0.selectedButtons = {}
	f20_arg0:dispatchEventToCurrentMenu( {
		name = "update_buttons"
	} )
	local f20_local1 = 0 < #f20_local0
	local f20_local2 = {}
	if not f20_local1 or not f20_local0[1].kills then
		local f20_local3 = 0
	end
	local f20_local4 = 0
	local f20_local5 = 0
	f20_local2.buttonPosition = {
		y = 0,
		x = f20_local5
	}
	f20_local2.categoryPosition = {
		y = 0,
		x = f20_local4
	}
	for f20_local6 = 1, #f20_local0, 1 do
		if f20_local0[f20_local6].kills ~= f20_local3 then
			f20_local4 = f20_local4 + 1
			local f20_local3 = f20_local0[f20_local6].kills
			f20_local5 = 0
		end
		if f20_local0[f20_local6].isActive then
			f20_local2.buttonPosition = {
				y = 0,
				x = f20_local5
			}
			f20_local2.categoryPosition = {
				y = 0,
				x = f20_local4
			}
			break
		end
		f20_local5 = f20_local5 + 1
	end
	if f20_local1 then
		if CONDITIONS.IsMobileOrMobileSim() then
			f20_arg0.StreakGrid:SetFocusedPosition( f20_local2.buttonPosition, true )
		else
			f0_local0( f20_arg0, f20_arg1 )
		end
	end
end

StreakSelectUtils.OnMenuClose = function ( f19_arg0, f19_arg1 )
	if CONDITIONS.InGame() or CoD.IsDMZMatch() then
		for f19_local3, f19_local4 in ddlpairs( STREAK.GetStreakPlayerData( f19_arg1 ) ) do
			if StreakSelectUtils.EquippedStreaks[f19_local3 + 1] then
				f19_local4.killstreak:set( StreakSelectUtils.EquippedStreaks[f19_local3 + 1].ref )
			end
		end
		ACTIONS.UploadStats( f19_arg0, f19_arg1 )
		f19_local0 = LUI.DataSourceInControllerModel.new( "cg.players.selectedLoadout" )
		if f19_local0:GetValue( f19_arg1 ) then
			Engine[0x6055C55456F05DF]( "class_edit", f19_local0:GetValue( f19_arg1 ) )
		end
	end
	STREAK.ClearStreaksData()
end

StreakSelectUtils.StreakSelectPostLoad = function ( f11_arg0, f11_arg1, f11_arg2 )
	f11_arg0._controllerIndex = f11_arg1
	f11_arg0._streakEarnType = GAMEMODE_SCRIPTBUNDLE_UTILS.StreakEarnType()
	f11_arg0._maxEquipStreaks = STREAK.GetMaxEquipStreaks()
	if Dvar[0x9E5BE3B4BBA4E0E]( 0x5714E49C17D1B4B ) then
		local f11_local0 = OPERATOR.GetEquippedOperatorCribKillstreakInInfo( f11_arg1 )
		ClientCharacter[0xAA614EB46957F3B]( 0, f11_local0[0x6D4C683B56F2FD0], f11_local0[0x9C0ACA099D06311] )
		ACTIONS.AnimateSequence( f11_arg0, "IntroHideBackground" )
		local f11_local1 = f11_arg0:Wait( 2400 )
		f11_local1.onComplete = function ()
			ACTIONS.AnimateSequence( f11_arg0, "IntroShowBackground" )
		end
		
	end
	if CONDITIONS.IsUnlockCriteriaEnabled() then
		ACTIONS.AnimateSequence( f11_arg0.ItemDetails.UnlockCriteriaWidget, "NoGap" )
	end
	f0_local0( f11_arg0 )
	if CONDITIONS.IsT10() then
		f11_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0x3EEBD595E0D2E4E ) )
	else
		f11_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0xCB7F887C28D2B9A ) )
	end
	if CONDITIONS.InGame() then
		LUI.TextChat.SetupMenuForSingleLine( f11_arg0 )
	end
	local f11_local0 = function ()
		Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
		f11_arg0( f11_arg0, f11_arg0 )
	end
	
	if f11_arg0.HelperBar then
		f11_arg0.HelperBar:SetHelperVerticalPosition( {
			top = 4294967226,
			topAnchor = 1,
			bottom = 0,
			bottomAnchor = 0
		} )
		f11_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 3,
			isHold = true,
			button_ref = "button_l3",
			helper_text = ToUpperCase( Engine[0xED84C33EC5F01EA]( 0x92FF557E0865F1C ) ),
			callback = f11_local0,
			helper_definition = Engine[0xED84C33EC5F01EA]( 0xDDC3F9AC2A6DC1D )
		}, {
			replaceTop = true
		} )
	end
	if f11_arg0.UnequipAllButton then
		f11_arg0.UnequipAllButton:addEventHandler( "button_action", function ( f16_arg0, f16_arg1 )
			f11_arg0()
		end )
	end
	local f11_local2 = LOADOUT.GetLoadoutSquadMember( f11_arg1 )
	f11_local2 = f11_local2.scoreStreak
	if f11_local2 then
		local f11_local1
		if f11_local2:get() == 0 then
			f11_local1 = not CONDITIONS.IsT10()
		else
			f11_local1 = false
		end
		f11_arg0.showKills = f11_local1
	else
		f11_arg0.showKills = false
	end
	if not CONDITIONS.IsT10() and not CONDITIONS.IsLeaguePlay() and f11_arg0.HelperBar then
		f11_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			priority = 1,
			isToggleButton = true,
			helper_text = ToUpperCase( Engine[0xED84C33EC5F01EA]( 0x3EEBD595E0D2E4E ) ),
			button_ref = f0_local0,
			isToggledOn = not f11_arg0.showKills,
			helper_definition = Engine[0xED84C33EC5F01EA]( 0x2C04B3F158E473 )
		}, {
			replaceTop = true
		} )
		f11_arg0.HelperBar.ButtonHelperText:TogglePromptByButtonRef( f0_local0, not f11_arg0.showKills )
	end
	f11_arg0:SubscribeToInputTypeModel( f11_arg1, function ( f15_arg0, f15_arg1 )
		local f15_local0 = f15_arg1._controllerIndex
		if not CONDITIONS.IsT10() and not CONDITIONS.IsLeaguePlay() and f15_arg1.HelperBar then
			local f15_local1 = nil
			local f15_local2 = f15_arg1.HelperBar.ButtonHelperText:GetPromptByButtonRef( f11_arg0 )
			if f15_local2 and f15_local2.ToggleButton and f15_local2.ToggleButton.GetToggleState then
				f15_local1 = f15_local2.ToggleButton:GetToggleState()
			end
			f15_arg1.HelperBar.ButtonHelperText:RemoveButtonPrompt( f11_arg0 )
			f15_arg1.HelperBar.ButtonHelperText:PushButtonPrompt( {
				side = "left",
				priority = 1,
				isToggleButton = true,
				helper_text = ToUpperCase( Engine[0xED84C33EC5F01EA]( 0x3EEBD595E0D2E4E ) ),
				button_ref = f11_arg0,
				isToggledOn = f15_local1,
				helper_definition = Engine[0xED84C33EC5F01EA]( 0x2C04B3F158E473 )
			}, {
				replaceTop = true
			} )
			f15_arg1.HelperBar.ButtonHelperText:RefreshButtonHelpers( {
				controllerIndex = f15_local0
			} )
		end
		if not CONDITIONS.IsMouseNavigation( f15_local0 ) and f15_arg1.buttonOver then
			f15_arg1.buttonOver.parent.StreakGrid:SetFocusedPosition( f15_arg1.buttonOver.position, false )
		end
	end )
	StreakSelectUtils.ToggleStreakLabels( f11_arg0, f11_arg1, true )
	if f11_arg0.MouseArea then
		f11_arg0.MouseArea:addEventHandler( "gamepad_button", function ( f14_arg0, f14_arg1 )
			if CONDITIONS.IsMouseWheelEvent( f14_arg1 ) and f14_arg1.down then
				local f14_local0 = f14_arg0:getParent()
				f14_arg1.forceScrollMove = true
				if f14_local0 then
					local f14_local1 = f14_local0.CategoryGrid
					if f14_local1 and f14_local1.Grid then
						f14_local1.Grid:processEvent( f14_arg1 )
					end
				end
			end
		end )
	end
	for f11_local1 = 0, f11_arg0.CategoryGrid:GetNumChildren() - 1, 1 do
		local f11_local5 = f11_arg0.CategoryGrid:GetWidgetAtIndex( f11_local1 )
		f11_local5.StreakGrid:addEventHandler( "gamepad_button", function ( f13_arg0, f13_arg1 )
			local f13_local0 = LUI.FlowManager.GetCurrentMenu( f13_arg0 )
			if CONDITIONS.IsMouseWheelEvent( f13_arg1 ) and f13_arg1.down and f13_local0.CategoryGrid and f13_local0.CategoryGrid.Grid then
				f13_local0.CategoryGrid.Grid:processEvent( f13_arg1 )
			end
		end )
	end
	if Challenge.IsWinChallengesUnlocked( f11_arg1 ) and not Challenge.IsMenuChallengeCompleteCallbackRegistered( f11_arg0 ) then
		Challenge.RegisterMenuChallengeCompleteCallback( f11_arg0, function ( f12_arg0, f12_arg1 )
			local f12_local0 = f12_arg0._currentFocusGridIndex
			for f12_local11, f12_local12 in ipairs( f12_arg0.CategoryGrid.Grid:GetBuiltChildren() ) do
				local f12_local13 = f12_local12:GetBuiltWidget()
				local f12_local4
				if f12_local13 then
					f12_local4 = f12_local13
				else
					f12_local4 = f12_local13.StreakGrid
				end
				if f12_local4 then
					local f12_local5 = f12_local4:GetBuiltChildren()
					if not Table.IsNilOrEmpty( f12_local5 ) then
						for f12_local9, f12_local10 in ipairs( f12_local5 ) do
							if f12_local10.winChallengeData then
								f12_local10:UpdateWinChallengeLabel( f11_arg0, f12_local10.winChallengeData.challengeID )
							end
						end
					end
				end
			end
			f12_arg0.ItemDetails.UnlockCriteriaWidget:UpdateFromDataSources( f11_arg0 )
		end )
	end
end

StreakSelectUtils.SetFirstStreakFromCostValue = function ( f10_arg0 )
	local f10_local0 = 0
	for f10_local4, f10_local5 in ipairs( f10_arg0 ) do
		local f10_local6 = f10_local5.kills
		f10_local5.isFirstFromCostValue = f10_local6 ~= f10_local0
		f10_local0 = f10_local6
	end
end

StreakSelectUtils.SetupMobileStreakSelectMenu = function ( f9_arg0, f9_arg1, f9_arg2 )
	if not CONDITIONS.IsMobileOrMobileSim() then
		return 
	else
		f9_arg0.detailsDataSource = LUI.SetupDataSourceUpdate( f9_arg0, f9_arg1, "UpdateDetailsDataSources", "alwaysLoaded.menu.streak.details", STREAK.GetCurrentStreakDetails( f9_arg1 ), LOADOUT.FormatDetailsDataTable )
	end
end

StreakSelectUtils.SetupMobileKillScoreSwitchButton = function ( f5_arg0, f5_arg1, f5_arg2 )
	local f5_local0 = function ( f8_arg0, f8_arg1 )
		if f8_arg0 then
			return Engine[0xED84C33EC5F01EA]( 0x56ECD1CD964F55B, f8_arg1.kills )
		else
			return f8_arg1.scoreCost
		end
	end
	
	local f5_local1 = function ( f7_arg0, f7_arg1 )
		local f7_local0 = nil
		if f7_arg0.showKills then
			f7_local0 = Engine[0xED84C33EC5F01EA]( 0xC790056979C3E18 )
			f5_arg0:PlaySwitchOnAnimation( f7_arg1 )
		else
			f7_local0 = Engine[0xED84C33EC5F01EA]( 0xA4512C2D83E2EBE )
			f5_arg0:PlaySwitchOfAnimation( f7_arg1 )
		end
		f7_arg0.KillScoreText:setText( f7_local0 )
	end
	
	f5_arg1:ValidateAnimationState()
	f5_local1( f5_arg0, true )
	f5_arg1:addEventHandler( "button_action", function ( f6_arg0, f6_arg1 )
		StreakSelectUtils.ToggleStreakLabels( f5_arg0, f6_arg1.controller, false )
		f5_arg0( f5_arg0, false )
		f5_arg0:RefreshContent()
	end )
end

StreakSelectUtils.SetupMobileEquippedStreaksGrid = function ( f3_arg0, f3_arg1 )
	f3_arg1:SetRefreshChild( function ( f4_arg0, f4_arg1, f4_arg2 )
		local f4_local0 = StreakSelectUtils.EquippedStreaks[f4_arg1 + 1]
		local f4_local1 = Engine[0xED84C33EC5F01EA]( f4_local0.name )
		local f4_local2 = GetKillOrScoreString( f3_arg0.showKills, f4_local0 )
		f4_arg0:SetHeaderText( f4_local1 )
		f4_arg0:SetSubHeaderText( f4_local2 )
		f4_arg0:SetupButton( {
			removeTextBacker = true,
			removeEquipBanner = true,
			buttonSize = "LargeTall",
			imageSize = "1x1",
			buttonData = {
				image = f4_local0.icon
			}
		} )
		f4_arg0:SetFieldUpgradeLayout()
	end )
end

StreakSelectUtils.SetupMobileStreakGrid = function ( f1_arg0, f1_arg1, f1_arg2 )
	local f1_local0 = STREAK.GetStreakPlayerData( f1_arg2 )
	local f1_local1 = STREAK.GetStreaksData( f1_arg2 )
	StreakSelectUtils.EquippedStreaks = STREAK.GetEquippedStreaksData( f1_arg2 )
	for f1_local2 = 1, #f1_local1, 1 do
		local f1_local5 = f1_local1[f1_local2]
		if f1_local5.equipped then
			f1_arg0.StreakButtonOver( f1_local5, "button_over_active" )
			break
		end
	end
	local f1_local2 = function ( f2_arg0, f2_arg1, f2_arg2 )
		local f2_local0 = f1_arg0[f2_arg1 + 1]
		StreakSelectUtils.SetupStreakButton( f1_arg0, f1_arg0, f2_arg0, f2_local0, f1_arg0 )
		f2_arg0:SetStreakValue( f2_local0, f1_arg0.showKills )
	end
	
	StreakSelectUtils.SetFirstStreakFromCostValue( f1_local1 )
	f1_arg1:SetNumChildren( #f1_local1 )
	f1_arg1:SetRefreshChild( f1_local2 )
	f1_arg1:SetCollapsableScrollbarOnTouch( f1_arg2 )
	StreakSelectUtils.SetupActiveState( f1_arg0, f1_arg2, f1_arg1, GRID_AND_LIST.ActiveBehaviorType.TOUCHEND, false )
end

