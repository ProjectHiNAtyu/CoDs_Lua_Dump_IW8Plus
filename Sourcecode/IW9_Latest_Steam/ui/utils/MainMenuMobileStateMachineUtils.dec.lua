-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
MainMenuMobileStateMachine = MainMenuMobileStateMachine or {}
local f0_local0 = function ( f17_arg0, f17_arg1 )
	local f17_local0 = DataSources.alwaysLoaded.activeParty.memberCount
	local f17_local1 = DataSources.alwaysLoaded.activeParty.memberMaxCount
	local f17_local2 = function ()
		local f18_local0 = f17_arg0:GetValue( f17_arg0 )
		local f18_local1 = f17_arg0:GetValue( f17_arg0 )
		if f18_local0 ~= nil and f18_local1 ~= nil then
			f17_arg0.MobileLobbyStatus.LobbyCount:setText( Engine[0xED84C33EC5F01EA]( 0x47F0ED61896F07A, f18_local0, f18_local1 ) )
		end
	end
	
	f17_arg0:SubscribeToModel( f17_local0:GetModel( f17_arg1 ), f17_local2 )
	f17_arg0:SubscribeToModel( f17_local1:GetModel( f17_arg1 ), f17_local2 )
end

local f0_local1 = function ( f16_arg0 )
	f16_arg0.MobileLobbyStatus.TimeElapsed:setText( Engine[0xED84C33EC5F01EA]( 0xF9288ED40B6BC30 ), Engine[0x7D3158A9539A355]( Engine[0x9F0E9247C145452]( math.abs( (Engine[0x6991337AE950F99]() - Lobby.ElapsedTime) / 1000 ) ) ) )
end

local f0_local2 = function ( f15_arg0, f15_arg1 )
	Engine[0xB81A5136C5503E4]( "xsetupprivatematchparty" )
end

local f0_local3 = function ( f14_arg0, f14_arg1 )
	local f14_local0 = LUI.FlowManager.GetScopedData( f14_arg0 )
	f14_local0.squadSelectionMenuDisplayed = false
	if Dvar[0x9E5BE3B4BBA4E0E]( 0x85EF1ED1D39D3A3 ) and not (Lobby[0xE282396C3A4C54B]() == Enum[0x6898CF1A0F3B21E][0xF7DCE5F96165B52]) then
		PRIVATE_MATCH.OpenMobilePrivateMatchDisbandedPopup( f14_arg1 )
		Dvar[0x8EA06EEDB58D872]( 0x85EF1ED1D39D3A3, false )
	end
end

MainMenuMobileStateMachine.StateEnum = {
	PRIVATE_MATCH = 2,
	MAIN_MENU = 0,
	MATCHMAKING = 1
}
MainMenuMobileStateMachine.Data = {
	[MainMenuMobileStateMachine.StateEnum.MAIN_MENU] = {
		SetUp = function ( f13_arg0, f13_arg1 )
			f13_arg0.PleaseWait:SetVisibility( LUI.Visibility.Hidden )
		end,
		Begin = function ( f12_arg0, f12_arg1 )
			f0_local0( f12_arg0, f12_arg1 )
			f12_arg0.MobileMainHubLayout.MobilePlayPanel:UpdateState( MainMenuMobileStateMachine.StateEnum.MAIN_MENU )
			Lobby[0x2043FF221ED6A77]( PartyUIRoot.BR_MAIN_MENU )
		end,
		End = function ( f11_arg0, f11_arg1 )
			
		end
	},
	[MainMenuMobileStateMachine.StateEnum.MATCHMAKING] = {
		SetUp = function ( menu, controller )
			menu.elapsedTimer = LUI.UITimer.new( {
				interval = 1000,
				disposable = false,
				event = {
					name = "update_lobby_elapsed_time"
				}
			} )
			menu.elapsedTimer.id = "lobbyElapsedTimer"
			menu:addElement( menu.elapsedTimer )
			ACTIONS.AnimateSequence( menu.MobileLobbyStatus.LobbyStatus, "MGLLayout" )
			menu.lobbyStatusTimer = LUI.UITimer.new( {
				interval = 400,
				event = "update_lobby_status"
			} )
			menu.lobbyStatusTimer.id = "lobbyStatusTimer"
			menu:addElement( menu.lobbyStatusTimer )
			menu.MobileLobbyStatus:SetHandleTouchInput( false )
			f0_local0( menu, controller )
		end,
		Begin = function ( f8_arg0, f8_arg1 )
			f8_arg0.MobileLobbyStatus.LobbyStatus:SetAlpha( 1 )
			f8_arg0.MobileLobbyStatus.LobbyCount:SetAlpha( 0 )
			f8_arg0.MobileLobbyStatus:SetHandleTouchInput( true )
			f8_arg0.MobileMainHubLayout.MobilePlayPanel:UpdateState( MainMenuMobileStateMachine.StateEnum.MATCHMAKING )
			f8_arg0:registerAndCallEventHandler( "update_lobby_elapsed_time", f0_local0 )
			f8_arg0:registerEventHandler( "update_lobby_status", function ( element, event )
				if Lobby[0xF1D2956B0C99DF6]() then
					f8_arg0.MobileLobbyStatus.LobbyCount:SetAlpha( 1 )
				end
			end )
			Lobby[0x2043FF221ED6A77]( PartyUIRoot.BATTLE_ROYALE_MENU_PUBLIC_LOBBY )
		end,
		End = function ( f7_arg0, f7_arg1 )
			f7_arg0.MobileLobbyStatus:SetHandleTouchInput( false )
			f7_arg0:deregisterEventHandler( "update_lobby_elapsed_time" )
			f7_arg0:deregisterEventHandler( "update_lobby_status" )
		end
	},
	[MainMenuMobileStateMachine.StateEnum.PRIVATE_MATCH] = {
		SetUp = function ( f6_arg0, f6_arg1 )
			
		end,
		Begin = function ( f5_arg0, f5_arg1 )
			f5_arg0.MobileMainHubLayout.MobilePlayPanel:UpdateState( MainMenuMobileStateMachine.StateEnum.PRIVATE_MATCH )
			Game[0x631AB43BA10119]( "br" )
			PRIVATE_MATCH.SetupPrivateMatchGameType( Enum[0x3085A67688502CD][0x7C26AC6414E926F] )
			f0_local0( f5_arg0, f5_arg1 )
			Lobby[0x2043FF221ED6A77]( PartyUIRoot.WZ_PRIVATE_MATCH_LOBBY )
			local f5_local0 = LUI.FlowManager.GetScopedData( f5_arg0 )
			if not f5_local0.squadSelectionMenuDisplayed then
				URI.QueueURI( "./MobilePrivateMatchSquadSelectionMenu", f5_arg1 )
				f5_local0.squadSelectionMenuDisplayed = true
			end
		end,
		End = function ( f4_arg0, f4_arg1 )
			f0_local0( f4_arg0, f4_arg1 )
		end
	}
}
MainMenuMobileStateMachine.CurrentState = MainMenuMobileStateMachine.StateEnum.MAIN_MENU
MainMenuMobileStateMachine.SetState = function ( f3_arg0, f3_arg1, f3_arg2 )
	local f3_local0 = MainMenuMobileStateMachine.CurrentState
	if f3_arg2 and f3_local0 ~= f3_arg2 then
		if f3_local0 then
			MainMenuMobileStateMachine.Data[f3_local0].End( f3_arg0, f3_arg1 )
		end
		MainMenuMobileStateMachine.Data[f3_arg2].Begin( f3_arg0, f3_arg1 )
		MainMenuMobileStateMachine.CurrentState = f3_arg2
	end
end

MainMenuMobileStateMachine.UpdateState = function ( f2_arg0, f2_arg1 )
	if DataSources.frontEnd.lobby.isPrivateMatchActive:GetValue( f2_arg1 ) then
		MainMenuMobileStateMachine.SetState( f2_arg0, f2_arg1, MainMenuMobileStateMachine.StateEnum.PRIVATE_MATCH )
	elseif DataSources.frontEnd.lobby.isMatchMaking:GetValue( f2_arg1 ) == true then
		MainMenuMobileStateMachine.SetState( f2_arg0, f2_arg1, MainMenuMobileStateMachine.StateEnum.MATCHMAKING )
	else
		MainMenuMobileStateMachine.SetState( f2_arg0, f2_arg1, MainMenuMobileStateMachine.StateEnum.MAIN_MENU )
	end
end

MainMenuMobileStateMachine.InitStateMachine = function ( f1_arg0, f1_arg1 )
	MainMenuMobileStateMachine.CurrentState = nil
	for f1_local3, f1_local4 in pairs( MainMenuMobileStateMachine.Data ) do
		f1_local4.SetUp( f1_arg0, f1_arg1 )
	end
	MainMenuMobileStateMachine.UpdateState( f1_arg0, f1_arg1 )
end

