-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
module( ..., package.seeall )
LUI.OverlayHUD = LUI.Class( LUI.UIElement )
LUI.OverlayHUD.init = function ( f6_arg0, f6_arg1, f6_arg2, f6_arg3 )
	LUI.OverlayHUD.super.init( f6_arg0 )
	f6_arg0.id = "OverlayHUD"
	assert( f6_arg1 )
	local f6_local0
	if not f6_arg1 then
		f6_local0 = f6_arg1
	else
		f6_local0 = f6_arg0:getRootController()
	end
	f6_arg0._controllerIndex = f6_local0
	f6_arg0._overlays = {}
	f6_arg0._overlayContainer = f6_arg2
	f6_arg0._underlayContainer = f6_arg3
	f6_arg0:registerOmnvarHandler( "ui_session_state", LUI.OverlayHUD.UpdateOverlays )
	f6_arg0:RefreshOnDataSourceChange( DataSources.inGame.player.currentWeapon )
	f6_arg0:registerEventHandler( "playerstate_client_changed", LUI.OverlayHUD.UpdateOverlays )
	f6_arg0:registerEventHandler( "empty_menu_stack", LUI.OverlayHUD.UpdateOverlays )
	f6_arg0:registerEventHandler( "non_empty_menu_stack", LUI.OverlayHUD.UpdateOverlays )
	f6_arg0:UpdateOverlays()
end

LUI.OverlayHUD.RefreshOnDataSourceChange = function ( f4_arg0, f4_arg1 )
	f4_arg0:SubscribeToModel( f4_arg1:GetModel( f4_arg0:getRootController() ), function ()
		f4_arg0:UpdateOverlays()
	end, true )
end

LUI.OverlayHUD.GetToggleOverlays = function ( f3_arg0 )
	return {}
end

LUI.OverlayHUD.UpdateOverlays = function ( f1_arg0 )
	local f1_local0, f1_local1, f1_local2, f1_local3 = f1_arg0:GetToggleOverlays()
	if f1_local2 == nil then
		f1_local2 = true
	end
	if f1_local3 == nil then
		f1_local3 = false
	end
	local f1_local4 = false
	for f1_local13, f1_local14 in pairs( f1_arg0._overlays ) do
		if f1_local0 ~= f1_local13 and not f1_local14.closing then
			if f1_local0 and f1_local0.GetBlockedOverlay then
				local f1_local8 = f1_local0:GetBlockedOverlay()
				if f1_local8 and 0 < #f1_local8 then
					for f1_local9 = 1, #f1_local8, 1 do
						if f1_local14.id == f1_local8[f1_local9] then
							f1_local4 = true
							break
						end
					end
				end
			end
			local f1_local8 = type( f1_local14.gracePeriod ) and f1_local14.gracePeriod( f1_arg0 ) or f1_local14.gracePeriod
			if 0 < f1_local8 then
				f1_local14.closing = true
				f1_local14.closeCount = f1_local14.closeCount + 1
				local f1_local9 = f1_local14.closeCount
				local f1_local10 = f1_local13
				local f1_local11 = f1_local14
				local f1_local12 = f1_local14:Wait( f1_local8 )
				f1_local12.onComplete = function ()
					if f1_arg0.closing and f1_arg0.closeCount == f1_arg0 then
						f1_arg0:closeTree()
						f1_arg0._overlays[f1_arg0] = nil
					end
				end
				
			end
			f1_local14:closeTree()
			f1_arg0._overlays[f1_local13] = nil
		end
	end
	if f1_local0 then
		if not f1_arg0._overlays[f1_local0] then
			f1_arg0._overlays[f1_local0] = f1_local0.new( f1_arg0._controllerIndex, {
				isOverlayToBuildBlocked = f1_local4
			} )
			f1_local5 = f1_arg0._overlays[f1_local0]
			if not f1_local1 then
				f1_local6 = f1_local1
			else
				f1_local6 = 0
			end
			f1_local5.gracePeriod = f1_local6
			f1_arg0._overlays[f1_local0].closeCount = 0
			f1_arg0._overlays[f1_local0].closing = false
			f1_arg0._overlays[f1_local0].hideable = f1_local3
			if f1_local2 then
				f1_arg0._overlayContainer:addElement( f1_arg0._overlays[f1_local0] )
			else
				f1_arg0._underlayContainer:addElement( f1_arg0._overlays[f1_local0] )
			end
		else
			f1_arg0._overlays[f1_local0].closing = false
		end
		f1_local5 = false
		f1_local6 = VISIBILITY_CONDITIONS.IsMenuOpen.conditionFunc( f1_arg0._controllerIndex )
		if not f1_local5 then
			f1_local5 = f1_local6
		end
		if not f1_local5 and CONDITIONS.IsMultiplayer() then
			f1_local7 = VISIBILITY_CONDITIONS.InScoreboard.conditionFunc( f1_arg0._controllerIndex )
			if not f1_local5 then
				if f1_local7 then
					f1_local5 = f1_local7
				else
					f1_local5 = f1_arg0._overlays[f1_local0].hideable
				end
			end
		end
		f1_local7 = f1_arg0._overlays[f1_local0]
		f1_local14 = f1_local7
		f1_local7 = f1_local7.SetAlpha
		local f1_local8
		if f1_local5 then
			f1_local8 = 0
		else
			f1_local8 = 1
		end
		f1_local7( f1_local14, f1_local8 )
	end
end

LockTable( _M )
