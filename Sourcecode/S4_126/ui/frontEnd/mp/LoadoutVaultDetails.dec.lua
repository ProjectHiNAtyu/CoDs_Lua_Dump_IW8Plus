-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
module( ..., package.seeall )
require( "ui.widgets.PopupFrame" )
require( "ui.widgets.SubMenuTab" )
require( "ui.frontEnd.mp.WeaponNameAndIcon" )
require( "ui.frontEnd.mp.AttachmentGrid" )
require( "ui.widgets.mp.LabeledIcon" )
require( "ui.widgets.LoadoutItemPerkButton" )
require( "ui.widgets.LoadoutItemButton" )
local f0_local0 = 270 * _1080p
local f0_local1 = 100 * _1080p
local f0_local2 = 762 * _1080p
local f0_local3 = {
	{
		name = Engine[0xED84C33EC5F01EA]( "LUA_MENU/PRIMARY" ),
		weaponSlot = WEAPON.PrimarySlot,
		itemsMissing = function ( f10_arg0, f10_arg1 )
			local f10_local0 = WEAPON.GenerateWeaponTable( f10_arg0.weaponSetups[WEAPON.PrimarySlot] )
			local f10_local1
			if f10_arg1 and f10_arg1.weapons then
				f10_local1 = f10_arg1.weapons[f10_local0.weapon]
				if not f10_local1 then
					f10_local1 = f10_arg1.attachments
					if f10_local1 then
						f10_local1 = f10_arg1.attachments[f10_local0.weapon]
					end
				end
			else
				f10_local1 = f10_arg1.attachments
				if f10_local1 then
					f10_local1 = f10_arg1.attachments[f10_local0.weapon]
				end
			end
			return f10_local1
		end
	},
	{
		name = Engine[0xED84C33EC5F01EA]( "LUA_MENU/SECONDARY" ),
		weaponSlot = WEAPON.SecondarySlot,
		itemsMissing = function ( f9_arg0, f9_arg1 )
			local f9_local0 = WEAPON.GenerateWeaponTable( f9_arg0.weaponSetups[WEAPON.SecondarySlot] )
			local f9_local1
			if f9_arg1 and f9_arg1.weapons then
				f9_local1 = f9_arg1.weapons[f9_local0.weapon]
				if not f9_local1 then
					f9_local1 = f9_arg1.attachments
					if f9_local1 then
						f9_local1 = f9_arg1.attachments[f9_local0.weapon]
					end
				end
			else
				f9_local1 = f9_arg1.attachments
				if f9_local1 then
					f9_local1 = f9_arg1.attachments[f9_local0.weapon]
				end
			end
			return f9_local1
		end
	},
	{
		name = Engine[0xED84C33EC5F01EA]( "LOADOUT_VAULT/STRATEGIC" ),
		itemsMissing = function ( f8_arg0, f8_arg1 )
			local f8_local0 = {
				f8_arg0.loadoutPerks[0]:get(),
				f8_arg0.loadoutPerks[1]:get(),
				[1] = f8_arg0.loadoutPerks[2]:get()
			}
			local f8_local1 = f8_arg0.equipmentSetups[0].equipment:get()
			local f8_local2 = f8_arg0.equipmentSetups[1].equipment:get()
			if f8_arg1 and f8_arg1.perks then
				for f8_local6, f8_local7 in ipairs( f8_local0 ) do
					if f8_arg1.perks[f8_local7] then
						return true
					end
				end
			end
			f8_arg1.equipment = f8_arg1.equipment or {}
			local f8_local3
			if f8_arg1 then
				f8_local3 = f8_arg1
			else
				f8_local3 = f8_arg1.equipment[f8_local1]
				if not f8_local3 then
					f8_local3 = f8_arg1.equipment[f8_local2]
				end
			end
			return f8_local3
		end
	}
}
local f0_local4 = function ( f7_arg0, f7_arg1, f7_arg2 )
	local f7_local0 = f0_local0[f7_arg2]
	local f7_local1, f7_local2 = LOADOUTVAULT.IsLoadoutComplete( f7_arg1, f7_arg0._loadout )
	if f7_local0.weaponSlot then
		local f7_local3 = WEAPON.GenerateWeaponTable( f7_arg0._loadout.weaponSetups[f7_local0.weaponSlot] )
		local f7_local4 = f7_arg0.Weapon
		local f7_local5 = f7_local4
		f7_local4 = f7_local4.Setup
		local f7_local6 = f7_arg1
		local f7_local7 = f7_local0.weaponSlot
		local f7_local8 = f7_local3
		local f7_local9
		if f7_local2 then
			f7_local9 = f7_local2
		else
			f7_local9 = f7_local2.weapons
			if f7_local9 then
				f7_local9 = f7_local2.weapons[f7_local3.weapon]
			end
		end
		f7_local4( f7_local5, f7_local6, f7_local7, f7_local8, f7_local9 )
		f7_local4 = 0 < #GUNSMITH.GetAttachmentCategories( f7_local3.weapon )
		f7_arg0.Weapon:SetVisible( true )
		f7_arg0.Attachments:SetVisible( f7_local4 )
		local f7_local10 = f0_local0 * 2
		f7_local5 = f7_local10 * -0.5
		f7_local6 = -(f0_local0 * 0.5 + f7_local10)
		if f7_local4 and not f7_local6 then
			f7_local7 = f7_local6
		else
			f7_local7 = f7_local5
		end
		f7_local8 = f7_local7 + f7_local10
		f7_arg0.Weapon:SetLeft( f7_local7 )
		f7_arg0.Weapon:SetRight( f7_local8 )
		f7_local9 = f0_local0 * 0.5
		local f7_local11 = f7_local9 + f0_local0
		f7_arg0.Attachments:SetLeft( f7_local9 )
		f7_arg0.Attachments:SetRight( f7_local11 )
		if f7_local4 then
			local f7_local12 = f7_local2.attachments
			if f7_local12 then
				f7_local12 = f7_local2.attachments[f7_local3.weapon]
			end
			f7_arg0.Attachments:Setup( f7_local3, f7_local12 )
		end
		f7_arg0.Perks:SetVisible( false )
		f7_arg0.LethalEquipment:SetVisible( false )
		f7_arg0.TacticalEquipment:SetVisible( false )
	else
		local f7_local13 = f7_arg0._loadout
		local f7_local3 = {
			f7_local13.loadoutPerks[0]:get(),
			f7_local13.loadoutPerks[1]:get(),
			[4] = f7_local13.loadoutPerks[2]:get()
		}
		local f7_local4 = f7_local13.equipmentSetups[0].equipment:get()
		local f7_local10 = f7_local13.equipmentSetups[1].equipment:get()
		f7_arg0.Perks:SetupButton( f7_arg1, f7_local3, f7_local2 )
		f7_arg0.LethalEquipment:SetupButton( f7_arg1, f7_local4, LOOT.itemTypes.EQUIPMENT, "LUA_MENU/RIG_LETHAL", f7_local2 )
		f7_arg0.TacticalEquipment:SetupButton( f7_arg1, f7_local10, LOOT.itemTypes.EQUIPMENT, "LUA_MENU/TITLE_TACTICAL", f7_local2 )
		f7_arg0.Weapon:SetVisible( false )
		f7_arg0.Attachments:SetVisible( false )
		f7_arg0.Perks:SetVisible( true )
		f7_arg0.LethalEquipment:SetVisible( true )
		f7_arg0.TacticalEquipment:SetVisible( true )
	end
	f7_arg0.MissingItemsWarning:SetVisible( 0 < CountTableKeys( f7_local2 ) )
end

local f0_local5 = function ( f5_arg0, f5_arg1 )
	f5_arg0._tabIdMap = {}
	for f5_local3, f5_local4 in pairs( f0_local0 ) do
		f5_arg0._tabIdMap[f5_local3] = f5_local4.tabId
	end
	f5_local0 = {}
	for f5_local4, f5_local5 in ipairs( f0_local0 ) do
		table.insert( f5_local0, {
			hasDefaultFocus = true,
			name = f5_local5.name,
			focusFunction = function ( f6_arg0, f6_arg1, f6_arg2, f6_arg3 )
				f5_arg0:FocusTab( f6_arg1, f6_arg2 + 1 )
			end
		} )
	end
	f5_arg0.Tabs:SetTabs( f5_local0 )
	f5_arg0.Tabs:SetAlignment( LUI.Alignment.Middle )
	f5_local1, f5_local2 = LOADOUTVAULT.IsLoadoutComplete( f5_arg1, f5_arg0._loadout )
	for f5_local3 = 1, #f5_local0, 1 do
		local f5_local6 = f0_local0[f5_local3].itemsMissing( f5_arg0._loadout, f5_local2 )
		local f5_local7 = f5_arg0.Tabs:GetTabAtIndex( f5_local3 )
		local f5_local8 = f5_local7.RestrictionWarning
		local f5_local9 = f5_local8
		f5_local8 = f5_local8.SetAlpha
		local f5_local10
		if f5_local6 then
			f5_local10 = 1
		else
			f5_local10 = 0
		end
		f5_local8( f5_local9, f5_local10 )
	end
end

local f0_local6 = function ( f3_arg0, f3_arg1, f3_arg2 )
	assert( f3_arg2.vaultLoadout, "LoadoutVaultDetails requires a valid vault loadout to replace active loadouts!" )
	f3_arg0.FocusTab = f0_local0
	f3_arg0.SetupTabs = f0_local0
	f3_arg0._loadout = f3_arg2.vaultLoadout
	f0_local0( f3_arg0, f3_arg1 )
	f3_arg0.bindButton:addEventHandler( "button_secondary", function ( f4_arg0, f4_arg1 )
		ACTIONS.LeaveMenu( f3_arg0, false )
	end )
	local f3_local0 = (LAYOUT.GetElementWidth( f3_arg0.MissingItemsWarning.Icon, f3_arg1 ) + LAYOUT.GetTextWidth( f3_arg0.MissingItemsWarning.Text, f3_arg1 )) * 0.5
	f3_arg0.MissingItemsWarning:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, -f3_local0, f3_local0, _1080p * 265, _1080p * 297 )
	f3_arg0.PopupFrame.Stripe.HeaderText:setText( Engine[0xED84C33EC5F01EA]( "LOADOUT_VAULT/LOADOUT_DETAILS" ), MarkLocalized( f3_arg0._loadout.name:get() ) )
	f3_arg0.PopupFrame.Background:SetVisibility( LUI.Visibility.Hidden )
	f3_arg0.Perks:ToggleDisabledState( true, true )
	f3_arg0.Perks:ToggleFocusState( false, true )
	f3_arg0.LethalEquipment:ToggleDisabledState( true, true )
	f3_arg0.LethalEquipment:ToggleFocusState( false, true )
	ACTIONS.AnimateSequence( f3_arg0.LethalEquipment, "LoadoutVaultDetails" )
	f3_arg0.TacticalEquipment:ToggleDisabledState( true, true )
	f3_arg0.TacticalEquipment:ToggleFocusState( false, true )
	ACTIONS.AnimateSequence( f3_arg0.TacticalEquipment, "LoadoutVaultDetails" )
end

function LoadoutVaultDetails( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "LoadoutVaultDetails"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	self.HelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	self.HelperBar.id = "HelperBar"
	self.HelperBar:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -85, 0 )
	self.HelperBar:setPriority( 10 )
	self:addElement( self.HelperBar )
	local f1_local2 = self
	local Blur = nil
	
	Blur = LUI.UIBlur.new()
	Blur.id = "Blur"
	ACTIONS.ScaleFullscreen( Blur )
	Blur:SetRGBFromTable( SWATCHES.highlight.vGrayBlur, 0 )
	Blur:SetBlurStrength( 2, 0 )
	self:addElement( Blur )
	self.Blur = Blur
	
	local Backer = nil
	
	Backer = LUI.UIImage.new()
	Backer.id = "Backer"
	ACTIONS.ScaleFullscreen( Backer )
	Backer:SetVisibility( LUI.Visibility.Hidden )
	Backer:SetRGBFromTable( SWATCHES.highlight.vOffBlack, 0 )
	Backer:SetAlpha( 0.6, 0 )
	self:addElement( Backer )
	self.Backer = Backer
	
	local PopupFrame = nil
	
	PopupFrame = MenuBuilder.BuildRegisteredType( "PopupFrame", {
		controllerIndex = f1_local1
	} )
	PopupFrame.id = "PopupFrame"
	ACTIONS.ScaleFullscreen( PopupFrame )
	PopupFrame.Stripe:SetTop( _1080p * -375, 0 )
	PopupFrame.Stripe:SetBottom( _1080p * 300, 0 )
	PopupFrame.Stripe.HeaderText:SetLeft( _1080p * -750, 0 )
	PopupFrame.Stripe.HeaderText:SetRight( _1080p * 750, 0 )
	PopupFrame.Stripe.HeaderText:SetAlignment( LUI.Alignment.Center )
	PopupFrame:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	self:addElement( PopupFrame )
	self.PopupFrame = PopupFrame
	
	local Tabs = nil
	
	Tabs = LUI.TabManager.new( {
		spacing = 0,
		wrap = false,
		tabHeight = _1080p * 45,
		buildTab = function ()
			return MenuBuilder.BuildRegisteredType( "SubMenuTab", {
				controllerIndex = menu
			} )
		end,
		controllerIndex = f1_local1
	} )
	Tabs.id = "Tabs"
	Tabs:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -500, _1080p * 500, _1080p * -218, _1080p * -173 )
	self:addElement( Tabs )
	self.Tabs = Tabs
	
	local Weapon = nil
	
	Weapon = MenuBuilder.BuildRegisteredType( "WeaponNameAndIcon", {
		controllerIndex = f1_local1
	} )
	Weapon.id = "Weapon"
	Weapon.WeaponName:SetAlignment( LUI.Alignment.Left )
	Weapon:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -270, _1080p * 270, _1080p * 492, _1080p * 712 )
	self:addElement( Weapon )
	self.Weapon = Weapon
	
	local Attachments = nil
	
	Attachments = MenuBuilder.BuildRegisteredType( "AttachmentGrid", {
		controllerIndex = f1_local1
	} )
	Attachments.id = "Attachments"
	Attachments:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -262, _1080p * 500, _1080p * 402, _1080p * 911 )
	self:addElement( Attachments )
	self.Attachments = Attachments
	
	local MissingItemsWarning = nil
	
	MissingItemsWarning = MenuBuilder.BuildRegisteredType( "LabeledIcon", {
		controllerIndex = f1_local1
	} )
	MissingItemsWarning.id = "MissingItemsWarning"
	MissingItemsWarning.Text:SetRGBFromTable( SWATCHES.genericMenu.warning, 0 )
	MissingItemsWarning.Text:SetAlpha( 1, 0 )
	MissingItemsWarning.Text:setText( Engine[0xED84C33EC5F01EA]( "LOADOUT_VAULT/LOADOUT_MISSING_ITEMS" ), 0 )
	MissingItemsWarning.Icon:SetVisibility( LUI.Visibility.Hidden )
	MissingItemsWarning.Icon:SetRGBFromInt( 16777215, 0 )
	MissingItemsWarning.Icon:setImage( RegisterMaterial( "ui_streak_warning" ), 0 )
	MissingItemsWarning:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -317, _1080p * 317, _1080p * 275, _1080p * 307 )
	self:addElement( MissingItemsWarning )
	self.MissingItemsWarning = MissingItemsWarning
	
	local Perks = nil
	
	Perks = MenuBuilder.BuildRegisteredType( "LoadoutItemPerkButton", {
		controllerIndex = f1_local1
	} )
	Perks.id = "Perks"
	Perks:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -475, _1080p * -15, _1080p * 438, _1080p * 593 )
	self:addElement( Perks )
	self.Perks = Perks
	
	local LethalEquipment = nil
	
	LethalEquipment = MenuBuilder.BuildRegisteredType( "LoadoutItemButton", {
		controllerIndex = f1_local1
	} )
	LethalEquipment.id = "LethalEquipment"
	LethalEquipment:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * 15, _1080p * 415, _1080p * 437, _1080p * 512 )
	self:addElement( LethalEquipment )
	self.LethalEquipment = LethalEquipment
	
	local TacticalEquipment = nil
	
	TacticalEquipment = MenuBuilder.BuildRegisteredType( "LoadoutItemButton", {
		controllerIndex = f1_local1
	} )
	TacticalEquipment.id = "TacticalEquipment"
	TacticalEquipment:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * 15, _1080p * 415, _1080p * 518, _1080p * 593 )
	self:addElement( TacticalEquipment )
	self.TacticalEquipment = TacticalEquipment
	
	self.HelperBar.ButtonHelperText:PushButtonPrompt( {
		side = "left",
		button_ref = "button_secondary",
		helper_text = Engine[0xED84C33EC5F01EA]( "LUA_MENU/BACK" )
	} )
	if not self.bindButton then
		local f1_local13 = LUI.UIBindButton.new()
		f1_local13.id = "selfBindButton"
		self:addElement( f1_local13 )
		self.bindButton = f1_local13
	end
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "LoadoutVaultDetails", LoadoutVaultDetails )
LockTable( _M )
