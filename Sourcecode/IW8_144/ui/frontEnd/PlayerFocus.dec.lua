-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 27-09-2025 22:41
module( ..., package.seeall )
FrontEndScene.RegisterScene( "PlayerFocus", "squad_lobby" )
local f0_local0 = function ( f6_arg0, f6_arg1, f6_arg2 )
	if not f6_arg0.lobbyMemberGrid then
		if not f6_arg2 then
			f6_arg2 = {}
		end
		f6_arg2.controllerIndex = f6_arg1
		f6_arg2.modelPath = Lobby.AllMembersPath
		f6_arg2.parent = f6_arg0
		f6_arg0.lobbyMemberGrid = MenuBuilder.BuildRegisteredType( "LobbyMemberGrid", f6_arg2 )
		f6_arg0:addElement( f6_arg0.lobbyMemberGrid )
		f6_arg0.lobbyMemberGrid:processEvent( {
			name = "gain_focus"
		} )
	end
end

local f0_local1 = function ( f3_arg0, f3_arg1, f3_arg2 )
	FrontEndScene.HideAllCharacters()
	f3_arg0:SubscribeToModel( DataSources.frontEnd.lobby.memberCount:GetModel( f3_arg1 ), function ()
		f3_arg0( f3_arg0, f3_arg0, f3_arg0 )
	end )
	local f3_local0 = function ()
		local f4_local0 = f3_arg0:GetDataSource()
		f3_arg0.PlayerFocusDetails:SetDataSource( f4_local0, f3_arg0 )
		local f4_local1, f4_local2 = nil
		local f4_local3 = f4_local0.selectedOperatorIndex:GetValue( f3_arg0 )
		if f4_local3 then
			if f4_local3 == OPERATOR.SuperFaction.WEST then
				f4_local1 = f4_local0.bodyWest:GetValue( f3_arg0 )
				f4_local2 = f4_local0.headWest:GetValue( f3_arg0 )
			else
				f4_local1 = f4_local0.bodyEast:GetValue( f3_arg0 )
				f4_local2 = f4_local0.headEast:GetValue( f3_arg0 )
			end
		end
		if f4_local1 ~= nil and f4_local2 ~= nil then
			local f4_local4, f4_local5 = Lobby.GetHeadAndBodyModelsToUse( f4_local1, f4_local2, f3_arg0 )
			local f4_local6 = Lobby.InferOperatorRefFromModel( f4_local4, f4_local5 )
			if f4_local6 and 0 < #f4_local6 then
				f3_arg0.PlayerFocusOperatorInfo:SetInfo( f4_local6, f4_local4, f4_local5 )
				FrontEndScene.RequestBodyModels( {
					f4_local4
				} )
				FrontEndScene.RequestHeadModels( {
					f4_local5
				} )
				Lobby.UpdateLocalClientCharacter( f3_arg0, FrontEndScene.ClientCharacters.LocalSquadMember, f4_local4, f4_local5, 1 )
			end
		end
	end
	
	f3_arg0:SubscribeToModelThroughElement( f3_arg0, "bodyWest", f3_local0 )
	f3_arg0:SubscribeToModelThroughElement( f3_arg0, "headWest", f3_local0 )
	f3_arg0:SubscribeToModelThroughElement( f3_arg0, "bodyEast", f3_local0 )
	f3_arg0:SubscribeToModelThroughElement( f3_arg0, "headEast", f3_local0 )
	f3_arg0:SubscribeToModelThroughElement( f3_arg0, "selectedOperatorIndex", f3_local0 )
end

function PlayerFocus( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "PlayerFocus"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	self.HelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	self.HelperBar.id = "HelperBar"
	self.HelperBar:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -85, 0 )
	self.HelperBar:setPriority( 10 )
	self:addElement( self.HelperBar )
	local f1_local2 = self
	local MenuTitle = nil
	
	MenuTitle = MenuBuilder.BuildRegisteredType( "MenuTitle", {
		controllerIndex = f1_local1
	} )
	MenuTitle.id = "MenuTitle"
	MenuTitle.MenuTitle:setText( Engine.CBBHFCGDIC( "LUA_MENU/PLAYER_LOBBY" ), 0 )
	MenuTitle:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1024, 0, _1080p * 100 )
	self:addElement( MenuTitle )
	self.MenuTitle = MenuTitle
	
	local PlayerFocusDetails = nil
	
	PlayerFocusDetails = MenuBuilder.BuildRegisteredType( "PlayerFocusDetails", {
		controllerIndex = f1_local1
	} )
	PlayerFocusDetails.id = "PlayerFocusDetails"
	PlayerFocusDetails:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 647, _1080p * 1197, _1080p * 154, _1080p * 979 )
	self:addElement( PlayerFocusDetails )
	self.PlayerFocusDetails = PlayerFocusDetails
	
	local PlayerFocusOperatorInfo = nil
	
	PlayerFocusOperatorInfo = MenuBuilder.BuildRegisteredType( "PlayerFocusOperatorInfo", {
		controllerIndex = f1_local1
	} )
	PlayerFocusOperatorInfo.id = "PlayerFocusOperatorInfo"
	PlayerFocusOperatorInfo.OperatorName:SetAlignment( LUI.Alignment.Left )
	PlayerFocusOperatorInfo.OperatorFactionName:SetAlignment( LUI.Alignment.Left )
	PlayerFocusOperatorInfo:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1224, _1080p * 1824, _1080p * 415, _1080p * 665 )
	self:addElement( PlayerFocusOperatorInfo )
	self.PlayerFocusOperatorInfo = PlayerFocusOperatorInfo
	
	self.HelperBar.ButtonHelperText:PushButtonPrompt( {
		side = "left",
		button_ref = "button_secondary",
		helper_text = Engine.CBBHFCGDIC( "LUA_MENU/BACK" )
	} )
	self.HelperBar.ButtonHelperText:PushButtonPrompt( {
		side = "left",
		button_ref = "button_primary",
		helper_text = Engine.CBBHFCGDIC( "LUA_MENU/VIEW_PROFILE" )
	} )
	
	local bindButton = LUI.UIBindButton.new()
	bindButton.id = "selfBindButton"
	self:addElement( bindButton )
	self.bindButton = bindButton
	
	self.bindButton:addEventHandler( "button_secondary", function ( f2_arg0, f2_arg1 )
		local f2_local0 = f2_arg1.controller or menu
		ACTIONS.LeaveMenu( menu )
	end )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "PlayerFocus", PlayerFocus )
LockTable( _M )
