-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
module( ..., package.seeall )
require( "ui.inGame.InGameMenuBackground" )
require( "ui.inGame.InGameMenuTimerStatus" )
require( "ui.widgets.WeaponAttributes" )
require( "ui.frontEnd.GunsmithButton" )
require( "ui.widgets.GunsmithEquippedSlots" )
require( "ui.widgets.LobbyMembersFooter" )
require( "ui.widgets.CDLRestrictionTag" )
require( "ui.frontEnd.GunsmithUndoPrompt" )
require( "ui.widgets.ButtonPromptContainer" )
local f0_local0 = "GunsmithButton"
local f0_local1 = false
local f0_local2 = true
local f0_local3 = 150
local f0_local4 = GUNSMITH.maxCategories
local f0_local5 = 4
local f0_local6 = nil
local f0_local7 = function ()
	return {
		{
			nil,
			1,
			5
		},
		{
			nil,
			2,
			6,
			7
		},
		{
			nil,
			3,
			8
		},
		{
			nil,
			4,
			10,
			9
		}
	}
end

local f0_local8 = function ( f53_arg0, f53_arg1 )
	local f53_local0 = f53_arg0[f0_local0 .. f53_arg1]
	assert( f53_local0 )
	return f53_local0
end

local f0_local9 = function ( f52_arg0, f52_arg1 )
	return f52_arg0[f0_local0 .. f52_arg1]
end

local f0_local10 = function ( f51_arg0, f51_arg1 )
	return f51_arg0._usedButtons[f51_arg1] ~= nil
end

local f0_local11 = function ( f50_arg0, f50_arg1 )
	assert( f50_arg1 )
	local f50_local0 = f50_arg1:GetCurrentAnchorsAndPositions()
	return (f50_local0.bottom + f50_local0.top) / 2
end

local f0_local12 = function ( f49_arg0 )
	for f49_local0 = 1, f0_local0, 1 do
		if not f49_arg0._usedButtons[f49_local0] then
			local f49_local3 = f49_arg0:GetGunsmithButton( f49_local0 )
			f49_local3:closeTree()
			f49_arg0[f0_local0 .. f49_local0] = nil
		end
	end
	f49_arg0._buttonsRemoved = true
end

local f0_local13 = function ( f48_arg0 )
	local f48_local0 = 0
	for f48_local4, f48_local5 in ipairs( f48_arg0._weaponTable.attachments ) do
		if f48_local5.ref ~= ATTACHMENT.none then
			f48_local0 = f48_local0 + 1
		end
	end
	f48_arg0.EquippedCount.EquippedTxt:setText( Engine[0xED84C33EC5F01EA]( "LUA_MENU/EQUIPPED" ) )
	f48_arg0.EquippedCount.Equipped:setText( f48_local0 )
	f48_arg0.EquippedCount.Count:setText( Engine[0xED84C33EC5F01EA]( "LUA_MENU/TOTAL_COUNT", ATTACHMENT.count ) )
	f48_arg0.EquippedCount:SetupCount( f48_local0 )
	f48_local1 = 10 * _1080p
	f48_local2 = 30 * _1080p
	f48_local3 = LAYOUT.GetTextWidth( f48_arg0.EquippedCount.EquippedTxt ) / _1080p + f48_local1
	f48_local4 = LAYOUT.GetTextWidth( f48_arg0.EquippedCount.Equipped ) / _1080p
	f48_local5 = LAYOUT.GetTextWidth( f48_arg0.EquippedCount.Count ) / _1080p
	local f48_local6 = f48_local3 + f48_local4
	local f48_local7 = f48_local6 + f48_local5 + f48_local2
	f48_arg0.EquippedCount.Equipped:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * f48_local3, _1080p * 300, 0, _1080p * 34 )
	f48_arg0.EquippedCount.Count:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * f48_local6, _1080p * 350, 0, _1080p * 32 )
	f48_arg0.EquippedCount.EquippedSlots:SetAnchorsAndPosition( 0, 1, 0.5, 0.5, _1080p * f48_local7, _1080p * f48_local7 + 320, _1080p * -16, _1080p * 16 )
	if IsLanguageArabic() then
		f48_arg0.EquippedCount.Equipped:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * f48_local3, _1080p * 320, 0, _1080p * 32 )
		f48_arg0.EquippedCount.Count:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * f48_local6, _1080p * 350, 0, _1080p * 32 )
		f48_arg0.EquippedCount.EquippedSlots:SetAnchorsAndPosition( -0.1, 1, 0.5, 0.5, _1080p * f48_local7, _1080p * f48_local7 + 320, _1080p * -16, _1080p * 16 )
	end
end

local f0_local14 = function ( f43_arg0, f43_arg1 )
	assert( not LUI.HasHideableItemsLogic( f43_arg0, f43_arg1 ) )
	local f43_local0 = {}
	for f43_local5, f43_local6 in pairs( f43_arg0._usedButtons ) do
		if f43_local6 then
			local f43_local4 = f43_arg0:GetGunsmithButton( f43_local5 )
			if not f43_local4:IsNewItemNotificationVisible() then
				table.insert( f43_local0, f43_local4 )
			end
		end
	end
	f43_local1 = NewUnlockIndicatorUtils.InNewItemsMode( f43_arg1 )
	f43_local2 = 200
	LUI.AddHideableItemsLogic( f43_arg0, f43_arg1, {
		items = f43_local0,
		hidden = f43_local1,
		FocusNearestElement = function ( f47_arg0, f47_arg1, f47_arg2 )
			local f47_local0 = f47_arg1:getParent()
			if LUI.HideableItemsUtils.FocusNearestElementList( f47_local0, f47_arg1, f47_arg2 ) == nil then
				local f47_local1
				if f47_local0 == f47_arg0._topNavigator then
					f47_local1 = f47_arg0._bottomNavigator
					if not f47_local1 then
					
					else
						local f47_local2 = FindClosestButtonNew( f47_arg0, f47_arg1, f47_local1 == f47_arg0._topNavigator )
						if f47_local2 then
							f47_local2:processEvent( {
								name = "gain_focus",
								controller = f47_arg2
							} )
						end
					end
				end
				f47_local1 = f47_arg0._topNavigator
			end
		end,
		ShowElement = function ( f46_arg0, f46_arg1, f46_arg2 )
			local f46_local0 = f46_arg1
			local f46_local1 = f46_arg1.SetAlpha
			local f46_local2 = 1
			local f46_local3
			if f46_arg2 then
				f46_local3 = 0
			else
				f46_local3 = f43_arg0
			end
			f46_local1( f46_local0, f46_local2, f46_local3 )
		end,
		HideElement = function ( f45_arg0, f45_arg1, f45_arg2, f45_arg3 )
			local f45_local0 = f45_arg1
			local f45_local1 = f45_arg1.SetAlpha
			local f45_local2 = 0
			local f45_local3
			if f45_arg2 then
				f45_local3 = 0
			else
				f45_local3 = f43_arg0
			end
			f45_local1( f45_local0, f45_local2, f45_local3 )
		end
	} )
	f43_arg0:addEventHandler( "toggle_new_items_mode", function ( f44_arg0, f44_arg1 )
		f44_arg0:SetItemsHidden( f44_arg1.enabled, f44_arg1.controllerIndex, f44_arg1.instantly )
		return true
	end )
end

local f0_local15 = function ( f42_arg0, f42_arg1, f42_arg2 )
	local f42_local0 = {}
	local f42_local1 = 1
	for f42_local5, f42_local6 in ipairs( f42_arg1 ) do
		if f42_arg2( f42_arg0, f42_local6 ) then
			f42_local0[f42_local1] = f42_local6
			f42_local1 = f42_local1 + 1
		end
	end
	return f42_local0
end

local f0_local16 = function ( f41_arg0, f41_arg1, f41_arg2 )
	return math.abs( f0_local0( f41_arg0, f0_local0( f41_arg0, f41_arg1 ) ) - f0_local0( f41_arg0, f0_local0( f41_arg0, f41_arg2 ) ) )
end

local f0_local17 = function ( f40_arg0, f40_arg1 )
	return f0_local0( f40_arg0, f40_arg1, f40_arg0._buttonSetupFocusIndex ) < f0_local0
end

local f0_local18 = function ( f39_arg0, f39_arg1, f39_arg2 )
	return #f39_arg0._columnButtons[f39_arg1] == f39_arg2
end

local f0_local19 = function ( f38_arg0, f38_arg1 )
	return f38_arg1 == 1
end

local f0_local20 = function ( f36_arg0, f36_arg1, f36_arg2, f36_arg3 )
	if f36_arg2 and f0_local0( f36_arg0, f36_arg1[1] ) then
		local f36_local0 = f36_arg1[1]
	elseif f36_arg3 and f0_local0( f36_arg0, f36_arg1[#f36_arg1] ) then
		local f36_local0 = f36_arg1[#f36_arg1]
	else
		local f36_local0 = f0_local0( f36_arg0, f36_arg1, f0_local0 )
		if next( f36_local0 ) == nil then
			local f36_local1 = nil
		end
		local f36_local1
		if 0 <= f0_local0 then
			f36_local1 = f0_local0( f36_arg0, f36_local0, f0_local0 )
			if not f36_local1 then
			
			else
				if next( f36_local1 ) == nil then
					local f36_local2 = nil
				end
				if 1 < #f36_local1 then
					table.sort( f36_local1, function ( f37_arg0, f37_arg1 )
						return f36_arg0( f36_arg0, f37_arg0, f36_arg0._buttonSetupFocusIndex ) <= f36_arg0( f36_arg0, f37_arg1, f36_arg0._buttonSetupFocusIndex )
					end )
				end
				return f36_local1[1]
			end
		end
		f36_local1 = f36_local0
	end
end

local f0_local21 = function ( f35_arg0, f35_arg1, f35_arg2, f35_arg3 )
	f35_arg0._buttonSetupFocusIndex = f35_arg0._columnButtons[f35_arg2][f35_arg3]
	local f35_local0 = nil
	local f35_local1 = f0_local0 and f0_local0( f35_arg0, f35_arg2, f35_arg3 ) or false
	local f35_local2 = f0_local0 and f0_local0( f35_arg0, f35_arg2, f35_arg3 ) or false
	local f35_local3 = nil
	local f35_local4 = f35_arg2
	if f35_local0 == nil then
		
	else
		
	end
	if f35_local0 == nil then
		return f35_arg0:GetGunsmithButton( f35_arg0._columnButtons[f35_arg2][f35_arg3] )
	else
		return f35_arg0:GetGunsmithButton( f35_local0 )
	end
end

local f0_local22 = function ( f34_arg0, f34_arg1, f34_arg2, f34_arg3 )
	local f34_local0 = f34_arg2
	local f34_local1 = #f34_arg0._columnButtons[f34_arg1]
	for f34_local2 = 1, f34_local1, 1 do
		local f34_local5 = f34_arg3( f34_local2, f34_arg2, f34_local1 )
		if f0_local0( f34_arg0, f34_arg0._columnButtons[f34_arg1][f34_local5] ) then
			return f34_arg0:GetGunsmithButton( f34_arg0._columnButtons[f34_arg1][f34_local5] )
		end
	end
	return f34_arg0:GetGunsmithButton( f34_arg0._columnButtons[f34_arg1][f34_arg2] )
end

local f0_local23 = function ( f33_arg0, f33_arg1 )
	local f33_local0 = {}
	local f33_local1 = 1
	for f33_local5, f33_local6 in ipairs( f33_arg0._columnButtons[f33_arg1] ) do
		if f0_local0 < f33_local6 and f0_local0( f33_arg0, f33_local6 ) then
			f33_local0[f33_local1] = f33_arg0:GetGunsmithButton( f33_local6 )
			f33_local1 = f33_local1 + 1
		end
	end
	return f33_local0
end

local f0_local24 = function ( f28_arg0 )
	local f28_local0, f28_local1, f28_local2, f28_local3 = nil
	for f28_local11, f28_local12 in ipairs( f28_arg0._columnButtons ) do
		for f28_local7, f28_local8 in ipairs( f28_local12 ) do
			local f28_local10 = f28_arg0:GetGunsmithButton( f28_local8 )
			f28_local10.navigation = f28_local10.navigation or {}
			if f0_local0( f28_arg0, f28_local8 ) then
				if f28_local0 == nil and f28_local8 <= f0_local0 and not f28_local8 then
					f28_local0 = f28_local8
				else
					
				end
				if f28_local8 <= f0_local0 and not f28_local8 then
					f28_local1 = f28_local8
				else
					
				end
				if f28_local2 == nil and f0_local0 < f28_local8 and not f28_local11 then
					f28_local2 = f28_local11
				else
					
				end
				if f0_local0 < f28_local8 and not f28_local11 then
					f28_local3 = f28_local11
				else
					
				end
				f28_local10.navigation.down = f0_local0( f28_arg0, f28_local11, f28_local7, function ( f32_arg0, f32_arg1, f32_arg2 )
					local f32_local0
					if f32_arg2 < f32_arg1 + 1 then
						f32_local0 = f32_arg1 + 1 - f32_arg2
						if not f32_local0 then
						
						else
							return f32_local0
						end
					end
					f32_local0 = f32_arg1 + f32_arg0
				end )
				f28_local10.navigation.up = f0_local0( f28_arg0, f28_local11, f28_local7, function ( f31_arg0, f31_arg1, f31_arg2 )
					local f31_local0 = f31_arg1 - f31_arg0
					local f31_local1 = 1
					return REG5 and f31_arg1 - f31_arg0 + f31_arg2 or f31_arg1 - f31_arg0
				end )
				f28_local10.navigation.left = f0_local0( f28_arg0, function ( f30_arg0, f30_arg1 )
					local f30_local0 = 1 and f30_arg1 - 1 or #f30_arg0._columnButtons
					return f30_arg0._columnButtons[f30_local0], f30_local0
				end, f28_local11, f28_local7 )
				f28_local10.navigation.right = f0_local0( f28_arg0, function ( f29_arg0, f29_arg1 )
					local f29_local0
					if f29_arg1 < #f29_arg0._columnButtons then
						f29_local0 = f29_arg1 + 1
						if not f29_local0 then
						
						else
							return f29_arg0._columnButtons[f29_local0], f29_local0
						end
					end
					f29_local0 = 1
				end, f28_local11, f28_local7 )
			end
		end
	end
	if f0_local0 and f28_local0 ~= nil and f28_local3 ~= nil then
		f28_local4 = f28_arg0:GetGunsmithButton( f28_local0 )
		f28_local5 = f0_local0( f28_arg0, f28_local3 )
		f28_local4.navigation.left = f28_local5[#f28_local5]
		for f28_local13, f28_local14 in pairs( f28_local5 ) do
			f28_local14.navigation.right = f28_local4
		end
	end
	if f0_local0 and f28_local2 ~= nil and f28_local1 ~= nil then
		f28_local4 = f28_arg0:GetGunsmithButton( f28_local1 )
		f28_local5 = f0_local0( f28_arg0, f28_local2 )
		f28_local4.navigation.right = f28_local5[#f28_local5]
		for f28_local13, f28_local14 in pairs( f28_local5 ) do
			f28_local14.navigation.left = f28_local4
		end
	end
end

local f0_local25 = function ( f27_arg0, f27_arg1 )
	local f27_local0 = GUNSMITH.GetBlockedCategories( f27_arg0._weaponTable )
	for f27_local5, f27_local6 in pairs( f27_arg0._usedButtons ) do
		if f27_local6 then
			local f27_local4 = f27_arg0:GetGunsmithButton( f27_local5 )
			f27_local4:Setup( f27_arg1, f27_local6, f27_arg0._attachments[f27_local6], f27_arg0._weaponTable, f27_local0[f27_local6] )
		end
	end
	if not f27_arg0._buttonsRemoved then
		f0_local0( f27_arg0 )
	end
	if CONDITIONS.IsGetMockNewItemsEnabled() then
		for f27_local5, f27_local6 in pairs( f27_arg0._usedButtons ) do
			if f27_local6 then
				local f27_local4 = f27_arg0:GetGunsmithButton( f27_local5 )
				f27_local4:SetNewItemNotificationVisible( f27_local5 % 2 == 0 )
			end
		end
		NewUnlockIndicatorUtils.RegisterMockNewItems( "GunsmithAttachments", true )
	end
	if not LUI.HasHideableItemsLogic( f27_arg0, f27_arg1 ) then
		f0_local0( f27_arg0, f27_arg1 )
	end
end

local f0_local26 = function ( f26_arg0 )
	local f26_local0 = {}
	for f26_local6, f26_local7 in pairs( f26_arg0._usedButtons ) do
		if f26_local7 then
			local f26_local4 = GUNSMITH.GetSelectedAttachIndexForCategory( f26_local7, f26_arg0._weaponTable )
			local f26_local5
			if f26_local4 then
				f26_local5 = f26_local4
			else
				f26_local5 = f26_arg0._weaponTable.attachments[f26_local4].ref
			end
			if f26_local4 then
				f26_local0[f26_local7] = {
					attachSlot = f26_local4,
					ref = f26_local5
				}
			end
		end
	end
	return f26_local0
end

local f0_local27 = function ( f25_arg0, f25_arg1, f25_arg2 )
	f25_arg0._weaponTable = WEAPON.GenerateWeaponTable( f25_arg2 )
	f0_local0( f25_arg0, f25_arg1 )
	for f25_local4, f25_local5 in pairs( f25_arg0._usedButtons ) do
		if f25_local5 then
			local f25_local3 = f25_arg0:GetGunsmithButton( f25_local4 )
			if f25_local3:isInFocus() then
				f25_local3:processEvent( {
					name = "button_over"
				} )
			end
		end
	end
	f25_local0 = f25_arg0:getParent()
	if f25_local0 and f25_local0._weaponModel then
		WEAPON.LoadAndSetModel( f25_arg1, f25_local0._weaponModel, f25_arg0._weaponTable )
	end
	f25_arg0.WeaponAttributes:Setup( f25_arg0._weaponTable )
	f0_local0( f25_arg0 )
	f25_local1 = LUI.FlowManager.GetScopedData( f25_arg0 )
	f25_local1.GunsmithAttachments = f25_local1.GunsmithAttachments or {}
	f25_local1.GunsmithAttachments.previousAttachments = f0_local0( f25_arg0 )
end

local f0_local28 = function ( f24_arg0, f24_arg1 )
	local f24_local0 = f24_arg0:GetCurrentMenu()
	if f24_local0 and f24_local0 and f24_local0.HelperBar then
		f24_local0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			clickable = true,
			priority = 20,
			ignoreTooltipPrompt = true,
			button_ref = "button_select",
			helper_text = Engine[0xED84C33EC5F01EA]( "CAS/UNDO" ),
			container = f24_arg0.GunsmithUndoPromptButtonContainer
		} )
	end
end

local f0_local29 = function ( f23_arg0 )
	local f23_local0 = f23_arg0:GetCurrentMenu()
	if f23_local0 and f23_local0.HelperBar then
		f23_local0.HelperBar.ButtonHelperText:PopButtonPrompt( {
			button_ref = "button_select"
		} )
	end
end

local f0_local30 = function ( f22_arg0 )
	local f22_local0 = f22_arg0:GetCurrentMenu()
	if f22_local0 and f22_local0.HelperBar then
		return f22_local0.HelperBar.ButtonHelperText:GetPromptByButtonRef( "button_select" )
	else
		return false
	end
end

local f0_local31 = function ( f21_arg0, f21_arg1 )
	local f21_local0 = LUI.FlowManager.GetScopedData( f21_arg0 )
	f21_local0.GunsmithAttachments.undoState = nil
	if LUI.IsLastInputGamepad( f21_arg1 ) then
		f21_arg0.GunsmithUndoPrompt:EndUndo( false )
		f21_arg0.GunsmithUndoPrompt:Hide()
	else
		f21_arg0:HideUndoPromptPC()
	end
end

local f0_local32 = function ( f20_arg0, f20_arg1 )
	local f20_local0 = LUI.FlowManager.GetScopedData( f20_arg0 )
	assert( f20_local0.GunsmithAttachments.undoState ~= nil )
	for f20_local11, f20_local12 in pairs( f20_arg0._usedButtons ) do
		if f20_local12 then
			local f20_local4 = f20_arg0:GetGunsmithButton( f20_local11 )
			local f20_local5 = false
			for f20_local9, f20_local10 in ipairs( f20_local0.GunsmithAttachments.undoState ) do
				if f20_local10.category == f20_local12 then
					f20_local5 = true
					break
				end
			end
			if f20_local5 then
				if LUI.IsLastInputGamepad( f20_arg1 ) then
					f20_arg0.GunsmithUndoPrompt:Show()
				else
					f20_arg0.needUndoPCPromptShowing = true
				end
			end
		end
	end
end

local f0_local33 = function ( f19_arg0, f19_arg1, f19_arg2 )
	local f19_local0 = LUI.FlowManager.GetScopedData( f19_arg0 )
	if f19_local0.GunsmithAttachments.undoState ~= nil then
		local f19_local1 = f19_local0.GunsmithAttachments.undoState[1]
		local f19_local2 = f19_local1.attachSlot
		local f19_local3 = f19_local1.previousAttachment
		if f19_local3 == nil then
			GUNSMITH.EquipAttachment( f19_arg0, f19_arg2, ATTACHMENT.none, f19_arg1, {
				attachSlot = f19_local2
			} )
		else
			GUNSMITH.EquipAttachment( f19_arg0, f19_arg2, f19_local3, f19_arg1, {
				attachSlot = f19_local2
			} )
		end
		table.remove( f19_local0.GunsmithAttachments.undoState, 1 )
		if 0 < #f19_local0.GunsmithAttachments.undoState then
			if LUI.IsLastInputGamepad( f19_arg2 ) then
				f19_arg0.GunsmithUndoPrompt:Reset()
			else
				f19_arg0:ShowUndoPromptPC( f19_arg2 )
			end
		else
			f0_local0( f19_arg0, f19_arg2 )
		end
		f0_local0( f19_arg0, f19_arg2, f19_arg1 )
	end
end

local f0_local34 = function ( f18_arg0, f18_arg1, f18_arg2 )
	if CONDITIONS.InNewItemsMode( f18_arg0._controllerIndex ) then
		ACTIONS.TurnOffNewItemsMode( f18_arg0, f18_arg0._controllerIndex, {
			instantly = true
		} )
	end
	local f18_local0 = LUI.FlowManager.GetScopedData( f18_arg1 )
	local f18_local1 = LOADOUT.GetLoadoutPlayerData( f18_arg0._controllerIndex, f18_local0.loadoutIndex )
	if CONDITIONS.IsWaveGameType() then
		local f18_local2 = PlayerData[0x8B73907B55C4D71]( f18_arg0._controllerIndex, LOADOUT.GetLoadoutStatsGroup() )
		f18_local1 = f18_local2.squadMembers.loadoutWaveMode
	end
	f18_arg0._weaponPlayerData = f18_local1.weaponSetups[f18_local0.weaponSlot]
	f18_arg0._weaponTable = WEAPON.GenerateWeaponTable( f18_arg0._weaponPlayerData )
	local f18_local2 = f18_arg0._weaponTable.weapon
	local f18_local3 = {
		weaponSlot = f18_local0.weaponSlot,
		loadoutIndex = f18_local0.loadoutIndex,
		category = f18_arg1._category,
		attachSlot = f18_arg1._selectedIndex,
		attachments = f18_arg1._attachments,
		quickSelect = f18_arg2
	}
	if Engine[0x12586A3F4FB490E]() and f18_arg1._category then
		local f18_local4 = GUNSMITH.GetAttachmentCategoryScene( f18_local2, f18_arg1._category )
		if f18_local4 then
			Engine[0x685AE31DEDA30A4]( f18_local4 )
		end
	end
	if not f18_arg0._disableAttachmentSelect then
		LUI.FlowManager.RequestAddMenu( "AttachmentSelect", true, f18_arg0._controllerIndex, false, f18_local3, true, true )
	end
end

local f0_local35 = function ( f12_arg0, f12_arg1, f12_arg2 )
	local selfBindButton = LUI.UIBindButton.new()
	selfBindButton.id = "selfBindButton"
	f12_arg0:addElement( selfBindButton )
	f12_arg0.selfBindButton = selfBindButton
	
	local f12_local1 = function ( f17_arg0 )
		local f17_local0 = LUI.FlowManager.GetScopedData( f17_arg0 )
		if f17_local0.selectedIndex then
			f12_arg0( f12_arg0, f12_arg0 )
			GUNSMITH.EquipAttachment( nil, f12_arg0, ATTACHMENT.none, f12_arg0, {
				attachSlot = f17_local0.selectedIndex
			} )
			f12_arg0( f12_arg0, f12_arg0, f12_arg0 )
		end
	end
	
	f12_arg0.selfBindButton:registerEventHandler( "button_alt1", function ( element, event )
		f12_arg0( element )
	end )
	f12_arg0:addEventHandler( "contextual_menu_deselect_attachment", f12_local1 )
	f12_arg0:registerEventHandler( "perform_undo_action", function ( element, event )
		f12_arg0( f12_arg0, f12_arg0, f12_arg0 )
	end )
	f12_arg0:registerEventHandler( "gamepad_button", function ( element, event )
		if event.button == "secondary" then
			if event.down then
				if element.GunsmithUndoPrompt:Enabled() and LUI.IsLastInputGamepad( event.controller ) then
					element.GunsmithUndoPrompt:StartUndo()
				else
					element:dispatchEventToCurrentMenu( {
						name = "leave_gunsmith_menu"
					} )
				end
			elseif element.GunsmithUndoPrompt:Enabled() then
				element.GunsmithUndoPrompt:EndUndo( true )
			end
		end
		if event.button == "select" and LUI.IsLastInputKeyboardMouse( event.controller ) and event.down and element:UndoPromptPCEnabled() then
			element.GunsmithUndoPrompt:KBMUndo()
		end
	end )
	local f12_local2 = function ()
		if PROGRESSION.IsWeaponMaxLevel( f12_arg0, f12_arg0._weaponTable.weapon ) or PROGRESSION.ShouldUnlockAll() then
			return 
		else
			LUI.FlowManager.RequestPopupMenu( nil, "NextUnlocksPopup", true, f12_arg0, false, {
				weaponRef = f12_arg0._weaponTable.weapon,
				bucketItems = f12_arg0._bucketItems
			} )
		end
	end
	
end

local f0_local36 = function ( f11_arg0, f11_arg1 )
	local f11_local0 = f0_local0( f11_arg0 )
	local f11_local1 = LUI.FlowManager.GetScopedData( f11_arg0 )
	f11_local1.GunsmithAttachments = f11_local1.GunsmithAttachments or {}
	local f11_local2 = f11_local1.GunsmithAttachments.undoState or {}
	if f11_local1.GunsmithAttachments.previousAttachments then
		local f11_local3 = f11_local1.GunsmithAttachments.previousAttachments
		local f11_local4 = f11_local0
		for f11_local8, f11_local9 in pairs( f11_local3 ) do
			if not f11_local4[f11_local8] then
				table.insert( f11_local2, 1, {
					category = f11_local8,
					attachSlot = f11_local9.attachSlot,
					previousAttachment = f11_local9.ref
				} )
			end
		end
		for f11_local8, f11_local9 in pairs( f11_local4 ) do
			if f11_local3[f11_local8] == nil or not LUI.AreTableContentsEqual( f11_local9, f11_local3[f11_local8] ) then
				table.insert( f11_local2, 1, {
					category = f11_local8,
					attachSlot = f11_local9.attachSlot,
					previousAttachment = f11_local3[f11_local8] and f11_local3[f11_local8].ref or nil
				} )
			end
		end
		if 0 < #f11_local2 then
			f11_local1.GunsmithAttachments.undoState = f11_local2
			f11_local1.GunsmithAttachments.previousAttachments = f11_local0
			f0_local0( f11_arg0, f11_arg1 )
		end
	else
		f11_local1.GunsmithAttachments.previousAttachments = f11_local0
	end
end

local f0_local37 = function ( f7_arg0, f7_arg1, f7_arg2 )
	f7_arg0._controllerIndex = f7_arg1
	f7_arg0.GetGunsmithButton = f0_local0
	f7_arg0.GetGunsmithButtonIfExists = f0_local0
	f7_arg0.TryUndoAttachment = f0_local0
	f7_arg0.ShowUndoPromptPC = f0_local0
	f7_arg0.HideUndoPromptPC = f0_local0
	f7_arg0.UndoPromptPCEnabled = f0_local0
	assert( f7_arg0.WeaponAttributes )
	if Engine[0x2DA54CF5D6B7F02]() then
		if not f7_arg2.loadoutIndex then
			DebugPrint( "WARNING: Missing \"loadoutIndex\" option for Gunsmith menu. Only OK after a MyChanges." )
			f7_arg2.loadoutIndex = 0
		end
		if not f7_arg2.weaponSlot then
			DebugPrint( "WARNING: Missing \"weaponSlot\" option for Gunsmith menu. Only OK after a MyChanges." )
			f7_arg2.weaponSlot = 0
		end
	end
	assert( f7_arg2.loadoutPlayerData )
	assert( f7_arg2.weaponPlayerData )
	assert( f7_arg2.loadoutIndex )
	assert( f7_arg2.weaponSlot )
	local f7_local0 = f7_arg2.loadoutPlayerData
	local f7_local1 = f7_arg2.weaponPlayerData
	f7_arg0._weaponTable = WEAPON.GenerateWeaponTable( f7_local1 )
	f7_arg0._attachments, f7_arg0._bucketItems = GUNSMITH.GetAttachmentsAndBucketItems( f7_arg1, f7_arg0._weaponTable.weapon, f7_arg0._weaponTable.lootID )
	f7_arg0._usedButtons = GUNSMITH.GetUsedAttachmentIndices( f7_arg0._weaponTable.weapon, f7_arg0._attachments )
	f7_arg0._columnButtons = f0_local0( f7_arg0 )
	f0_local0( f7_arg0 )
	f0_local0( f7_arg0, f7_arg1 )
	f7_arg0.WeaponAttributes:Setup( f7_arg0._weaponTable )
	f7_arg0._disableAttachmentSelect = f7_arg2.disableAttachmentSelect
	f7_arg0.OpenAttachmentSelect = f0_local0
	f0_local0( f7_arg0 )
	f0_local0( f7_arg0, f7_arg1 )
	f0_local0( f7_arg0, f7_arg1, f7_local1 )
	if IsLanguageChinese() then
		ACTIONS.AnimateSequence( f7_arg0, "CH" )
	end
	f7_arg0.EquippedCount.EquippedTxt:SetNotifyOnStyledTextRender( true )
	f7_arg0.EquippedCount.EquippedTxt:addEventHandler( "styled_text_rendered", function ( f10_arg0, f10_arg1 )
		
	end )
	SEQUENCEPRESETS.RegisterAnimation( f7_arg0, LUI.Transition.TransNextFrom, "OutLeft", 0 )
	SEQUENCEPRESETS.RegisterAnimation( f7_arg0, LUI.Transition.TransNextTo, "InLeft", 0 )
	SEQUENCEPRESETS.RegisterAnimation( f7_arg0, LUI.Transition.TransPrevFrom, "OutRight", 0 )
	SEQUENCEPRESETS.RegisterAnimation( f7_arg0, LUI.Transition.TransPrevTo, "InRight", 0 )
	f7_arg0:addEventHandler( "menu_create", function ( f9_arg0, f9_arg1 )
		if f9_arg0.needUndoPCPromptShowing then
			f9_arg0:ShowUndoPromptPC( f9_arg1.controllerIndex )
			f9_arg0.needUndoPCPromptShowing = false
		end
	end )
	f7_arg0:addEventHandler( "update_input_type", function ( f8_arg0, f8_arg1 )
		if f8_arg0:UndoPromptPCEnabled() and LUI.IsLastInputGamepad( f8_arg1.controllerIndex ) then
			f8_arg0:HideUndoPromptPC()
			f8_arg0.GunsmithUndoPrompt:Reset()
		elseif f8_arg0.GunsmithUndoPrompt:Enabled() and LUI.IsLastInputKeyboardMouse( f8_arg1.controllerIndex ) then
			f8_arg0:ShowUndoPromptPC()
			f8_arg0.GunsmithUndoPrompt:Hide()
		end
	end )
end

function GunsmithAttachments( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "GunsmithAttachments"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	self._sequenceLengths = self._sequenceLengths or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local f1_local3 = nil
	if CONDITIONS.InGame() then
		f1_local3 = MenuBuilder.BuildRegisteredType( "InGameMenuBackground", {
			controllerIndex = f1_local1
		} )
		f1_local3.id = "InGameMenuBackground"
		f1_local3:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
		self:addElement( f1_local3 )
		self.InGameMenuBackground = f1_local3
	end
	local f1_local4 = nil
	if not Engine[0x12586A3F4FB490E]() then
		f1_local4 = MenuBuilder.BuildRegisteredType( "InGameMenuTimerStatus", {
			controllerIndex = f1_local1
		} )
		f1_local4.id = "InGameMenuTimerStatus"
		f1_local4:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1473, _1080p * 1873, _1080p * 66, _1080p * 116 )
		self:addElement( f1_local4 )
		self.InGameMenuTimerStatus = f1_local4
	end
	local WeaponAttributes = nil
	
	WeaponAttributes = MenuBuilder.BuildRegisteredType( "WeaponAttributes", {
		controllerIndex = f1_local1
	} )
	WeaponAttributes.id = "WeaponAttributes"
	WeaponAttributes:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 96, _1080p * 691, _1080p * -272, _1080p * -100 )
	self:addElement( WeaponAttributes )
	self.WeaponAttributes = WeaponAttributes
	
	local GunsmithButton1 = nil
	
	GunsmithButton1 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton1.id = "GunsmithButton1"
	GunsmithButton1:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -765, _1080p * -465, _1080p * 262, _1080p * 326 )
	self:addElement( GunsmithButton1 )
	self.GunsmithButton1 = GunsmithButton1
	
	local GunsmithButton2 = nil
	
	GunsmithButton2 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton2.id = "GunsmithButton2"
	GunsmithButton2:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -279, _1080p * 21, _1080p * 224, _1080p * 288 )
	self:addElement( GunsmithButton2 )
	self.GunsmithButton2 = GunsmithButton2
	
	local GunsmithButton3 = nil
	
	GunsmithButton3 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton3.id = "GunsmithButton3"
	GunsmithButton3:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * 170, _1080p * 470, _1080p * 224, _1080p * 288 )
	self:addElement( GunsmithButton3 )
	self.GunsmithButton3 = GunsmithButton3
	
	local GunsmithButton4 = nil
	
	GunsmithButton4 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton4.id = "GunsmithButton4"
	GunsmithButton4:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * 564, _1080p * 864, _1080p * 262, _1080p * 326 )
	self:addElement( GunsmithButton4 )
	self.GunsmithButton4 = GunsmithButton4
	
	local GunsmithButton5 = nil
	
	GunsmithButton5 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton5.id = "GunsmithButton5"
	GunsmithButton5:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -733, _1080p * -433, _1080p * 569, _1080p * 633 )
	self:addElement( GunsmithButton5 )
	self.GunsmithButton5 = GunsmithButton5
	
	local GunsmithButton6 = nil
	
	GunsmithButton6 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton6.id = "GunsmithButton6"
	GunsmithButton6:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -230, _1080p * 70, _1080p * 641, _1080p * 705 )
	self:addElement( GunsmithButton6 )
	self.GunsmithButton6 = GunsmithButton6
	
	local GunsmithButton7 = nil
	
	GunsmithButton7 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton7.id = "GunsmithButton7"
	GunsmithButton7:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * -230, _1080p * 70, _1080p * 737, _1080p * 801 )
	self:addElement( GunsmithButton7 )
	self.GunsmithButton7 = GunsmithButton7
	
	local GunsmithButton8 = nil
	
	GunsmithButton8 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton8.id = "GunsmithButton8"
	GunsmithButton8:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * 180, _1080p * 480, _1080p * 664, _1080p * 728 )
	self:addElement( GunsmithButton8 )
	self.GunsmithButton8 = GunsmithButton8
	
	local GunsmithButton9 = nil
	
	GunsmithButton9 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton9.id = "GunsmithButton9"
	GunsmithButton9:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * 564, _1080p * 864, _1080p * 737, _1080p * 801 )
	self:addElement( GunsmithButton9 )
	self.GunsmithButton9 = GunsmithButton9
	
	local GunsmithButton10 = nil
	
	GunsmithButton10 = MenuBuilder.BuildRegisteredType( "GunsmithButton", {
		controllerIndex = f1_local1
	} )
	GunsmithButton10.id = "GunsmithButton10"
	GunsmithButton10:SetAnchorsAndPosition( 0.5, 0.5, 0, 1, _1080p * 564, _1080p * 864, _1080p * 641, _1080p * 705 )
	self:addElement( GunsmithButton10 )
	self.GunsmithButton10 = GunsmithButton10
	
	local EquippedCount = nil
	
	EquippedCount = MenuBuilder.BuildRegisteredType( "GunsmithEquippedSlots", {
		controllerIndex = f1_local1
	} )
	EquippedCount.id = "EquippedCount"
	EquippedCount:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 97, _1080p * 681, _1080p * -310, _1080p * -275 )
	self:addElement( EquippedCount )
	self.EquippedCount = EquippedCount
	
	local f1_local17 = nil
	if CONDITIONS.InFrontend() then
		f1_local17 = MenuBuilder.BuildRegisteredType( "LobbyMembersFooter", {
			controllerIndex = f1_local1
		} )
		f1_local17.id = "LobbyMembersFooter"
		f1_local17:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, _1080p * 150 )
		self:addElement( f1_local17 )
		self.LobbyMembersFooter = f1_local17
	end
	local CDLRestrictionTag = nil
	
	CDLRestrictionTag = MenuBuilder.BuildRegisteredType( "CDLRestrictionTag", {
		controllerIndex = f1_local1
	} )
	CDLRestrictionTag.id = "CDLRestrictionTag"
	CDLRestrictionTag:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1508, _1080p * 1824, _1080p * 186, _1080p * 216 )
	self:addElement( CDLRestrictionTag )
	self.CDLRestrictionTag = CDLRestrictionTag
	
	local GunsmithUndoPrompt = nil
	
	GunsmithUndoPrompt = MenuBuilder.BuildRegisteredType( "GunsmithUndoPrompt", {
		controllerIndex = f1_local1
	} )
	GunsmithUndoPrompt.id = "GunsmithUndoPrompt"
	GunsmithUndoPrompt:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * 178, _1080p * 378, _1080p * -257, _1080p * -201 )
	self:addElement( GunsmithUndoPrompt )
	self.GunsmithUndoPrompt = GunsmithUndoPrompt
	
	local GunsmithUndoPromptButtonContainer = nil
	GunsmithUndoPromptButtonContainer = MenuBuilder.BuildRegisteredType( "ButtonPromptContainer", {
		controllerIndex = f1_local1
	} )
	GunsmithUndoPromptButtonContainer.id = "GunsmithUndoPromptButtonContainer"
	if CONDITIONS.AlwaysFalse() then
		GunsmithUndoPromptButtonContainer.Label:setText( "ButtonPrompt", 0 )
	end
	if CONDITIONS.AlwaysFalse() then
		GunsmithUndoPromptButtonContainer.Label:SetAlignment( LUI.Alignment.Left )
	end
	GunsmithUndoPromptButtonContainer:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * 160, _1080p * 360, _1080p * -236, _1080p * -206 )
	self:addElement( GunsmithUndoPromptButtonContainer )
	self.GunsmithUndoPromptButtonContainer = GunsmithUndoPromptButtonContainer
	
	self._sequences.DefaultSequence = function ()
		
	end
	
	self._sequenceLengths.DefaultSequence = 0
	self._sequences.Modification = function ()
		
	end
	
	self._sequenceLengths.Modification = 0
	self._sequences.HasModification = function ()
		
	end
	
	self._sequenceLengths.HasModification = 0
	self._sequences.ModifyWithModification = function ()
		
	end
	
	self._sequenceLengths.ModifyWithModification = 0
	local f1_local21 = nil
	EquippedCount:RegisterAnimationSequence( "CH", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * -296
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * -262
		}
	} )
	self._sequences.CH = function ()
		menu:AnimateSequence( "CH" )
	end
	
	self._sequenceLengths.CH = 0
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "GunsmithAttachments", GunsmithAttachments )
LockTable( _M )
