-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:02
module( ..., package.seeall )
FencePremiumInterface = LUI.Class( LUI.Fence )
FencePremiumInterface.init = function ( f20_arg0 )
	FencePremiumInterface.super.init( f20_arg0 )
end

FencePremiumInterface.UpdateState = function ( f19_arg0 )
	f19_arg0._state = LUI.Fence.STATE.fail
	for f19_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		if f19_arg0:PassCondition( f19_local0 ) then
			f19_arg0._state = LUI.Fence.STATE.pass
			break
		end
	end
end

FencePremium = LUI.Class( LUI.Fence )
FencePremium.init = function ( f18_arg0 )
	FencePremium.super.init( f18_arg0 )
end

FencePremium.UpdateState = function ( f17_arg0 )
	f17_arg0._state = LUI.Fence.STATE.block
	for f17_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		if Engine[0xD2813B521711C11]( f17_local0 ) and Engine[0xEB0606D5D898BA6]( f17_local0 ) then
			local f17_local3 = GameInstall[0x37F59297B471D9A]()
			if f17_local3 ~= nil and GameInstall[0x18809AE3656D481]( f17_local3, f17_local0 ) then
				f17_arg0._state = LUI.Fence.STATE.pass
				return 
			end
			f17_arg0._state = LUI.Fence.STATE.fail
		end
	end
end

FencePremium.PostFail = function ( f16_arg0 )
	if f16_arg0._state == LUI.Fence.STATE.fail then
		local f16_local0 = Engine[0x45B054C920178E9]()
		Engine[0x5DEE98AA6FB3C2]( f16_local0, CoD.LeavePartyMoveUI.YES, CoD.LeavePartyShowMessage.NO, "FencePremium.PostFail" )
		local f16_local1 = {}
		if f16_arg0._timeLimitState then
			f16_local1.title = 0xA05B91C81A5CA0A
		end
		f16_local1.entitlement = GameInstall[0xA106AEABEC1F79B]( GameInstall[0x37F59297B471D9A]() )
		LUI.FlowManager.RequestPopupMenu( nil, "BlockedPremiumMenuPopup", true, f16_local0, false, f16_local1, nil, true, true )
	end
end

LUI.Fence.Register( "premium", FencePremium )
FencePremiumByPlaylist = LUI.Class( FencePremium )
FencePremiumByPlaylist.init = function ( f15_arg0, f15_arg1 )
	FencePremiumByPlaylist.super.init( f15_arg0 )
	f15_arg0._GetCurrentPlaylist = f15_arg1
end

local f0_local0 = function ()
	local f13_local0 = -1
	local f13_local1 = Engine[0xB686A0A723E6442]() - 1
	return function ()
		if f13_local0 < f13_local0 then
			
		else
			
		end
		return nil
	end
	
end

FencePremiumByPlaylist.UpdateState = function ( f12_arg0 )
	local f12_local0, f12_local1 = f12_arg0._GetCurrentPlaylist()
	FencePremiumByPlaylist.super.UpdateState( f12_arg0 )
	if f12_arg0._state ~= LUI.Fence.STATE.fail then
		return 
	elseif not PlaylistUtils.IsPlaylistF2P( Engine[0x45B054C920178E9](), f12_local0, f12_local1 ) then
		return 
	elseif PLAY_MENU.IsGameModeFreeTrial( GameInstall[0x37F59297B471D9A]() ) then
		f12_arg0._state = LUI.Fence.STATE.pass
		return 
	elseif f12_arg0._timeLimitState then
		f12_arg0._state = f12_arg0._timeLimitState
		return 
	elseif Dvar[0x9E5BE3B4BBA4E0E]( 0xB5602B275BDFAD7 ) == true then
		f12_arg0._state = LUI.Fence.STATE.pass
		return 
	end
	for f12_local5 in f0_local0() do
		if Fences[0x6C6D08978B8C65]( f12_local5, "ACHIEVEMENTENGINE" ) ~= LUI.Fence.FenceObjectState.PASSING then
			return 
		end
	end
	for f12_local5 in f0_local0() do
		local f12_local6, f12_local7 = PLAY_MENU.GetFreeTrialTimeLimitProgress( f12_local5 )
		if 0 < f12_local7 then
			f12_arg0._state = LUI.Fence.STATE.pass
			break
		end
	end
	f12_arg0._timeLimitState = f12_arg0._state
end

local f0_local1 = function ()
	local f11_local0 = Playlist[0x7B3B2B73B53EB34]()
	local f11_local1 = Playlist[0xD78924AD23DE66B]()
	if Playlist[0x29DC19B8CA68312]( f11_local1 ) then
		f11_local0 = PlaylistUtils.USE_FILTERED_PLAYLIST_ID
	end
	return f11_local0, f11_local1
end

FencePremiumCPPlaylist = LUI.Class( FencePremiumByPlaylist )
FencePremiumCPPlaylist.init = function ( f10_arg0 )
	FencePremiumCPPlaylist.super.init( f10_arg0, f0_local0 )
end

LUI.Fence.Register( "premiumCPPlaylist", FencePremiumCPPlaylist )
local f0_local2 = function ()
	local f9_local0 = Playlist[0x7B3B2B73B53EB34]()
	local f9_local1 = Playlist[0xD78924AD23DE66B]()
	if Playlist[0x29DC19B8CA68312]( f9_local1 ) then
		f9_local0 = PlaylistUtils.USE_FILTERED_PLAYLIST_ID
	end
	return f9_local0, f9_local1
end

FencePremiumMPPlaylist = LUI.Class( FencePremiumByPlaylist )
FencePremiumMPPlaylist.init = function ( f8_arg0 )
	FencePremiumMPPlaylist.super.init( f8_arg0, f0_local0 )
end

LUI.Fence.Register( "premiumMPPlaylist", FencePremiumMPPlaylist )
FencePremiumOrTrial = LUI.Class( FencePremium )
FencePremiumOrTrial.init = function ( f7_arg0 )
	FencePremiumOrTrial.super.init( f7_arg0 )
end

FencePremiumOrTrial.UpdateState = function ( f6_arg0 )
	FencePremiumOrTrial.super.UpdateState( f6_arg0 )
	if f6_arg0._state ~= LUI.Fence.STATE.fail then
		return 
	end
	local f6_local0 = Engine[0x45B054C920178E9]()
	if Engine[0xD2813B521711C11]( f6_local0 ) and Engine[0xEB0606D5D898BA6]( f6_local0 ) and PLAY_MENU.IsGameModeFreeTrial( GameInstall[0x37F59297B471D9A]() ) then
		f6_arg0._state = LUI.Fence.STATE.pass
	end
end

LUI.Fence.Register( "premiumOrTrial", FencePremiumOrTrial )
FencePremiumOrLaunchChunk = LUI.Class( FencePremiumInterface )
FencePremiumOrLaunchChunk.PassCondition = function ( f5_arg0, f5_arg1 )
	local f5_local0 = Engine[0x8B495DC361731F7]( f5_arg1 )
	if not f5_local0 then
		f5_local0 = CONDITIONS.IsLaunchChunk()
	end
	return f5_local0
end

FencePremiumOrLaunchChunk.PostFail = function ( f4_arg0 )
	if f4_arg0._state == LUI.Fence.STATE.fail then
		Engine[0x5DEE98AA6FB3C2]( Engine[0x45B054C920178E9](), CoD.LeavePartyMoveUI.YES, CoD.LeavePartyShowMessage.NO, "FencePremiumOrLaunchChunk.PostFail" )
	end
end

LUI.Fence.Register( "premiumOrLaunchChunk", FencePremiumOrLaunchChunk )
local f0_local3 = 1000
local f0_local4 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.controllerIndex = f2_arg1
	f2_arg0.entitlement = f2_arg2
	f2_arg0:CreateEventTimer( "disk_insert_timer", f0_local0, {
		immediate = true,
		callbackFunc = function ( f3_arg0, f3_arg1 )
			local f3_local0 = CoD.GetUTC()
			if not String.IsNilOrEmpty( f3_arg0.entitlement ) then
				if GameInstall[0xA6769AE0AC6FE21]( f3_arg0.entitlement, f3_arg0.controllerIndex ) then
					f3_arg0:RemoveEventTimer( "disk_insert_timer" )
					LUI.FlowManager.RequestLeaveMenuByName( "BlockedPremiumMenuPopup", true )
				elseif CONDITIONS[0x1D1EEFABC21D0E7]() then
					GameInstall[0x4A083D2379C9B69]( f3_arg0.controllerIndex )
				end
			else
				f3_arg0:RemoveEventTimer( "disk_insert_timer" )
			end
			return true
		end
	} )
end

function BlockedPremiumMenuPopup( f1_arg0, f1_arg1 )
	if Table.IsNilOrEmpty( f1_arg1 ) then
		local f1_local0 = {
			title = 0xB7CC88A30D3FF0C
		}
		local f1_local1 = Engine[0xEE6F69FEA944B13]()
		f1_local0.controllerIndex = f1_local1:GetControllerIndex()
		f1_local0.entitlement = CoD.DEFAULT_ENTITLEMENT
		f1_arg1 = f1_local0
	end
	local f1_local0 = f1_arg1.entitlement
	if not f1_local0 then
		f1_local0 = CoD.DEFAULT_ENTITLEMENT
	end
	f1_arg1.entitlement = f1_local0
	local f1_local1 = MenuBuilder.BuildRegisteredType( "PopupMessageAndButtons", STORE.GetGameUpsellPopup( f1_arg1 ) )
	f1_local1.controllerIndex = f1_arg1.controllerIndex
	f1_local1.entitlement = f1_arg1.entitlement
	f0_local0( f1_local1, f1_arg1.controllerIndex, f1_arg1.entitlement )
	f1_local1.id = "BlockedPremiumMenuPopup"
	return f1_local1
end

MenuBuilder.registerType( "BlockedPremiumMenuPopup", BlockedPremiumMenuPopup )
LockTable( _M )
