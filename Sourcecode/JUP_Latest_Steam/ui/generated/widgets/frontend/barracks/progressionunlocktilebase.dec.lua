-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
module( ..., package.seeall )
local f0_local0 = 1
local f0_local1 = 2
local f0_local2 = 3
local f0_local3 = {
	[PROGRESSION.GameModeToCode[LOOT.GameModeFilterString.OB]] = "OBLogo",
	[PROGRESSION.GameModeToCode[LOOT.GameModeFilterString.MP]] = "MPLogo",
	[PROGRESSION.GameModeToCode[LOOT.GameModeFilterString.BR]] = "WZLogo"
}
local f0_local4 = function ( f18_arg0 )
	for f18_local3, f18_local4 in pairs( f0_local0 ) do
		local f18_local5 = f18_arg0[f0_local0[f18_local3]]
		if BitwiseOperators.band( f18_local3, f18_arg0._gameModes ) ~= 0 then
			f18_local5:SetAlpha( 1, 0 )
		else
			f18_local5:SetAlpha( 0.33, 0 )
		end
	end
end

local f0_local5 = function ( f16_arg0 )
	f16_arg0:registerEventHandler( "expand_friends_popup", function ( element, event )
		if element.rankIndex ~= event.focusedTile or Table.IsNilOrEmpty( element._friendsList ) then
			return 
		else
			element.FriendsContainer:ExpandFriends()
			return true
		end
	end )
end

local f0_local6 = function ( f15_arg0, f15_arg1 )
	if Table.IsNilOrEmpty( f15_arg1 ) then
		f15_arg1 = f15_arg0.rewardPackage
	end
	f15_arg0._isPreviewAvailable = false
	f15_arg0._previewItem = nil
	for f15_local0 = f0_local0, f0_local0, 1 do
		local f15_local3 = f15_arg1[f15_local0]
		local f15_local4
		if f15_local3 then
			f15_local4 = LOOT.IsTypePreviewable( f15_local3.lootType )
			if not f15_local4 then
			
			else
				f15_arg0._isPreviewAvailable = f15_local4
				if f15_arg0._isPreviewAvailable then
					f15_arg0._previewItem = f15_local3
					break
				end
			end
		end
		f15_local4 = false
	end
	if f15_arg1[f0_local0] and f15_arg0.RewardLeft then
		f15_arg0.RewardLeft:setImage( RegisterMaterial( f15_arg1[f0_local0].icon ) )
		if f15_arg0.Brackets then
			f15_arg0.Brackets:SetVisible( f15_arg1[f0_local0].lootType == LOOT.itemTypes.OPERATOR )
		end
	end
	if f15_arg1[f0_local0] and f15_arg0.RewardRight then
		f15_arg0.RewardRight:setImage( RegisterMaterial( f15_arg1[f0_local0].icon ) )
	end
	local f15_local0 = #f15_arg1
	if 2 < f15_local0 and f15_arg0.RewardThird then
		f15_arg0.RewardThird:setImage( RegisterMaterial( f15_arg1[f0_local0].icon ) )
		ACTIONS.AnimateSequence( f15_arg0, "ThreeRewards" )
		if LAYOUT.GetMaterialAspectRatio( f15_arg1[f0_local0].icon ) == 1 then
			ACTIONS.AnimateSequence( f15_arg0, "ThreeRewards" )
		else
			ACTIONS.AnimateSequence( f15_arg0, "ThreeRewards2x1" )
		end
	elseif 1 < f15_local0 then
		local f15_local1 = LAYOUT.GetMaterialAspectRatio( f15_arg1[f0_local0].icon )
		local f15_local2 = LAYOUT.GetMaterialAspectRatio( f15_arg1[f0_local0].icon )
		if f15_local1 == 1 then
			ACTIONS.AnimateSequence( f15_arg0, "TwoRewards1x1" )
		else
			ACTIONS.AnimateSequence( f15_arg0, "TwoRewards2x1" )
		end
		if f15_local2 == 2 then
			ACTIONS.AnimateSequence( f15_arg0, "TwoRewardsLeft2x1" )
		end
	elseif f15_local0 == 1 then
		if LAYOUT.GetMaterialAspectRatio( f15_arg1[f0_local0].icon ) == 1 then
			ACTIONS.AnimateSequence( f15_arg0, "OneReward1x1" )
		else
			ACTIONS.AnimateSequence( f15_arg0, "OneReward2x1" )
		end
	else
		ACTIONS.AnimateSequence( f15_arg0, "NoRewards" )
	end
	f0_local0( f15_arg0 )
end

local f0_local7 = function ( f13_arg0 )
	f13_arg0._defaultTileActive = true
	f13_arg0:registerEventHandler( "toggle_zombie_tile", function ( element, event )
		if element.rankIndex ~= event.focusedTile or not element._isZombieTile then
			return 
		end
		local f14_local0 = element.RankLabel:getText()
		element.RankLabel:setText( element.RankLabelZombie:getText() )
		element.RankLabelZombie:setText( f14_local0 )
		local f14_local1, f14_local2, f14_local3, f14_local4 = element.RankLabel:getCurrentRGBA()
		local f14_local5, f14_local6, f14_local7, f14_local8 = element.RankLabelZombie:getCurrentRGBA()
		element.RankLabel:SetRGB( GetIntForColor( {
			r = f14_local5,
			g = f14_local6,
			b = f14_local7
		} ) )
		element.RankLabelZombie:SetRGB( GetIntForColor( {
			r = f14_local1,
			g = f14_local2,
			b = f14_local3
		} ) )
		if element._defaultTileActive then
			f13_arg0( element, element._zombieReward )
		else
			f13_arg0( element )
		end
		element._defaultTileActive = not element._defaultTileActive
		Engine[0xC4146BA76D0F982]( SOUND_SETS.default.toggle )
		return true
	end )
end

local f0_local8 = function ( f12_arg0, f12_arg1, f12_arg2 )
	local f12_local0
	if f12_arg0._isZombieTile and not f12_arg2 then
		f12_local0 = f12_arg2
	else
		f12_local0 = f12_arg1
	end
	ACTIONS.AnimateSequence( f12_arg0, f12_local0 )
end

local f0_local9 = function ( f11_arg0 )
	if f11_arg0._unlocked then
		ACTIONS.AnimateSequence( f11_arg0, "Focus" )
		ACTIONS.AnimateSequence( f11_arg0.ButtonHIghlight, "Enabled" )
		f11_arg0.ButtonHIghlight:SetNoAction( not f11_arg0._isPreviewAvailable, not f11_arg0._isPreviewAvailable )
	else
		ACTIONS.AnimateSequence( f11_arg0, "LockedFocus" )
		ACTIONS.AnimateSequence( f11_arg0.ButtonHIghlight, "Disabled" )
		f11_arg0.ButtonHIghlight:SetNoAction( true, true )
		if f11_arg0._isZombieTile then
			ACTIONS.AnimateSequence( f11_arg0, "LockedFocusZombie" )
		end
	end
	f11_arg0:dispatchEventToRoot( {
		name = "update_helper_bar_prompts",
		showFriendsPrompt = f11_arg0._friendsList ~= nil,
		showZombiePrompt = f11_arg0._isZombieTile
	} )
	if not (not f11_arg0._focusSFX or not Engine[0x1F61B16806D3CA2]( f11_arg0._focusSFX )) or LUI.IsLastInputMouseNavigation( f11_arg0._controllerIndex ) then
		return 
	elseif not CONDITIONS.IsMobileOrMobileSim() then
		f11_arg0._focusSFX = Engine[0xC4146BA76D0F982]( SOUND_SETS.default.gainFocus )
	end
end

local f0_local10 = function ( f10_arg0 )
	if f10_arg0._unlocked then
		ACTIONS.AnimateSequence( f10_arg0, "Unfocus" )
		if f10_arg0._isZombieTile then
			ACTIONS.AnimateSequence( f10_arg0, "UnfocusZombie" )
		end
	else
		ACTIONS.AnimateSequence( f10_arg0, "LockedUnfocus" )
	end
	f10_arg0.FriendsContainer:ExpandFriends( true )
end

local f0_local11 = function ( f9_arg0, f9_arg1 )
	if not CONDITIONS.IsGamepadEnabled() then
		f9_arg0:SetHandleMouse( f9_arg1 )
	end
end

local f0_local12 = function ( f8_arg0, f8_arg1 )
	if f8_arg0.ButtonHIghlight then
		f8_arg0.ButtonHIghlight:SetPrimaryPrompt( Engine[0xED84C33EC5F01EA]( 0x1A59CC1F0C077E3 ), LUI.IsKBMActiveInputMethodForPrompts( f8_arg1 ) )
	end
end

local f0_local13 = function ( f6_arg0, f6_arg1, f6_arg2, f6_arg3 )
	f6_arg0._unlocked = f6_arg2.rank <= f6_arg2.currentRank
	f6_arg0.rank = f6_arg2.rank
	f6_arg0.rankIndex = f6_arg2.rankIndex
	f6_arg0._season = f6_arg2.season
	f6_arg0._isStartOfSeason = f6_arg2.isStartOfSeason
	f6_arg0._seasonTilePadding = f6_arg3
	f6_arg0._isZombieTile = false
	f6_arg0._friendsList = f6_arg2.friendsList
	f6_arg0._gameModes = PROGRESSION.GameModeToCode.NO_GAME_MODES
	local f6_local0 = f6_arg2.rank > PROGRESSION.GetMaxRank()
	if 0 <= f6_arg0.rank and f6_arg0.rank <= PROGRESSION.GetPlayerLifeTimeMaxRank() then
		f6_arg0.rewardPackage = AAR.GetRankupUnlockPackage( f6_arg1, f6_arg0.rank, f6_arg2.gameMode )
		local f6_local1 = function ( f7_arg0, f7_arg1, f7_arg2 )
			f6_arg0._gameModes = BitwiseOperators.bor( f6_arg0._gameModes, f7_arg0.availableGameModes )
			return BitwiseOperators.band( f7_arg0.availableGameModes, f6_arg0.gameMode ) ~= 0
		end
		
		if not f6_local0 then
			f6_arg0.rewardPackage = Table.Filter( f6_arg0.rewardPackage, f6_local1 )
		end
		local f6_local2 = false
		local f6_local3 = true
		local f6_local4 = 0
		if 0 < #f6_arg0.rewardPackage and CONDITIONS.IsZombieTileAllowed() then
			local f6_local5 = CONDITIONS.IsJupPublicBetaBuildEnabled()
			local f6_local6 = f6_arg0._isZombieTile
			local f6_local7 = LOOT.GetZombieFieldUpgrades( f6_arg1 )
			local f6_local8 = f6_arg0.WinToken ~= nil
			local f6_local9 = f6_arg0.AlreadyOwnedLabel ~= nil
			for f6_local13, f6_local14 in ipairs( f6_arg0.rewardPackage ) do
				local f6_local15 = f6_local14.lootID
				if f6_local8 and not f6_local2 and 0 < LOOT.GetItemWinTokenCostById( f6_local14.lootType, f6_local15 ) then
					f6_local2 = true
				end
				if f6_local9 and f6_local3 and PROXY_LOOT.IsOwned( f6_arg1, f6_local15 ) == 0 then
					f6_local3 = false
				end
				if not f6_local6 and LOOT.IsZombieSuperByID( f6_arg1, f6_local15, f6_local7 ) and not f6_local0 and not f6_local5 then
					f6_local6 = true
					f6_local4 = f6_local13
				end
			end
			f6_arg0._isZombieTile = f6_local6
		end
		if f6_local2 and f6_arg0.WinToken ~= nil then
			f6_arg0.WinToken:SetupButton( {
				buttonData = {
					showIcon = true
				}
			} )
		end
		if f6_arg0.AlreadyOwnedLabel ~= nil then
			f6_arg0.AlreadyOwnedLabel:SetVisible( f6_local3 )
		end
		f6_arg0.RankLabel:setText( ToUpperCase( Engine[0xED84C33EC5F01EA]( 0x55935E8D49F35E5, PROGRESSION.GetRankDisplay( f6_arg0.rank ) ) ) )
		f6_arg0.RankImage:setImage( RegisterMaterial( PROGRESSION.GetRankBigIcon( f6_arg0.rank ) ) )
		if f6_local0 then
			f6_arg0.PrestigeLabel:setText( ToUpperCase( Engine[0xED84C33EC5F01EA]( PROGRESSION.GetRankFullName( f6_arg0.rank ) ) ) )
			f0_local0( f6_arg0 )
			ACTIONS.AnimateSequence( f6_arg0, "PrestigeRank" )
		else
			if f6_arg0._isZombieTile and f6_arg0.RankLabelZombie then
				ACTIONS.AnimateSequence( f6_arg0, "ZombieTile" )
				f6_arg0._zombieReward = {
					[2] = table.remove( f6_arg0.rewardPackage, f6_local4 )
				}
				f6_arg0.RankLabelZombie:setText( ToUpperCase( Engine[0xED84C33EC5F01EA]( 0xE33FA99E51631B9 ) ) )
				f0_local0( f6_arg0 )
			else
				ACTIONS.AnimateSequence( f6_arg0, "DefaultTile" )
			end
			f0_local0( f6_arg0 )
			ACTIONS.AnimateSequence( f6_arg0, "WeaponRank" )
		end
		if f6_arg0._unlocked then
			ACTIONS.AnimateSequence( f6_arg0, "Unlocked" )
			f6_arg0:setActionSFX( SOUND_SETS.default.action )
		else
			ACTIONS.AnimateSequence( f6_arg0, "Locked" )
			f6_arg0:setActionSFX( SOUND_SETS.default.disableAction )
		end
		if f6_arg0.FriendsContainer then
			f6_arg0.FriendsContainer:UpdateFriendsList( f6_arg2.friendsList )
			if f6_arg2.friendsList then
				f0_local0( f6_arg0 )
			end
		end
	end
	if f6_arg0.RankLineBacker then
		f6_arg0.RankLineBacker:SetVisible( not f6_arg2.isLastLevel )
	end
	f0_local0( f6_arg0 )
end

local f0_local14 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0._controllerIndex = f3_arg1
	f3_arg0.GainFocusTile = f0_local0
	f3_arg0.LoseFocusTile = f0_local0
	f3_arg0.SetMouseEnabledIfUsingKBM = f0_local0
	f3_arg0.SetupProgressionUnlockTile = f0_local0
	if f3_arg2.rank then
		f3_arg0:SetupProgressionUnlockTile( f3_arg1, {
			rank = f3_arg2.rank,
			rankIndex = f3_arg2.rankIndex,
			currentRank = f3_arg2.currentRank
		} )
	end
	f3_arg0:registerEventHandler( "mouseenter", function ( element, event )
		local f5_local0 = element:getParent()
		f5_local0:processEvent( {
			name = "tile_gained_focus",
			tile = element
		} )
	end )
	f3_arg0:SubscribeToInputTypeModel( f3_arg1, function ( f4_arg0, f4_arg1 )
		f3_arg0( f4_arg1, f4_arg1._controllerIndex )
	end )
	f3_arg0.ButtonHIghlight:SetupHighlight( {
		removeSecondary = true
	} )
end

local f0_local15 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0._controllerIndex = f2_arg1
	f2_arg0.PostLoadShared = f0_local0
end

function ProgressionUnlockTileBase( f1_arg0, f1_arg1 )
	local f1_local0 = LUI
	local f1_local1 = f1_local0.UIButton.new()
	f1_local1:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 283, 0, 440 )
	f1_local1.id = "ProgressionUnlockTileBase"
	local f1_local2
	if f1_arg1 then
		f1_local2 = f1_arg1
	else
		f1_local2 = f1_arg1.controllerIndex
	end
	f0_local0( f1_local1, f1_local0.ValidateControllerIndex( f1_local1, f1_local2 ), f1_arg1 )
	return f1_local1
end

MenuBuilder.registerType( 0xCF4D71B4974AD35, ProgressionUnlockTileBase )
LockTable( _M )
