-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:01
QUARTERMASTER = QUARTERMASTER or {}
QUARTERMASTER.storeSession = {}
QUARTERMASTER.itemData = {}
QUARTERMASTER.dlogEnabled = Dvar[0x9E5BE3B4BBA4E0E]( 0x83CB8EEA5E59813 )
QUARTERMASTER.GetMenuSource = function ( f9_arg0 )
	if f9_arg0 == "BladeMenu" then
		return f9_arg0
	elseif LUI.FlowManager.IsMenuOnTop( "BRMainMenu" ) then
		return "BRStore"
	else
		local f9_local0
		if Engine[0xCA085C21FCBD7CA]() then
			f9_local0 = "CPStore"
		else
			f9_local0 = "MPStore"
		end
	end
	return f9_local0
end

QUARTERMASTER.RefreshStoreSession = function ( f8_arg0, f8_arg1 )
	if Engine[0x8B495DC361731F7]( f8_arg0 ) then
		QUARTERMASTER.storeSession.storeName = Dvar[0x54084D7CA2317BB]( 0x64110B2B092E8FA )
	else
		QUARTERMASTER.storeSession.storeName = Dvar[0x54084D7CA2317BB]( 0x5015D57F0DB76C1 )
	end
	QUARTERMASTER.storeSession.storeRegion = Engine[0x2553ADACEC3D1C]()
	QUARTERMASTER.storeSession.storeLayout = f8_arg1.storeLayout
	local f8_local0 = QUARTERMASTER.storeSession
	local f8_local1 = f8_arg1.recommendationData
	if f8_local1 then
		f8_local1 = f8_arg1.recommendationData.isEnabled
	end
	f8_local0.recommendationsEnabled = f8_local1
	QUARTERMASTER.storeSession.recommendedItems = f8_arg1.recommendationData and f8_arg1.recommendationData.items or "none"
end

QUARTERMASTER.RecordStoreEnterEvent = function ( f7_arg0, f7_arg1, f7_arg2, f7_arg3 )
	if QUARTERMASTER.dlogEnabled and f7_arg2 then
		QUARTERMASTER.storeSession = {}
		QUARTERMASTER.storeSession.id = Engine[0x863AA6457598928]()
		local f7_local0 = QUARTERMASTER.GetMenuSource( f7_arg3 )
		local f7_local1 = {
			storeLayout = f7_arg1,
			recommendationData = f7_arg2
		}
		local f7_local2 = Dvar[0x54084D7CA2317BB]( 0x722F3BC5CA49330 )
		local f7_local3 = Dvar[0x54084D7CA2317BB]( 0x358FFD4EFF0D39F )
		local f7_local4 = Dvar[0x54084D7CA2317BB]( 0x23D7B8AAF90167A )
		local f7_local5 = Dvar[0x54084D7CA2317BB]( 0xC242A7F87575441 )
		local f7_local6 = Dvar[0x54084D7CA2317BB]( 0x73E3DC9E920E65C )
		local f7_local7 = Dvar[0x54084D7CA2317BB]( 0x979E423FDB37FB3 )
		local f7_local8 = Engine[0x8B495DC361731F7]( f7_arg0 ) or false
		QUARTERMASTER.RefreshStoreSession( f7_arg0, f7_local1 )
		local f7_local9 = QUARTERMASTER.storeSession
		Engine[0x15D98DF5F61904B]( f7_arg0, "dlog_event_store_qm_entry", {
			store_name = f7_local9.storeName,
			store_session_id = f7_local9.id,
			source = f7_local0,
			region = f7_local9.storeRegion,
			store_layout = f7_local9.storeLayout,
			recommendations_enabled = f7_local9.recommendationsEnabled,
			recommended_items = f7_local9.recommendedItems,
			weapon_items = f7_local2,
			weapon_items_f2p = f7_local3,
			featured_items = f7_local4,
			featured_items_f2p = f7_local5,
			operator_items = f7_local6,
			operator_items_f2p = f7_local7,
			is_premium = f7_local8
		} )
		QUARTERMASTER.storeSession = f7_local9
	end
end

QUARTERMASTER.BeginItemBrowseEvent = function ( f6_arg0, f6_arg1, f6_arg2, f6_arg3 )
	if QUARTERMASTER.dlogEnabled then
		QUARTERMASTER.RefreshStoreSession( f6_arg0, {
			storeLayout = f6_arg2,
			recommendationData = f6_arg3
		} )
		local f6_local0 = QUARTERMASTER.storeSession
		QUARTERMASTER.itemData = {}
		QUARTERMASTER.itemData.sessionId = f6_local0.id
		QUARTERMASTER.itemData.start_time = os.time()
		QUARTERMASTER.itemData.item_id = f6_arg1.id or 0
		QUARTERMASTER.itemData.item_name = f6_arg1.name
		QUARTERMASTER.itemData.bundle_id = f6_arg1.bundleID
		QUARTERMASTER.itemData.position_in_grid = f6_arg1.positionInGrid or 0
	end
end

QUARTERMASTER.RecordItemBrowseEvent = function ( f5_arg0, f5_arg1, f5_arg2 )
	if QUARTERMASTER.dlogEnabled then
		local f5_local0 = QUARTERMASTER.storeSession
		if QUARTERMASTER.itemData and f5_local0.id == QUARTERMASTER.itemData.sessionId then
			local f5_local1 = QUARTERMASTER.GetMenuSource( f5_arg2 )
			local f5_local2 = QUARTERMASTER.itemData
			Engine[0x15D98DF5F61904B]( f5_arg0, "dlog_event_store_qm_item_browse", {
				store_name = f5_local0.storeName,
				store_session_id = f5_local0.id,
				source = f5_local1,
				region = f5_local0.storeRegion,
				store_layout = f5_local0.storeLayout,
				item_id = f5_local2.item_id,
				item_name = f5_local2.item_name,
				bundle_id = f5_local2.bundle_id,
				start_time = f5_local2.start_time,
				end_time = os.time(),
				interacted = f5_arg1,
				item_slot_in_category = f5_local2.position_in_grid
			} )
		end
		QUARTERMASTER.itemData = nil
	end
end

QUARTERMASTER.BeginMenuBrowseEvent = function ( f4_arg0, f4_arg1, f4_arg2, f4_arg3, f4_arg4 )
	if QUARTERMASTER.dlogEnabled then
		QUARTERMASTER.RefreshStoreSession( f4_arg0, {
			storeLayout = f4_arg3,
			recommendationData = f4_arg4
		} )
		local f4_local0 = QUARTERMASTER.storeSession
		QUARTERMASTER.itemData = {}
		QUARTERMASTER.itemData.sessionId = f4_local0.id
		QUARTERMASTER.itemData.start_time = os.time()
		QUARTERMASTER.itemData.category_index = f4_arg1.categoryIndex
		QUARTERMASTER.itemData.category_name = f4_arg1.name
		QUARTERMASTER.itemData.item_id = f4_arg2.id or 0
		QUARTERMASTER.itemData.item_name = f4_arg2.name
		QUARTERMASTER.itemData.position_in_grid = f4_arg2.positionInGrid or 0
	end
end

QUARTERMASTER.RecordMenuBrowseEvent = function ( f3_arg0, f3_arg1, f3_arg2 )
	if QUARTERMASTER.dlogEnabled then
		local f3_local0 = QUARTERMASTER.storeSession
		if QUARTERMASTER.itemData and f3_local0.id == QUARTERMASTER.itemData.sessionId then
			local f3_local1 = QUARTERMASTER.GetMenuSource( f3_arg2 )
			local f3_local2 = QUARTERMASTER.itemData
			Engine[0x15D98DF5F61904B]( f3_arg0, "dlog_event_store_qm_menu_browse", {
				store_name = f3_local0.storeName,
				store_session_id = f3_local0.id,
				source = f3_local1,
				region = f3_local0.storeRegion,
				store_layout = f3_local0.storeLayout,
				category_index = f3_local2.category_index,
				category_name = f3_local2.category_name,
				item_id = f3_local2.item_id,
				item_name = f3_local2.item_name,
				start_time = f3_local2.start_time,
				end_time = os.time(),
				interacted = f3_arg1,
				item_slot_in_category = f3_local2.position_in_grid
			} )
		end
		QUARTERMASTER.itemData = nil
	end
end

QUARTERMASTER.RecordPurchaseConfirmEvent = function ( f2_arg0, f2_arg1, f2_arg2, f2_arg3, f2_arg4 )
	if QUARTERMASTER.dlogEnabled then
		QUARTERMASTER.RefreshStoreSession( f2_arg0, f2_arg4 )
		local f2_local0 = QUARTERMASTER.storeSession
		local f2_local1 = false
		local f2_local2 = {
			store_name = f2_local0.storeName,
			store_session_id = f2_local0.id,
			source = QUARTERMASTER.GetMenuSource( f2_arg4.source ),
			region = f2_local0.storeRegion,
			store_layout = f2_local0.storeLayout,
			category_index = f2_arg4.categoryIndex,
			category_name = f2_arg4.categoryName,
			item_id = f2_arg4.itemID,
			item_name = f2_arg4.itemName,
			current_menu = LUI.FlowManager.GetMenuNameAtIndex( -1 ),
			previous_menu = f2_arg1,
			purchased = f2_arg2
		}
		local f2_local3
		if not f2_local1 then
			f2_local3 = f2_local1
		else
			f2_local3 = f2_arg3
		end
		f2_local2.err = f2_local3
		f2_local2.item_slot_in_category = f2_arg4.positionInGrid
		Engine[0x15D98DF5F61904B]( f2_arg0, "dlog_event_store_qm_item_purchase", f2_local2 )
	end
end

QUARTERMASTER.FlushData = function ( f1_arg0 )
	QUARTERMASTER.RecordMenuBrowseEvent( f1_arg0, false )
end

