-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
module( ..., package.seeall )
require( "ui.generated.widgets.buttons.mousebuttonarea" )
require( "ui.generated.widgets.frontend.sp.missionselect.levelselectmapcontainer" )
require( "ui.generated.widgets.frontend.sp.missionselect.levelselectbutton" )
require( "ui.generated.widgets.scrollbar.horizontalscrollbar" )
require( "ui.generated.widgets.buttonhelperbar" )
require( "ui.generated.widgets.buttonpromptcontainerhorizontal" )
require( "ui.generated.widgets.genericsidebuttonsrow" )
local f0_local0 = function ( f17_arg0, f17_arg1 )
	assert( f17_arg0._levelList )
	local f17_local0 = f17_arg0.LevelSelectionList:GetFocusPositionIndex() + 1
	local f17_local1 = f17_arg0._levelList[f17_local0]
	if f17_local0 ~= f17_arg0._prevLevelIndex then
		f17_arg0.LevelSelectMap:UpdateDetails( f17_arg0._prevLevelIndex, f17_local0, f17_local1 )
		f17_arg0._prevLevelIndex = f17_local0
	end
end

local f0_local1 = function ( f14_arg0, f14_arg1 )
	f14_arg0.LevelSelectionList:SetMask( f14_arg0.ImageMask )
	local f14_local0 = 0
	local f14_local1 = -2
	if not MapInfo.UsingSingleplayerMapAsset() then
		local f14_local2 = MapInfo.spLevels.GetFile()
		local f14_local3 = StringTable[0xFD4E49A34DD43AE]( f14_local2 ) - 1
		for f14_local4 = 0, f14_local3, 1 do
			local f14_local7 = CSV.ReadRowWithFile( MapInfo.spLevels, f14_local2, f14_local4 )
			local f14_local8 = f14_local7.ref
			if SPSharedUtils.IsLevelInFileSystem( f14_local8 ) then
				if String.IsNilOrEmpty( f14_local7.image ) then
					f14_local7.image = CoD.PLACEHOLDER_TEXTURE
				end
				local f14_local9 = {
					isCurrentMission = f14_local8 == f14_arg0._currentMission,
					levelIndex = f14_local4,
					levelRef = f14_local8,
					displayName = Engine[0xED84C33EC5F01EA]( f14_local7.string ),
					locationText = Engine[0xED84C33EC5F01EA]( f14_local7.location ),
					desc = Engine[0xED84C33EC5F01EA]( f14_local7.desc ),
					difficultyRank = SPSharedUtils.GetHighestDifficultyForLevel( f14_local8, f14_arg1 ),
					image = f14_local7.image,
					missionState = SPSharedUtils.GetMissionStateForLevel( f14_local8, f14_arg1 ),
					mapPosition = f14_local7.mapPosition,
					focusSFX = f14_local7.focusSFX
				}
				if f14_local9.missionState == SPSharedUtils.MissionState.COMPLETE then
					f14_local1 = f14_local4
				end
				local f14_local10 = f14_local9.levelRef == SPSharedUtils.GetFirstMap()
				local f14_local11 = f14_local4 - 1 <= f14_local1
				local f14_local12
				if f14_local9.missionState == SPSharedUtils.MissionState.LOCKED then
					if not f14_local11 then
						f14_local12 = f14_local11
					else
						f14_local12 = f14_local10
					end
				else
					f14_local12 = true
				end
				if f14_local12 or SPSharedUtils.UnlockAllMissions( f14_arg1 ) then
					if f14_local9.isCurrentMission then
						f14_local0 = #f14_arg0._levelList
					end
					table.insert( f14_arg0._levelList, f14_local9 )
				end
			end
		end
	else
		local f14_local2 = Lobby[0xF14659C6AA6180F]()
		for f14_local3 = 0, f14_local2 - 1, 1 do
			local f14_local13 = Game[0x16A8B517C8280EA]( f14_local3 )
			local f14_local7 = MapInfo.BundleGetName( f14_local13 )
			if SPSharedUtils.IsLevelInFileSystem( f14_local7 ) then
				local f14_local8 = {
					focusSFX = "ui_sp_missionselect_cleanhouse",
					bundle = f14_local13,
					isCurrentMission = MapInfo.BundleGetName( f14_local13 ) == f14_arg0._currentMission,
					levelIndex = f14_local3,
					levelRef = f14_local7,
					displayName = MapInfo.BundleGetDisplayName( f14_local13 ),
					locationText = MapInfo.BundleGetDisplayLocation( f14_local13 ),
					desc = MapInfo.BundleGetDisplayDescription( f14_local13 ),
					difficultyRank = SPSharedUtils.GetHighestDifficultyForLevel( f14_local7, f14_arg1 ),
					image = MapInfo.BundleGetLoadingImageName( f14_local13 ),
					missionState = SPSharedUtils.GetMissionStateForLevel( f14_local7, f14_arg1 ),
					mapPosition = MapInfo.BundleGetLocationMapPosition( f14_local13 )
				}
				if f14_local8.missionState == SPSharedUtils.MissionState.COMPLETE then
					f14_local1 = f14_local3
				end
				local f14_local9 = f14_local8.levelRef == SPSharedUtils.GetFirstMap()
				local f14_local10 = f14_local3 - 1 <= f14_local1
				local f14_local11
				if f14_local8.missionState == SPSharedUtils.MissionState.LOCKED then
					if not f14_local10 then
						f14_local11 = f14_local10
					else
						f14_local11 = f14_local9
					end
				else
					f14_local11 = true
				end
				if f14_local11 or SPSharedUtils.UnlockAllMissions( f14_arg1 ) then
					if f14_local8.isCurrentMission then
						f14_local0 = #f14_arg0._levelList
					end
					table.insert( f14_arg0._levelList, f14_local8 )
				end
			end
		end
	end
	f14_arg0.LevelSelectMap:PopulateMap( f14_arg0._levelList )
	f14_arg0.LevelSelectionList:SetActiveOnMouseOverBehavior( f14_arg1 )
	f14_arg0.LevelSelectionList:TouchMouseSetActiveToDefaultFocusMenuCreate( f14_arg1 )
	f14_arg0.LevelSelectionList:SetRefreshChild( function ( f15_arg0, f15_arg1, f15_arg2 )
		local f15_local0 = f14_arg0._levelList[1 + f14_arg0.LevelSelectionList:GetContentIndex( f15_arg1, f15_arg2 )]
		f15_arg0:SetupLevelSelectButton( {
			isCurrentMission = f15_local0.isCurrentMission,
			levelRef = f15_local0.levelRef,
			displayName = f15_local0.displayName,
			image = f15_local0.image,
			locationText = f15_local0.locationText
		} )
		f15_arg0:setGainFocusAllSFX( f15_local0.focusSFX )
		f15_arg0._column = f15_arg1
		f15_arg0._row = f15_arg2
		if not f15_arg0._eventHandlersAdded then
			f15_arg0._eventHandlersAdded = true
			f15_arg0:registerEventHandler( "button_over", function ( element, event )
				f15_arg0.LevelSelectionList:SetFocusedPosition( {
					x = element._column,
					y = element._row
				}, true )
				f15_arg0( f15_arg0, f15_arg0 )
				ACTIONS.AnimateSequence( element, "ButtonOver" )
			end )
		end
	end )
	f14_arg0.LevelSelectionList:SetDefaultFocus( {
		y = 0,
		x = f14_local0
	} )
	f14_arg0.LevelSelectionList:SetNumChildren( #f14_arg0._levelList )
	f14_arg0.LevelSelectionList:RefreshContent()
end

local f0_local2 = function ( f9_arg0 )
	if f9_arg0._handlersAdded then
		
	else
		
	end
	f9_arg0._handlersAdded = true
	f9_arg0:AddButtonHelperTextToElement( f9_arg0.ButtonHelperBar, {
		side = "left",
		priority = 0,
		button_ref = "button_alt1",
		helper_text = Engine[0xED84C33EC5F01EA]( 0x10D17BD838D8722 ),
		helper_definition = Engine[0xED84C33EC5F01EA]( 0xBEAF7B0A3D0A256 ),
		container = f9_arg0.ButtonPromptContainer
	} )
	f9_arg0:AddGamepadEventCallback( "button_alt1", function ( f13_arg0, f13_arg1 )
		if Engine[0xC436AD5B92B0408]( f9_arg0._controllerIndex ) then
			LUI.FlowManager.RequestPopupMenu( f9_arg0, "OverwriteSaveWarningPopup", true, f9_arg0._controllerIndex, false, {
				newGame = true
			} )
		else
			SPSharedUtils.OpenDifficultySelectMenu( f9_arg0._controllerIndex, SPSharedUtils.GetFirstMap() )
		end
	end )
	if SPSharedUtils.IsResumeGameAvailable( f9_arg0._controllerIndex ) then
		local f9_local0 = function ()
			if Engine[0xC436AD5B92B0408]( f9_arg0._controllerIndex ) then
				f9_arg0:AddButtonHelperTextToElement( f9_arg0.ButtonHelperBar, {
					side = "left",
					priority = 1,
					button_ref = "button_alt2",
					helper_text = Engine[0xED84C33EC5F01EA]( 0xC5FBAEAB87A83CB ),
					container = f9_arg0.ButtonPromptContainer
				} )
				f9_arg0:AddGamepadEventCallback( "button_alt2", function ( f12_arg0, f12_arg1 )
					LUI.FlowManager.RequestPopupMenu( f12_arg0, "ResumeGamePopup", false, f12_arg1.controller, false )
				end )
			end
		end
		
		f9_local0()
		f9_arg0:addEventHandler( "update_save_game_available_complete", function ( f10_arg0, f10_arg1 )
			f9_arg0()
		end )
	end
end

local f0_local3 = function ( f8_arg0 )
	if SPSharedUtils.IsMissionCheatEnabled( f8_arg0._controllerIndex ) then
		local self = LUI.UIText.new()
		self:setText( "Cheat Mode Enabled - All Maps Unlocked, but Progression saving disabled!", 0 )
		self:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
		self:SetAlignment( LUI.Alignment.Left )
		self:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 130, _1080p * 438, _1080p * 216, _1080p * 252 )
		f8_arg0:addElement( self )
		f8_arg0.CheatLabel = self
	end
end

local f0_local4 = function ( f4_arg0, f4_arg1, f4_arg2 )
	f4_arg0._controllerIndex = f4_arg1
	f4_arg0._currentMission = SPSharedUtils.GetCurrentMission( f4_arg1 )
	f4_arg0._levelList = {}
	f4_arg0._prevLevelIndex = nil
	Engine[0x8CEE785C0D63D7E]( GAMEMODE_SCRIPTBUNDLE_UTILS.GetMusicState() )
	Engine[0x4F101A5D730C0AE]( 1, 0.5 )
	f0_local0( f4_arg0 )
	f0_local0( f4_arg0, f4_arg1 )
	f0_local0( f4_arg0 )
	f4_arg0.MouseButtonArea:registerEventHandler( "gamepad_button", function ( element, event )
		if event.qualifier == "mousewheel" then
			event.forceScrollMove = true
			f4_arg0.LevelSelectionList:GamepadButton( event )
		end
	end )
	MenuUtils.SetupSideArrows( f4_arg0, f4_arg0.LevelSelectionList, true )
	f4_arg0.LevelSelectionList:addEventHandler( "mouseenter", function ( f6_arg0, f6_arg1 )
		ACTIONS.AnimateSequence( f4_arg0.HorizontalMinimalScrollbar.sliderArea, "GridButtonOver" )
	end )
	f4_arg0.LevelSelectionList:addEventHandler( "mouseleave", function ( f5_arg0, f5_arg1 )
		ACTIONS.AnimateSequence( f4_arg0.HorizontalMinimalScrollbar.sliderArea, "GridButtonUp" )
	end )
	ACTIONS.GainFocus( f4_arg0, "LevelSelectionList", f4_arg1 )
end

function CampaignPlayMenu( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "CampaignPlayMenu"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local MouseButtonArea = nil
	
	MouseButtonArea = MenuBuilder.BuildRegisteredType( "MouseButtonArea", {
		controllerIndex = f1_local1
	} )
	MouseButtonArea.id = "MouseButtonArea"
	MouseButtonArea:setPriority( -10 )
	MouseButtonArea:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	self:addElement( MouseButtonArea )
	self.MouseButtonArea = MouseButtonArea
	
	local LevelSelectMap = nil
	
	LevelSelectMap = MenuBuilder.BuildRegisteredType( "LevelSelectMapContainer", {
		controllerIndex = f1_local1
	} )
	LevelSelectMap.id = "LevelSelectMap"
	LevelSelectMap:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -960, _1080p * 960, _1080p * -540, _1080p * 540 )
	self:addElement( LevelSelectMap )
	self.LevelSelectMap = LevelSelectMap
	
	local FooterBacker = nil
	
	FooterBacker = LUI.UIImage.new()
	FooterBacker.id = "FooterBacker"
	ACTIONS.AspectRatioScaleAdjustment( self, FooterBacker, LAYOUT.AspectRatioImageScalePct.FADEFRAME_LARGE )
	FooterBacker:SetRGBFromTable( SWATCHES.IW9StyleGuide.styleGuideWarm05, 0 )
	FooterBacker:SetAlpha( 0.8, 0 )
	FooterBacker:setImage( RegisterMaterial( 0x3A8F29C0EC8E46E ), 0 )
	FooterBacker:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -648, 0 )
	self:addElement( FooterBacker )
	self.FooterBacker = FooterBacker
	
	local BlockLeft = nil
	
	BlockLeft = LUI.UIImage.new()
	BlockLeft.id = "BlockLeft"
	BlockLeft:SetRGBFromInt( 0, 0 )
	BlockLeft:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * -507.1, _1080p * -63.1, 0, _1080p * 1082 )
	self:addElement( BlockLeft )
	self.BlockLeft = BlockLeft
	
	local GradientLeft = nil
	
	GradientLeft = LUI.UIImage.new()
	GradientLeft.id = "GradientLeft"
	GradientLeft:SetRGBFromInt( 0, 0 )
	GradientLeft:setImage( RegisterMaterial( 0x5576BB3DF9CFC11 ), 0 )
	GradientLeft:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * -101.65, _1080p * 0.35, 0, _1080p * 1080 )
	self:addElement( GradientLeft )
	self.GradientLeft = GradientLeft
	
	local GradientRight = nil
	
	GradientRight = LUI.UIImage.new()
	GradientRight.id = "GradientRight"
	GradientRight:SetRGBFromInt( 0, 0 )
	GradientRight:setImage( RegisterMaterial( 0x4FE6BCA771A03A5 ), 0 )
	GradientRight:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1919.9, _1080p * 2021.9, 0, _1080p * 1080 )
	self:addElement( GradientRight )
	self.GradientRight = GradientRight
	
	local BlockRight = nil
	
	BlockRight = LUI.UIImage.new()
	BlockRight.id = "BlockRight"
	BlockRight:SetRGBFromInt( 0, 0 )
	BlockRight:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1984.9, _1080p * 2428.9, 0, _1080p * 1080 )
	self:addElement( BlockRight )
	self.BlockRight = BlockRight
	
	local LevelSelectionList = nil
	
	LevelSelectionList = LUI.UIGrid.new( {
		maxVisibleRows = 1,
		maxVisibleColumns = 5,
		wrapY = false,
		wrapX = false,
		controllerIndex = f1_local1,
		buildChild = function ()
			return MenuBuilder.BuildRegisteredType( "LevelSelectButton", {
				controllerIndex = menu
			} )
		end,
		refreshChild = function ( f2_arg0, f2_arg1, f2_arg2 )
			
		end,
		spacingX = _1080p * 16,
		spacingY = _1080p * 25,
		columnWidth = _1080p * 336,
		rowHeight = _1080p * 160
	} )
	LevelSelectionList.id = "LevelSelectionList"
	LevelSelectionList:SetMaxVisibleColumns( 5 )
	LevelSelectionList:SetRowSpacing( 25 )
	LevelSelectionList:setUseStencil( false )
	LevelSelectionList:SetWraps( false, nil )
	LevelSelectionList:SetWraps( nil, false )
	LevelSelectionList:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * -872, _1080p * 872, _1080p * -288, _1080p * -128 )
	self:addElement( LevelSelectionList )
	self.LevelSelectionList = LevelSelectionList
	
	local ImageMask = nil
	
	ImageMask = LUI.UIImage.new()
	ImageMask.id = "ImageMask"
	ImageMask:setImage( RegisterMaterial( 0xF718FC1BD1FE7E0 ), 0 )
	ImageMask:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * -874, _1080p * 874, _1080p * -328, _1080p * -88 )
	self:addElement( ImageMask )
	self.ImageMask = ImageMask
	
	local HorizontalMinimalScrollbar = nil
	
	HorizontalMinimalScrollbar = MenuBuilder.BuildRegisteredType( "HorizontalScrollbar", {
		controllerIndex = f1_local1
	} )
	HorizontalMinimalScrollbar.id = "HorizontalMinimalScrollbar"
	HorizontalMinimalScrollbar:SetAnchorsAndPosition( 0.5, 0.5, 1, 0, _1080p * -345, _1080p * 345, _1080p * -84, _1080p * -66 )
	self:addElement( HorizontalMinimalScrollbar )
	self.HorizontalMinimalScrollbar = HorizontalMinimalScrollbar
	
	local ButtonHelperBar = nil
	
	ButtonHelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	ButtonHelperBar.id = "ButtonHelperBar"
	ButtonHelperBar:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -960, _1080p * 960, _1080p * 470, _1080p * 540 )
	self:addElement( ButtonHelperBar )
	self.ButtonHelperBar = ButtonHelperBar
	
	local ButtonPromptContainer = nil
	ButtonPromptContainer = MenuBuilder.BuildRegisteredType( "ButtonPromptContainerHorizontal", {
		controllerIndex = f1_local1
	} )
	ButtonPromptContainer.id = "ButtonPromptContainer"
	if CONDITIONS.AlwaysFalse() then
		ButtonPromptContainer.Label:setText( "ButtonPrompt", 0 )
	end
	ButtonPromptContainer:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 150, _1080p * 251, _1080p * -56, _1080p * -25 )
	self:addElement( ButtonPromptContainer )
	self.ButtonPromptContainer = ButtonPromptContainer
	
	local SideArrows = nil
	
	SideArrows = MenuBuilder.BuildRegisteredType( "GenericSideButtonsRow", {
		controllerIndex = f1_local1
	} )
	SideArrows.id = "SideArrows"
	SideArrows:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * -0.1, _1080p * 1919.9, _1080p * -288, _1080p * -128 )
	self:addElement( SideArrows )
	self.SideArrows = SideArrows
	
	local f1_local15 = LUI.UIScrollbar.new
	local f1_local16 = {
		direction = LUI.DIRECTION.horizontal,
		eventListener = HorizontalMinimalScrollbar,
		startCap = HorizontalMinimalScrollbar.startCap,
		endCap = HorizontalMinimalScrollbar.endCap,
		sliderArea = HorizontalMinimalScrollbar.sliderArea
	}
	local f1_local17 = HorizontalMinimalScrollbar.sliderArea
	if f1_local17 then
		f1_local17 = HorizontalMinimalScrollbar.sliderArea.slider
	end
	f1_local16.slider = f1_local17
	f1_local17 = HorizontalMinimalScrollbar.sliderArea
	if f1_local17 then
		f1_local17 = HorizontalMinimalScrollbar.sliderArea.fixedSizeSlider
	end
	f1_local16.fixedSizeSlider = f1_local17
	LevelSelectionList:AddScrollbar( f1_local15( f1_local16 ) )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "CampaignPlayMenu", CampaignPlayMenu )
LockTable( _M )
