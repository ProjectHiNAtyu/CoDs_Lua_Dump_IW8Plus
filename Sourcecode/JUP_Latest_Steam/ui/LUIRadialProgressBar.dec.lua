-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
LUI.UIRadialProgressBar = LUI.Class( LUI.UIElement )
LUI.UIRadialProgressBar.init = function ( f10_arg0, f10_arg1 )
	LUI.UIRadialProgressBar.super.init( f10_arg0, f10_arg1 )
	f10_arg0.id = "UIRadialProgressBar"
	f10_arg0.segmentCount = f10_arg1.segmentCount
	f10_arg0.percentUpdateFunc = f10_arg1.percentUpdateFunc
	f10_arg0.counterClockwise = f10_arg1.counterClockwise
	f10_arg0.fillFromAngle = f10_arg1.fillFromAngle or 0
	f10_arg0.snapToMultiplesOfAngle = f10_arg1.snapToMultiplesOfAngle or 0
	f10_arg0.segmentSpacing = f10_arg1.segmentSpacing or 0
	f10_arg0.maskMaterial = f10_arg1.maskMaterial
	f10_arg0.segmentMaterial = f10_arg1.segmentMaterial
	local f10_local0
	if f10_arg0.segmentCount < 3 then
		f10_local0 = not f10_arg1.useLuaImplementation
	else
		f10_local0 = false
	end
	f10_arg0.useCodeImplementation = f10_local0
	if 0 < f10_arg0.fillFromAngle then
		f10_arg0:SetZRotation( f10_arg0.fillFromAngle )
	end
	if f10_arg0.useCodeImplementation then
		f10_arg0:SetupRadialProgressBar( f10_arg1.counterClockwise == true )
		f10_arg0:setImage( RegisterMaterial( f10_arg1.segmentMaterial ) )
	else
		if f10_arg1.counterClockwise then
			f10_local0 = 1
		else
			f10_local0 = -1
		end
		f10_arg0.rotDirection = f10_local0
		f10_arg0.segmentData = {}
		f10_arg0:CreateSegments( f10_arg1.segmentMaterial, f10_arg1.maskMaterial, f10_arg1.counterClockwise, f10_arg0.segmentSpacing )
		f10_arg0:SetProgress( 0 )
	end
end

LUI.UIRadialProgressBar.SetProgress = function ( f8_arg0, f8_arg1, f8_arg2, f8_arg3 )
	local f8_local0 = nil
	if 0 < f8_arg0.snapToMultiplesOfAngle then
		local f8_local1 = f8_arg0.snapToMultiplesOfAngle / 360
		f8_arg1 = math.floor( 0.5 + f8_arg1 / f8_local1 ) * f8_local1
	end
	f8_arg0.fillPercent = f8_arg1
	if f8_arg0.useCodeImplementation then
		local f8_local2 = f8_arg0
		local f8_local1 = f8_arg0.SetProgressInC
		local f8_local3 = f8_arg1
		local f8_local4
		if not f8_arg2 then
			f8_local4 = f8_arg2
		else
			f8_local4 = 0
		end
		local f8_local5
		if not f8_arg3 then
			f8_local5 = f8_arg3
		else
			f8_local5 = 0
		end
		f8_local0 = f8_local1( f8_local2, f8_local3, f8_local4, f8_local5 )
	else
		f8_arg0:RefreshSegments( f8_arg1 )
	end
	if 0 < f8_arg0.fillFromAngle then
		local f8_local1 = f8_arg0.fillFromAngle + 180 * f8_arg1
		local f8_local6
		if f8_arg0.counterClockwise then
			f8_local6 = -1
		else
			f8_local6 = 1
		end
		f8_local1 = f8_local1 * f8_local6
		local f8_local3 = f8_arg0
		f8_local6 = f8_arg0.SetZRotation
		local f8_local4 = f8_local1
		local f8_local5
		if not f8_arg2 then
			f8_local5 = f8_arg2
		else
			f8_local5 = 0
		end
		local f8_local7
		if not f8_arg3 then
			f8_local7 = f8_arg3
		else
			f8_local7 = 0
		end
		f8_local6( f8_local3, f8_local4, f8_local5, f8_local7 )
	end
	if type( f8_arg0.percentUpdateFunc ) == "function" then
		f8_arg0:percentUpdateFunc( f8_arg1 )
	end
	if type( f8_arg0.percentUpdateCompleteFunc ) == "function" and not f8_arg0._isWaiting then
		f8_arg0._isWaiting = true
		local f8_local1 = f8_arg0:Wait( f8_arg2 )
		f8_local1.onComplete = function ()
			f8_arg0._isWaiting = false
			f8_arg0:percentUpdateCompleteFunc( f8_arg0 )
		end
		
	end
	return f8_local0
end

LUI.UIRadialProgressBar.SetFillFromAngle = function ( f7_arg0, f7_arg1 )
	f7_arg0.fillFromAngle = f7_arg1
	f7_arg0:SetZRotation( f7_arg1 )
end

LUI.UIRadialProgressBar.SetOnUpdateCallback = function ( f6_arg0, f6_arg1 )
	f6_arg0.percentUpdateFunc = f6_arg1
end

LUI.UIRadialProgressBar.SetOnUpdateCompleteCallback = function ( f5_arg0, f5_arg1 )
	f5_arg0.percentUpdateCompleteFunc = f5_arg1
end

LUI.UIRadialProgressBar.SetSegmentImage = function ( f4_arg0, f4_arg1 )
	if f4_arg0.useCodeImplementation then
		f4_arg0:setImage( f4_arg1 )
	else
		for f4_local0 = 1, f4_arg0.segmentCount, 1 do
			f4_arg0.segmentData[f4_local0].segment:setImage( f4_arg1 )
		end
	end
end

LUI.UIRadialProgressBar.CreateSegments = function ( f3_arg0, f3_arg1, f3_arg2, f3_arg3, f3_arg4 )
	local f3_local0 = f3_arg0.rotDirection * 360 / f3_arg0.segmentCount
	local f3_local1 = 1 / f3_arg0.segmentCount
	local f3_local2, f3_local3, f3_local4, f3_local5 = f3_arg0:getCurrentRGBA()
	for f3_local6 = 1, f3_arg0.segmentCount, 1 do
		local f3_local9 = (f3_local6 - 1) * f3_local0 - f3_arg4
		local self = LUI.UIImage.new()
		self:SetRGB( {
			r = f3_local2,
			g = f3_local3,
			b = f3_local4
		} )
		self:SetZRotation( f3_local9 )
		self:setImage( RegisterMaterial( f3_arg1 ) )
		self.id = "segment" .. f3_local6
		f3_arg0:addElement( self )
		local f3_local11 = LUI.UIImage.new()
		f3_local11:SetRGB( {
			r = f3_local2,
			g = f3_local3,
			b = f3_local4
		} )
		f3_local11:SetZRotation( f3_local9 )
		f3_local11:setImage( RegisterMaterial( f3_arg2 ) )
		f3_local11.id = "segmentMask" .. f3_local6
		f3_arg0:addElement( f3_local11 )
		if f3_arg3 then
			self:SetUMin( 1, 0 )
			self:SetUMax( 0, 0 )
			f3_local11:SetUMin( 1, 0 )
			f3_local11:SetUMax( 0, 0 )
		end
		self:SetMask( f3_local11 )
		f3_local11.startRot = f3_local9
		f3_local11.endRot = math.max( f3_local9 + f3_local0 ) + 2 * f3_arg4
		f3_local11.startPercent = (f3_local6 - 1) * f3_local1
		f3_local11.endPercent = math.max( f3_local11.startPercent + f3_local1 )
		table.insert( f3_arg0.segmentData, {
			segment = self,
			mask = f3_local11
		} )
	end
end

LUI.UIRadialProgressBar.RefreshSegments = function ( f2_arg0, f2_arg1 )
	for f2_local0 = 1, f2_arg0.segmentCount, 1 do
		local f2_local3 = f2_arg0.segmentData[f2_local0].mask
		f2_local3:SetZRotation( f2_local3.startRot + LUI.clamp( (f2_arg1 - f2_local3.startPercent) / (f2_local3.endPercent - f2_local3.startPercent), 0, 1 ) * (f2_local3.endRot - f2_local3.startRot) )
	end
end

function BuildRadialProgressBar( f1_arg0, f1_arg1 )
	return LUI.UIRadialProgressBar.new( f1_arg1 )
end

MenuBuilder.registerType( "UIRadialProgressBar", BuildRadialProgressBar )
