-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
module( ..., package.seeall )
CoD.PrintModuleLoad( _NAME )
FenceGameModeSelect = LUI.Class( LUI.Fence )
FenceGameModeSelect.init = function ( f12_arg0 )
	LUI.Fence.init( f12_arg0 )
end

FenceGameModeSelect.Start = function ( f11_arg0 )
	DebugPrint( "FenceGameModeSelect.Start" )
	f11_arg0._controllerIndex = Engine[0x45B054C920178E9]()
end

FenceGameModeSelect.Stop = function ( f10_arg0 )
	DebugPrint( "FenceGameModeSelect.Stop" )
	f10_arg0:ClosePopups()
end

FenceGameModeSelect.UpdateState = function ( f9_arg0 )
	if not Dvar[0x9E5BE3B4BBA4E0E]( 0x8D820DC4F6B8333 ) then
		f9_arg0._state = LUI.Fence.STATE.pass
		return 
	end
	f9_arg0._state = GMS[0x6C6D08978B8C65]( f9_arg0._controllerIndex )
	if f9_arg0._state == LUI.Fence.STATE.pass then
		f9_arg0:ManageConfigUpdate()
	elseif f9_arg0._state == LUI.Fence.STATE.block and GMS[0x303E2E74D2DEE96]() then
		f9_arg0:OpenUpdatingPopup()
	end
end

FenceGameModeSelect.ManageConfigUpdate = function ( f8_arg0 )
	if not Dvar[0x9E5BE3B4BBA4E0E]( 0x51E1E23F1C9EFE4 ) then
		local f8_local0 = GMS[0x3D3010D7301C694]()
		if 1 < f8_local0 and f8_arg0._currentGMSConfigVersion ~= f8_local0 then
			f8_arg0:OpenConfigUpdatedPopup()
		end
		f8_arg0._currentGMSConfigVersion = f8_local0
	end
end

FenceGameModeSelect.OpenUpdatingPopup = function ( f6_arg0 )
	assert( f6_arg0._controllerIndex )
	if not f6_arg0._openedUpdatingPopup then
		f6_arg0._openedUpdatingPopup = true
		f6_arg0._isCancelling = false
		LUI.FlowManager.RequestPopupMenu( nil, "GMSConfigUpdatingPopup", false, f6_arg0._controllerIndex, false, {
			controllerIndex = f6_arg0._controllerIndex,
			onCancel = function ( f7_arg0, f7_arg1 )
				DebugPrint( "Cancelling FenceGameModeSelect" )
				f6_arg0._state = LUI.Fence.STATE.fail
				f6_arg0._isCancelling = true
			end
		}, nil, true, true )
	end
end

FenceGameModeSelect.ClosePopups = function ( f5_arg0 )
	LUI.FlowManager.RequestLeaveMenuByName( "GMSConfigUpdatingPopup", true )
	f5_arg0._openedUpdatingPopup = false
	LUI.FlowManager.RequestLeaveMenuByName( "GMSConfigUpdatedPopup", true )
	f5_arg0._openedUpdatedPopup = false
end

FenceGameModeSelect.OpenConfigUpdatedPopup = function ( f4_arg0 )
	assert( f4_arg0 )
	assert( f4_arg0._controllerIndex )
	if not f4_arg0._openedUpdatedPopup then
		f4_arg0._openedUpdatedPopup = true
		Tournament[0xF8B2F41CC5CF158]()
		Engine[0xF8B2F41CC5CF158]( f4_arg0._controllerIndex, Enum[0x5BA77296D5B1B09][0x21451191E60C4AD], "FenceGameModeSelect.OpenConfigUpdatedPopup" )
		LUI.FlowManager.RequestRestoreMenu( MAIN_MENU.GetMainMenuId(), nil, f4_arg0._controllerIndex )
		LUI.FlowManager.RequestPopupMenu( nil, "GMSConfigUpdatedPopup", false, f4_arg0._controllerIndex, false, {
			message = "Mode Select menu has been updated!"
		}, nil, false, false )
	end
end

local f0_local0 = function ( f2_arg0, f2_arg1 )
	assert( f2_arg1 )
	assert( f2_arg1.controllerIndex )
	assert( f2_arg1.onCancel )
	local f2_local0 = MenuBuilder.BuildRegisteredType( "live_dialog_text_box", {
		buttonsClosePopup = false,
		cancelClosesPopup = false,
		message = "Updating Mode Select menu",
		onCancel = f2_arg1.onCancel,
		onMessageUpdateCallback = function ( f3_arg0 )
			return f2_arg0
		end
	} )
	f2_local0.id = "GMSConfigUpdatingPopup"
	return f2_local0
end

local f0_local1 = function ( f1_arg0, f1_arg1 )
	assert( f1_arg1 )
	assert( f1_arg1.message )
	local f1_local0 = MenuBuilder.BuildRegisteredType( "PopupOK", {
		message = f1_arg1.message
	} )
	f1_local0.id = "GMSConfigUpdatedPopup"
	return f1_local0
end

MenuBuilder.registerType( "GMSConfigUpdatingPopup", f0_local0 )
MenuBuilder.registerType( "GMSConfigUpdatedPopup", f0_local1 )
LUI.Fence.Register( "gamemodeselect", FenceGameModeSelect )
LockTable( _M )
