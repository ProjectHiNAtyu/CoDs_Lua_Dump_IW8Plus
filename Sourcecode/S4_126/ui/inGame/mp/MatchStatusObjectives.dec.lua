-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
module( ..., package.seeall )
local f0_local0 = function ( f8_arg0 )
	local f8_local0 = f8_arg0._controllerIndex
	assert( f8_local0 )
	local f8_local1 = LUI.HudManager.GetObjectiveData( f8_local0 )
	local f8_local2 = Dvar[0x54084D7CA2317BB]( "#x3a30c33efc8281eb1" )
	local f8_local3 = Game[0x395DE1E9756DA1F]( Game[0x51CB5C434C63793]( f8_local0 ) )
	local f8_local4 = #f8_arg0._widgets + 1
	for f8_local5 = 1, f8_arg0._numFlags, 1 do
		f8_arg0._widgets[f8_local5] = f8_arg0._widgets[f8_local5] or {}
		if f8_arg0._widgets[f8_local5] then
			local f8_local8 = f8_local1[f8_local5]
			if f8_local2 == "control" and DataSources.inGame.MP.isMatchInProgress:GetValue( f8_local0 ) and f8_local8.side == OBJECTIVES.NEUTRAL then
				f8_arg0._widgets[f8_local5]:closeTree()
			end
			if f8_arg0._widgets[f8_local5].Update then
				f8_arg0._widgets[f8_local5]:Update( f8_local8 )
			end
		end
	end
end

local f0_local1 = function ( f7_arg0 )
	local f7_local0 = f7_arg0._controllerIndex
	local f7_local1 = Dvar[0x54084D7CA2317BB]( "#x3a30c33efc8281eb1" )
	local f7_local2 = Game[0x395DE1E9756DA1F]( Game[0x51CB5C434C63793]( f7_local0 ) )
	local f7_local3 = {
		nil,
		"ObjectiveA",
		"ObjectiveB",
		"ObjectiveC",
		"ObjectiveD",
		"ObjectiveE",
		"ObjectiveF",
		"ObjectiveG"
	}
	f7_arg0._numFlags = Game[0x28624DEF6F708C8]( f7_local0, "ui_num_dom_flags" )
	if f7_arg0._widgets and 0 < #f7_arg0._widgets then
		for f7_local4 = 1, #f7_arg0._widgets, 1 do
			f7_arg0:RemoveElement( f7_arg0._widgets[f7_local4] )
		end
	end
	local f7_local4 = CONDITIONS.IsControlGameType()
	f7_arg0._widgets = {}
	for f7_local5 = 1, f7_arg0._numFlags, 1 do
		local f7_local8 = MenuBuilder.BuildRegisteredType( "MatchStatusWaypoint", {
			controllerIndex = f7_local0
		} )
		f7_local8.id = f7_local3[f7_local5]
		if f7_local4 then
			f7_local8:SetAnchorsAndPosition( 0, 1, 0.5, 0.5, 0, _1080p * 48, 0, 0 )
		else
			f7_local8:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 48, 0, _1080p * 48 )
		end
		f7_arg0:addElement( f7_local8 )
		table.insert( f7_arg0._widgets, f7_local8 )
		ACTIONS.AnimateSequence( f7_arg0._widgets[f7_local5], f7_local3[f7_local5] )
	end
	f7_arg0:Update()
	if CONDITIONS.IsArmsRaceGameType() then
		local f7_local5 = Game[0x28624DEF6F708C8]( f7_local0, "ui_base_destroyed_objectives" ) or 0
		if 0 < f7_local5 then
			for f7_local6 = 1, f7_arg0._numFlags, 1 do
				if Engine[0x77DA0DE401A96D0]( f7_local5, f7_local6 ) and f7_arg0._widgets[f7_local6] and type( f7_arg0._widgets[f7_local6] ) ~= "table" then
					f7_arg0._widgets[f7_local6]:closeTree()
					f7_arg0._widgets[f7_local6] = nil
				end
			end
		end
	end
end

local f0_local2 = function ( f6_arg0, f6_arg1 )
	if f6_arg0._currentTargetIndex and f6_arg0._widgets[f6_arg0._currentTargetIndex] then
		f6_arg0:RemoveElement( f6_arg0._widgets[f6_arg0._currentTargetIndex] )
		f6_arg0._widgets[f6_arg0._currentTargetIndex] = nil
		f6_arg0._currentTargetIndex = nil
		return 
	end
	local f6_local0 = f6_arg1.value or 0
	if 0 < f6_local0 and f6_arg0._widgets[f6_local0] then
		f6_arg0._widgets[f6_local0].NukeTimer:setEndTime( Game[0x28624DEF6F708C8]( f6_arg0._controllerIndex, "ui_nuke_end_milliseconds" ) )
		ACTIONS.AnimateSequence( f6_arg0._widgets[f6_local0], "NukeTarget" )
	end
	f6_arg0._currentTargetIndex = f6_local0
end

local f0_local3 = function ( f5_arg0, f5_arg1 )
	if f5_arg1.value then
		for f5_local0 = 1, f5_arg0._numFlags, 1 do
			if f5_arg0._widgets[f5_local0] and type( f5_arg0._widgets[f5_local0] ) ~= "table" then
				local f5_local3
				if 0 < f5_arg1.value then
					f5_local3 = Engine[0x77DA0DE401A96D0]( f5_arg1.value, f5_local0 )
					if not f5_local3 then
					
					elseif f5_local3 then
						f5_arg0._widgets[f5_local0]:closeTree()
						f5_arg0._widgets[f5_local0] = nil
					end
				end
				f5_local3 = false
			end
		end
	end
end

local f0_local4 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0._controllerIndex = f2_arg1
	f2_arg0._numFlags = 0
	f2_arg0:SetAlignment( LUI.Alignment.Center )
	f2_arg0.Update = f0_local0
	f2_arg0.CreateObjectives = f0_local0
	f2_arg0:CreateObjectives()
	f2_arg0:registerAndCallEventHandler( "objectives_ping", function ( f4_arg0, f4_arg1 )
		f4_arg0:Update()
	end )
	f2_arg0:addEventHandler( "update_color_blind_colors", function ( f3_arg0 )
		f3_arg0:Update()
	end )
	if CONDITIONS.IsArmsRaceGameType() then
		f2_arg0:registerOmnvarHandler( "ui_base_nuke_target", f0_local0 )
		f2_arg0:registerOmnvarHandler( "ui_base_destroyed_objectives", f0_local0 )
	end
end

function MatchStatusObjectives( menu, controller )
	local self = LUI.UIHorizontalStackedLayout.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 480 * _1080p, 0, 48 * _1080p )
	self.id = "MatchStatusObjectives"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "MatchStatusObjectives", MatchStatusObjectives )
LockTable( _M )
