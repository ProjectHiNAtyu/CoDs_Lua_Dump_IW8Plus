-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:15
module( ..., package.seeall )
require( "ui.generated.widgets.buttonhelperbar" )
require( "ui.generated.widgets.frontend.social.socialprofilecardsmallgroupmember" )
require( "ui.generated.widgets.frontend.social.socialcardsgrid" )
local f0_local0 = 39
local f0_local1 = 500
local f0_local2 = function ( f39_arg0 )
	local f39_local0
	if 0 < f39_arg0._numPages then
		f39_local0 = f39_arg0._numPages
		if not f39_local0 then
		
		else
			f39_arg0.PageCounter:setText( Engine[0xED84C33EC5F01EA]( 0x560A850F07406FF, f39_arg0._curPage + 1, f39_local0 ) )
		end
	end
	f39_local0 = "?"
end

local f0_local3 = function ( f38_arg0 )
	f0_local0( f38_arg0 )
	local f38_local0 = LUI.FlowManager.GetScopedData( f38_arg0 )
	local f38_local1 = math.min( f38_local0.currentDataProvider:GetLastAvailableItemIndex() - f38_arg0._curPage * f0_local0, f0_local0 )
	assert( 0 <= f38_local1 )
	f38_arg0.NothingFound:SetVisible( f38_local1 == 0 )
	f38_arg0._playersGrid:SetNumChildren( f38_local1 )
	f38_arg0._playersGrid:RefreshContent()
	f38_arg0:GainInitialFocus()
end

local f0_local4 = function ( f37_arg0 )
	local f37_local0 = LUI.FlowManager.GetScopedData( f37_arg0 )
	f37_arg0._numPages = math.ceil( f37_local0.currentDataProvider:GetLastAvailableItemIndex() / f0_local0 )
	f0_local0( f37_arg0 )
end

local f0_local5 = function ( f36_arg0, f36_arg1 )
	if 1 <= f36_arg0._curPage and f36_arg1.currentDataProvider:IsNoFetchRequestInProgress() then
		f36_arg0._curPage = f36_arg0._curPage - 1
		f0_local0( f36_arg0 )
	end
end

local f0_local6 = function ( f33_arg0, f33_arg1 )
	local f33_local0 = f33_arg0._curPage + 1
	if (f33_arg0._numPages < 0 or f33_local0 < f33_arg0._numPages) and f33_arg1.currentDataProvider:IsNoFetchRequestInProgress() then
		f33_arg0._curPage = f33_local0
		if not f33_arg1.currentDataProvider:Get( f33_arg0._curPage * f0_local0 + f0_local0, function ()
			local f34_local0 = f33_arg0.currentDataProvider
			local f34_local1 = f34_local0
			f34_local0 = f34_local0.FetchRange
			f34_local0( f34_local1, f33_arg0, f33_arg0 + f33_arg0, function ()
				f34_local0( f34_local0 )
			end )
		end
		 ) then
			f33_arg0._playersGrid:SetNumChildren( 0 )
			f33_arg0._playersGrid:RefreshContent()
		end
	end
end

local f0_local7 = function ( f32_arg0 )
	f32_arg0.SocialCardsGrid:ClearFocus()
end

local f0_local8 = function ( f31_arg0 )
	f31_arg0.SocialCardsGrid:ClearFocus()
	if 0 < (f31_arg0.SocialCardsGrid.PlayersGrid and f31_arg0.SocialCardsGrid.PlayersGrid:GetNumChildren() or 0) then
		if LUI.IsLastInputMouseNavigation( f31_arg0._controllerIndex ) then
			f31_arg0.SocialCardsGrid.PlayersGrid:TouchMouseSetActiveToDefaultFocus( f31_arg0._controllerIndex )
		else
			ACTIONS.GainFocus( f31_arg0.SocialCardsGrid, f31_arg0.SocialCardsGrid.PlayersGrid.id, f31_arg0._controllerIndex )
		end
	end
end

local f0_local9 = function ( f27_arg0, f27_arg1 )
	local f27_local0 = LUI.FlowManager.GetScopedData( f27_arg0 )
	f27_arg0._playersGrid = f27_arg0.SocialCardsGrid.PlayersGrid
	f27_arg0.SocialCardsGrid:SetSearchBoxCallback( function ( f29_arg0, f29_arg1 )
		local f29_local0 = "group_all_members_search_typing_delay"
		local f29_local1 = 200
		f27_arg0:RemoveEventTimer( f29_local0 )
		f27_arg0:CreateEventTimer( f29_local0, f29_local1, {
			immediate = false,
			callbackFunc = function ( f30_arg0, f30_arg1 )
				f30_arg0:RemoveEventTimer( f29_arg0 )
				f29_arg0._searchText = f29_arg0 and string.lower( f29_arg0 ) or nil
				f29_arg0._curPage = 0
				local f30_local0 = f29_arg0
				local f30_local1
				if f29_arg0 then
					f30_local1 = -1
				else
					f30_local1 = f29_arg0._numPagesMax
				end
				f30_local0._numPages = f30_local1
				f29_arg0( f29_arg0 )
				f29_arg0._playersGrid:SetNumChildren( 0 )
				f29_arg0._playersGrid:RefreshContent()
				f29_arg0.currentDataProvider:UpdateDataFiltering( f29_arg0, f29_arg0 )
			end
		} )
	end )
	f27_arg0.SocialCardsGrid:SetSearchBoxEditCompleteCallback( function ()
		f27_arg0.currentDataProvider:UpdateDataFiltering( f27_arg0, f27_arg0 )
		f27_arg0:GainInitialFocus()
	end )
	f27_arg0.SocialCardsGrid:SetSearchBoxDefaultText( 0x3DEFDA1634DCD5D )
end

local f0_local10 = function ( f23_arg0, f23_arg1 )
	local f23_local0 = LUI.FlowManager.GetScopedData( f23_arg0 )
	f23_local0.currentSorting = DataSources.frontEnd.social.groupMembersActiveSort:GetValue( f23_arg1 )
	f23_arg0.SocialCardsGrid:UpdateFilteringLabel( Engine[0xED84C33EC5F01EA]( 0x9ADAC0AA6B81B29, GROUPS.SocialGroupMemberSortingStrings[f23_local0.currentSorting] ) )
	local f23_local1 = function ()
		local f26_local0 = DataSources.frontEnd.social.groupMembersActiveSort:GetValue( f23_arg0 )
		if f23_arg0.currentSorting ~= f26_local0 then
			f23_arg0.currentSorting = f26_local0
			f23_arg0.SocialCardsGrid:UpdateFilteringLabel( Engine[0xED84C33EC5F01EA]( 0x9ADAC0AA6B81B29, GROUPS.SocialGroupMemberSortingStrings[f26_local0] ) )
			local f26_local1 = Engine[0xED84C33EC5F01EA]( 0x9ADAC0AA6B81B29, GROUPS.SocialGroupMemberSortingStrings[f23_arg0.currentSorting] )
			f23_arg0.currentDataProvider:ResetData()
			f23_arg0._playersGrid:SetNumChildren( 0 )
			f23_arg0._playersGrid:RefreshContent()
			f23_arg0.currentDataProvider:UpdateDataFiltering( f23_arg0 * (f23_arg0._curPage + 1), f23_arg0 )
		end
	end
	
	f23_arg0.SocialCardsGrid:AddGamepadEventCallback( "button_right_trigger", function ( f24_arg0, f24_arg1 )
		LUI.FlowManager.RequestPopupMenu( nil, "FlyInPopup", true, f23_arg0, false, {
			flyInRightNarrow = true,
			widget = MenuBuilder.BuildRegisteredType( "SocialGroupsSearchFilterTab", {
				screenTitle = Engine[0xED84C33EC5F01EA]( 0xA464B4CA82007FD ),
				sections = {
					{
						buttonList = GROUPS.SocialGroupMemberSortingStrings,
						dataSource = DataSources.frontEnd.social.groupMembersActiveSort
					}
				}
			} )
		} )
		local f24_local0 = LUI.FlowManager.GetMenuByName( "FlyInPopup" )
		f24_local0.menu:SetExitAnimationDoneCallback( function ( f25_arg0 )
			ACTIONS.LeaveMenu( f25_arg0 )
			MobileFlyInPopupUtils.ResetCurrentFlyInPopup()
			f24_arg0()
		end )
	end )
end

local f0_local11 = function ( f22_arg0, f22_arg1 )
	if GROUPS.CommonDataProviders.KickHandleFunc( f22_arg1 ) then
		f0_local0( f22_arg0 )
	end
end

local f0_local12 = function ( f21_arg0, f21_arg1, f21_arg2 )
	local f21_local0 = LUI.FlowManager.GetScopedData( f21_arg0 )
	local f21_local1 = f21_local0.groupDetails.numGroupMembers / f21_arg0._numPagesMax
	local f21_local2 = f21_arg1.options and f21_arg1.options.genEventName or f21_arg1.name
	if f21_local2 == GROUPS.GroupEvents.LUI_EVENT_PARAM_GROUP_MEMBERADDED then
		f21_local0.currentDataProvider:ResetData()
		if f21_local1 == f0_local0 then
			f21_arg0._numPages = f21_arg0._numPages + 1
			f21_arg0._numPagesMax = f21_arg0._numPages
			f21_arg0.PageCounter:SetVisible( true )
			f21_arg0.PageBar:SetVisible( true )
		end
		f21_local0.currentDataProvider:UpdateDataFiltering( (f21_arg0._curPage + 1) * f0_local0, f0_local0 )
	elseif f21_local2 == GROUPS.GroupEvents.LUI_EVENT_GROUP_REMOVED_MEMBER_XUID then
		if f21_local1 == f0_local0 then
			f21_arg0._numPages = f21_arg0._numPages - 1
			f21_arg0._numPagesMax = f21_arg0._numPages
		end
		f0_local0( f21_arg0, f21_arg1.xuid or f21_arg1.memberXuid )
	end
	GROUPS.UpdateGroupDetails( f21_arg0._controllerIndex, f21_local0.groupDetails )
end

local f0_local13 = function ( f8_arg0, f8_arg1, f8_arg2 )
	f8_arg0._controllerIndex = f8_arg1
	local f8_local0 = f8_arg2.groupDetails.groupId
	local f8_local1 = f8_arg2.isSimplified
	f8_arg0._numPagesMax = math.ceil( f8_arg2.groupDetails.numGroupMembers / f0_local0 )
	local f8_local2 = LUI.FlowManager.GetScopedData( f8_arg0 )
	f8_local2.currentDataProvider = f8_arg2.dataProvider
	f8_local2.currentDataProvider:ChangeOwner( f8_arg0 )
	f8_local2._searchText = nil
	f8_local2._isRecentlyOnlineRequired = false
	f8_local2.tabIdForFriendsService = FRIENDS.TabIDs.GROUP_PROFILE_MEMBERS
	f8_arg0:registerEventHandler( "groups_notification", function ( element, event )
		local f20_local0 = event.options
		if event.options.genEventName == "groups_max_members_in_role" then
			LUI.FlowManager.RequestErrorPopup( f8_arg0, Engine[0xED84C33EC5F01EA]( 0x2D549B120EB5C3C ), Engine[0xED84C33EC5F01EA]( 0x185DE4AE81906C4 ) )
		elseif f20_local0.success and f8_arg0.groupDetails.groupId == event.options.groupId and (f20_local0.genEventName == GROUPS.GroupEvents.LUI_EVENT_PARAM_GROUP_MEMBERBANNED or f20_local0.genEventName == GROUPS.GroupEvents.LUI_EVENT_PARAM_GROUP_KICKED) then
			LUI.FlowManager.RequestLeaveMenu( element, false, true )
			if LUI.FlowManager.IsInStack( "SocialGroupSetupMenu" ) then
				LUI.FlowManager.RequestLeaveMenuByName( "SocialGroupSetupMenu", false, true )
			end
			if LUI.FlowManager.IsInStack( "SocialGroupProfile" ) then
				LUI.FlowManager.RequestLeaveMenuByName( "SocialGroupProfile", false, true )
			end
		end
	end )
	f0_local0( f8_arg0, f8_arg1 )
	f0_local0( f8_arg0, f8_arg1 )
	f8_arg0._numPages = f8_arg0._numPagesMax
	f8_arg0._curPage = 0
	f0_local0( f8_arg0 )
	f8_arg0.PageBar.ButtonHelperText:PushButtonPrompt( {
		clickable = true,
		side = "left",
		priority = 1,
		ignoreTooltipPrompt = true,
		button_ref = "button_stickr_updown",
		isIconEnabledForKBM = false,
		helper_text = Engine[0xED84C33EC5F01EA]( 0x3741B369F9D1568 ),
		callback = function ()
			f8_arg0( f8_arg0, f8_arg0 )
		end
	} )
	f8_arg0.PageBar.ButtonHelperText:PushButtonPrompt( {
		clickable = true,
		side = "right",
		priority = 1,
		ignoreTooltipPrompt = true,
		button_ref = "button_stickr_updown_noswap",
		isIconEnabledForKBM = false,
		helper_text = Engine[0xED84C33EC5F01EA]( 0x59192A44399DCB4 ),
		callback = function ()
			f8_arg0( f8_arg0, f8_arg0 )
		end
	} )
	if f8_arg0._numPagesMax <= 1 then
		f8_arg0.PageCounter:SetVisible( false )
		f8_arg0.PageBar:SetVisible( false )
	end
	f8_arg0.lastMoveTime = Engine[0x6991337AE950F99]()
	f8_arg0:addEventHandler( "gamepad_button", function ( f17_arg0, f17_arg1 )
		local f17_local0 = Engine[0x6991337AE950F99]()
		if f17_local0 - f8_arg0.lastMoveTime < f8_arg0 then
			return 
		end
		f8_arg0.lastMoveTime = f17_local0
		local f17_local1 = CONDITIONS.ButtonRightStickLeft( f8_arg0, f17_arg1 )
		local f17_local2 = CONDITIONS.ButtonRightStickRight( f8_arg0, f17_arg1 )
		if f17_local1 then
			f8_arg0( f8_arg0, f8_arg0 )
		elseif f17_local2 then
			f8_arg0( f8_arg0, f8_arg0 )
		end
	end )
	f8_arg0:registerEventHandler( "member_kicked_from_group_local_update", function ( element, event )
		f8_arg0( f8_arg0, event.xuid )
	end )
	f8_arg0:registerEventHandler( "member_role_change_local_update", function ( element, event )
		GROUPS.CommonDataProviders.RoleChangeHandleFunc( element, event )
	end )
	f8_arg0:registerEventHandler( "group_member_unbaned_local_update", function ( element, event )
		local f13_local0 = f8_arg0.currentDataProvider:SearchForAvailableItem( function ( f14_arg0 )
			return f14_arg0.xuid == element.xuid
		end )
		f13_local0.forceHide = true
		f8_arg0.currentDataProvider:UpdateDataFiltering()
		f8_arg0( f8_arg0 )
	end )
	f8_arg0:addEventHandler( "on_close", function ( f12_arg0, f12_arg1 )
		f8_arg0.currentDataProvider:ChangeOwner( nil )
	end )
	f8_arg0:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	LAYOUT.SetupGenericGridViewInputAnimations( f8_arg0, f8_arg0.SocialCardsGrid.PlayersGrid, {
		widgetSwapToGridViewAnim = "SwapToGridView",
		additionalSwapToGridViewAnimSequences = {
			{
				animSequence = "SwapToGridView",
				widget = f8_arg0.SocialCardsGrid
			}
		}
	} )
	f8_arg0._playersGrid:ExpandGrid( f8_arg0 )
	f8_arg0.SocialCardsGrid:SetSearchBoxNavigation()
	local f8_local3 = function ( f10_arg0, f10_arg1, f10_arg2 )
		local f10_local0 = f8_arg0._playersGrid:GetContentIndex( f10_arg1, f10_arg2 ) + 1
		f10_arg0.id = f10_local0
		f8_arg0.currentDataProvider:Get( f10_local0 + f8_arg0._curPage * f8_arg0, function ( f11_arg0, f11_arg1 )
			if f11_arg1 then
				if f10_arg0 then
					f11_arg1.cardType = FRIENDS.ProfileCardType.FRIEND_GROUP_MEMBER_TYPE
				end
				f10_arg0:SetCurrentLocation( FRIENDS.TabIDs.GROUP_PROFILE_MEMBERS )
				f10_arg0:SetupPlayerData( f11_arg1 )
			end
		end )
	end
	
	f8_local2.currentDataProvider:UpdateDataFiltering( f0_local0, function ( f9_arg0 )
		f8_arg0.SocialCardsGrid._dataDisplayType = f8_arg0.tabIdForFriendsService
		f8_arg0._playersGrid:SetRefreshChild( f8_arg0 )
		f8_arg0( f8_arg0 )
	end )
end

local f0_local14 = function ( f7_arg0, f7_arg1, f7_arg2 )
	f7_arg0.GainInitialFocus = f0_local0
	f7_arg0.ClearFocus = f0_local0
	f7_arg0.Init = f0_local0
	f7_arg0.UpdateMembers = f0_local0
	if not f7_arg2 or not f7_arg2.groupDetails then
		return 
	else
		f7_arg0:Init( f7_arg1, f7_arg2 )
	end
end

States = {
	[0xAD14C6E7156B923] = function ( f3_arg0, f3_arg1 )
		local f3_local0 = function ( f6_arg0, f6_arg1 )
			
		end
		
		f3_arg0.LoadingFade:RegisterAnimationSequence( "Loading", {
			nil,
			nil,
			nil,
			0,
			[1] = TWEEN_PROPERTY.Visibility,
			[2] = LUI.Visibility.Visible
		} )
		f3_arg0.LoadingLbl:RegisterAnimationSequence( "Loading", {
			nil,
			nil,
			nil,
			0,
			[1] = TWEEN_PROPERTY.Visibility,
			[2] = LUI.Visibility.Visible
		} )
		local f3_local1 = function ( f5_arg0, f5_arg1 )
			f5_arg0.LoadingFade:AnimateSequence( "Loading" )
			f5_arg0.LoadingLbl:AnimateSequence( "Loading" )
		end
		
		f3_arg0.LoadingFade:RegisterAnimationSequence( "LoadFinished", {
			nil,
			nil,
			nil,
			0,
			[1] = TWEEN_PROPERTY.Visibility,
			[2] = LUI.Visibility.Hidden
		} )
		f3_arg0.LoadingLbl:RegisterAnimationSequence( "LoadFinished", {
			nil,
			nil,
			nil,
			0,
			[1] = TWEEN_PROPERTY.Visibility,
			[2] = LUI.Visibility.Hidden
		} )
		f3_arg0._sequences = {
			DefaultSequence = f3_local0,
			Loading = f3_local1,
			LoadFinished = function ( f4_arg0, f4_arg1 )
				f4_arg0.LoadingFade:AnimateSequence( "LoadFinished" )
				f4_arg0.LoadingLbl:AnimateSequence( "LoadFinished" )
			end
		}
		f3_arg0._sequenceLengths = {
			LoadFinished = 0,
			DefaultSequence = 0,
			Loading = 0
		}
	end
}
function SocialGroupMembersTab( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "SocialGroupMembersTab"
	self.__states = States
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local LoadingFade = nil
	
	LoadingFade = LUI.UIImage.new()
	LoadingFade.id = "LoadingFade"
	LoadingFade:SetVisible( false )
	LoadingFade:SetRGBFromTable( SWATCHES.genericMenu.blackBackground, 0 )
	LoadingFade:SetAlpha( 0.8, 0 )
	LoadingFade:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 39.44, _1080p * 1826.44, _1080p * 210.84, _1080p * 1033.84 )
	self:addElement( LoadingFade )
	self.LoadingFade = LoadingFade
	
	local LoadingLbl = nil
	
	LoadingLbl = LUI.UIText.new()
	LoadingLbl.id = "LoadingLbl"
	LoadingLbl:SetVisible( false )
	LoadingLbl:setText( Engine[0xED84C33EC5F01EA]( 0xD8BECEE0C9A06EB ), 0 )
	LoadingLbl:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
	LoadingLbl:SetFontSize( 34 * _PT )
	LoadingLbl:SetMinFontSize( 34 * _PT )
	LoadingLbl:SetWordWrap( true )
	LoadingLbl:SetAlignment( LUI.Alignment.Center )
	LoadingLbl:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 388.44, _1080p * 1429.44, _1080p * 495.34, _1080p * 552.34 )
	self:addElement( LoadingLbl )
	self.LoadingLbl = LoadingLbl
	
	local NothingFound = nil
	
	NothingFound = LUI.UIText.new()
	NothingFound.id = "NothingFound"
	NothingFound:SetVisible( false )
	NothingFound:setText( Engine[0xED84C33EC5F01EA]( 0x44B6929959A035B ), 0 )
	NothingFound:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
	NothingFound:SetFontSize( 24 * _PT )
	NothingFound:SetMinFontSize( 24 * _PT )
	NothingFound:SetWordWrap( true )
	NothingFound:SetAlignment( LUI.Alignment.Center )
	NothingFound:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 357.49, _1080p * 1452.49, _1080p * 402, _1080p * 482 )
	self:addElement( NothingFound )
	self.NothingFound = NothingFound
	
	local PageBar = nil
	
	PageBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	PageBar.id = "PageBar"
	PageBar:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 443, _1080p * 95, _1080p * 158 )
	self:addElement( PageBar )
	self.PageBar = PageBar
	
	local PageCounter = nil
	
	PageCounter = LUI.UIStyledText.new()
	PageCounter.id = "PageCounter"
	PageCounter:setText( "", 0 )
	PageCounter:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
	PageCounter:SetFontSize( 28 * _PT )
	PageCounter:SetMinFontSize( 28 * _PT )
	PageCounter:SetWordWrap( false )
	PageCounter:SetAlignment( LUI.Alignment.Left )
	PageCounter:SetVerticalAlignment( LUI.Alignment.Middle )
	PageCounter:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 385, _1080p * 677, _1080p * 100, _1080p * 143 )
	self:addElement( PageCounter )
	self.PageCounter = PageCounter
	
	local SocialCardsGrid = nil
	local f1_local9 = MenuBuilder.BuildRegisteredType
	local f1_local10 = "SocialCardsGrid"
	local f1_local11 = {
		controllerIndex = f1_local1
	}
	local f1_local12 = Table.Merge
	local f1_local13 = {
		maxVisibleColumns = 3,
		buildChild = function ()
			return MenuBuilder.BuildRegisteredType( "SocialProfileCardSmallGroupMember", {
				controllerIndex = menu
			} )
		end,
		columnWidth = _1080p * 556,
		rowHeight = _1080p * 94,
		maxVisibleRows = SubtractForSplitscreen( 8, 6 ),
		spacingX = _1080p * 53,
		spacingY = _1080p * 25
	}
	local f1_local14
	if controller then
		f1_local14 = controller.SocialCardsGridConfigOverride
		if not f1_local14 then
		
		else
			f1_local11.PlayersGridConfigOverride = f1_local12( f1_local13, f1_local14 )
			f1_local11.EmptyPlayerGridConfigOverride = {
				maxVisibleColumns = 3
			}
			
			SocialCardsGrid = f1_local9( f1_local10, f1_local11 )
			SocialCardsGrid.id = "SocialCardsGrid"
			SocialCardsGrid:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1920, _1080p * -40, _1080p * 1040 )
			self:addElement( SocialCardsGrid )
			self.SocialCardsGrid = SocialCardsGrid
			
			f0_local0( self, f1_local1, controller )
			return self
		end
	end
	f1_local14 = {}
end

MenuBuilder.registerType( "SocialGroupMembersTab", SocialGroupMembersTab )
LockTable( _M )
