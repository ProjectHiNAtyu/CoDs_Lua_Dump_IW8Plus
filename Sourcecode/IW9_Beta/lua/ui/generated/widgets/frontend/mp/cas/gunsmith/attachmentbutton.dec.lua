-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:02
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.mp.cas.progressionitembutton" )
require( "ui.generated.widgets.genericlock" )
local f0_local0 = function ( f17_arg0 )
	return f17_arg0._data
end

local f0_local1 = function ( f10_arg0, f10_arg1, f10_arg2, f10_arg3, f10_arg4, f10_arg5 )
	f10_arg0._data = f10_arg2
	f10_arg0.Selected:SetEquipped( f10_arg3 )
	if f10_arg5 then
		ACTIONS.AnimateSequence( f10_arg0, "ShowRestriction" )
	else
		ACTIONS.AnimateSequence( f10_arg0, "HideRestriction" )
	end
	local f10_local0
	if 0 < #f10_arg0._data.image then
		f10_local0 = f10_arg0._data.image
		if not f10_local0 then
		
		else
			if f10_arg0._data.isClassified then
				f10_arg0.Icon:setImage( RegisterMaterial( "icon_empty_circle" ) )
				f10_arg0.Text:setText( Engine[0xED84C33EC5F01EA]( 0x99E24C4EADB96DB ) )
			else
				f10_arg0.Icon:setImage( RegisterMaterial( f10_local0 ) )
				f10_arg0.Text:setText( Engine[0xED84C33EC5F01EA]( f10_arg0._data.name ) )
			end
			f10_arg0._data.blockedCategorySlot = ATTACHMENT.GetBlockedCategorySlot( f10_arg0._data.ref, f10_arg4 )
			if CONDITIONS.IsWaveGameType() then
				f10_arg0.CPWaveSurvivalCost:setText( Engine[0xED84C33EC5F01EA]( 0x516E4EC0FA14469, tostring( f10_arg0._data.survivalCost ) ) )
			end
			if not f10_arg0._data.unlocked then
				local f10_local1 = f10_arg0._data.gunsmithAttach
				local f10_local2 = {}
				local f10_local3
				if 0 < #f10_local1.challengeID then
					f10_local3 = LOOT.unlockTypes.CHALLENGE
					if not f10_local3 then
					
					else
						f10_local2.type = f10_local3
						f10_local2.level = PROGRESSION.GetRankDisplay( tonumber( f10_local1.level ) )
						f10_arg0.GenericLock:Setup( f10_local2 )
					end
				end
				f10_local3 = LOOT.unlockTypes.LEVEL
			end
			local f10_local1 = GUNSMITH.IsAttachVariantCategoryBlacklisted( f10_arg4.weapon, ATTACHMENT.GetCategory( f10_arg2.ref ) )
			if not f10_arg0._handlersAdded then
				f10_arg0:addEventHandler( "button_over", function ( f16_arg0, f16_arg1 )
					f10_arg0:dispatchEventToCurrentMenu( {
						name = "update_showcase",
						attachmentData = f16_arg0._data
					} )
					ACTIONS.AnimateSequence( f10_arg0, "ButtonOver" )
				end )
				f10_arg0:addEventHandler( "button_over_disable", function ( f15_arg0, f15_arg1 )
					f10_arg0:dispatchEventToCurrentMenu( {
						name = "update_showcase",
						attachmentData = f15_arg0._data
					} )
					ACTIONS.AnimateSequence( f10_arg0, "ButtonOverDisabled" )
				end )
				f10_arg0:addEventHandler( "button_disable", function ( f14_arg0, f14_arg1 )
					ACTIONS.AnimateSequence( f10_arg0, "ButtonUpDisabled" )
				end )
				if CONDITIONS.IsWaveGameType() then
					f10_arg0:addEventHandler( "button_action", function ( f13_arg0, f13_arg1 )
						if tonumber( f13_arg0._data.survivalCost ) <= CP.CurrencyGet( f13_arg1.controller ) then
							f10_arg0:dispatchEventToCurrentMenu( {
								name = "equip_attachment",
								attachmentData = f13_arg0._data
							} )
						else
							Engine[0xC4146BA76D0F982]( 0xC434AA96E20B199 )
						end
					end )
				else
					f10_arg0:addEventHandler( "button_action", function ( f12_arg0, f12_arg1 )
						f10_arg0:dispatchEventToCurrentMenu( {
							name = "equip_attachment",
							attachmentData = f12_arg0._data
						} )
					end )
				end
				f10_arg0:addEventHandler( "button_up", function ( f11_arg0, f11_arg1 )
					if f10_arg0.NewItemNotification then
						f10_arg0.NewItemNotification:ClearBreadcrumbByID( f10_arg0, f10_arg0._attachmentID )
					end
					ACTIONS.AnimateSequence( f10_arg0, "ButtonUp" )
					f10_arg0:dispatchEventToCurrentMenu( {
						name = "update_showcase_off",
						attachmentData = f11_arg0._data
					} )
				end )
				f10_arg0._handlersAdded = true
			end
			local f10_local4 = f10_arg0
			local f10_local2 = f10_arg0.SetButtonDisabled
			local f10_local5
			if f10_arg0._data.unlocked then
				f10_local5 = f10_arg5
			else
				f10_local5 = true
			end
			f10_local2( f10_local4, f10_local5 )
			f10_local2 = assert
			f10_local4 = f10_arg0._data.gunsmithAttach.lootID
			if f10_local4 then
				if type( f10_arg0._data.gunsmithAttach.lootID ) ~= "number" and (type( f10_arg0._data.gunsmithAttach.lootID ) ~= "string" or 0 >= #f10_arg0._data.gunsmithAttach.lootID) then
					f10_local4 = false
				else
					f10_local4 = true
				end
			end
			f10_local2( f10_local4 )
			f10_arg0._attachmentID = tonumber( f10_arg0._data.gunsmithAttach.lootID )
			if f10_arg0.NewItemNotification and not f10_arg3 then
				f10_arg0.NewItemNotification:UpdateBreadcrumbByID( f10_arg1, f10_arg0._attachmentID )
			end
		end
	end
	f10_local0 = "white"
end

local f0_local2 = function ( f9_arg0, f9_arg1, f9_arg2 )
	assert( f9_arg0.Selected )
	assert( f9_arg0.Icon )
	assert( f9_arg0.Text )
	f9_arg0.Setup = f0_local0
	f9_arg0.GetData = f0_local0
end

function AttachmentButton( f1_arg0, f1_arg1 )
	local f1_local0 = MenuBuilder.BuildRegisteredType( "ProgressionItemButton", f1_arg1 )
	f1_local0:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 420 * _1080p, 0, 62 * _1080p )
	f1_local0.id = "AttachmentButton"
	f1_local0._animationSets = f1_local0._animationSets or {}
	f1_local0._sequences = f1_local0._sequences or {}
	f1_local0._sequenceLengths = f1_local0._sequenceLengths or {}
	local f1_local1
	if f1_arg1 then
		f1_local1 = f1_arg1
	else
		f1_local1 = f1_arg1.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( f1_local0, f1_local1 )
	local f1_local2 = f1_local0
	f1_local0.Text:setText( ToUpperCase( "" ), 0 )
	f1_local0.Text:SetAlignment( LUI.Alignment.Left )
	local f1_local3 = nil
	if not CONDITIONS.AreCDLRulesActive( f1_local1 ) then
		f1_local3 = MenuBuilder.BuildRegisteredType( "GenericLock", {
			controllerIndex = f1_local1
		} )
		f1_local3.id = "GenericLock"
		f1_local3:SetAlpha( 0, 0 )
		f1_local3:SetAnchorsAndPosition( 1, 0, 0.5, 0.5, _1080p * -56, _1080p * -6, _1080p * -25, _1080p * 25 )
		f1_local0:addElement( f1_local3 )
		f1_local0.GenericLock = f1_local3
	end
	local self = nil
	if CONDITIONS.IsWaveGameType( f1_local0 ) then
		self = LUI.UIStyledText.new()
		self.id = "CPWaveSurvivalCost"
		self:SetRGBFromInt( 8421504, 0 )
		self:SetAlpha( 0.6, 0 )
		self:setText( "", 0 )
		self:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
		self:SetFontSize( 24 * _PT )
		self:SetMinFontSize( 18 * _PT )
		self:SetWordWrap( true )
		self:SetAlignment( LUI.Alignment.Right )
		self:SetOutlineRGBFromInt( 0, 0 )
		self:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -177, _1080p * -49, _1080p * 38, _1080p * 62 )
		f1_local0:addElement( self )
		f1_local0.CPWaveSurvivalCost = self
	end
	local RestrictionWarning = nil
	
	RestrictionWarning = LUI.UIImage.new()
	RestrictionWarning.id = "RestrictionWarning"
	RestrictionWarning:SetAlpha( 0, 0 )
	RestrictionWarning:setImage( RegisterMaterial( "ui_streak_warning" ), 0 )
	RestrictionWarning:SetAnchorsAndPosition( 1, 0, 0.5, 0.5, _1080p * -48, _1080p * -14, _1080p * -17, _1080p * 17 )
	f1_local0:addElement( RestrictionWarning )
	f1_local0.RestrictionWarning = RestrictionWarning
	
	f1_local0._sequences.DefaultSequence = function ()
		
	end
	
	f1_local0._sequenceLengths.DefaultSequence = 0
	local f1_local6 = nil
	if f1_local3 then
		f1_local3:RegisterAnimationSequence( "ButtonUp", {
			{
				value = 0,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
	end
	f1_local0._sequences.ButtonUp = function ()
		if f1_arg0 then
			f1_arg0:AnimateSequence( "ButtonUp" )
		end
	end
	
	f1_local0._sequenceLengths.ButtonUp = 0
	local f1_local7 = nil
	if f1_local3 then
		f1_local3:RegisterAnimationSequence( "ButtonOver", {
			{
				value = 0,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
	end
	f1_local0._sequences.ButtonOver = function ()
		if f1_arg0 then
			f1_arg0:AnimateSequence( "ButtonOver" )
		end
	end
	
	f1_local0._sequenceLengths.ButtonOver = 0
	local f1_local8 = nil
	if f1_local3 then
		f1_local3:RegisterAnimationSequence( "ButtonOverDisabled", {
			{
				value = 1,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
	end
	f1_local0._sequences.ButtonOverDisabled = function ()
		if f1_arg0 then
			f1_arg0:AnimateSequence( "ButtonOverDisabled" )
		end
	end
	
	f1_local0._sequenceLengths.ButtonOverDisabled = 0
	local f1_local9 = nil
	if f1_local3 then
		f1_local3:RegisterAnimationSequence( "ButtonUpDisabled", {
			{
				value = -2.3534382788928255E-185,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			}
		} )
	end
	f1_local0._sequences.ButtonUpDisabled = function ()
		if f1_arg0 then
			f1_arg0:AnimateSequence( "ButtonUpDisabled" )
		end
	end
	
	f1_local0._sequenceLengths.ButtonUpDisabled = 0
	local f1_local10 = nil
	RestrictionWarning:RegisterAnimationSequence( "ShowRestriction", {
		{
			value = 1,
			duration = 30,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	f1_local0._sequences.ShowRestriction = function ()
		f1_arg0:AnimateSequence( "ShowRestriction" )
	end
	
	f1_local0._sequenceLengths.ShowRestriction = 30
	local f1_local11 = nil
	RestrictionWarning:RegisterAnimationSequence( "HideRestriction", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Alpha
		}
	} )
	f1_local0._sequences.HideRestriction = function ()
		f1_arg0:AnimateSequence( "HideRestriction" )
	end
	
	f1_local0._sequenceLengths.HideRestriction = 0
	f0_local0( f1_local0, f1_local1, f1_arg1 )
	return f1_local0
end

MenuBuilder.registerType( "AttachmentButton", AttachmentButton )
LockTable( _M )
