-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:48
module( ..., package.seeall )
local f0_local0 = 5
local f0_local1 = function ( f32_arg0 )
	for f32_local3, f32_local4 in ipairs( f32_arg0._currentCamos ) do
		if f32_arg0._equippedCamoRef == f32_local4[0x9E9C01960F4C582] then
			return f32_local3 - 1
		end
	end
	return 0
end

local f0_local2 = function ( f31_arg0, f31_arg1, f31_arg2 )
	if Engine[0x12586A3F4FB490E]() then
		f31_arg0._weaponTableWithHighlightedCamo = WEAPON.GenerateWeaponTable( f31_arg0._weaponPlayerData )
		f31_arg0._weaponTableWithHighlightedCamo.camo = f31_arg2
		local f31_local0 = WEAPON.GetWeaponModelName( f31_arg0._weaponTableWithHighlightedCamo.weapon, f31_arg0._weaponTableWithHighlightedCamo, {
			includeCamos = true,
			includeAttachments = true,
			includeStickers = true,
			controllerIndex = f31_arg1
		} )
		FrontEndScene.RequestWeaponViewModels( {
			f31_local0
		}, f31_arg1 )
		WEAPON.SetModelIfLoaded( f31_arg1, f31_arg0.weaponModel, f31_local0 )
	end
end

local f0_local3 = function ( f30_arg0, f30_arg1, f30_arg2 )
	LOOT.SendDlogLootEquipped( f30_arg1, LOOT.itemTypes.CAMO, nil, nil, f30_arg0._equippedCamoRef, f30_arg2 )
	WEAPON.SetEquippedCamo( f30_arg0._weaponPlayerData, f30_arg2 )
	f30_arg0._equippedCamoRef = f30_arg2
	f30_arg0.CamoGrid:RefreshContent()
	f0_local0( f30_arg0, f30_arg1, f30_arg2 )
	if f30_arg0.HelperBar then
		f30_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			button_ref = "button_alt1",
			priority = 2,
			helper_text = Engine[0xED84C33EC5F01EA]( 0xDE44C2C175C6810 )
		} )
	end
	if f30_arg0.CategoryGrid then
		f30_arg0.CategoryGrid:RefreshContent()
	end
end

local f0_local4 = function ( f29_arg0, f29_arg1 )
	if not f29_arg0._equippedCamoRef or f29_arg0._equippedCamoRef == WEAPON.CamoNoneValue then
		return 
	end
	LOOT.SendDlogLootEquipped( f29_arg1, LOOT.itemTypes.CAMO, nil, nil, f29_arg0._equippedCamoRef, WEAPON.CamoNoneValue )
	WEAPON.SetEquippedCamo( f29_arg0._weaponPlayerData, WEAPON.CamoNoneValue )
	f29_arg0._equippedCamoRef = nil
	if Engine[0x12586A3F4FB490E]() then
		local f29_local0 = WEAPON.GenerateWeaponTable( f29_arg0._weaponPlayerData )
		f29_local0.camo = WEAPON.CamoNoneValue
		local f29_local1 = WEAPON.GetWeaponModelName( f29_local0.weapon, f29_local0, {
			includeCamos = true,
			includeAttachments = true,
			includeStickers = true,
			controllerIndex = f29_arg1
		} )
		FrontEndScene.RequestWeaponViewModels( {
			f29_local1
		}, f29_arg1 )
		WEAPON.SetModelIfLoaded( f29_arg1, f29_arg0.weaponModel, f29_local1 )
		Engine[0xC4146BA76D0F982]( SOUND_SETS.default.action )
		if f29_arg0.HelperBar then
			f29_arg0.HelperBar.ButtonHelperText:PopButtonPrompt( {
				button_ref = "button_alt1"
			} )
		end
		f29_arg0._equippedCamoCategory = "default"
	end
	f29_arg0.CamoGrid:RefreshContent()
	if f29_arg0.CategoryGrid then
		f29_arg0.CategoryGrid:RefreshContent()
	end
end

local f0_local5 = function ( f28_arg0, f28_arg1 )
	if f28_arg0.UnlockCount then
		if f28_arg0.isAllUnlockedCamos then
			f28_arg0.AllUnlockedCamosCount:setText( Engine[0xED84C33EC5F01EA]( 0x74821ADAF79FD0F, #f28_arg0._allUnlocksTable - f28_arg0._invisibleButtonAmount, f28_arg0._totalCamoAmount ) )
		else
			local f28_local0 = 0
			for f28_local4, f28_local5 in ipairs( f28_arg0._currentCamos ) do
				if f28_local5[0x28887F70BF5EBA] and LOOT.IsUnlockedWithID( f28_arg1, tonumber( f28_local5[0x28887F70BF5EBA] ) ) then
					f28_local0 = f28_local0 + 1
				end
			end
			f28_arg0.UnlockCount:UpdateCount( f28_local0, #f28_arg0._currentCamos, false, f28_arg0._currentCategory[0x4BCADBA8E631B86] )
		end
	end
end

local f0_local6 = function ( f27_arg0, f27_arg1 )
	f27_arg0._equippedCamoRef = WEAPON.GetEquippedCamo( f27_arg0._weaponPlayerData )
	f27_arg0.CamoGrid:RemoveFocusFromChild()
	f27_arg0.CamoGrid:SetNumChildren( #f27_arg0._currentCamos )
	f27_arg0.CamoGrid:RefreshContent()
	if f27_arg0.CategoryGrid then
		f27_arg0.CategoryGrid:RefreshContent()
	end
	f0_local0( f27_arg0, f27_arg1 )
end

local f0_local7 = function ( f26_arg0, f26_arg1 )
	local f26_local0 = f26_arg1.camoRef
	local f26_local1 = f26_arg1.controller
	local f26_local2 = f26_arg1.challengesData
	local f26_local3 = GUNSMITH.GetCamoDetails( f26_local1, f26_local0, f26_local2 )
	if f26_arg0.CamoTitle then
		f26_arg0.CamoTitle:SetData( f26_local3, f26_local2.challengeWeaponRef )
	elseif f26_arg0.ItemDetails then
		f26_arg0.ItemDetails:UpdateDetails( f26_local3 )
	end
	f0_local0( f26_arg0, f26_local1, f26_local0 )
end

local f0_local8 = function ( f25_arg0, f25_arg1 )
	local f25_local0 = f25_arg1.camoRef
	local f25_local1 = f25_arg1.controller
	if f25_local0 == f25_arg0._equippedCamoRef then
		f0_local0( f25_arg0, f25_local1 )
	else
		f0_local0( f25_arg0, f25_local1, f25_local0 )
	end
end

local f0_local9 = function ( f24_arg0 )
	if f24_arg0.isAllUnlockedCamos then
		f24_arg0._nextCategoryIndex = f24_arg0._categoryIndex + 1
		if #f24_arg0._categoryTable < f24_arg0._nextCategoryIndex then
			f24_arg0._nextCategoryIndex = f24_arg0._categoryIndex
		end
		f24_arg0._prevCategoryIndex = f24_arg0._categoryIndex - 1
		if f24_arg0._prevCategoryIndex < 1 then
			f24_arg0._prevCategoryIndex = f24_arg0._categoryIndex
		end
	else
		f24_arg0._nextCategoryIndex = f24_arg0._categoryIndex
		f24_arg0._prevCategoryIndex = f24_arg0._categoryIndex
	end
end

local f0_local10 = function ( f21_arg0, f21_arg1, f21_arg2, f21_arg3, f21_arg4 )
	if not f21_arg4 then
		f21_arg4 = {}
	end
	local f21_local0 = f21_arg2
	local f21_local1 = f21_arg2.SetAlpha
	local f21_local2
	if f21_arg4.isInvisibleButton then
		f21_local2 = 0
	else
		f21_local2 = 1
	end
	f21_local1( f21_local0, f21_local2 )
	f21_arg2.isInvisibleButton = f21_arg4.isInvisibleButton
	f21_local1 = nil
	if not f21_arg2.isInvisibleButton then
		f21_arg2.camoRef = f21_arg3[0x9E9C01960F4C582]
		f21_local1 = f21_arg3[0x28887F70BF5EBA]
		GUNSMITH.SetupCamoButton( f21_arg1, f21_arg2, f21_arg3[0xAB612888528489A], f21_arg2.camoRef == f21_arg0._equippedCamoRef, f21_arg0 )
		f21_arg2:SetDisabled( GUNSMITH.IsCamoChallengeDisabled( f21_arg1, f21_local1 ) )
		f21_arg2.challengesData = GUNSMITH.GetCamoChallenges( f21_arg1, f21_arg2.camoRef, {
			camoData = f21_arg3
		} )
		f21_local2 = GUNSMITH.GetCamoChallengeProgression( f21_arg1, f21_arg2.challengesData )
		if f21_arg2.SetProgress and f21_local2 then
			f21_arg2:SetProgress( f21_arg1, f21_local2 )
		end
	end
	local f21_local3
	if not f21_arg4.showCategoryLine then
		f21_local3 = f21_arg4.isLastInCategory
		if f21_local3 then
		
		else
			f21_arg2:ShowCategoryLine( f21_local3, f21_arg4.isLastInCategory )
			if f21_arg4.isFirstInCategory and f21_arg4.categoryName then
				f21_arg2:CreateCamoCategoryTitle( f21_arg1, f21_arg4.categoryName, f21_arg4.isLastInCategory )
			else
				f21_arg2:RemoveCamoCategoryTitle()
			end
			f21_local0 = function ( f23_arg0, f23_arg1 )
				if f23_arg0.isInvisibleButton then
					if LUI.IsLastInputGamepad( f23_arg1.controller ) and f23_arg0.gridData and f21_arg0.CategoryGrid then
						f21_arg0.CategoryGrid:SetFocusedPosition( {
							x = f23_arg0.gridData.col,
							y = f23_arg0.gridData.row - 1
						}, false, true )
						f21_arg0._lastFocusedElement = f21_arg0.CategoryGrid:GetElementAtPosition( f23_arg0.gridData.col, f23_arg0.gridData.row - 1 )
					end
					return 
				elseif f21_arg0._lastFocusedElement then
					f21_arg0._lastFocusedElement:processEvent( {
						name = "lose_focus"
					} )
					f21_arg0._lastFocusedElement = nil
				end
				if f21_arg0.isAllUnlockedCamos then
					f21_arg0._categoryIndex = f23_arg0.camoCategoryInfo.categoryIndex
					f21_arg0( f21_arg0 )
					f23_arg0:dispatchEventToCurrentMenu( {
						name = "camo_category_header_update",
						controller = f21_arg0,
						categoryIndex = f23_arg0.camoCategoryInfo.categoryIndex
					} )
				end
				f23_arg0:dispatchEventToCurrentMenu( {
					name = "camo_button_over",
					controller = f21_arg0,
					camoRef = f23_arg0.camoRef,
					challengesData = f23_arg0.challengesData
				} )
			end
			
			f21_arg2:addEventHandler( "button_over", f21_local0 )
			f21_arg2:addEventHandler( "button_over_disable", f21_local0 )
			f21_arg2:registerEventHandler( "button_action", function ( element, event )
				if element.isInvisibleButton then
					return 
				else
					element:dispatchEventToCurrentMenu( {
						name = "camo_button_action",
						controller = f21_arg0,
						camoRef = element.camoRef
					} )
				end
			end )
		end
	end
	f21_local3 = not f21_arg4.isFirstInCategory
end

local f0_local11 = function ( f20_arg0, f20_arg1 )
	f0_local0( f20_arg0 )
	if f20_arg0.ButtonHelperBar then
		f20_arg0.ButtonHelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "right",
			button_ref2 = "button_shoulderr",
			priority = 1,
			helper_text = CONDITIONS.IsKbm( f20_arg1 ) and Engine[0xED84C33EC5F01EA]( 0x11A589832C7AAE1, f20_arg0._categoryTable[f20_arg0._nextCategoryIndex][0x4BCADBA8E631B86] ) or Engine[0xED84C33EC5F01EA]( 0xCC062AD4C358A2B, f20_arg0._categoryTable[f20_arg0._nextCategoryIndex][0x4BCADBA8E631B86] )
		} )
		f20_arg0.ButtonHelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			button_ref = "button_shoulderl",
			priority = 1,
			helper_text = CONDITIONS.IsKbm( f20_arg1 ) and Engine[0xED84C33EC5F01EA]( 0x9086967DA498436, f20_arg0._categoryTable[f20_arg0._prevCategoryIndex][0x4BCADBA8E631B86] ) or Engine[0xED84C33EC5F01EA]( 0xCC062AD4C358A2B, f20_arg0._categoryTable[f20_arg0._prevCategoryIndex][0x4BCADBA8E631B86] )
		} )
	end
end

local f0_local12 = function ( f19_arg0, f19_arg1, f19_arg2 )
	local f19_local0 = LOOT.IsUnlockedWithID( f19_arg0, tonumber( f19_arg1[0x28887F70BF5EBA] ) )
	if f19_local0 ~= LOOT.IsUnlockedWithID( f19_arg0, tonumber( f19_arg2[0x28887F70BF5EBA] ) ) then
		return f19_local0
	else
		return Engine[0xED84C33EC5F01EA]( f19_arg1[0x4BCADBA8E631B86] ) < Engine[0xED84C33EC5F01EA]( f19_arg2[0x4BCADBA8E631B86] )
	end
end

local f0_local13 = function ( f17_arg0, f17_arg1, f17_arg2, f17_arg3 )
	f17_arg0._categoryIndex = f17_arg2
	f17_arg0._currentCategory = f17_arg0._categoryTable[f17_arg0._categoryIndex]
	f17_arg0._currentCamos = f17_arg0._camoTable[f17_arg0._currentCategory[0x9E9C01960F4C582]]
	if f17_arg0.isAllUnlockedCamos then
		if f17_arg3 then
			f17_arg0.CategoryGrid:SetScrollThresholdX( #f17_arg0._currentCamos )
		else
			f17_arg0.CategoryGrid:SetScrollThresholdX( 0 )
		end
		f0_local0( f17_arg0 )
		f17_arg0.CategoryGrid:SetFocusedPosition( f17_arg0._allFirstInCategoryGridPos[f17_arg0._categoryIndex], false, true )
		f17_arg0.CategoryGrid:SetScrollThresholdX( f0_local0 )
	end
	if f17_arg0._currentCategory and f17_arg0._currentCategory[0x9E9C01960F4C582] == "events" then
		f17_arg0._currentCamos = GUNSMITH.GetWeaponClassCamos( f17_arg1, f17_arg0._weaponClass, f17_arg0._currentCamos )
	end
	table.sort( f17_arg0._currentCamos, function ( f18_arg0, f18_arg1 )
		return f17_arg0( f17_arg0, f18_arg0, f18_arg1 )
	end )
	f0_local0( f17_arg0, f17_arg1 )
	f17_arg0.CamoGrid:SetFocusedPosition( {
		x = 0,
		y = 0
	}, true, false )
	f17_arg0.CamoGrid:processEvent( {
		name = "request_active"
	} )
	if f17_arg0.ButtonHelperBar then
		f0_local0( f17_arg0, f17_arg1 )
	end
	local f17_local0 = f17_arg0.SideArrows
	f17_local0._currentIndex = 0
	f17_local0._maxIndex = f17_local0._grid:GetContentCount( LUI.DIRECTION.horizontal ) - 1
	f17_local0:UpdateSideButtons()
	f17_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0x6A51E18DC8715B7, f17_arg0._currentCategory[0x4BCADBA8E631B86] ) )
	local f17_local1 = f17_arg0._currentCamos[1][0x9E9C01960F4C582]
	local f17_local2 = GUNSMITH.GetCamoChallenges( f17_arg1, f17_local1 )
	local f17_local3 = GUNSMITH.GetCamoDetails( f17_arg1, f17_local1, f17_local2 )
	if f17_arg0.CamoTitle then
		f17_arg0.CamoTitle:SetData( f17_local3, f17_local2.challengeWeaponRef )
	elseif f17_arg0.ItemDetails then
		f17_arg0.ItemDetails:UpdateDetails( f17_local3 )
	end
	f0_local0( f17_arg0, f17_arg1, f17_local1 )
end

local f0_local14 = function ( f16_arg0, f16_arg1, f16_arg2 )
	assert( f16_arg2.camoTable )
	assert( f16_arg2.categoryTable )
	assert( f16_arg2.categoryIndex )
	assert( f16_arg2.loadoutIndex )
	assert( f16_arg2.weaponSlot )
	f16_arg0._categoryTable = f16_arg2.categoryTable
	f16_arg0._camoTable = f16_arg2.camoTable
	f16_arg0._categoryIndex = f16_arg2.categoryIndex
	f16_arg0._currentCategory = f16_arg0._categoryTable[f16_arg0._categoryIndex]
	f16_arg0._weaponPlayerData = f16_arg2.weaponPlayerData
	f16_arg0._equippedCamoRef = f16_arg2.equippedCamo
	f16_arg0._totalCamoAmount = f16_arg2.totalCamoAmount
	if f16_arg0._currentCategory then
		f16_arg0._currentCamos = f16_arg0._camoTable[f16_arg0._currentCategory[0x9E9C01960F4C582]]
	end
	f16_arg0._weaponRef = f16_arg2.weaponTable.weapon
	f16_arg0._weaponClass = WEAPON.GetWeaponClass( f16_arg0._weaponRef )
	if f16_arg0._currentCategory and f16_arg0._currentCategory[0x9E9C01960F4C582] == "events" then
		f16_arg0._currentCamos = GUNSMITH.GetWeaponClassCamos( f16_arg1, f16_arg0._weaponClass, f16_arg0._currentCamos )
	end
end

local f0_local15 = function ( f15_arg0, f15_arg1 )
	FrontEndScene.SetExclusiveWeaponModels( {
		FrontEndScene.ClientWeapons.Preview
	} )
	f15_arg0.weaponModel = WEAPON.GetWeaponModel( f15_arg1, FrontEndScene.ClientWeapons.Preview, CSV.weaponOffsets.previewFile )
	f15_arg0:addElement( f15_arg0.weaponModel )
end

local f0_local16 = function ( f13_arg0, f13_arg1 )
	f13_arg0.CamoGrid:SetDefaultFocus( {
		y = 0,
		x = f0_local0( f13_arg0 )
	} )
	f13_arg0.CamoGrid:TouchMouseSetActiveToDefaultFocusMenuCreate( f13_arg1 )
	f13_arg0.CamoGrid:SetRefreshChild( function ( f14_arg0, f14_arg1, f14_arg2 )
		f13_arg0( f13_arg0, f13_arg0, f14_arg0, f13_arg0._currentCamos[f14_arg1 + f14_arg2 * f13_arg0.CamoGrid:GetNumColumns() + 1] )
	end )
	f0_local0( f13_arg0, f13_arg1 )
end

local f0_local17 = function ( f8_arg0, f8_arg1 )
	f8_arg0:AddGamepadEventCallback( "button_shoulderr", function ( f12_arg0, f12_arg1 )
		f8_arg0( f8_arg0, f8_arg0, f8_arg0._nextCategoryIndex, true )
	end )
	f8_arg0:AddGamepadEventCallback( "button_shoulderl", function ( f11_arg0, f11_arg1 )
		f8_arg0( f8_arg0, f8_arg0, f8_arg0._prevCategoryIndex )
	end )
	if CONDITIONS.IsWeaponPreviewEnabled() then
		f8_arg0:AddGamepadEventCallback( "left_stick", function ( f10_arg0, f10_arg1 )
			LUI.FlowManager.RequestAddMenu( "WeaponPreview", true, f8_arg0, nil, {
				weaponTable = f8_arg0._weaponTableWithHighlightedCamo
			}, true )
			if f10_arg1.qualifier then
				Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
			end
		end )
	end
	f8_arg0:AddGamepadEventCallback( "button_alt1", function ( f9_arg0, f9_arg1 )
		f8_arg0( f8_arg0, f8_arg0 )
	end )
end

local f0_local18 = function ( f6_arg0, f6_arg1 )
	if f6_arg0.ButtonHelperBar then
		f0_local0( f6_arg0, f6_arg1 )
	end
	f6_arg0:SubscribeToInputTypeModel( f6_arg1, function ( f7_arg0, f7_arg1 )
		f6_arg0( f6_arg0, f6_arg0 )
	end )
end

local f0_local19 = function ( f4_arg0, f4_arg1, f4_arg2 )
	f4_arg0.UpdateWeaponPreview = f0_local0
	f4_arg0.SetupCamoButton = f0_local0
	f4_arg0.UpdateUnlockCount = f0_local0
	f0_local0( f4_arg0, f4_arg1, f4_arg2 )
	f4_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0x6A51E18DC8715B7, f4_arg2.category ) )
	f0_local0( f4_arg0, f4_arg1 )
	if not f4_arg0.isAllUnlockedCamos then
		table.sort( f4_arg0._currentCamos, function ( f5_arg0, f5_arg1 )
			return f4_arg0( f4_arg0, f5_arg0, f5_arg1 )
		end )
		f0_local0( f4_arg0, f4_arg1 )
		f0_local0( f4_arg0, f4_arg1 )
	else
		f0_local0( f4_arg0 )
	end
	f4_arg0:addEventHandler( "camo_button_over", f0_local0 )
	f4_arg0:addEventHandler( "camo_button_action", f0_local0 )
	f0_local0( f4_arg0, f4_arg1 )
end

local f0_local20 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.PostLoadShared = f0_local0
end

function CamoSelectBase( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "CamoSelectBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	self:AddGamepadEventCallback( "button_secondary", function ( f2_arg0, f2_arg1 )
		local f2_local0 = f2_arg1.controller or menu
		ACTIONS.LeaveMenu( menu )
	end )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "CamoSelectBase", CamoSelectBase )
LockTable( _M )
