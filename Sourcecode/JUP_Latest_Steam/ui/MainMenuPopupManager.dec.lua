-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
LUI.MainMenuPopupManager = LUI.Class( LUI.UIElement )
LUI.MainMenuPopupManager.Instance = function ()
	return LUI.MainMenuPopupManager.GetLayer()
end

LUI.MainMenuPopupManager.GetLayer = function ()
	local f39_local0 = Engine[0xEE6F69FEA944B13]()
	return f39_local0.mainMenuPopupManager
end

LUI.MainMenuPopupManager.InitLayer = function ( f38_arg0 )
	
end

LUI.MainMenuPopupManager.ClearLayer = function ( f37_arg0, f37_arg1 )
	f37_arg0.closeChildren()
end

LUI.MainMenuPopupManager.ShouldBeVisible = function ( f36_arg0 )
	return true
end

LUI.MainMenuPopupManager.init = function ( f35_arg0, f35_arg1 )
	LUI.UIElement.init( f35_arg0 )
	f35_arg0.id = "MainMenuPopupManager"
	f35_arg0:registerEventHandler( "remove_menu_stack", LUI.MainMenuPopupManager.OnRemoveMenuStack )
	f35_arg0:registerEventHandler( "webview_fence_fail", LUI.MainMenuPopupManager.OnRemoveMenuStack )
end

local f0_local0 = LUI.MainMenuPopupManager
local f0_local1 = {
	{
		name = "AgeGateNoticePopup",
		shouldShowFct = function ( f34_arg0 )
			return AGEGATES[0xB3026C7BB5015C7]( f34_arg0 )
		end,
		tryShow = function ( f33_arg0 )
			AGEGATES[0x2771ED017C94E3D]( f33_arg0 )
			return AGEGATES[0x1A0C04B5CACC1F2]
		end,
		postShow = function ( f32_arg0 )
			AGEGATES[0xC38EF5C058B5150]( f32_arg0 )
		end
	},
	{
		name = "SPProgressionTransferPopup",
		shouldShowFct = function ( f31_arg0 )
			if not CONDITIONS.IsSony() then
				return false
			elseif Engine[0x647B2ED05194AAB]( f31_arg0 ) then
				return true
			else
				return false
			end
		end,
		tryShow = function ( f30_arg0, f30_arg1 )
			LUI.FlowManager.RequestPopupMenu( nil, "PopupMessageAndButtons", true, f30_arg0, false, SPSharedUtils.GetSPProgressionTransferPopupOptions( f30_arg0 ) )
			return "PopupMessageAndButtons"
		end,
		postShow = function ( f29_arg0 )
			
		end
	},
	{
		name = "CinematicFullscreen",
		shouldShowFct = function ( f28_arg0 )
			if Dvar[0x9E5BE3B4BBA4E0E]( 0x1D3FD8961BD9873 ) then
				return false
			elseif not SEASON.IsValidSeason() then
				return false
			elseif Dvar[0x9E5BE3B4BBA4E0E]( 0x421D8D250F388E4 ) then
				return true
			else
				local f28_local0 = Onboarding.SeasonVideo.WasCompleted( f28_arg0, SEASON.GetCurrentSeasonPrecise() )
				if f28_local0 == nil then
					return false
				else
					return not f28_local0
				end
			end
		end,
		tryShow = function ( f25_arg0, f25_arg1 )
			local f25_local0 = SEASON.GetCurrentSeasonPrecise()
			local f25_local1 = SEASON.GetCinematic( f25_local0 )
			local f25_local2 = false
			local f25_local3 = String.IsNilOrEmpty( f25_local1 ) and false
			f25_local3 = function ( f26_arg0 )
				return function ()
					local f27_local0 = SEASON.GetCurrentSeasonPrecise()
					local f27_local1 = Onboarding.SeasonVideo.WasCompleted( f26_arg0, f27_local0 )
					if f27_local1 ~= nil and not f27_local1 then
						Onboarding.SeasonVideo.MarkCompleted( f26_arg0, f27_local0 )
					end
					if CONDITIONS.IsPC() and f26_arg0 then
						ShaderUpload[0x58462107DF222FC]( Enum[0x4D85518FAA20DA8][0xB9DCC60A535A135][0xEFE12D9D742402E] )
					end
				end
				
			end
			
			local f25_local4 = {
				disableQuickAccess = true,
				skipVideoOnPartyJoin = true,
				video = f25_local1,
				onVideoFinished = f25_local3( f25_arg0 ),
				unskippable = not Dvar[0x9E5BE3B4BBA4E0E]( 0x275E8EF53752995 ),
				skipImmediate = not Dvar[0x9E5BE3B4BBA4E0E]( 0x4203CE3C40112EF ),
				widescreen = SEASON.IsCinematicWidescreen( f25_local0 )
			}
			DataSources.telescope.conflictfullscreenwebview:SetValue( f25_arg0, true )
			LUI.FlowManager.RequestAddMenu( "CinematicFullscreen", true, f25_arg0, false, f25_local4, true )
			if CONDITIONS.IsPC() then
				ShaderUpload[0xC3DFE9D3355C27A]( Enum[0x4D85518FAA20DA8][0xB9DCC60A535A135][0xEFE12D9D742402E] )
				f25_local2 = true
			end
			return "CinematicFullscreen"
		end,
		postShow = function ( f24_arg0 )
			
		end
	},
	{
		name = "LobbyRejoinPopup",
		shouldShowFct = function ( f23_arg0 )
			return LUI.RejoinManager.IsDataFetchCompleted()
		end,
		tryShow = function ( f22_arg0, f22_arg1 )
			if LUI.RejoinManager.IsDataFetchCompleted() then
				RejoinUtils.UpdateRejoinState( f22_arg0 )
			end
			return "LobbyRejoinPopup"
		end,
		postShow = function ( f21_arg0 )
			
		end
	}
}
local f0_local2 = {}
local f0_local3
if Dvar[0x22EAAB59AA27E9B]( 0xC89B24BC6BDFB19 ) == 5 then
	f0_local3 = "JupBattlePassOnboardingPopup"
else
	f0_local3 = "BattlePassOnboardingPopup"
end
f0_local2.name = f0_local3
f0_local2.shouldShowFct = function ( f20_arg0 )
	if not SEASON.IsValidSeason() then
		return false
	elseif not (Dvar[0x9E5BE3B4BBA4E0E]( 0xF45433D913C5323 ) or false) then
		if Dvar[0x9E5BE3B4BBA4E0E]( 0xF0B09907510EDA7 ) then
			return false
		elseif SEASON.GetCurrentSeason() == 1 and BATTLEPASS.IsOwned( f20_arg0 ) then
			Onboarding.BattlePassIntro.MarkCompleted( f20_arg0, SEASON.GetCurrentSeason() )
			return false
		elseif Onboarding.BattlePassIntro.WasCompleted( f20_arg0, SEASON.GetCurrentSeason() ) then
			return false
		end
	end
	DataSources.telescope.conflictfullscreenwebview:SetValue( f20_arg0, true )
	return true
end

f0_local2.tryShow = function ( f19_arg0, f19_arg1 )
	DataSources.alwaysLoaded.showingBattlepassFlow:SetValue( f19_arg0, true )
	if Dvar[0x22EAAB59AA27E9B]( 0xC89B24BC6BDFB19 ) == 5 then
		LUI.FlowManager.RequestAddMenu( "JupBattlePassOnboardingPopup", true, f19_arg0, false, nil, true )
		return "JupBattlePassOnboardingPopup"
	else
		LUI.FlowManager.RequestAddMenu( "BattlePassOnboardingPopup", true, f19_arg0, false, nil, true )
		return "BattlePassOnboardingPopup"
	end
end

f0_local2.postShow = function ( f18_arg0 )
	
end

f0_local1[5] = f0_local2
f0_local1[6] = {
	name = "LoginRewardPopup",
	shouldShowFct = function ( f17_arg0 )
		if DataSources.telescope.seenloginreward:GetValue( f17_arg0 ) then
			return false
		else
			DataSources.telescope.seenloginreward:SetValue( f17_arg0, true )
			if DataSources.telescope.conflictfullscreenwebview:GetValue( f17_arg0 ) then
				return false
			else
				local f17_local0, f17_local1 = WebViewSwitcherAndFenceUtils.IsWebViewSwitcherAnyFailed( f17_arg0, WebViewFullScreenConfigs.FullScreenName.LoginRewardPopup )
				if f17_local0 then
					return false
				else
					return true
				end
			end
		end
	end,
	tryShow = function ( f16_arg0, f16_arg1 )
		local f16_local0 = LUI.WebViewManager.Instance()
		f16_local0:OpenLoginReward( f16_arg0 )
		return WebViewFullScreenConfigs.FullScreenName.LoginRewardPopup
	end,
	postShow = function ( f15_arg0 )
		
	end
}
f0_local1[7] = {
	name = "WinbackPopup",
	shouldShowFct = function ( f14_arg0 )
		if DataSources.telescope.seenwinback:GetValue( f14_arg0 ) then
			return false
		else
			DataSources.telescope.seenwinback:SetValue( f14_arg0, true )
			if DataSources.telescope.conflictfullscreenwebview:GetValue( f14_arg0 ) then
				return false
			else
				local f14_local0, f14_local1 = WebViewSwitcherAndFenceUtils.IsWebViewSwitcherAnyFailed( f14_arg0, WebViewFullScreenConfigs.FullScreenName.WinbackPopup )
				if f14_local0 then
					return false
				else
					return true
				end
			end
		end
	end,
	tryShow = function ( f13_arg0, f13_arg1 )
		local f13_local0 = LUI.WebViewManager.Instance()
		f13_local0:OpenWinbackPopup( f13_arg0 )
		return WebViewFullScreenConfigs.FullScreenName.WinbackPopup
	end,
	postShow = function ( f12_arg0 )
		
	end
}
f0_local1[8] = {
	name = "MotdFullScreenPopup",
	shouldShowFct = function ( f11_arg0 )
		if DataSources.telescope.seenfullscreenmotd:GetValue( f11_arg0 ) then
			return false
		elseif CONDITIONS.IsJupPublicBetaBuildEnabled() then
			return false
		else
			DataSources.telescope.seenfullscreenmotd:SetValue( f11_arg0, true )
			if DataSources.telescope.conflictfullscreenwebview:GetValue( f11_arg0 ) then
				return false
			else
				local f11_local0, f11_local1 = WebViewSwitcherAndFenceUtils.IsWebViewSwitcherAnyFailed( f11_arg0, WebViewFullScreenConfigs.FullScreenName.MOTDPopup )
				if f11_local0 then
					return false
				else
					return true
				end
			end
		end
	end,
	tryShow = function ( f10_arg0, f10_arg1 )
		local f10_local0 = LUI.WebViewManager.Instance()
		f10_local0:OpenMOTD( f10_arg0 )
		return WebViewFullScreenConfigs.FullScreenName.MOTDPopup
	end,
	postShow = function ( f9_arg0 )
		
	end
}
f0_local1[9] = {
	name = "UninstallPromptPopup",
	shouldShowFct = function ( f7_arg0 )
		local f7_local0 = Dvar[0x9E5BE3B4BBA4E0E]( 0x842E893233E761B ) or false
		f7_local0 = FILE_MANAGEMENT.IsFileManagementEnabled() or false
		f7_local0 = false
		local f7_local1 = {
			groupsToShow = {}
		}
		for f7_local9, f7_local10 in ipairs( CoD.ScenarioUninstallCheck ) do
			local f7_local11 = FILE_MANAGEMENT.ScenarioGroupPopupValuesTable[f7_local10].contentId .. "_uninstallPromptLastSeenTimeStamp"
			if Engine[0xC8B174B6BF663C4]( f7_local10 ) then
				local f7_local5 = CoD.GetUTC()
				local f7_local6 = Engine[0x7B17D94988FD5D0]( f7_local11, f7_arg0 ) or 0
				local f7_local7 = Dvar[0x22EAAB59AA27E9B]( 0x747C2D0C8D360A0 )
				if not f7_local7 then
					f7_local7 = FILE_MANAGEMENT.UNINSTALL_PROMPT_REMIND_ME_LATER_DAYS_DEFAULT
				end
				local f7_local8 = f7_local7 * TIME.DAY
				if f7_local6 == 0 then
					Engine[0x9694388D6DAC134]( f7_local11, CoD.GetUTC(), f7_arg0 )
					f7_local0 = true
				end
				if f7_local6 + f7_local8 < f7_local5 then
					table.insert( f7_local1.groupsToShow, f7_local10 )
				end
			end
			Engine[0x9694388D6DAC134]( f7_local11, 0, f7_arg0 )
			f7_local0 = true
		end
		if f7_local0 then
			Engine[0xB81A5136C5503E4]( "updategamerprofile" )
		end
		f7_local2 = Dvar[0x54084D7CA2317BB]( 0xB7A88C1DD8A1C7A )
		f7_local3 = {}
		if f7_local2 and 0 < #f7_local1.groupsToShow then
			f7_local3 = LUI.Split( f7_local2, "," )
			f7_local4 = function ( f8_arg0 )
				for f8_local3, f8_local4 in ipairs( f7_arg0 ) do
					if f8_local4 == f8_arg0 then
						return true
					end
				end
				return false
			end
			
			f7_local9 = {}
			for f7_local5, f7_local6 in ipairs( f7_local1.groupsToShow ) do
				if not f7_local4( FILE_MANAGEMENT.ScenarioGroupPopupValuesTable[f7_local6].contentId ) then
					table.insert( f7_local9, f7_local6 )
				end
			end
			f7_local1.groupsToShow = f7_local9
		end
		return 0 < #f7_local1.groupsToShow, f7_local1
	end,
	tryShow = function ( f6_arg0, f6_arg1 )
		local f6_local0 = nil
		local f6_local1 = 0
		local f6_local2 = {}
		local f6_local3 = #f6_arg1.groupsToShow
		for f6_local7, f6_local8 in ipairs( f6_arg1.groupsToShow ) do
			local f6_local9 = FILE_MANAGEMENT.ScenarioGroupPopupValuesTable[f6_local8]
			f6_local1 = f6_local1 + FILE_MANAGEMENT.GetContentSizeMB( f6_local9.contentId )
			table.insert( f6_local2, f6_local9.contentId )
			if f6_local3 == 1 or f6_local7 == 1 then
				f6_local0 = Engine[0xED84C33EC5F01EA]( f6_local9.groupTitleStringRef )
			end
			if f6_local3 == f6_local7 then
				f6_local0 = Engine[0xED84C33EC5F01EA]( 0xFFF4C7CC72AD177, f6_local0, f6_local9.groupTitleStringRef )
			else
				f6_local0 = Engine[0xED84C33EC5F01EA]( 0x77F573284F20E35, f6_local0, f6_local9.groupTitleStringRef )
			end
		end
		LUI.FlowManager.RequestPopupMenu( nil, "PopupMessageAndButtons", true, f6_arg0, false, FILE_MANAGEMENT.GetUninstallPromptPopupOptionsData( f6_arg0, 0xCFD726BB03ACA96, Engine[0xED84C33EC5F01EA]( 0x82B20F5679788D6, f6_local0, FILE_MANAGEMENT.GetFileSizeString( f6_local1 ) ), f6_local2 ) )
		return "PopupMessageAndButtons"
	end,
	postShow = function ( f5_arg0 )
		
	end
}
f0_local0.introPopups = f0_local1
LUI.MainMenuPopupManager.ShowCurrentPopup = function ( f4_arg0, f4_arg1 )
	local f4_local0 = f4_arg0.introPopups[DataSources.alwaysLoaded.mainMenuPopupIndex:GetValue( f4_arg1 )]
	local f4_local1, f4_local2 = f4_local0.shouldShowFct( f4_arg1 )
	if f4_local1 then
		local f4_local3 = f4_local0.tryShow( f4_arg1, f4_local2 )
		if f4_local3 and LUI.FlowManager.IsInStack( f4_local3 ) then
			DataSources.alwaysLoaded.mainMenuPopupMenuName:SetValue( f4_arg1, f4_local3 )
			return true
		elseif f4_local0.postShow then
			f4_local0.postShow( f4_arg1 )
			Dvar[0x8EA06EEDB58D872]( 0x3EC3B87FCEEF73B, true )
		end
	end
	return false
end

LUI.MainMenuPopupManager.ShowNextPopup = function ( f3_arg0, f3_arg1 )
	local f3_local0 = DataSources.alwaysLoaded.mainMenuIntroPopupsFlowComplete:GetValue( f3_arg1 )
	if LUI.FlowManager.IsInStack( DataSources.alwaysLoaded.mainMenuPopupMenuName:GetValue( f3_arg1 ) ) then
		return 
	elseif not false then
		
	else
		
	end
end

LUI.MainMenuPopupManager.OnRemoveMenuStack = function ( f2_arg0, f2_arg1 )
	local f2_local0 = f2_arg1.controllerIndex
	if not DataSources.alwaysLoaded.mainMenuIntroPopupsFlowComplete:GetValue( f2_local0 ) and LUI.FlowManager.IsInStack( "MainMenu" ) and f2_arg1.menuName == DataSources.alwaysLoaded.mainMenuPopupMenuName:GetValue( f2_local0 ) then
		local f2_local1 = f2_arg0.introPopups[DataSources.alwaysLoaded.mainMenuPopupIndex:GetValue( f2_local0 )]
		if f2_local1.postShow then
			f2_local1.postShow( f2_local0 )
		end
		local f2_local2 = LUI.MainMenuPopupManager.Instance()
		f2_local2:ShowNextPopup( f2_local0 )
		return true
	else
		return false
	end
end

LUI.MainMenuPopupManager.ShowIntroPopups = function ( f1_arg0, f1_arg1 )
	local f1_local0 = Dvar[0x9E5BE3B4BBA4E0E]( 0x4A3BD6828304049 )
	local f1_local1 = DataSources.alwaysLoaded.mainMenuIntroPopupsFlowComplete:GetValue( f1_arg1 )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xB641668972D55A7 ) then
		DataSources.alwaysLoaded.mainMenuIntroPopupsFlowComplete:SetValue( f1_arg1, false )
		DataSources.alwaysLoaded.mainMenuPopupMenuName:SetValue( f1_arg1, "" )
		DataSources.alwaysLoaded.mainMenuPopupIndex:SetValue( f1_arg1, 0 )
	end
	Dvar[0x8EA06EEDB58D872]( 0x3EC3B87FCEEF73B, true )
	if not MAIN_MENU.TryShowTitleUpdateAvailablePopup() and not f1_local1 and not f1_local0 then
		Dvar[0x8EA06EEDB58D872]( 0x3EC3B87FCEEF73B, false )
		local f1_local2 = LUI.MainMenuPopupManager.Instance()
		f1_local2:ShowNextPopup( f1_arg1 )
	end
end

