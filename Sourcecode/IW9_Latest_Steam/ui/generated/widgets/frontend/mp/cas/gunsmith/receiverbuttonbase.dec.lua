-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
module( ..., package.seeall )
local f0_local0 = 6 * _1080p
local f0_local1 = 16 * _1080p
local f0_local2 = 10 * _1080p
local f0_local3 = 10 * _1080p
local f0_local4 = 370 * _1080p
local f0_local5 = 500 * _1080p
local f0_local6 = function ( f15_arg0 )
	local f15_local0 = LAYOUT.GetTextWidth( f15_arg0.CategoryName )
	local f15_local1 = f15_arg0.CategoryName:GetAnchorsAndPosition()
	f15_local1 = f15_local1.left
	local f15_local2 = LAYOUT.GetTextWidth( f15_arg0.AttachmentName )
	local f15_local3 = f15_local0 + (f15_arg0.CostLabel and f0_local0 + LAYOUT.GetTextWidth( f15_arg0.CostLabel ) or 0)
	local f15_local4 = f15_local1
	if f15_arg0._useDynamicWidth then
		if f15_local2 < f15_local3 then
			f15_local4 = f15_local4 + f15_local3
		else
			f15_local4 = f15_local4 + f15_local2
		end
		f15_local4 = f15_local4 + f0_local0 * 2
		local f15_local5 = LAYOUT.GetTextWidth( f15_arg0.AmmoName ) + 0
		if f15_local4 < f15_local5 then
			f15_local4 = f15_local5
		end
		if f0_local0 < f15_local4 then
			f15_local4 = f0_local0
		elseif f15_local4 < f0_local0 then
			f15_local4 = f0_local0
		end
	else
		f15_local4 = f0_local0
	end
	if f15_arg0._isFocused then
		f15_arg0.Background:SetRight( f15_local4 )
		f15_arg0.TopBar:SetRight( f15_local4 )
		f15_arg0.BottomBar:SetRight( f15_local4 )
	end
	f15_arg0.AmmoName:SetRight( f15_local4 - f0_local0 )
	f15_arg0.AttachmentName:SetRight( f15_local4 - f0_local0 )
	f15_arg0.CategoryName:SetRight( f15_local4 - f0_local0 )
	if f15_arg0._brandingImageRightPos then
		f15_arg0.Branding:SetRight( math.min( f15_arg0._brandingImageRightPos, f15_local4 - f0_local0 ) )
	end
	local f15_local6 = LAYOUT.GetTextWidth( f15_arg0.AmmoName )
	local f15_local5 = f15_arg0.AmmoName:GetAnchorsAndPosition()
	local f15_local7 = 8 * _1080p
	local f15_local8 = f15_local5.left + f15_local6
	if f15_local5.right < f15_local8 then
		f15_local8 = f15_local5.right
	end
	f15_arg0.ClassBacker:SetRight( f15_local8 + f15_local7 )
	local f15_local9 = LAYOUT.GetTextWidth( f15_arg0.UnlockCount )
	local f15_local10 = LAYOUT.GetElementWidth( f15_arg0.UnlockIcon )
	local f15_local11 = 8 * _1080p
	local f15_local12 = 12 * _1080p
	f15_arg0.LockedBacker:SetRight( f15_local4 )
	f15_arg0.LockedBacker:SetLeft( f15_local4 - f15_local9 - f15_local10 - f15_local11 * 3 - f15_local12 )
	f15_arg0.UnlockCount:SetRight( f15_local4 - f15_local11 )
	f15_arg0.UnlockIcon:SetRight( f15_local4 - f15_local9 - f15_local11 * 2 )
	f15_arg0.UnlockIcon:SetLeft( f15_local4 - f15_local9 - f15_local11 * 2 - f15_local10 )
	local f15_local13 = LAYOUT.GetElementWidth( f15_arg0.RestrictionWarning )
	local f15_local14 = 2 * _1080p
	f15_arg0.RestrictionWarning:SetRight( f15_local4 - f15_local14 * 2 )
	f15_arg0.RestrictionWarning:SetLeft( f15_local4 - f15_local14 * 2 - f15_local13 )
end

local f0_local7 = function ( f14_arg0, f14_arg1 )
	if not f14_arg0._attachLine then
		return 
	end
	local f14_local0 = f14_arg0._attachLine
	local f14_local1 = f14_local0
	f14_local0 = f14_local0.SetAlpha
	local f14_local2
	if f14_arg0._isFocused then
		f14_local2 = 1
	else
		f14_local2 = 0.2
	end
	f14_local0( f14_local1, f14_local2 )
	f14_arg0._attachLine:SetVertexPadding( LUI.UILine.END, 1 )
	f14_local0 = f14_arg0._attachLine
	f14_local1 = f14_local0
	f14_local0 = f14_local0.SetVertexPadding
	f14_local2 = LUI.UILine.END
	local f14_local3 = 0
	local f14_local4
	if f14_arg1 and not f14_arg1 then
		f14_local4 = f14_arg1
	else
		f14_local4 = GUNSMITH.lineDuration
	end
	f14_local0( f14_local1, f14_local2, f14_local3, f14_local4, LUI.EASING.outQuadratic )
	if f14_arg0._attachPoint then
		f14_local0 = f14_arg0._attachPoint
		f14_local1 = f14_local0
		f14_local0 = f14_local0.SetAlpha
		if f14_arg0._isFocused then
			f14_local2 = 1
		else
			f14_local2 = 0.2
		end
		f14_local0( f14_local1, f14_local2 )
	end
end

local f0_local8 = function ( f11_arg0, f11_arg1, f11_arg2, f11_arg3 )
	local f11_local0 = function ( f13_arg0 )
		GUNSMITH.SetupAttachLine( f13_arg0, f11_arg0.weapon, f11_arg0.variantID, f11_arg0 )
		GUNSMITH.SetupAttachPoint( f11_arg0, f11_arg0.weapon, f11_arg0.variantID, f11_arg0._category )
		if f13_arg0._attachLine then
			f13_arg0._attachLine:SetThickness( 2 * _1080p )
			f13_arg0._attachLine:SetVertexPosition( LUI.UILine.START, 0, 0, 1 * _1080p, 0 )
		end
		f11_arg0( f13_arg0 )
	end
	
	if #Dvar[0x54084D7CA2317BB]( 0x8CC749B90DD2705 ) == 0 then
		f11_local0( f11_arg0 )
	else
		f11_arg0:registerEventHandler( "scene_transitioned", function ( element, event )
			f11_arg0( element )
		end )
	end
end

local f0_local9 = function ( f10_arg0 )
	if f10_arg0._attachLine then
		f10_arg0._attachLine:SetRGBFromTable( f10_arg0._isFocused and SWATCHES.IW9StyleGuide.styleGuideAccentMain or SWATCHES.IW9StyleGuide.styleGuideCool02 )
	end
end

local f0_local10 = function ( f9_arg0, f9_arg1 )
	f9_arg0.AttachmentName:setText( Engine[0xEB2A2834B76AEA4]( f9_arg1 ) )
	f9_arg0.Branding:setImage( RegisterMaterial( "iw9_icon_weapon_manufacturer_tempest_sm" ) )
end

local f0_local11 = function ( f7_arg0, f7_arg1, f7_arg2 )
	local f7_local0 = f7_arg2.category
	local f7_local1 = f7_arg2.attachments
	local f7_local2 = f7_arg2.weaponPlayerData
	local f7_local3 = f7_arg2.isTunable
	f7_arg0._category = f7_local0
	local f7_local4 = nil
	if f7_arg2.weaponTable.variantID ~= WEAPON.baseVariant then
		f7_local4 = WEAPON.GenerateWeaponTableFromWeaponString( f7_arg2.weaponTable.weapon, f7_arg2.weaponModelName, {
			shouldConvertVariantIDToNumber = true,
			shouldOrganizeAttachments = true,
			shouldIncludeAllAttachments = true
		} )
	else
		f7_local4 = f7_arg2.weaponTable
	end
	f7_arg0._weaponRef = GL_HACK.GetWeaponMPRef( f7_local4.weapon )
	local f7_local5 = GUNSMITH.GetSelectedAttachIndexForCategory( f7_local0, f7_local4 )
	local f7_local6
	if f7_local5 then
		f7_local6 = f7_local5
	else
		f7_local6 = f7_local4.attachments[f7_local5].variantID
	end
	local f7_local7
	if not f7_local6 then
		f7_local7 = f7_local6
	else
		f7_local7 = 0
	end
	f7_arg0._variantID = f7_local7
	if f7_local5 then
		f7_local7 = f7_local5
	else
		f7_local7 = ATTACHMENT.GetRef( f7_local4.attachments[f7_local5].ref, f7_local4.weapon )
	end
	local f7_local8 = Engine[0xED84C33EC5F01EA]( ATTACHMENT.GetAttachmentCategoryName( f7_local0 ) )
	if f7_local6 and f7_local6 > WEAPON.baseVariant and not CONDITIONS.IsMobileOrMobileSim() then
		f7_local8 = Engine[0xED84C33EC5F01EA]( 0x905E03005927C0F, f7_local8 )
	end
	f7_arg0.CategoryName:setText( Engine[0xEB2A2834B76AEA4]( f7_local8 ) )
	if f7_arg0.CostLabel then
		f7_arg0.CostLabel:setText( LocalizeIntoString( WEAPON.GetWeaponCost( f7_arg0._weaponRef, {} ), 0x757A21A4FFB96DF ) )
		local f7_local9 = LAYOUT.GetTextWidth( f7_arg0.CategoryName )
		local f7_local10 = f7_arg0.CategoryName:GetAnchorsAndPosition()
		f7_arg0.CostLabel:SetRight( f7_local10.left + f7_local9 + f0_local0 + LAYOUT.GetTextWidth( f7_arg0.CostLabel ) )
	end
	local f7_local11 = WEAPON.GetAmmoData( f7_arg1, f7_local4 )
	local f7_local9 = f7_arg0.AmmoName
	local f7_local12 = f7_local9
	f7_local9 = f7_local9.setText
	local f7_local13 = f7_local11.ammoDisplayName
	local f7_local14 = 0x0
	f7_local9( f7_local12, REG23 and Engine[0xED84C33EC5F01EA]( f7_local11.ammoName ) or Engine[0xED84C33EC5F01EA]( f7_local11.ammoDisplayName ) )
	if f7_local7 then
		f7_arg0.AttachmentName:setText( Engine[0xEB2A2834B76AEA4]( ATTACHMENT.GetName( f7_local7 ) ) )
		f7_arg0.Icon:setImage( RegisterMaterial( WEAPON.GetIconWithWeaponTable( f7_local4 ) ) )
		f7_local9 = Engine[0xFC084BF31D917C5]( f7_arg0._weaponRef, f7_local7, f7_arg0._variantID )
		local f7_local10
		if f7_local9 then
			f7_local10 = f7_local9
		else
			f7_local10 = f7_local9[0x2EAB902F6509817]
		end
		f7_local12 = GUNSMITH.GetBrandingSmallMaterialName( f7_local10 )
		if not String.IsNilOrEmpty( f7_local12 ) then
			f7_arg0.Branding:setImage( RegisterMaterial( f7_local12 ) )
			f7_arg0.Branding:SetVisible( true )
			f7_local13 = f7_arg0.Branding:GetAnchorsAndPosition()
			f7_arg0._brandingImageRightPos = f7_local13.left + GUNSMITH.GetBrandingSmallMaterialWidth( f7_local10 ) * 0.625
			f7_arg0.Branding:SetRight( f7_arg0._brandingImageRightPos )
		else
			f7_arg0.Branding:SetVisible( false )
		end
		f7_local13 = false
		f7_local14 = f7_local4.attachments[f7_local5].ref
		if CONDITIONS.AreRestrictionsActive( f7_arg1 ) then
			if MatchRules[0x722F56788C744E9]( f7_local14, weapon ) then
				f7_local13 = true
			else
				local f7_local15 = WEAPON.GetWeaponRefByRec( f7_local14 )
				if MatchRules[0x966A6F3A93A1200]( f7_local15 ) or MatchRules[0xB0FA3D79A09CF96]( WEAPON.GetWeaponClass( f7_local15 ) ) then
					f7_local13 = true
				end
			end
		end
		local f7_local15 = ACTIONS.AnimateSequence
		local f7_local16 = f7_arg0
		local f7_local17
		if f7_local13 then
			f7_local17 = "ShowRestriction"
		else
			f7_local17 = "HideRestriction"
		end
		f7_local15( f7_local16, f7_local17 )
	end
	local f7_local9, f7_local10 = WEAPON.GetAmountOfReceiverUnlocksForPlatform( f7_local4.weapon, f7_arg1 )
	f7_arg0.UnlockCount:setText( Engine[0xED84C33EC5F01EA]( "LUA_MENU/X_OF_Y", f7_local9, f7_local10 ) )
	if not f7_arg0._handlersAdded then
		f7_arg0:registerEventHandler( "button_action", function ( element, event )
			local f8_local0 = GUNSMITH.GetSelectedAttachIndexForCategory( f7_arg0, f7_arg0 )
			local f8_local1 = LUI.FlowManager.GetScopedData( element )
			local f8_local2 = element:getParent()
			local f8_local3 = f8_local2:getParent()
			if f8_local3 then
				local f8_local4 = LUI.FlowManager.GetScopedData( f8_local3 )
				if f8_local4 then
					f8_local4.buttonCategoryToFocus = f7_arg0
				end
			end
			if not CONDITIONS.IsMobileOrMobileSim() then
				LUI.FlowManager.RequestAddMenu( LOADOUT.GetAttachmentSelectMenuRef(), true, f7_arg0, false, {
					weaponSlot = f8_local1.weaponSlot,
					loadoutIndex = f8_local1.loadoutIndex,
					category = f7_arg0,
					attachSlot = f8_local0,
					attachments = f7_arg0,
					forShowcase = f8_local1.forShowcase
				} )
			else
				GUNSMITH.OpenMobileAttachmentSelectMenu( event.controller or element.controllerIndex, f7_arg0, f8_local0 )
			end
		end )
		f7_arg0._handlersAdded = true
	end
	if not CONDITIONS.IsMobileOrMobileSim() then
		
	else
		
	end
	if CONDITIONS.ShouldShowAttachmentLines() then
		f0_local0( f7_arg0, f7_arg1, f7_local0, f7_local4 )
	end
	f0_local0( f7_arg0 )
	if not CONDITIONS.IsMobileOrMobileSim() then
		f7_arg0:setActionSFX( SOUND_SETS.gunsmith.attachmentSelect )
		f7_arg0:setGainFocusAllSFX( SOUND_SETS.gunsmith.attachmentHover, {
			clearChildrenSFX = true
		} )
	end
end

local f0_local12 = function ( f6_arg0 )
	return f6_arg0._category
end

local f0_local13 = function ( f5_arg0, f5_arg1 )
	f5_arg0._isFocused = true
	if f5_arg0._attachLine then
		f5_arg0._attachLine:SetAlpha( 0.5 )
	end
	local f5_local0 = GUNSMITH.GetFrontendTagWorldPositionAndAxis( f5_arg1, f5_arg0._weaponRef, f5_arg0._variantID, f5_arg0._category )
	if f5_arg0:getParent() then
		
	else
		
	end
	ACTIONS.AnimateSequence( f5_arg0, "ButtonOver" )
	f0_local0( f5_arg0 )
	f0_local0( f5_arg0 )
	f0_local0( f5_arg0, 150 )
end

local f0_local14 = function ( f4_arg0 )
	f4_arg0._isFocused = false
	if f4_arg0._attachLine then
		f4_arg0._attachLine:SetAlpha( 0 )
	end
	ACTIONS.AnimateSequence( f4_arg0, "ButtonUp" )
	f0_local0( f4_arg0 )
	f0_local0( f4_arg0, 0 )
end

local f0_local15 = function ( f3_arg0, f3_arg1, f3_arg2 )
	if not CONDITIONS.IsMobileOrMobileSim() then
		f3_arg0.ButtonOver = f0_local0
		f3_arg0.ButtonUp = f0_local0
	end
	f3_arg0.Setup = f0_local0
	f3_arg0.GetCategory = f0_local0
	f3_arg0._controllerIndex = f3_arg1
	f3_arg0._category = nil
	f3_arg0._isFocused = false
	f3_arg0._useDynamicWidth = true
end

local f0_local16 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function ReceiverButtonBase( menu, controller )
	local self = LUI.UIButton.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 400 * _1080p, 0, 120 * _1080p )
	self.id = "ReceiverButtonBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f0_local0( self, LUI.ValidateControllerIndex( self, f1_local1 ), controller )
	return self
end

MenuBuilder.registerType( "ReceiverButtonBase", ReceiverButtonBase )
LockTable( _M )
