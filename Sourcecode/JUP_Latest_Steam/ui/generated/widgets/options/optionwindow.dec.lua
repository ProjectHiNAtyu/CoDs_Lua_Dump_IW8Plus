-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
module( ..., package.seeall )
require( "ui.generated.widgets.dynamiclist" )
require( "ui.generated.widgets.scrollbar.verticalminimalscrollbar" )
local f0_local0 = 20
local f0_local1 = 892
local f0_local2 = 864
local f0_local3 = 16
local f0_local4 = 20
local f0_local5 = function ( f33_arg0, f33_arg1 )
	if f33_arg1.type ~= OPTIONS.OptionType.EXPANDER and f33_arg1.type ~= OPTIONS.OptionType.PARENTLESS_EXPANDER and f33_arg1.type ~= OPTIONS.OptionType.CATEGORY then
		local f33_local0 = f33_arg0:getParent()
		f33_local0 = f33_local0:getParent()
		if f33_local0 and f33_local0.lastActive == f33_arg1.settingBundle and not LUI.UIButton.IsButtonActive( f33_arg0 ) then
			f33_arg0:dispatchEventToParent( {
				name = "request_active",
				target = f33_arg0
			} )
		elseif f33_local0.lastActive ~= f33_arg1.settingBundle and LUI.UIButton.IsButtonActive( f33_arg0 ) then
			f33_arg0:RemoveActive()
		end
	end
end

local f0_local6 = function ( f32_arg0, f32_arg1 )
	local f32_local0 = f32_arg1
	local f32_local1 = f32_arg0:GetActiveOnMouseOverChildId()
	if f32_local1 and f32_local0[f32_local1] then
		f32_local0 = f32_local0[f32_local1]
		f32_local1 = f32_local0:GetActiveOnMouseOverChildId()
		if f32_local0 and f32_local0[f32_local1] then
			f32_local0 = f32_local0[f32_local1]
		end
	end
	f32_local0:dispatchEventToParent( {
		name = "request_active",
		target = f32_local0
	} )
	f32_local0:RemoveEventTimer( LUI.UIElement.DELAYED_ACTIVE_EVENT_ID )
end

local f0_local7 = function ( f27_arg0, f27_arg1 )
	local f27_local0 = {
		maxVisibleColumns = 1,
		maxVisibleRows = 15,
		scrollLimitFadeOutLength = 350,
		extraPoolSize = 5,
		forceCachedHeight = true,
		allowScrollLimitFeedback = true,
		scrollLimitFadeInLength = 350,
		spacingY = CONDITIONS.IsMobileOrMobileSim() and f0_local0 or f0_local0,
		alignment = LUI.Alignment.Top,
		activeBehaviorType = GRID_AND_LIST.ActiveBehaviorType.MOUSE_OVER
	}
	if CONDITIONS.IsSplitscreen( f27_arg0 ) then
		f27_arg0.DynamicList:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, OPTIONS.SPLITSCREEN_OPTION_GRID_HEIGHT )
		local f27_local1, f27_local2, f27_local3, f27_local4 = f27_arg0.DynamicList:getLocalRect()
		f27_arg0.Scrollbar:SetAnchorsAndPosition( 0, 1, 0, 1, f27_local3 + f0_local0, f27_local3 + f0_local0, f27_local2, f27_local4 )
		f27_local0.maxVisibleRows = 8
		f27_local0.scrollingThresholdY = 0
	end
	f27_arg0.DynamicList:SetupList( f27_local0, f27_arg0.Scrollbar )
	f27_arg0.DynamicList:SetScrollbarKBMStyle( true )
	local f27_local1 = {
		ParentlessExpander = "GenericParentlessExpander",
		keyBinding = "GenericKeybindOption",
		ColorSelection = "ColorSelectionWidget"
	}
	local f27_local2
	if CONDITIONS.IsMobileOrMobileSim() then
		f27_local2 = "MobileGenericOptionSubcategoryTitle"
	else
		f27_local2 = "SubHeaderWithPrompt"
	end
	f27_local1.SubCategory = f27_local2
	if CONDITIONS.IsMobileOrMobileSim() then
		f27_local2 = "MobileOptionSettingButton"
	else
		f27_local2 = "GenericOpenFullscreenButton"
	end
	f27_local1.GenericButton = f27_local2
	if CONDITIONS.IsMobileOrMobileSim() then
		f27_local2 = "MobileGenericDropdown"
	else
		f27_local2 = "GenericDropdown"
	end
	f27_local1.Dropdown = f27_local2
	if CONDITIONS.IsMobileOrMobileSim() then
		f27_local2 = "MobileGenericSliderWithEditBox"
	else
		f27_local2 = "GenericSliderWithEditBox"
	end
	f27_local1.SliderBarWithEditBox = f27_local2
	if CONDITIONS.IsMobileOrMobileSim() then
		f27_local2 = "MobileGenericToggle"
	else
		f27_local2 = "GenericToggleButton"
	end
	f27_local1.ToggleButton = f27_local2
	if CONDITIONS.IsMobileOrMobileSim() then
		f27_local2 = "MobileGenericExpander"
	else
		f27_local2 = "GenericExpander"
	end
	f27_local1.Expander = f27_local2
	if CONDITIONS.IsMobileOrMobileSim() then
		f27_local2 = "MobileOptionSettingButton"
	else
		f27_local2 = "GenericOpenFullscreenButton"
	end
	f27_local1.AdvancedTab = f27_local2
	for f27_local5, f27_local6 in pairs( f27_local1 ) do
		f27_arg0.DynamicList:RegisterWidgetType( f27_local5, function ()
			local f31_local0 = MenuBuilder.BuildRegisteredType( f27_arg0, {
				controllerIndex = f27_arg0
			} )
			if f27_arg0 == OPTIONS.OptionType.KEYBINDING then
				OPTIONS.InitkeyBindingWidget( f27_arg0, f31_local0 )
			else
				OPTIONS.InitSettingWidget( f31_local0, f27_arg0, f27_arg0 )
			end
			return f31_local0
		end, function ( f30_arg0, f30_arg1, f30_arg2 )
			f30_arg0.indexInDynamicList = f30_arg1
			local f30_local0 = f30_arg0:getParent()
			f30_local0:SetGridChildDynamicSize( true, LUI.DIRECTION.vertical )
			if f30_arg2.type == OPTIONS.OptionType.KEYBINDING then
				OPTIONS.UpdatekeyBindingWidget( f27_arg0, f30_arg0, f30_arg2 )
			else
				OPTIONS.UpdateSettingWidget( f27_arg0, f30_arg0, f30_arg2 )
			end
			if LUI.IsLastInputMouseNavigation( f27_arg0 ) then
				f27_arg0( f30_arg0, f30_arg2 )
			end
		end )
	end
	f27_arg0.tabCache = {}
	f27_arg0.DynamicList.Grid:SetActiveOnMouseOverBehavior( f27_arg1, "_BuiltWidget" )
	f27_arg0.DynamicList.Grid.TryRequestActiveOnChildFocusOverride = f0_local0
	f27_arg0.DynamicList.Grid:registerEventHandler( "clear_active_option_menu", function ( element, event )
		if (element._activeElement or event.fromList ~= element.previousList) and element ~= event.fromList then
			element.previousList = event.fromList
			element:processEvent( {
				immediate = true,
				name = "request_active"
			} )
			local f29_local0, f29_local1 = element:GetChildPosition( event.fromList:getParent() )
			if f29_local1 then
				element._targetPosition = {
					x = 0,
					y = f29_local1
				}
				element._childInFocus = event.fromList:getParent()
			end
			element.currentActiveList = event.fromList
		end
		return true
	end )
	f27_arg0.DynamicList.Grid:addEventHandler( "request_active", function ( f28_arg0, f28_arg1 )
		if f28_arg1.target then
			f28_arg0.lastActive = f28_arg1.target.settingBundle
			if f28_arg0.currentActiveList then
				f28_arg0.currentActiveList:processEvent( {
					name = "clear_active_option_menu",
					fromList = f28_arg0
				} )
			else
				f28_arg0:dispatchEventToParent( {
					name = "clear_active_option_menu",
					fromList = f28_arg0
				} )
			end
		end
	end )
end

local f0_local8 = function ( f26_arg0, f26_arg1, f26_arg2, f26_arg3, f26_arg4, f26_arg5 )
	local f26_local0 = {}
	local f26_local1
	if CONDITIONS.IsMobileOrMobileSim() then
		f26_local1 = OPTIONS.MOBILE_SUBCATEGORY
		if not f26_local1 then
			if f26_arg5 == 0 then
				f26_local1 = OPTIONS.FIRST_SUBCATEGORY_HEIGHT
				if not f26_local1 then
				
				else
					f26_local0.SubCategory = f26_local1
					f26_local0.Expander = CONDITIONS.IsMobileOrMobileSim() and OPTIONS.MOBLE_EXPANDER_HEIGHT or OPTIONS.EXPANDER_HEIGHT
					if not f26_arg3.height and not f26_local0[f26_arg2] then
						local f26_local2 = CONDITIONS.IsMobileOrMobileSim()
						local f26_local3 = OPTIONS.MOBILE_OPTION_HEIGHT
						local f26_local4 = OPTIONS.OPTION_HEIGHT
					end
					f26_arg1:AddWidget( f26_arg2, {
						adjustContentToFit = true,
						refreshGrid = false,
						widgetOptions = f26_arg3,
						focusable = f26_arg4,
						height = f26_local2 and f26_local3 or f26_local4
					} )
				end
			end
			f26_local1 = OPTIONS.SUBCATEGORY_HEIGHT
		end
	else
		if f26_arg5 == 0 then
			f26_local1 = OPTIONS.FIRST_SUBCATEGORY_HEIGHT
			if not f26_local1 then
			
			else
				f26_local0.SubCategory = f26_local1
				f26_local0.Expander = CONDITIONS.IsMobileOrMobileSim() and OPTIONS.MOBLE_EXPANDER_HEIGHT or OPTIONS.EXPANDER_HEIGHT
				if not f26_arg3.height and not f26_local0[f26_arg2] then
					local f26_local2 = CONDITIONS.IsMobileOrMobileSim()
					local f26_local3 = OPTIONS.MOBILE_OPTION_HEIGHT
					local f26_local4 = OPTIONS.OPTION_HEIGHT
				end
				f26_arg1:AddWidget( f26_arg2, {
					adjustContentToFit = true,
					refreshGrid = false,
					widgetOptions = f26_arg3,
					focusable = f26_arg4,
					height = f26_local2 and f26_local3 or f26_local4
				} )
			end
		end
		f26_local1 = OPTIONS.SUBCATEGORY_HEIGHT
	end
	f26_local0.SubCategory = f26_local1
	f26_local0.Expander = CONDITIONS.IsMobileOrMobileSim() and OPTIONS.MOBLE_EXPANDER_HEIGHT or OPTIONS.EXPANDER_HEIGHT
	if not f26_arg3.height and not f26_local0[f26_arg2] then
		local f26_local2 = CONDITIONS.IsMobileOrMobileSim()
		local f26_local3 = OPTIONS.MOBILE_OPTION_HEIGHT
		local f26_local4 = OPTIONS.OPTION_HEIGHT
	end
	f26_arg1:AddWidget( f26_arg2, {
		adjustContentToFit = true,
		refreshGrid = false,
		widgetOptions = f26_arg3,
		focusable = f26_arg4,
		height = f26_local2 and f26_local3 or f26_local4
	} )
end

local f0_local9 = function ( f25_arg0 )
	for f25_local8, f25_local9 in pairs( f25_arg0.tabCache ) do
		if f25_local9.inner then
			LUI.UIElement.closeTree( f25_local9.inner )
			f25_local9.inner = nil
		end
		if f25_local9.children then
			for f25_local6, f25_local7 in ipairs( f25_local9.children ) do
				LUI.UIElement.closeTree( f25_local7 )
			end
			f25_local9.children = nil
		end
	end
	f25_arg0.tabCache = {}
end

local f0_local10 = nil
f0_local10 = function ( f24_arg0, f24_arg1, f24_arg2, f24_arg3, f24_arg4 )
	if not f24_arg3 then
		f24_arg3 = 0
	end
	local f24_local0 = {}
	table.insert( f24_local0, f24_arg1 )
	for f24_local6, f24_local7 in ipairs( f24_arg2 ) do
		local f24_local4 = f24_local7[0x228576E3216368B]
		if f24_local4 then
			f24_local4 = OPTIONS.GetAvailableSettingDataFromId( f24_local7[0x228576E3216368B], f24_arg0 )
		end
		if f24_local4 and (not f24_arg4 or f24_local4[0xCA80BC02299BAAF]) then
			local f24_local5 = f24_local7[0xE7843F98867B161]
			if f24_local5 then
				f24_local4 = f0_local0( f24_arg0, f24_local4, f24_local5, f24_arg3 + 1 )
			end
			table.insert( f24_local0, f24_local4 )
		end
	end
	if #f24_local0 < 2 then
		return f24_arg1
	else
		return {
			type = "Expander",
			options = f24_local0,
			expanderDepth = f24_arg3
		}
	end
end

local f0_local11 = function ( f22_arg0, f22_arg1, f22_arg2, f22_arg3, f22_arg4 )
	local f22_local0 = f22_arg0:getParent()
	f22_arg0:ClearCurrentOptions()
	f0_local0( f22_arg0 )
	local f22_local1 = -1
	local f22_local2 = -1
	if type( f22_arg3 ) == "number" then
		f22_local2 = f22_arg3 - 1
	end
	if type( f22_arg3 ) == "xhash" then
		f22_arg0.buttonList.lastActive = f22_arg3
	else
		f22_arg0.buttonList.lastActive = nil
	end
	local f22_local3 = {}
	for f22_local19, f22_local20 in ipairs( f22_arg2 ) do
		local f22_local21 = false
		if f22_local20[0xE7843F98867B161] then
			local f22_local7 = false
			for f22_local17, f22_local18 in ipairs( f22_local20[0xE7843F98867B161] ) do
				local f22_local11 = f22_local18[0x228576E3216368B]
				if f22_local11 then
					f22_local11 = OPTIONS.GetAvailableSettingDataFromId( f22_local18[0x228576E3216368B], f22_arg1 )
				end
				if f22_local11 and (not f22_arg4 or f22_local11[0xCA80BC02299BAAF]) then
					f22_local1 = f22_local1 + 1
					if not f22_local7 then
						f0_local0( f22_local0, f22_arg0.DynamicList, "SubCategory", {
							type = "SubCategory",
							name = f22_local20[0x4BCADBA8E631B86]
						}, false, f22_local1 )
						f22_local1 = f22_local1 + 1
						f22_local7 = true
					end
					if f22_local18[0xCE7405F2D5F2AA] and f22_local18[0xE7843F98867B161] then
						f22_local11 = f0_local0( f22_arg1, f22_local11, f22_local18[0xE7843F98867B161], nil, f22_arg4 )
						if f22_local11.options then
							for f22_local15, f22_local16 in ipairs( f22_local11.options ) do
								if not (f22_arg3 or f22_local2 ~= -1) or f22_local2 == f22_local1 or f22_local16.settingbundle and f22_local16.settingbundle == f22_arg3 then
									f22_local2 = f22_local1
									f22_local11.initialChildInFocus = f22_local15 - 1
									break
								end
							end
						end
					end
					f0_local0( f22_local0, f22_arg0.DynamicList, f22_local11.type, f22_local11, true )
					if f22_local2 == f22_local1 and not f22_local18[0xCE7405F2D5F2AA] then
						f22_arg0.buttonList.lastActive = f22_local11.settingbundle
					end
					if f22_local2 == -1 or f22_local11.settingbundle and f22_local11.settingbundle == f22_arg3 then
						f22_local2 = f22_local1
						f22_arg0.buttonList.lastActive = f22_local11.settingbundle
					end
				end
			end
		end
	end
	f22_arg0.DynamicList:RefreshGrid()
	f22_arg0.buttonList:clearSavedState()
	if f22_local2 ~= -1 then
		f22_local4 = f22_arg0:Wait( 1 )
		f22_local4.onComplete = function ()
			if LUI.IsLastInputMouseNavigation( f22_arg0 ) then
				f22_arg0.buttonList:SetPosition( {
					x = 0,
					y = f22_arg0
				}, false, true )
			else
				f22_arg0.buttonList:SetFocusedPosition( {
					x = 0,
					y = f22_arg0
				}, false, true, true, false )
			end
		end
		
	end
end

local f0_local12 = function ( f18_arg0, f18_arg1 )
	if f18_arg0.buttonList then
		f18_arg0.buttonListVScrollbar:closeTree()
		f18_arg0.buttonListVScrollbar = nil
		f18_arg0.buttonList:closeTree()
		f18_arg0.buttonList = nil
	end
	local buttonList = LUI.UIGrid.new( {
		maxVisibleColumns = 1,
		maxVisibleRows = 20,
		wrapY = true,
		maxRows = -28,
		mouseWheelScrollingOffsetPx = 32,
		allowScrollLimitFeedback = true,
		spacingY = CONDITIONS.IsMobileOrMobileSim() and f0_local0 or f0_local0,
		controllerIndex = f18_arg1
	} )
	if CONDITIONS.IsSplitscreen( f18_arg0 ) then
		buttonList:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, 255 )
	elseif Dvar[0x9E5BE3B4BBA4E0E]( 0xD7862EAA83B3B27 ) then
		buttonList:SetAnchorsAndPosition( 0, 0, 0, 0, 0, 0, 0, 0 )
	else
		buttonList:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, 724 )
	end
	buttonList.id = "buttonListId"
	buttonList:setUseStencil( true )
	buttonList.dispatchEventToChildren = function ( f21_arg0, f21_arg1 )
		if f21_arg1.name == "HDR_state_change" or f21_arg1.name == "refresh" then
			for f21_local0 = 0, f18_arg0:GetNumRows() - 1, 1 do
				local f21_local3 = f18_arg0:GetElementAtPosition( 0, f21_local0 )
				if f21_local3.type == "Expander" then
					f21_local3:processEvent( f21_arg1 )
					if f21_local3.ChildrenContainer:getFirstChild() then
						
					end
				end
				f21_local3:processEvent( f21_arg1 )
			end
		else
			if f21_arg0:getFirstChild() then
				
			else
				
			end
			if CONDITIONS.IsMobileOrMobileSim() then
				local f21_local1 = f21_arg0:GetBuiltChildren()
				if f21_local1 then
					for f21_local5, f21_local6 in ipairs( f21_local1 ) do
						f21_local6:processEvent( f21_arg1 )
					end
				end
			end
		end
	end
	
	f18_arg0:addElement( buttonList )
	f18_arg0.buttonList = buttonList
	
	f18_arg0.__defaultFocus = f18_arg0.buttonList
	f18_arg0.buttonList:SetActiveOnMouseOverBehavior( f18_arg1, "InnerWidget" )
	f18_arg0.buttonList:registerEventHandler( "clear_active_option_menu", function ( element, event )
		if (element._activeElement or event.fromList ~= element.previousList) and element ~= event.fromList then
			element.previousList = event.fromList
			element:processEvent( {
				immediate = true,
				name = "request_active"
			} )
			local f20_local0, f20_local1 = element:GetChildPosition( event.fromList:getParent() )
			if f20_local1 then
				element._targetPosition = {
					x = 0,
					y = f20_local1
				}
				element._childInFocus = event.fromList:getParent()
			end
		end
	end )
	f18_arg0.buttonList:addEventHandler( "request_active", function ( f19_arg0, f19_arg1 )
		if f19_arg1.target then
			f19_arg0:dispatchEventToChildren( {
				name = "clear_active_option_menu",
				fromList = f19_arg0
			} )
		end
	end )
	local buttonListVScrollbar = nil
	buttonListVScrollbar = MenuBuilder.BuildRegisteredType( "VerticalMinimalScrollbar", {
		controllerIndex = f18_arg1
	} )
	buttonListVScrollbar.id = "buttonListVScrollbar"
	local f18_local2, f18_local3, f18_local4, f18_local5 = f18_arg0.buttonList:getLocalRect()
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xD7862EAA83B3B27 ) then
		buttonListVScrollbar:SetAnchorsAndPosition( 1, 0, 0, 0, 0, f0_local0, 0, 0 )
	else
		buttonListVScrollbar:SetAnchorsAndPosition( 0, 1, 0, 1, f18_local4 + f0_local0, f18_local4 + f0_local0, f18_local3, f18_local5 )
	end
	f18_arg0:addElement( buttonListVScrollbar )
	f18_arg0.buttonListVScrollbar = buttonListVScrollbar
	
	local f18_local6 = LUI.UIScrollbar.new
	local f18_local7 = {
		direction = LUI.DIRECTION.vertical,
		eventListener = buttonListVScrollbar,
		startCap = buttonListVScrollbar.startCap,
		endCap = buttonListVScrollbar.endCap,
		sliderArea = buttonListVScrollbar.sliderArea
	}
	local f18_local8 = buttonListVScrollbar.sliderArea
	if f18_local8 then
		f18_local8 = buttonListVScrollbar.sliderArea.slider
	end
	f18_local7.slider = f18_local8
	f18_local8 = buttonListVScrollbar.sliderArea
	if f18_local8 then
		f18_local8 = buttonListVScrollbar.sliderArea.fixedSizeSlider
	end
	f18_local7.fixedSizeSlider = f18_local8
	f18_local7.mouseWheelTarget = f18_arg0.buttonList
	f18_local6 = f18_local6( f18_local7 )
	f18_arg0.buttonList:AddScrollbar( f18_local6 )
	f18_local6:UpdateSliderAreaVertical( false )
	f18_local6:SetKBMStyle( true )
	Engine[0xC4146BA76D0F982]( SOUND_SETS.default.tabHighlight )
end

local f0_local13 = function ( f17_arg0, f17_arg1 )
	local f17_local0, f17_local1 = f17_arg0.buttonList:GetChildPosition( f17_arg1 )
	return f17_local1
end

local f0_local14 = function ( f16_arg0, f16_arg1 )
	if OPTIONS.UseDynamicGridInSettings() then
		f16_arg0.DynamicList:RemoveAllWidgets( true )
	elseif f16_arg0.options and 0 < #f16_arg0.options then
		if type( f16_arg0.options[1] ) == "userdata" then
			f0_local0( f16_arg0, f16_arg1 )
		end
		f16_arg0.options = {}
	end
end

local f0_local15 = function ( f15_arg0, f15_arg1, f15_arg2, f15_arg3, f15_arg4, f15_arg5 )
	if 0 < #f15_arg0.options then
		local f15_local0 = f15_arg2 - 1
		if f15_arg3 then
			local f15_local1 = f15_arg0.buttonList:GetElementAtPosition( 0, f15_local0 )
			if f15_local1 and f15_local1._isExpander then
				f15_arg0.buttonList:SetFocusedPosition( {
					x = 0,
					y = f15_local0
				}, true, true )
				f15_local1:ExpandOrCollapse( true, true, f15_arg1, true )
				f15_local1:processEvent( {
					name = "lose_focus",
					controller = f15_arg1
				} )
				if not LUI.IsLastInputMouseNavigation( f15_arg1 ) and not f15_arg4 then
					f15_arg3:processEvent( {
						name = "gain_focus",
						controller = f15_arg1
					} )
				else
					f15_arg3:dispatchEventToParent( {
						name = "request_active",
						target = f15_arg3
					} )
				end
			end
		elseif not LUI.IsLastInputMouseNavigation( f15_arg1 ) and not f15_arg4 then
			f15_arg0.buttonList:SetFocusedPosition( {
				x = 0,
				y = f15_local0
			}, true, true, true, false )
		else
			if not f15_arg4 then
				f15_arg0.buttonList:SetPosition( {
					x = 0,
					y = f15_local0
				}, false )
			end
			if not f15_arg4 or f15_arg5 then
				local f15_local1 = f15_arg0.buttonList:GetElementAtPosition( 0, f15_local0 )
				if f15_local1 and f15_local1.InnerWidget then
					f15_local1 = f15_local1.InnerWidget
				end
				f15_local1:dispatchEventToParent( {
					name = "request_active",
					target = f15_local1
				} )
			end
		end
	end
end

local f0_local16 = function ( f14_arg0, f14_arg1, f14_arg2 )
	local f14_local0, f14_local1 = nil
	if f14_arg0.options and 0 < #f14_arg0.options and type( f14_arg0.options[1] ) == "userdata" then
		local f14_local2 = type( f14_arg2 )
		for f14_local3 = 1, #f14_arg0.options, 1 do
			local f14_local6 = f14_arg0.options[f14_local3]
			if f14_local6._typeName ~= 0xCD1E58963F98FDE and f14_local6._typeName ~= 0xECD7808596D64CF then
				if not (f14_local2 ~= "number" or f14_local3 ~= f14_arg2) or f14_local2 == "xhash" and f14_local6.settingBundle == f14_arg2 then
					return f14_local6, f14_local3
				elseif f14_local2 == "xhash" and f14_local6._isExpander then
					if f14_local6.InnerWidget.settingBundle == f14_arg2 then
						return f14_local6, f14_local3
					elseif f14_local6.ChildrenContainer:getFirstChild() then
						
					end
				end
				if not f14_local1 then
					f14_local1 = f14_local3
					f14_local0 = f14_local6
				end
			end
		end
	end
	return f14_local0, f14_local1
end

local f0_local17 = function ( f8_arg0, f8_arg1, f8_arg2, f8_arg3, f8_arg4, f8_arg5, f8_arg6 )
	if f8_arg6 then
		f8_arg0:addEventHandler( "gain_focus", function ( f13_arg0, f13_arg1 )
			return true
		end )
	end
	local f8_local0 = 0
	if not f8_arg0.currCategory or f8_arg0.currCategory ~= f8_arg4 then
		f8_arg0:ClearCurrentOptions( f8_arg1 )
		f8_arg0.options = f8_arg2( f8_arg0, f8_arg1, f8_arg3 )
		f8_arg0.categoryIndexList = {}
		if f8_arg0.options and 0 < #f8_arg0.options and type( f8_arg0.options[1] ) == "userdata" then
			for f8_local1 = 1, #f8_arg0.options, 1 do
				local f8_local4 = f8_arg0.options[f8_local1]
				f8_local4.index = f8_local1
				if f8_local4._typeName ~= 0xCD1E58963F98FDE and f8_local4._typeName ~= 0xECD7808596D64CF then
					ACTIONS.SetButtonUsingGridListActive( f8_local4, true )
					if f8_local4._typeName == 0x1E3A3649FB37A19 then
						if f8_local4.ChildrenContainer:getFirstChild() then
							
						else
							
						end
						ACTIONS.SetButtonUsingGridListActive( f8_local4.InnerWidget, true )
						f8_local4.InnerWidget:addEventHandler( "gain_focus", function ( f12_arg0, f12_arg1 )
							f8_arg0.ExpandButton:UpdatePrompt( true )
						end )
					end
					OPTIONS.ShowFavoriteIconOnCommonWidget( f8_arg1, f8_local4 )
					f8_local4:addEventHandler( "button_over", function ( f11_arg0, f11_arg1 )
						f8_arg0:processEvent( {
							name = "optionwindow_button_over"
						} )
					end )
					f8_local4:addEventHandler( "button_over_disable", function ( f10_arg0, f10_arg1 )
						f8_arg0:processEvent( {
							name = "optionwindow_button_over"
						} )
					end )
				else
					table.insert( f8_arg0.categoryIndexList, f8_local1 )
				end
				f8_arg0.buttonList:AddElement( f8_local4 )
			end
		end
	end
	local f8_local1, f8_local2, f8_local3 = f0_local0( f8_arg0, f8_arg1, f8_arg5 )
	if f8_local2 then
		local f8_local5 = f8_arg5 ~= nil
		local f8_local4 = f8_arg0:Wait( 1 )
		f8_local4.onComplete = function ()
			f8_arg0( f8_arg0, f8_arg0, f8_arg0, f8_arg0, f8_arg0, f8_arg0 )
		end
		
	end
	f8_arg0.currCategory = f8_arg4
end

local f0_local18 = function ( f7_arg0, f7_arg1 )
	if f7_arg0.options and 0 < #f7_arg0.options then
		for f7_local0 = 1, #f7_arg0.options, 1 do
			if f7_arg1 then
				f7_arg0.options[f7_local0]:SetAlpha( 0.6 )
			else
				f7_arg0.options[f7_local0]:SetAlpha( 1 )
			end
		end
		f7_arg0.isFaded = f7_arg1
	end
end

function PostLoadFunc( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.ClearCurrentOptions = f0_local0
	f2_arg0.FadeOptions = f0_local0
	f2_arg0.GetChildIndexInGrid = f0_local0
	f2_arg0.options = {}
	if OPTIONS.UseDynamicGridInSettings() then
		f2_arg0.UpdateOptions = f0_local0
		f0_local0( f2_arg0, f2_arg1 )
		f2_arg0.buttonList = f2_arg0.DynamicList.Grid
		f2_arg0:registerEventHandler( "update_expander_cache", function ( element, event )
			element.tabCache[event.id] = element.tabCache[event.id] or {}
			for f4_local8, f4_local9 in pairs( event.parameters ) do
				element.tabCache[event.id][f4_local8] = f4_local9
				if f4_local8 == "innerWidget" then
					f4_local9.closeTree = function ( f6_arg0 )
						f6_arg0:RemoveFromParent()
					end
					
				end
				if f4_local8 == "children" then
					for f4_local6, f4_local7 in ipairs( f4_local9 ) do
						f4_local7.closeTree = function ( f5_arg0 )
							f5_arg0:RemoveFromParent()
						end
						
					end
				end
			end
		end )
		f2_arg0:addEventHandler( "on_close", function ( f3_arg0, f3_arg1 )
			f2_arg0( f3_arg0 )
		end )
	else
		f2_arg0.UpdateOptions = f0_local0
		f0_local0( f2_arg0, f2_arg1 )
	end
	f2_arg0.__defaultFocus = f2_arg0.buttonList
	f2_arg0:addEventHandler( "gain_focus", LUI.UIElement.HandleDefaultFocus )
end

function OptionWindow( f1_arg0, f1_arg1 )
	local f1_local0 = CONDITIONS
	local f1_local1 = LUI
	local f1_local2 = MenuBuilder
	local f1_local3 = f1_local1.UIElement.new()
	f1_local3:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1000, 0, 800 )
	f1_local3.id = "OptionWindow"
	local f1_local4
	if f1_arg1 then
		f1_local4 = f1_arg1
	else
		f1_local4 = f1_arg1.controllerIndex
	end
	f1_local4 = f1_local1.ValidateControllerIndex( f1_local3, f1_local4 )
	local f1_local5 = nil
	if OPTIONS.UseDynamicGridInSettings( menu ) then
		f1_local5 = f1_local2.BuildRegisteredType( 0xE912B67EAB866DA, {
			controllerIndex = f1_local4
		} )
		f1_local5[0x8B72E07B55C3AC0] = "DynamicList"
		f1_local5:SetScale( 0, 0 )
		f1_local5:SetAnchorsAndPosition( 0, 0, 0, 0, 1, -39, 0, 0 )
		f1_local3:addElement( f1_local5 )
		f1_local3[0xE912B67EAB866DA] = f1_local5
	end
	local f1_local6 = nil
	if OPTIONS.UseDynamicGridInSettings( menu ) then
		f1_local6 = f1_local2.BuildRegisteredType( 0x12A2D6C64C313D0, {
			controllerIndex = f1_local4
		} )
		f1_local6[0x8B72E07B55C3AC0] = "Scrollbar"
		f1_local6:SetAnchorsAndPosition( 1, 0, 0, 0, -20, 0, 0, 0 )
		f1_local3:addElement( f1_local6 )
		f1_local3[0xF0042112D8663D9] = f1_local6
	end
	PostLoadFunc( f1_local3, f1_local4, f1_arg1 )
	return f1_local3
end

MenuBuilder.registerType( 0xCCF0C2EE9A439C8, OptionWindow )
LockTable( _M )
