-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
module( ..., package.seeall )
local f0_local0 = function ( f38_arg0, f38_arg1, f38_arg2 )
	if not String.IsNilOrEmpty( f38_arg2 ) then
		Challenge.WinChallengePrepend( f38_arg0, f38_arg1, f38_arg2 )
	end
end

local f0_local1 = function ( f37_arg0, f37_arg1, f37_arg2 )
	if not String.IsNilOrEmpty( f37_arg2 ) then
		Challenge.WinChallengeRemove( f37_arg0, f37_arg1, f37_arg2 )
	end
end

local f0_local2 = function ( f36_arg0, f36_arg1 )
	if CONDITIONS.IsLoadoutMenuBreadCrumbsEnabled() and f36_arg0.NewItemNotification and f36_arg0._equipmentData then
		if f36_arg0:isInFocus() then
			f36_arg0.NewItemNotification:ClearBreadcrumbByID( f36_arg1, f36_arg0._equipmentData.lootID )
		else
			f36_arg0.NewItemNotification:UpdateBreadcrumbByID( f36_arg1, f36_arg0._equipmentData.lootID )
		end
	end
end

local f0_local3 = function ( f28_arg0, f28_arg1, f28_arg2, f28_arg3, f28_arg4 )
	local f28_local0 = EQUIPMENT.GetEquippedEquipment( f28_arg1, f28_arg0.loadoutIndex, f28_arg0.equipmentIndex ) == f28_arg4.ref
	local f28_local1 = f28_arg0.equipmentIndex == EQUIPMENT[0x74F9D21004E6324][0x2B1AD16803854BB]
	local f28_local2 = f28_arg0.equipmentIndex == EQUIPMENT[0x74F9D21004E6324][0x731F3C21BFD3FF4]
	local f28_local3 = Restrictions.IsEquiupmentRestricted( f28_arg4.ref )
	local f28_local4 = Restrictions.IsItemPartiallyRestricted( f28_arg4.ref )
	if f28_local4 then
		f28_local4 = not CONDITIONS[0x4A020C7B018B3BA]()
	end
	local f28_local5
	if LUI.IsItemInArray( LOOT.mobileComingSoonItemIds, f28_arg4.lootID ) ~= nil then
		f28_local5 = not Dvar[0x9E5BE3B4BBA4E0E]( 0x400E64D176DA3A4 )
	else
		f28_local5 = false
	end
	local f28_local6 = CONDITIONS.IsOutbreakGametype()
	local f28_local7 = Challenge.IsWinChallengeItem( f28_arg1, f28_arg4.lootID )
	f28_arg3._equipmentData = f28_arg4
	f28_arg3._buttonConfig = {
		removeTextBacker = true,
		imageSize = "1x1",
		buttonData = {
			header = f28_arg4.nameRef,
			image = f28_arg4.image,
			winTokenCost = f28_arg4.winTokenCost,
			isUnlocked = f28_arg4.isUnlocked
		},
		isComingSoon = f28_local5,
		optOutEquippedColor = f28_local6,
		isWinChallengeItem = f28_local7
	}
	local f28_local8 = LOOT.GetLootSkins( f28_arg1, f28_arg4.useWeapon, f28_arg4.lootID )
	local f28_local9 = 1 < #f28_local8
	if f28_local9 then
		f28_arg3._equipmentData.skinVariants = f28_local8
		if f28_arg3.SetupSkins then
			f28_arg3:SetupSkins( #f28_local8 - 1 )
		end
	else
		f28_arg3._equipmentData.skinVariants = {}
		if f28_arg3.SetupSkins then
			f28_arg3:SetupSkins( 0 )
		end
	end
	local f28_local10 = GAMEMODE_SCRIPTBUNDLE_UTILS.IsBuyAndSellFlowEnabled()
	f28_arg3.Button:SetupButton( f28_arg3._buttonConfig )
	f28_arg3.Button:SetEquipped( f28_local0 )
	f28_arg3.Button:SetDisabled( not f28_arg4.isUnlocked )
	f28_arg3.Button:SetRestricted( f28_local3, f28_local4 )
	f28_arg3:SetButtonDisabled( not f28_arg4.isUnlocked )
	if CONDITIONS.IsPerpetualInventoryEnabled() then
		if f28_local9 then
			if f28_local6 and f28_local0 then
				f28_arg3[0xAA9C45C0F9EF371]:SetDisabledText( Engine[0xED84C33EC5F01EA]( 0x11A42B3B7868280 ) )
			else
				f28_arg3[0xAA9C45C0F9EF371]:SetDisabledText( Engine[0xED84C33EC5F01EA]( 0xD4463A566EAB153 ) )
			end
			if f28_arg3[0xAA9C45C0F9EF371][0x4AA903119F4FA7B] then
				f28_arg3[0xAA9C45C0F9EF371][0x4AA903119F4FA7B]:KeepPrimaryPromptActiveIfLocked()
				f28_arg3[0xAA9C45C0F9EF371][0x4AA903119F4FA7B]:SetIsPromptShownForDisabled( true )
			end
		else
			f28_arg3[0xAA9C45C0F9EF371]:SetDisabledText( Engine[0xED84C33EC5F01EA]( 0x8B93DC546B4878D ) )
			if f28_arg3[0xAA9C45C0F9EF371][0x4AA903119F4FA7B] then
				f28_arg3[0xAA9C45C0F9EF371][0x4AA903119F4FA7B]:RemovePrimaryPromptActiveIfLocked()
				f28_arg3[0xAA9C45C0F9EF371][0x4AA903119F4FA7B]:SetIsPromptShownForDisabled( false )
			end
		end
	end
	local f28_local11 = 0xCA07A93FADF9E95
	if f28_arg3.WinChallengeItemTag then
		if f28_local7 then
			if not Challenge.IsWinChallengeComplete( f28_arg1, f28_local7.challengeID ) then
				local f28_local12, f28_local13 = Challenge.WinChallengeListFind( f28_arg1, f28_local7.challengeID )
				f28_arg3.WinChallengeItemTag:SetVisible( true )
				f28_arg3.WinChallengeItemTag:SetWinChallengeLabelType( f28_local13 )
				if not f28_arg4.isUnlocked then
					f28_local11 = 0x8B93DC546B4878D
				end
			end
		else
			f28_arg3.WinChallengeItemTag:SetVisible( false )
		end
	end
	local f28_local12 = false
	local f28_local13 = false
	if f28_local10 then
		if not f28_local0 and f28_arg4.ref ~= EQUIPMENT.none then
			f28_local11 = 0x7031B327FA58FEC
			local f28_local14 = EXGM_UTILS.GetItemPrice( LOOT.GetItemID( f28_arg4.ref ) )
			f28_arg3.Button:SetSecondaryPromptText( Engine[0xED84C33EC5F01EA]( 0xB6868376C405B52, INVENTORY.GetCashDisplay( f28_local14 ) ) )
			if EXGM_UTILS.GetLocalPlayerBalance( f28_arg1 ) < f28_local14 then
				f28_arg3.Button:SetPrimaryPromptTextColor( SWATCHES[0x5E2F4190CE482DE][0x60313DE08955E67] )
				f28_arg3.Button:SetSecondaryPromptTextColor( SWATCHES[0xEAF2060ABE5269B][0x38C01F58B8A2781] )
			end
			local f28_local15 = f28_arg3.Button.ButtonHighlight.SecondaryAction:GetAnchorsAndPosition()
			f28_arg3.Button.ButtonHighlight.SecondaryAction:SetAnchorsAndPosition( f28_local15.leftAnchor, f28_local15.rightAnchor, f28_local15.topAnchor, f28_local15.bottomAnchor, f28_local15.left - 10, f28_local15.right, f28_local15.top, f28_local15.bottom )
		end
	elseif f28_local6 and f28_local0 and f28_arg4.ref ~= EQUIPMENT.none then
		f28_local11 = 0x11A42B3B7868280
	end
	if not f28_arg4.isUnlocked and f28_local9 then
		f28_local11 = 0xD4463A566EAB153
	end
	f28_arg3.Button:SetPrimaryPromptText( f28_local11 )
	if f28_arg3.InventoryQuantity then
		f28_arg3.InventoryQuantity:Setup( f28_arg4.quantity )
	end
	f0_local0( f28_arg3, f28_arg1 )
	local f28_local16 = function ( f33_arg0 )
		local f33_local0 = f33_arg0._equipmentData
		local f33_local1 = EQUIPMENT.GetEquipmentDetails( f28_arg0, f33_local0.ref )
		if f28_arg0.UpdateDetailsDataSources then
			f28_arg0:UpdateDetailsDataSources( f28_arg0, f33_local1 )
		else
			f28_arg0.ItemDetails:UpdateDetails( f33_local1 )
		end
		f28_arg0( f33_arg0, f28_arg0 )
		if CONDITIONS.InFrontend() then
			if f28_arg0.currentButton == f33_arg0 then
				
			else
				
			end
			f28_arg0.currentButton = f33_arg0
			local f33_local2 = f33_local0.model
			if f33_local0.isEquipped then
				local f33_local3 = EQUIPMENT.GetEquippedSkin( f28_arg0, f28_arg0.loadoutIndex, f28_arg0.equipmentIndex )
				if f33_local3 and 0 < f33_local3 then
					local f33_local4 = LOOT.GetLootSkins( f28_arg0, f33_local0.useWeapon, f33_local0.lootID )
					if not Table.IsNilOrEmpty( f33_local4 ) then
						for f33_local8, f33_local9 in ipairs( f33_local4 ) do
							if f33_local9.variantID == f33_local3 and not String.IsNilOrEmpty( f33_local9.frontendModelOverride ) then
								f33_local2 = f33_local9.frontendModelOverride
								break
							end
						end
					end
				end
			end
			if f28_arg0.loadouts[f28_arg0.loadoutIndex].equipmentSetups[f28_arg0.equipmentIndex].flcExtraEquipment:get() == 1 then
				local f33_local4 = CLIENT_MODEL.SetModel
				local f33_local6 = f28_arg0.equipmentIndex
				local f33_local7 = EQUIPMENT[0x74F9D21004E6324][0x2B1AD16803854BB]
				f33_local4( REG14 and CLIENT_MODEL.coreMPModels.LETHAL_02 or CLIENT_MODEL.coreMPModels.TACTICAL_02, f33_local2 )
			end
			CLIENT_MODEL.SetModel( f28_arg0 and CLIENT_MODEL.coreMPModels.LETHAL or CLIENT_MODEL.coreMPModels.TACTICAL, f33_local2 )
			local f33_local5 = f28_arg0:Wait( 5 )
			f33_local5.onComplete = function ()
				CLIENT_MODEL.ApplyEquipmentOffsets( f33_arg0, f33_arg0 and f33_arg0.nameRef or "", f33_arg0 and f33_arg0.nameRef or "", f33_arg0 and f33_arg0, f33_arg0 and f33_arg0 )
			end
			
			f33_local5 = f28_arg0:Wait( 300 )
			f33_local5.onComplete = function ()
				if f33_arg0.currentButton == f33_arg0 then
					CLIENT_MODEL.SendClientModelTagDataToServer( f33_arg0.loadouts[f33_arg0.loadoutIndex].weaponSetups[0].weapon:get(), f33_arg0.loadouts[f33_arg0.loadoutIndex].weaponSetups[1].weapon:get(), f33_arg0 )
				end
			end
			
		end
	end
	
	if not f28_arg3._handlersAdded then
		f28_arg3:addEventHandler( "button_over", f28_local16 )
		f28_arg3:addEventHandler( "button_over_disable", f28_local16 )
		local f28_local14 = function ( f32_arg0 )
			LUI.FlowManager.RequestAddMenu( "EquipmentSkinSelect", true, f28_arg0, nil, {
				equipmentData = f32_arg0._equipmentData,
				loadoutIndex = f28_arg0.loadoutIndex,
				equipmentIndex = f28_arg0.equipmentIndex,
				lootItemType = LOOT.itemTypes.EQUIPMENT
			}, true )
		end
		
		f28_arg3:addEventHandler( "button_action", function ( f31_arg0 )
			local f31_local0 = f31_arg0._equipmentData
			local f31_local1 = false
			local f31_local2 = false
			if GAMEMODE_SCRIPTBUNDLE_UTILS.IsBuyAndSellFlowEnabled() then
				if f28_arg0 == f31_local0.ref then
					f31_local1 = true
				else
					local f31_local3 = LOOT.GetItemID( f31_local0.ref )
					local f31_local4 = f31_local0.ref
					local f31_local5 = EQUIPMENT.none
					f31_local4 = REG19 and EXGM_UTILS.GetItemPrice( f31_local3 ) or 0
					if f31_local4 <= EXGM_UTILS.GetLocalPlayerBalance( f28_arg0 ) then
						f31_local5 = LOADOUT.GetLoadoutSquadMember( f28_arg0 )
						f31_local5 = f31_local5.loadouts[f28_arg0.loadoutIndex].equipmentSetups[f28_arg0.equipmentIndex]
						if f31_local5.equipment:get() ~= EQUIPMENT.none then
							local f31_local6 = EXGM_UTILS.GetItemPrice( LOOT.GetItemID( f31_local5.equipment:get() ) )
							EXGM_UTILS.UpdateLocalPlayerBalance( f28_arg0, f31_local6 )
							LUI.ToastManager.CreateToast( f28_arg0, LUI.ToastManager.StandardEmphasisWithTopRightTextToast( Engine[0xED84C33EC5F01EA]( f28_arg0.equipmentIndex and 0x50FD083268D2500 or 0x5F8D76994532C05 ), LOOT.GetItemName( LOOT.itemTypes.EQUIPMENT, f31_local5.equipment:get() ), Engine[0xED84C33EC5F01EA]( 0x91E9FC19D222504, INVENTORY.GetCashDisplay( f31_local6 ) ), LUI.ToastManager.ToastNotificationType.Gear ) )
						end
						if f31_local0.ref ~= EQUIPMENT.none then
							EXGM_UTILS.UpdateLocalPlayerBalance( f28_arg0, -f31_local4 )
							LUI.ToastManager.CreateToast( f28_arg0, LUI.ToastManager.StandardEmphasisWithTopRightTextToast( Engine[0xED84C33EC5F01EA]( f28_arg0.equipmentIndex and 0xA17FA8BA9F2D377 or 0x2117381EA61E22 ), Engine[0xED84C33EC5F01EA]( f31_local0.nameRef ), Engine[0xED84C33EC5F01EA]( 0x9CC5C5D7BF0D452, INVENTORY.GetCashDisplay( f31_local4 ) ), LUI.ToastManager.ToastNotificationType.Gear ) )
						end
						f31_local1 = true
					end
				end
			elseif f31_local0 and f31_local0.skinVariants and 1 < #f31_local0.skinVariants then
				if f28_arg0 then
					f31_local2 = f28_arg0 == f31_local0.ref
				end
				if not f31_local2 then
					f28_arg0( f31_arg0 )
					return true
				end
			elseif f28_arg0 == f31_local0.ref then
				if f28_arg0 then
					f31_local2 = true
				else
					f31_local1 = true
				end
			elseif f28_arg0 ~= f31_local0.ref then
				f31_local1 = true
				f28_arg0:dispatchEventToRoot( {
					name = "send_toast_notification",
					immediate = true,
					options = {
						iconScale = 4.667263495923649E-62,
						displayTime = 3000,
						icon = "cac_equip_fill",
						iconColor = SWATCHES[0x1F5A9ABAC207F9D][0x5412D050D9404DA],
						header = Engine[0xED84C33EC5F01EA]( f28_arg0 and 0xA17FA8BA9F2D377 or 0x2117381EA61E22 ),
						description = Engine[0xED84C33EC5F01EA]( f31_local0.nameRef ),
						type = LUI.ToastManager.NotificationType.EquipmentEquipped,
						controllerIndex = f28_arg0
					}
				} )
			end
			local f31_local3 = f31_local0.ref
			if f31_local2 then
				f31_local3 = EQUIPMENT.none
				f31_local1 = true
			end
			if f31_local1 then
				EQUIPMENT.SetEquippedEquipment( f28_arg0, f28_arg0.loadoutIndex, f28_arg0.equipmentIndex, f31_local3 )
				if CONDITIONS.InGame() then
					Engine[0x6055C55456F05DF]( "equip_item_ingame", 1 )
				end
				LOOT.SendDlogLootEquipped( f28_arg0, LOOT.itemTypes.EQUIPMENT, nil, nil, f28_arg0, f31_local3 )
				LUI.FlowManager.RequestLeaveMenu( f28_arg0, true )
			end
		end )
		f28_arg3:addEventHandler( "button_action_disable", function ( f30_arg0, f30_arg1 )
			if f30_arg0._equipmentData and f30_arg0._equipmentData.skinVariants and 1 < #f30_arg0._equipmentData.skinVariants then
				local f30_local0 = f28_arg0
				if f30_local0 then
					f30_local0 = f28_arg0 == f30_arg0._equipmentData.ref
				end
				if f30_local0 then
					EQUIPMENT.SetEquippedEquipment( f28_arg0, f28_arg0.loadoutIndex, f28_arg0.equipmentIndex, EQUIPMENT.none )
					LOOT.SendDlogLootEquipped( f28_arg0, LOOT.itemTypes.EQUIPMENT, nil, nil, f28_arg0, EQUIPMENT.none )
					LUI.FlowManager.RequestLeaveMenu( f28_arg0, true )
				else
					f28_arg0( f30_arg0 )
				end
				return true
			else
				
			end
		end )
		f28_arg3:AddGamepadEventCallback( "button_alt1", function ( f29_arg0, f29_arg1 )
			if not CONDITIONS.IsPerpetualInventoryEnabled() or f29_arg0._equipmentData.isUnlocked then
				return 
			else
				local f29_local0 = UNLOCK_CRITERIA.GetUnlockActionInfo( f28_arg0, f29_arg0._equipmentData.lootID )
				if f29_local0 ~= nil then
					f29_local0.UnlockAction( f28_arg0, f29_arg0, f29_arg0._equipmentData.lootID )
					return true
				else
					
				end
			end
		end, {
			requireFocus = true
		} )
		f28_arg3._handlersAdded = true
	end
	MenuUtils.SetupItemButtonTags( f28_arg1, f28_arg3, f28_arg3._equipmentData and f28_arg3._equipmentData.lootID or nil )
end

local f0_local4 = function ( f27_arg0, f27_arg1 )
	if CONDITIONS.InFrontend() then
		local FrontendCameraMover = MenuBuilder.BuildRegisteredType( "FrontendCameraMover", {
			enableSway = true,
			controllerIndex = f27_arg1
		} )
		FrontendCameraMover:SetSwayValues( 4500, 0.06, 0.1 )
		FrontendCameraMover:SetLimits( -0.3, 0.3, -0.3, 0.3 )
		f27_arg0:addElement( FrontendCameraMover )
		f27_arg0.FrontendCameraMover = FrontendCameraMover
		
		FrontEndScene.SetExclusiveWeaponModels( {
			FrontEndScene.ClientWeapons.GunTablePrimary,
			FrontEndScene.ClientWeapons.GunTableSecondary
		} )
		LOADOUT.RequestWeaponModels( f27_arg1, f27_arg0.loadoutIndex )
	end
end

local f0_local5 = function ( f26_arg0, f26_arg1 )
	if CONDITIONS.InFrontend() then
		local f26_local0 = f26_arg1 == EQUIPMENT[0x74F9D21004E6324][0x2B1AD16803854BB]
		local f26_local1 = Engine[0x685AE31DEDA30A4]
		local f26_local2
		if f26_local0 then
			f26_local2 = "loadout_showcase_l"
		else
			f26_local2 = "loadout_showcase_t"
		end
		f26_local1( f26_local2 )
	end
end

local f0_local6 = function ( f25_arg0, f25_arg1 )
	f25_arg0.ItemDetails:SetupForEquipment()
	if Engine[0x2DA54CF5D6B7F02]() then
		if not f25_arg1.loadoutIndex then
			f25_arg1.loadoutIndex = 0
		end
		if not f25_arg1.equipmentIndex then
			f25_arg1.equipmentIndex = EQUIPMENT[0x74F9D21004E6324][0x2B1AD16803854BB]
		end
	end
	f25_arg0.loadoutIndex = f25_arg1.loadoutIndex
	f25_arg0.equipmentIndex = f25_arg1.equipmentIndex
end

local f0_local7 = function ( f24_arg0 )
	local f24_local0
	if f24_arg0.equipmentIndex == EQUIPMENT[0x74F9D21004E6324][0x2B1AD16803854BB] then
		f24_local0 = 0xCCC460329644DD6
		if not f24_local0 then
		
		else
			f24_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( f24_local0 ) )
		end
	end
	f24_local0 = 0xC9FD83CD7F8C0C1
end

local f0_local8 = function ( f22_arg0, f22_arg1 )
	table.sort( f22_arg0._equipmentTable, function ( f23_arg0, f23_arg1 )
		if f23_arg0.isRestricted ~= f23_arg1.isRestricted then
			local f23_local0 = f23_arg1.isRestricted
			if f23_local0 then
				f23_local0 = not f23_arg0.isRestricted
			end
			return f23_local0
		elseif f23_arg0.isUnlocked ~= f23_arg1.isUnlocked then
			return f23_arg0.isUnlocked
		elseif f23_arg0.unlockRank ~= f23_arg1.unlockRank then
			if f23_arg0.unlockRank < 0 and 0 < f23_arg1.unlockRank then
				return false
			elseif 0 < f23_arg0.unlockRank and f23_arg1.unlockRank < 0 then
				return true
			else
				return f23_arg0.unlockRank < f23_arg1.unlockRank
			end
		elseif f23_arg0.order ~= f23_arg1.order then
			return f23_arg0.order < f23_arg1.order
		else
			local f23_local0 = Engine[0xED84C33EC5F01EA]( f23_arg0.nameRef )
			local f23_local1 = Engine[0xED84C33EC5F01EA]( f23_arg1.nameRef )
			if f23_local0 ~= f23_local1 then
				return f23_local0 < f23_local1
			else
				return false
			end
		end
	end )
	local f22_local0 = EQUIPMENT.GetOtherEquipmentIndex( f22_arg0.equipmentIndex )
	local f22_local1 = EQUIPMENT.GetBundleByRef( EQUIPMENT.GetEquippedEquipment( f22_arg1, f22_arg0.loadoutIndex, f22_local0 ) )
	local f22_local2
	if f22_local1 then
		f22_local2 = f22_local1[0x4BCADBA8E631B86]
		if not f22_local2 then
		
		else
			if CONDITIONS.InFrontend() and not CONDITIONS.IsMobileOrMobileSim() then
				local f22_local3 = f22_local0 == EQUIPMENT[0x74F9D21004E6324][0x2B1AD16803854BB]
				local f22_local4 = f22_local0 == EQUIPMENT[0x74F9D21004E6324][0x731F3C21BFD3FF4]
				local f22_local5 = CLIENT_MODEL.ApplyEquipmentOffsets
				local f22_local6 = f22_arg1
				local f22_local7
				if f22_local3 and not f22_local2 then
					f22_local7 = f22_local2
				else
					f22_local7 = ""
				end
				local f22_local8
				if f22_local4 and not f22_local2 then
					f22_local8 = f22_local2
				else
					f22_local8 = ""
				end
				f22_local5( f22_local6, f22_local7, f22_local8 )
			end
		end
	end
	f22_local2 = ""
end

local f0_local9 = function ( f21_arg0 )
	if CONDITIONS.IsSplitscreen() then
		if f21_arg0.SplitscreenGridMask then
			f21_arg0.EquipmentGrid:SetMask( f21_arg0.SplitscreenGridMask )
		end
		f21_arg0.EquipmentGrid:SetMaxVisibleColumns( 6 )
		if CONDITIONS.InGame( f21_arg0 ) then
			if f21_arg0.Vignette then
				ACTIONS.ScaleFullscreen( f21_arg0.Vignette )
			end
			ACTIONS.AnimateSequence( f21_arg0, "Splitscreen" )
		end
	end
end

local f0_local10 = function ( f20_arg0, f20_arg1, f20_arg2 )
	local f20_local0 = EQUIPMENT.GetEquippedEquipment( f20_arg1, f20_arg0.loadoutIndex, f20_arg0.equipmentIndex )
	local f20_local1 = 1
	for f20_local5, f20_local6 in ipairs( f20_arg2 ) do
		if f20_local0 == f20_arg2[f20_local5].ref then
			f20_local1 = f20_local5 - 1
		end
	end
	return f20_local1
end

local f0_local11 = function ( f16_arg0, f16_arg1, f16_arg2 )
	f16_arg0.EquipmentGrid:SetNumChildren( #f16_arg0._equipmentTable )
	f16_arg0.EquipmentGrid:SetRefreshChild( function ( f19_arg0, f19_arg1, f19_arg2 )
		local f19_local0 = f16_arg0._equipmentTable[f19_arg0._gridContentColumnIndex + 1]
		f16_arg0( f16_arg0, f16_arg0, f16_arg0, f19_arg0, f19_local0 )
		if CONDITIONS.InFrontend() and CONDITIONS.AreRestrictionsActive() then
			f19_arg0.Button:SetButtonDisabled( f19_local0.isRestricted )
			if f16_arg0.CDLRestricted then
				if f19_local0.isRestricted then
					f16_arg0.CDLRestricted:SetAlpha( 1 )
				else
					f16_arg0.CDLRestricted:SetAlpha( 0 )
				end
			end
		end
	end )
	f16_arg0.EquipmentGrid:SetDefaultFocus( function ()
		local f18_local0 = f16_arg0( f16_arg0, f16_arg0, f16_arg0._equipmentTable )
		if f16_arg0._selectedIndex then
			return {
				y = 0,
				x = f16_arg0._selectedIndex
			}
		else
			return {
				y = 0,
				x = f18_local0
			}
		end
	end )
	f16_arg0.EquipmentGrid:TouchMouseSetActiveToDefaultFocusMenuCreate( f16_arg1 )
	f16_arg0.EquipmentGrid:RefreshContent()
	if Challenge.IsWinChallengesUnlocked( f16_arg1 ) and not Challenge.IsMenuChallengeCompleteCallbackRegistered( f16_arg0 ) then
		Challenge.RegisterMenuChallengeCompleteCallback( f16_arg0, function ( f17_arg0, f17_arg1 )
			f17_arg0.EquipmentGrid:RefreshContent()
			if CONDITIONS[0x4A020C7B018B3BA]() or CONDITIONS.IsOutbreakGametype() then
				f17_arg0.ItemDetails.UnlockCriteriaWidget:UpdateFromDataSources( f16_arg0 )
			else
				f17_arg0.LoadoutItemSelectLayoutFLC.ItemDetails.UnlockCriteriaWidget:UpdateFromDataSources( f16_arg0 )
			end
		end )
	end
end

local f0_local12 = function ( f13_arg0 )
	local f13_local0 = f13_arg0.EquipmentGrid
	local f13_local1 = f13_arg0.SideArrows
	f13_local0._onNewTargetFocusPosition = function ( f15_arg0, f15_arg1 )
		if f13_arg0 then
			f13_arg0:AddScrollWatch()
		end
	end
	
	if f13_local1 then
		f13_local0:addEventHandler( "gamepad_button", function ( f14_arg0, f14_arg1 )
			if CONDITIONS.IsMouseWheelEvent( f14_arg1 ) and f14_arg1.down then
				return f13_arg0:ExternalScroll( f14_arg1 )
			else
				
			end
		end )
		local f13_local2 = f13_local0:GetContentCount( LUI.DIRECTION.horizontal )
		f13_local1:SetupSideButtons( f13_local0 )
		f13_local1:UpdateSideButtons()
	end
end

local f0_local13 = function ( f12_arg0, f12_arg1 )
	local f12_local0 = EQUIPMENT.GetEquipmentsData( f12_arg1 )
	local f12_local1 = {}
	for f12_local7, f12_local8 in ipairs( f12_local0 ) do
		local f12_local5
		if CONDITIONS.InGame() then
			f12_local5 = PROGRESSION.IsUnlocked( f12_arg1, LOOT.itemTypes.EQUIPMENT, f12_local8.ref )
		else
			f12_local5 = true
		end
		local f12_local6 = LOOT.GetItemID( f12_local8.ref )
		f12_local8.unlockRank = PROGRESSION.GetUnlockRank( f12_local6 )
		if not (LOOT.IsItemBanned( f12_local6 ) or not f12_local5 or f12_local8.isRestricted) or f12_local8.isEquipped then
			table.insert( f12_local1, f12_local8 )
		end
	end
	f12_arg0._equipmentTable = f12_local1
end

local f0_local14 = function ( f8_arg0, f8_arg1 )
	f8_arg0:addEventHandler( "menu_create", function ( f11_arg0, f11_arg1 )
		local f11_local0 = f11_arg1.controller or f8_arg0
		if not f11_arg0.EquipmentGrid:GetFocusPositionIndex() then
			f11_arg0.EquipmentGrid:SetFocusedPosition( {
				y = 0,
				x = f8_arg0( f8_arg0, f11_local0, f8_arg0._equipmentTable )
			}, true )
		end
	end )
	f8_arg0:SubscribeToInputTypeModel( f8_arg1, function ( f10_arg0, f10_arg1 )
		f10_arg1.EquipmentGrid:restoreState()
	end )
	f8_arg0:addEventHandler( "refresh_equipment", function ( f9_arg0, f9_arg1 )
		f9_arg0.EquipmentGrid:RefreshContent()
	end )
end

local f0_local15 = function ( f6_arg0 )
	if f6_arg0.HelperBar and CONDITIONS.InGame() and not CONDITIONS.IsThirdGameMode() then
		f6_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			clickable = true,
			priority = 5,
			ignoreTooltip = false,
			side = "left",
			kbmTooltipPromptOverload = "button_dismiss_pause_menu",
			button_ref = "button_start",
			helper_text = Engine[0xED84C33EC5F01EA]( 0xEF0F75B0AB08E35 )
		} )
		f6_arg0:AddGamepadEventCallback( "button_start", function ( f7_arg0, f7_arg1 )
			LUI.FlowManager.RequestCloseAllMenus()
		end )
	end
end

local f0_local16 = function ( f4_arg0, f4_arg1, f4_arg2 )
	if CONDITIONS.InFrontend() then
		CLIENT_MODEL.TrySetAllModelsModifiable( f4_arg0, f4_arg1, CLIENT_MODEL.SET_MODIFIABLE_TIMEOUT_DEFAULT )
	end
	f0_local0( f4_arg0, f4_arg2 )
	f0_local0( f4_arg0, f4_arg2.equipmentIndex )
	f0_local0( f4_arg0, f4_arg1 )
	f0_local0( f4_arg0 )
	local f4_local0 = LOADOUT.GetLoadoutSquadMember( f4_arg1 )
	f0_local0( f4_arg0, f4_arg1 )
	f0_local0( f4_arg0, f4_arg1 )
	f0_local0( f4_arg0 )
	f0_local0( f4_arg0, f4_arg1, f4_local0 )
	f0_local0( f4_arg0 )
	f0_local0( f4_arg0, f4_arg1 )
	f0_local0( f4_arg0 )
	f4_arg0:registerEventHandler( "closing_quick_access_menu", function ( element, event )
		f4_arg0( element, element.equipmentIndex )
		return true
	end )
end

local f0_local17 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.PostLoadShared = f0_local0
end

function EquipmentSelectBase( f1_arg0, f1_arg1 )
	local f1_local0 = ACTIONS
	local f1_local1 = LUI
	local f1_local2 = f1_local1.UIMenu.new()
	f1_local2.id = "EquipmentSelectBase"
	local f1_local3
	if f1_arg1 then
		f1_local3 = f1_arg1
	else
		f1_local3 = f1_arg1.controllerIndex
	end
	f1_local3 = f1_local1.ValidateControllerIndex( f1_local2, f1_local3 )
	local f1_local4 = f1_local2
	local f1_local5 = f1_local2
	EQUIPMENT.SetupEquipmentSelectMenu( f1_local2, f1_local3, f1_arg1 )
	f1_local2:AddGamepadEventCallback( 0x691AB96D9875434, function ( f2_arg0, f2_arg1 )
		local f2_local0 = f2_arg1.controller or f1_arg0
		f1_arg0:LeaveMenu()
	end )
	f0_local0( f1_local2, f1_local3, f1_arg1 )
	return f1_local2
end

MenuBuilder.registerType( 0xFCF0786E58DF71A, EquipmentSelectBase )
LockTable( _M )
