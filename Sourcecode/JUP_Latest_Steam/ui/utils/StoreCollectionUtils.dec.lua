-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:02
StoreCollection = StoreCollection or {}
StoreCollection[0xC33D13AB5EC2345] = {}
StoreCollection[0xC33D13AB5EC2345][0x8606E8ED5BB39A8] = nil
local f0_local0 = 0xC274E438F2C42B8
local f0_local1 = 0x464240CFA12986B
local f0_local2 = 0xE50A61426143BB3
StoreCollection.COLLECTION_COMPLETE_COLOR = SWATCHES[0xDBB8C7CA3AEB214][0x10046B9D845B497]
local f0_local3 = function ()
	local f18_local0 = String.Split( Dvar[0x54084D7CA2317BB]( 0x5CA3ED77AAEFD6E ) or "", "|" )
	for f18_local4, f18_local5 in ipairs( f18_local0 ) do
		f18_local0[f18_local4] = tonumber( f18_local5 )
	end
	return f18_local0
end

local f0_local4 = function ( f17_arg0 )
	local f17_local0 = nil
	local f17_local1 = StoreCollection.GetChallengeRef( f17_arg0 )
	local f17_local2 = Challenge.GetBundleCollectionChallengeDataByRef( f17_local1 )
	if f17_local2 then
		local f17_local3 = f17_arg0[0x1E06DC009329524]
		local f17_local4 = f17_local2.collectionID
		if not f17_local3 or not f17_local4 or f17_local3 ~= f17_local4 then
			local f17_local5
			if not f17_local0 then
				f17_local5 = f17_local0
			else
				f17_local5 = ""
			end
			f17_local0 = f17_local5 .. "- Collection ID is missing or doesn't match between GDT and AE\n"
		end
		local f17_local5 = #f17_arg0[0x5A11C2DD9AB8CEC][0x83E236481DF1EE2]
		if f17_local5 == #f17_local2.bundles then
			for f17_local6 = 1, f17_local5, 1 do
				local f17_local9 = f17_arg0[0x5A11C2DD9AB8CEC][0x83E236481DF1EE2][f17_local6]
				local f17_local10 = f17_local2.bundles[f17_local6]
				local f17_local11 = STORE.Bundles.BaseSKU( f17_local9 )
				local f17_local12
				if f17_local11 then
					f17_local12 = f17_local11
				else
					f17_local12 = f17_local11[0x6B65B4278C6C417]
				end
				local f17_local13
				if f17_local10 then
					f17_local13 = f17_local10
				else
					f17_local13 = f17_local10.sku
				end
				if f17_local12 ~= f17_local13 then
					local f17_local14
					if not f17_local0 then
						f17_local14 = f17_local0
					else
						f17_local14 = ""
					end
					local f17_local15 = string.format
					local f17_local16 = "- Bundle skus %d and %d don't match between GDT and AE\n"
					local f17_local17
					if not f17_local12 then
						f17_local17 = f17_local12
					else
						f17_local17 = 0
					end
					local f17_local18
					if not f17_local13 then
						f17_local18 = f17_local13
					else
						f17_local18 = 0
					end
					f17_local0 = f17_local14 .. f17_local15( f17_local16, f17_local17, f17_local18 )
				end
				if not STORE.Bundles.ContainsLootID( f17_local9, f17_local10.activationFee ) then
					local f17_local14 = string.format
					local f17_local19 = "- Bundle %d does not contain activation loot %d entered in AE"
					local f17_local16
					if not f17_local12 then
						f17_local16 = f17_local12
					else
						f17_local16 = 0
					end
					f17_local14 = f17_local14( f17_local19, f17_local16, f17_local10.activationFee or 0 )
					local f17_local15
					if not f17_local0 then
						f17_local15 = f17_local0
					else
						f17_local15 = ""
					end
					f17_local0 = f17_local15 .. f17_local14 .. "\n"
				end
			end
		else
			local f17_local6
			if not f17_local0 then
				f17_local6 = f17_local0
			else
				f17_local6 = ""
			end
			f17_local0 = f17_local6 .. "- Bundle counts don't match between GDT and AE\n"
		end
		if not f17_arg0[0x791A4EABFCC1F99] or f17_arg0[0x791A4EABFCC1F99] == LOOT.emptyID or not f17_local2.lootIDs[1] or f17_local2.lootIDs[1] == LOOT.emptyID or f17_arg0[0x791A4EABFCC1F99] ~= f17_local2.lootIDs[1] then
			local f17_local6
			if not f17_local0 then
				f17_local6 = f17_local0
			else
				f17_local6 = ""
			end
			f17_local0 = f17_local6 .. "- Loot rewards missing or mismatched between GDT and AE\n"
		end
	else
		local f17_local3 = "- Collection challenge not found: " .. f17_local1
		local f17_local4
		if not f17_local0 then
			f17_local4 = f17_local0
		else
			f17_local4 = ""
		end
		f17_local0 = f17_local4 .. f17_local3 .. "\n"
	end
	if f17_local0 then
		f17_local0 = "Collection: " .. Engine[0xED84C33EC5F01EA]( StoreCollection.GetName( f17_arg0 ) ) .. "\n" .. f17_local0
	end
	return f17_local0
end

local f0_local5 = function ()
	if StoreCollection[0xC33D13AB5EC2345][0x8606E8ED5BB39A8] then
		return 
	end
	StoreCollection[0xC33D13AB5EC2345][0x8606E8ED5BB39A8] = {}
	if not CONDITIONS.AreStoreBundleCollectionsEnabled() then
		return 
	end
	local f16_local0 = f0_local0()
	local f16_local1 = Engine[0x6093D047200548]( f0_local0 )
	local f16_local2 = CONDITIONS.ShowAllStoreBundleCollections()
	local f16_local3 = nil
	if not Table.IsNilOrEmpty( f16_local1 ) then
		for f16_local19, f16_local20 in ipairs( f16_local1[0xD6BC469C8B376C6] ) do
			if f16_local20[0x93B8EBCC208569B] then
				local f16_local7 = Engine[0x6093D047200548]( f0_local0 .. f16_local20[0x93B8EBCC208569B] )
				if not (not f16_local7[0xF7DDD8B320EE821] or Table.FindItemIndexInArray( f16_local0, f16_local7[0x1E06DC009329524] ) ~= nil) or f16_local2 then
					f16_local7 = Table.DeepCopy( f16_local7 )
					f16_local7[0x7F5C18E246C6638] = Color.HDRColorToInt( f16_local7[0x7F5C18E246C6638] )
					f16_local7[0x5A11C2DD9AB8CEC] = {}
					f16_local7[0x5A11C2DD9AB8CEC][0x83E236481DF1EE2] = {}
					for f16_local17, f16_local18 in ipairs( f16_local7[0x83E236481DF1EE2] ) do
						if f16_local18[0x93B8EBCC208569B] then
							local f16_local11 = Engine[0x6093D047200548]( f0_local0 .. f16_local18[0x93B8EBCC208569B] )
							f16_local7[0x5A11C2DD9AB8CEC][0x83E236481DF1EE2][f16_local17] = f16_local11
							if f16_local11 then
								for f16_local15, f16_local16 in ipairs( STORE.Bundles.GetSKUs( f16_local11 ) ) do
									StoreCollection[0xC33D13AB5EC2345][0x8606E8ED5BB39A8][f16_local16[0x6B65B4278C6C417]] = f16_local7
								end
							end
						end
					end
					f16_local7[0x83E236481DF1EE2] = nil
					if CONDITIONS[0x2F9F94DF6F92292]() and not Dvar[0x9E5BE3B4BBA4E0E]( 0x244E1B9C23A167C ) and not Dvar[0x9E5BE3B4BBA4E0E]( 0x7B4848E3EF9CD04 ) then
						f16_local8 = f0_local0( f16_local7 )
						if f16_local8 then
							if not f16_local3 then
								f16_local9 = f16_local3
							else
								f16_local9 = ""
							end
							f16_local3 = f16_local9 .. f16_local8 .. "\n"
						end
					end
				end
			end
		end
	end
	if not String.IsNilOrEmpty( f16_local3 ) then
		LUI.FlowManager.RequestDevErrorPopup( "Store Collection Validation Failed", f16_local3 )
	end
end

local f0_local6 = function ( f15_arg0, f15_arg1 )
	local f15_local0 = STORE.Bundles.IsScheduled( f15_arg0, f15_arg1 )
	local f15_local1 = STORE.Bundles.IsAvailable( f15_arg0, f15_arg1 )
	local f15_local2 = STORE.Bundles.IsOwned( f15_arg0, f15_arg1 )
	local f15_local3 = STORE.Bundles.IsBlacklisted( f15_arg0, f15_arg1 )
	local f15_local4
	if f15_local0 and not f15_local1 then
		f15_local4 = f15_local1
	elseif f15_local2 then
		f15_local4 = f15_local2
	else
		f15_local4 = not f15_local3
	end
	return f15_local4
end

local f0_local7 = function ()
	f0_local0()
	return StoreCollection[0xC33D13AB5EC2345][0x8606E8ED5BB39A8]
end

StoreCollection.GetCollection = function ( f13_arg0, f13_arg1 )
	local f13_local0 = STORE.Bundles.BaseSKU( f13_arg1 )
	local f13_local1
	if f13_local0 then
		f13_local1 = f13_local0
	else
		f13_local1 = f13_local0[0x6B65B4278C6C417]
	end
	local f13_local2 = f0_local0()
	return f13_local2[f13_local1]
end

StoreCollection.IsComplete = function ( f12_arg0, f12_arg1 )
	for f12_local3, f12_local4 in ipairs( f12_arg1[0x5A11C2DD9AB8CEC][0x83E236481DF1EE2] ) do
		if not STORE.Bundles.IsOwned( f12_arg0, f12_local4 ) then
			return false
		end
	end
	return true
end

StoreCollection.GetCollectionProgress = function ( f10_arg0, f10_arg1 )
	local f10_local0 = {}
	for f10_local4, f10_local5 in ipairs( f10_arg1[0x5A11C2DD9AB8CEC][0x83E236481DF1EE2] ) do
		if not f0_local0( f10_arg0, f10_local5 ) then
			table.insert( f10_local0, {
				owned = false,
				available = false
			} )
		end
		if STORE.Bundles.IsOwned( f10_arg0, f10_local5 ) then
			table.insert( f10_local0, {
				owned = true,
				available = true
			} )
		else
			table.insert( f10_local0, {
				owned = false,
				available = true
			} )
		end
	end
	table.sort( f10_local0, function ( f11_arg0, f11_arg1 )
		local f11_local0
		if f11_arg0.owned then
			f11_local0 = 2
		else
			f11_local0 = 0
		end
		local f11_local1
		if f11_arg0.available then
			f11_local1 = 1
		else
			f11_local1 = 0
		end
		f11_local0 = f11_local0 + f11_local1
		if f11_arg1.owned then
			f11_local1 = 2
		else
			f11_local1 = 0
		end
		local f11_local2
		if f11_arg1.available then
			f11_local2 = 1
		else
			f11_local2 = 0
		end
		return f11_local1 + f11_local2 < f11_local0
	end )
	return f10_local0
end

StoreCollection.GetBundles = function ( f9_arg0, f9_arg1 )
	local f9_local0 = {}
	for f9_local4, f9_local5 in ipairs( f9_arg1[0x5A11C2DD9AB8CEC][0x83E236481DF1EE2] ) do
		if f0_local0( f9_arg0, f9_local5 ) then
			table.insert( f9_local0, f9_local5 )
		else
			table.insert( f9_local0, StoreLayoutUtils.CustomBundles.ComingSoon )
		end
	end
	return f9_local0
end

StoreCollection.GetOwnership = function ( f8_arg0, f8_arg1 )
	local f8_local0 = {}
	for f8_local4, f8_local5 in ipairs( f8_arg1[0x5A11C2DD9AB8CEC][0x83E236481DF1EE2] ) do
		table.insert( f8_local0, STORE.Bundles.IsOwned( f8_arg0, f8_local5 ) )
	end
	return f8_local0
end

StoreCollection.GetChallengeRef = function ( f7_arg0 )
	local f7_local0 = f7_arg0[0x92AC4FDC8A44D8F]
	if not f7_local0 then
		f7_local0 = ""
	end
	return f7_local0
end

StoreCollection.GetRewardLootID = function ( f6_arg0 )
	local f6_local0 = f6_arg0[0x791A4EABFCC1F99]
	if not f6_local0 then
		f6_local0 = LOOT.emptyID
	end
	return f6_local0
end

StoreCollection.GetRewardLootImage = function ( f5_arg0 )
	local f5_local0 = CoD.PLACEHOLDER_TEXTURE
	if not String.IsNilOrEmpty( f5_arg0[0xB44920215767CA1] ) then
		f5_local0 = f5_arg0[0xB44920215767CA1]
	elseif LOOT.IsValidLootID( f5_arg0[0x791A4EABFCC1F99] ) then
		f5_local0 = LOOT.GetItemImageByID( f5_arg0[0x791A4EABFCC1F99] )
	end
	return f5_local0
end

StoreCollection.GetName = function ( f4_arg0 )
	local f4_local0 = f4_arg0[0x4BCADBA8E631B86]
	if not f4_local0 then
		f4_local0 = 0x0
	end
	return f4_local0
end

StoreCollection.GetIcon = function ( f3_arg0 )
	return f3_arg0[0xBFF4CC56C2092F0]
end

StoreCollection.GetLargeIcon = function ( f2_arg0 )
	return f2_arg0[0x3B783D946B4EE55]
end

StoreCollection.GetColor = function ( f1_arg0 )
	return f1_arg0[0x7F5C18E246C6638]
end

