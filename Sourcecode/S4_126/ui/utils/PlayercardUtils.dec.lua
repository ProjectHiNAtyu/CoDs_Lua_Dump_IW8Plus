-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
PlayercardUtils = PlayercardUtils or {}
PlayercardUtils.PlayerCardModelPath = "frontEnd.MP.conquest.Headquarters.callingCardEditors.smallPlayerCard"
PlayercardUtils.PlayerTitlesEnabled = Dvar[0x9E5BE3B4BBA4E0E]( "#x34c1ffaa68478ddbe" )
local f0_local0 = nil
if Engine[0x2DA54CF5D6B7F02]() and Dvar[0x9E5BE3B4BBA4E0E]( "#x3b3deaa2b951eb6e4" ) then
	PlayercardUtils.PlayerTitlesEnabled = true
	f0_local0 = {
		PlayerTitles = {}
	}
end
PlayercardUtils.GetGridEquippedIndex = function ( f11_arg0 )
	return f11_arg0
end

PlayercardUtils.GetDataEquippedIndex = function ( f10_arg0 )
	return f10_arg0 + 1
end

PlayercardUtils.UpdateSmallPlayerCardData = function ( f9_arg0, f9_arg1 )
	local f9_local0 = PlayercardUtils.GetFrontendDataSources( PlayercardUtils.PlayerCardModelPath, f9_arg1 )
	f9_arg0:SetControllerIndex( f9_arg1 )
	f9_arg0:SetDataSource( f9_local0, f9_arg1 )
end

PlayercardUtils.GetCurrentGridIndex = function ( f8_arg0 )
	assert( f8_arg0 )
	local f8_local0 = f8_arg0.GetFocusPositionIndex
	assert( f8_local0 )
	local f8_local1 = f8_local0( f8_arg0 )
	if f8_local1 then
		return f8_local1 + 1
	else
		
	end
end

PlayercardUtils.GetPlayerTitlesAndIndex = function ( f7_arg0 )
	local f7_local0 = PlayercardUtils.GetAllPlayerTitles( f7_arg0 )
	local f7_local1 = PlayerCustomizationUtils.GetDataSourceForMenu( PlayerCustomizationUtils.MenuTypes.PLAYER_TITLE )
	return f7_local0, LUI.clamp( f7_local1:GetValue( f7_arg0 ), 0, #f7_local0 - 1 )
end

PlayercardUtils.GetAllPlayerTitles = function ( f6_arg0 )
	local f6_local0 = f0_local0
	if f6_local0 then
		f6_local0 = f0_local0.GetAllPlayerTitles
	end
	if f6_local0 then
		return f6_local0()
	else
		return LOOT.GetAllLootType( f6_arg0, LOOT.itemTypes.TITLES, CSV.titles, nil )
	end
end

PlayercardUtils.HasPlayerTitleUnlocked = function ( f5_arg0, f5_arg1 )
	if not PlayercardUtils.PlayerTitlesEnabled then
		return false
	end
	for f5_local3, f5_local4 in pairs( CallingCardUtils.GetAllPlayerCardTitles( f5_arg0 ) ) do
		if f5_local4.hideInUI ~= "1" and f5_local4.isUnlocked then
			return true
		end
	end
	return false
end

PlayercardUtils.GetEquippedPlayerTitle = function ( f4_arg0 )
	local f4_local0 = PlayerCustomizationUtils.GetDataSourceForMenu( PlayerCustomizationUtils.MenuTypes.PLAYER_TITLE )
	return CallingCardUtils.GetTitleText( f4_local0:GetValue( f4_arg0 ) )
end

PlayercardUtils.GetGridContentIndexForTableData = function ( f3_arg0, f3_arg1, f3_arg2, f3_arg3 )
	assert( f3_arg0 )
	local f3_local0 = f3_arg0:GetContentIndex( f3_arg1, f3_arg2, f3_arg3 )
	if not f3_local0 then
		return 
	else
		return f3_local0 + 1
	end
end

PlayercardUtils.GetFrontendDataSources = function ( f1_arg0, f1_arg1 )
	assert( f1_arg0 )
	assert( f1_arg1 )
	local f1_local0 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".fullName" )
	local f1_local1 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".prestige" )
	local f1_local2 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".rank" )
	local f1_local3 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".leaguePlayXP" )
	local f1_local4 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".leaguePlaySD" )
	local f1_local5 = LUI.AggregateDataSource.new( f1_local2, {
		f1_local2,
		f1_local1
	}, "rankIcon", Rank.MakeRankIconAggregateFunction( f1_local2, f1_local1, f1_local3, f1_local4 ) )
	local f1_local6 = LUI.AggregateDataSource.new( f1_local2, {
		f1_local2,
		f1_local1
	}, "display", Rank.MakeRankDisplayAggregateFunction( f1_local2, f1_local1, f1_local3, f1_local4 ) )
	local f1_local7 = f1_local1:Filter( "isMasterPrestige", Rank.IsMasterPrestige )
	local f1_local8 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".customEmblemEquipped" )
	local f1_local9 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".emblemIndex" )
	local f1_local10 = LUI.FilteredDataSource.new( f1_local9, "emblem", function ( f2_arg0, f2_arg1 )
		return StringTable[0x2DCF0973239E909]( CSV.emblems.file, CSV.emblems.cols.index, f2_arg0, CSV.emblems.cols.image )
	end )
	local f1_local11 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".emblemType" )
	f1_local11:SetValue( f1_arg1, Engine[0xCFB24E159372CA1]( f1_arg1 ) )
	local f1_local12 = {
		backgroundColorId = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".emblemData.backgroundColorId" ),
		backgroundShapeId = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".emblemData.backgroundShapeId" ),
		foregroundColorId = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".emblemData.foregroundColorId" ),
		foregroundShapeId = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".emblemData.foregroundShapeId" )
	}
	if CLANS.IsInClan( f1_arg1 ) then
		local f1_local13 = Clans[0x2D84BBDDAB24F9]( f1_arg1, Clans[0x43F567012B7061]( f1_arg1 ) )
		f1_local12.backgroundColorId:SetValue( f1_arg1, f1_local13.backgroundColorId )
		f1_local12.backgroundShapeId:SetValue( f1_arg1, f1_local13.backgroundShapeId )
		f1_local12.foregroundColorId:SetValue( f1_arg1, f1_local13.foregroundColorId )
		f1_local12.foregroundShapeId:SetValue( f1_arg1, f1_local13.foregroundShapeId )
	end
	local f1_local13 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".backgroundIndex" )
	local f1_local14 = f1_local13:Filter( "background", CallingCardUtils.GetCardTexture )
	local f1_local15 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".frameIndex" )
	local f1_local16 = f1_local15:Filter( "frame", CallingCardUtils.GetFrameTexture )
	local f1_local17 = Engine[0x29DFACECF20DE0E]( f1_arg1 )
	local f1_local18 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".xuid", f1_local17 )
	f1_local18:SetValue( f1_arg1, f1_local17 )
	local f1_local19 = LUI.DataSourceInControllerModel.new( f1_arg0 .. ".titleIndex" )
	return {
		xuid = f1_local18,
		fullName = f1_local0,
		displayRank = f1_local6,
		rankIcon = f1_local5,
		rank = f1_local2,
		isMasterPrestige = f1_local7,
		emblemIndex = f1_local9,
		emblem = f1_local10,
		emblemType = f1_local11,
		emblemData = f1_local12,
		customEmblemEquipped = f1_local8,
		prestige = f1_local1,
		backgroundIndex = f1_local13,
		background = f1_local14,
		frame = f1_local16,
		frameIndex = f1_local15,
		title = f1_local19:Filter( "title", CallingCardUtils.GetTitleText )
	}
end

