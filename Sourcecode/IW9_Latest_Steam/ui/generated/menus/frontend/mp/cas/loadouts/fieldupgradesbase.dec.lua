-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:48
module( ..., package.seeall )
if Engine[0x12586A3F4FB490E]() then
	LUI.FlowManager.RegisterFenceGroup( "FieldUpgrades", {
		nil,
		"StatsGroup"
	} )
end
local f0_local0 = 150
local f0_local1 = f0_local0 + 50
local f0_local2 = function ( f57_arg0 )
	local f57_local0 = f57_arg0.upgrades[SUPER.Slot.LEFT]
	f57_arg0.upgrades[SUPER.Slot.LEFT] = f57_arg0.upgrades[SUPER.Slot.RIGHT]
	f57_arg0.upgrades[SUPER.Slot.RIGHT] = f57_local0
end

local f0_local3 = function ( f56_arg0, f56_arg1 )
	for f56_local3, f56_local4 in pairs( f56_arg0.upgrades ) do
		if f56_local4.ref == f56_arg1 then
			return f56_local4.isActive
		end
	end
	return false
end

local f0_local4 = function ( f55_arg0, f55_arg1 )
	local f55_local0 = false
	local f55_local1 = false
	for f55_local5, f55_local6 in ipairs( f55_arg0.upgrades ) do
		if f55_arg1 == f55_local6.ref then
			f55_local0 = true
			if f55_local6.isActive then
				f55_local1 = true
				break
			end
		end
	end
	return f55_local0, f55_local1
end

local f0_local5 = function ( f54_arg0, f54_arg1, f54_arg2 )
	local f54_local0 = ONBOARDING_DATA.GetOnboardingProFieldUpgradeData()
	local f54_local1
	if f54_arg2 then
		f54_local1 = 0
	else
		f54_local1 = f54_local0.waitTime
	end
	f54_local0.waitTime = f54_local1
	LUI.FlowManager.RequestPopupMenu( f54_arg0, "onboardingfeaturepopup", true, f54_arg1, false, f54_local0 )
end

local f0_local6 = function ( f53_arg0, f53_arg1 )
	local f53_local0 = f53_arg0._currentRef
	f53_arg0.FieldUpgradesGrid:RefreshContent()
	if Engine[0x12586A3F4FB490E]() and not Onboarding.FieldUpgrade.WasCompleted( f53_arg0, f53_arg1 ) then
		LUI.FlowManager.RequestPopupMenu( f53_arg0, "onboardingpopup", true, f53_arg1, false, ONBOARDING_DATA.GetOnboardingFieldUpgradeData() )
		Onboarding.FieldUpgrade.MarkCompleted( f53_arg0, f53_arg1 )
	end
end

local f0_local7 = function ( f52_arg0, f52_arg1, f52_arg2, f52_arg3, f52_arg4 )
	local f52_local0 = {
		displayTime = 2000,
		icon = f52_arg2,
		header = f52_arg3
	}
	local f52_local1
	if f52_arg4 then
		f52_local1 = Engine[0xED84C33EC5F01EA]( f52_arg4 )
		if not f52_local1 then
		
		else
			f52_local0.description = f52_local1
			f52_local0.type = LUI.ToastManager.NotificationType.FieldUpgradeMenu
			f52_local0.controllerIndex = f52_arg1
			f52_arg0:dispatchEventToRoot( {
				name = "send_toast_notification",
				immediate = true,
				options = f52_local0
			} )
		end
	end
	f52_local1 = nil
end

local f0_local8 = function ( f51_arg0, f51_arg1 )
	if DMZ.IsInstanceInventoryEnabledFrontend() then
		DMZ.SetEquippedInstanceFieldUpgrade( f51_arg1, f51_arg0.upgrades[SUPER.Slot.LEFT].ref )
	else
		f51_arg0._loadoutData.fieldUpgrades[0]:set( f51_arg0.upgrades[SUPER.Slot.LEFT].ref )
		f51_arg0._loadoutData.fieldUpgrades[1]:set( f51_arg0.upgrades[SUPER.Slot.RIGHT].ref )
		ACTIONS.UploadStats( f51_arg0, f51_arg1 )
	end
end

local f0_local9 = function ( f50_arg0, f50_arg1 )
	if f50_arg0.upgrades[SUPER.Slot.LEFT].ref == SUPER.superNoneValue then
		f0_local0( f50_arg0 )
	end
	if not CoD.IsDMZMatch() then
		assert( f50_arg0.upgrades[SUPER.Slot.LEFT].ref ~= SUPER.superNoneValue )
	end
	f0_local0( f50_arg0, f50_arg1 )
	local f50_local0 = LUI.DataSourceInControllerModel.new( "cg.players.selectedLoadout" )
	if not Engine[0x12586A3F4FB490E]() and f50_local0:GetValue( f50_arg1 ) then
		Engine[0x6055C55456F05DF]( "class_edit", f50_local0:GetValue( f50_arg1 ) )
	end
end

local f0_local10 = function ( f49_arg0, f49_arg1 )
	local f49_local0 = {}
	for f49_local4, f49_local5 in ipairs( SUPER.GetAllFieldUpgrades( f49_arg1 ) ) do
		if not (MatchRules[0xFB2C9897F2DED4D]( f49_local5.ref ) and (not f49_arg0.upgrades or f49_local5.ref ~= f49_arg0.upgrades[SUPER.Slot.LEFT].ref)) or f49_arg0.upgrades and f49_local5.ref == f49_arg0.upgrades[SUPER.Slot.RIGHT].ref then
			table.insert( f49_local0, f49_local5 )
		end
	end
	return f49_local0
end

local f0_local11 = nil
local f0_local12 = function ( f47_arg0, f47_arg1, f47_arg2 )
	local f47_local0, f47_local1 = f0_local0( f47_arg0, f47_arg1.ref )
	local f47_local2 = f47_arg0.upgrades[f47_arg0._slotInUse].ref
	local f47_local3 = function ( f48_arg0 )
		f47_arg0.upgrades[f48_arg0].ref = f47_arg0
		f47_arg0.upgrades[f48_arg0].isActive = true
		f47_arg0.upgrades[f48_arg0].button = f47_arg0
		f47_arg0( f47_arg0, f47_arg0, SUPER.GetImage( f47_arg0 ), Engine[0xED84C33EC5F01EA]( 0xA6801A3F9D49BD6 ), SUPER.GetNameUnlocalized( f47_arg0 ) )
		local f48_local0 = nil
		if f48_arg0 == SUPER.Slot.LEFT then
			f48_local0 = f47_arg0.FieldUpgrade1
		else
			f48_local0 = f47_arg0.FieldUpgrade2
			f47_arg0.FieldUpgrade2:SetEmpty( false )
		end
		f48_local0:SetImage( SUPER.GetImage( f47_arg0 ) )
		f48_local0:SetHeaderText( SUPER.GetName( f47_arg0 ) )
		f48_local0:SetRestricted( MatchRules[0xFB2C9897F2DED4D]( f47_arg0 ) )
		if CONDITIONS.IsSplitscreen() then
			ACTIONS.AnimateSequence( f47_arg0, "HideGrid_Splitscreen" )
		else
			ACTIONS.AnimateSequence( f47_arg0, "HideGrid" )
		end
		f47_arg0.HorizontalMinimalScrollbar:SetMouseFocusBlockerForAllChildren( true )
		f47_arg0.SideArrows:SetMouseFocusBlocker( true )
		ACTIONS.AnimateSequence( f47_arg0, "AllFUFocused" )
		f47_arg0.FieldUpgradesGrid:SetMouseFocusBlocker( true )
		f47_arg0.FieldUpgradesGrid:processEvent( {
			name = "lose_focus"
		} )
		f48_local0:processEvent( {
			name = "gain_focus"
		} )
		LOOT.SendDlogLootEquipped( f47_arg0, LOOT.itemTypes.SUPER, nil, nil, f47_arg0, f47_arg0 )
		f47_arg0._gridOpen = false
	end
	
	f47_local3( f47_arg0._slotInUse )
	if MatchRules[0xFB2C9897F2DED4D]( f47_local2 ) then
		f47_arg0._allFieldUpgrades = f0_local0( f47_arg0, f47_arg2 )
		f0_local0( f47_arg0, f47_arg2 )
	end
	f0_local0( f47_arg0, f47_arg2 )
	f47_local3 = LUI.FlowManager.GetScopedData( f47_arg0 )
	if CoD.IsDMZMatch() or f47_local3.openedFromScriptRequest and f47_arg0.proMode ~= SUPER.ProMode.ENABLED then
		ACTIONS.LeaveMenu()
	end
end

local f0_local13 = function ( f45_arg0, f45_arg1 )
	assert( f45_arg0.FadeCover )
	local f45_local0 = f0_local0
	if not f45_arg0._prevImage then
		f45_local0 = 0
	end
	f45_arg0.FadeCover:SetAlpha( 1, f45_local0, LUI.EASING.inQuadratic )
	local f45_local1 = f45_arg0.FadeCover:Wait( f45_local0, true )
	f45_local1.onComplete = function ()
		if f45_arg0 ~= SUPER.superNoneValue then
			assert( f45_arg0.Showcase )
			f45_arg0.Showcase:setImage( RegisterMaterial( SUPER.GetFullImage( f45_arg0 ) ) )
			f45_arg0.FadeCover:SetAlpha( 0, f45_arg0, LUI.EASING.outQuadratic )
			f45_arg0.Showcase:SetScale( f45_arg0.Showcase.aspectRatioScaleAdjust or 0, 0 )
			f45_arg0.Showcase:SetScale( (f45_arg0.Showcase.aspectRatioScaleAdjust or 0) + 0.015, 2500, LUI.EASING.outQuadratic )
			f45_arg0._prevImage = SUPER.GetFullImage( f45_arg0 )
		end
	end
	
end

local f0_local14 = function ( f44_arg0, f44_arg1, f44_arg2, f44_arg3 )
	local f44_local0 = SUPER.GetFieldUpgradeDetails( f44_arg1, f44_arg2 )
	if f44_arg3 and f44_arg3.unlockSubLocation and 0 <= f44_arg3.unlockSubLocation then
		f44_local0.unlockCriteria = Engine[0xED84C33EC5F01EA]( 0x69BCC09828D8A29 )
	end
	if f44_arg0.UpdateDetailsDataSources then
		f44_arg0:UpdateDetailsDataSources( f44_arg1, f44_local0 )
	else
		f44_local0.isEquipped = f0_local0( f44_arg0, f44_arg2 )
		f44_arg0.ItemDetails:UpdateDetails( f44_local0 )
	end
end

local f0_local15 = function ( f43_arg0, f43_arg1, f43_arg2 )
	local f43_local0 = f43_arg0._currentRef
	if f43_arg0.CDLRestricted then
		if MLG.IsCDLActive( f43_arg1 ) and MatchRules[0xFB2C9897F2DED4D]( f43_local0 ) then
			f43_arg0.CDLRestricted:SetAlpha( 1 )
		else
			f43_arg0.CDLRestricted:SetAlpha( 0 )
		end
	end
	f0_local0( f43_arg0, f43_arg1, f43_local0, f43_arg2 )
	if Engine[0x12586A3F4FB490E]() then
		f0_local0( f43_arg0, f43_local0 )
	end
end

f0_local11 = function ( f32_arg0, f32_arg1, f32_arg2 )
	local f32_local0 = f32_arg0.FieldUpgradesGrid
	local f32_local1 = function ( f38_arg0, f38_arg1, f38_arg2 )
		local f38_local0 = f38_arg1 + f38_arg2 * f32_arg0:GetNumColumns()
		local f38_local1 = f32_arg0._allFieldUpgrades[f38_local0 + 1]
		local f38_local2 = f38_local1.ref
		local f38_local3 = f38_arg0.Button
		f38_local3.ref = f38_local2
		f38_local3:SetDisabled( false )
		local f38_local4 = function ( f40_arg0, f40_arg1 )
			if not f40_arg0.disabled then
				if CONDITIONS.InFrontend() and CONDITIONS.IsDMZMatch() then
					local f40_local0 = f38_arg0.upgrades[f38_arg0._slotInUse].ref
					if SUPER.GetHideInDMZ( f38_arg0, f40_local0 ) and f40_local0 ~= SUPER.superNoneValue then
						LUI.FlowManager.RequestPopupMenu( nil, "FullScreenWarningPopUp", false, f38_arg0, false, {
							headerText = Engine[0xEB2A2834B76AEA4]( Engine[0xED84C33EC5F01EA]( 0xA39321EBD504346 ) ),
							desc = Engine[0xED84C33EC5F01EA]( 0x1CDF1E592058B8E, SUPER.GetName( f40_local0 ) ),
							changeButtonText = Engine[0xEB2A2834B76AEA4]( Engine[0xED84C33EC5F01EA]( 0x8FAE58C32A5A2DE ) ),
							changeCallback = function ( f42_arg0, f42_arg1 )
								LUI.FlowManager.RequestLeaveMenu( f42_arg0 )
							end,
							confirmButtonText = Engine[0xEB2A2834B76AEA4]( Engine[0xED84C33EC5F01EA]( 0x11A42B3B7868280 ) ),
							confirmCallback = function ( f41_arg0, f41_arg1 )
								LUI.FlowManager.RequestLeaveMenu( f41_arg0, true )
								f40_arg0( f40_arg0, f40_arg0, f40_arg0 )
							end
						}, nil, false, false )
						return 
					end
				end
				f38_arg0( f38_arg0, f40_arg0, f38_arg0 )
				return true
			else
				
			end
		end
		
		local f38_local5 = function ( f39_arg0, f39_arg1 )
			f38_arg0._currentRef = f39_arg0.data.ref
			if f38_arg0._currentRef then
				f38_arg0( f38_arg0, f38_arg0, f39_arg0.data )
			end
		end
		
		if not f38_local3._handlersAdded then
			f38_local3:registerEventHandler( "button_action", f38_local4 )
			f38_local3:addEventHandler( "button_over", f38_local5 )
			f38_local3:addEventHandler( "button_over_disable", f38_local5 )
			f38_local3._handlersAdded = true
		end
		local f38_local6 = MatchRules[0xFB2C9897F2DED4D]( f38_local2 )
		if f38_local6 then
			f38_local6 = not CONDITIONS.IsMagmaGameMode()
		end
		local f38_local7 = false
		if CoD.IsDMZMatch() and f38_local1.unlockSubLocation and 0 <= f38_local1.unlockSubLocation then
			f38_local7 = DMZ.IsUpgradeUnlocked( f38_local1.unlockSubLocation )
		else
			local f38_local8 = PROGRESSION.IsUnlocked( f32_arg0, LOOT.itemTypes.SUPER, f38_local2 )
			if f38_local8 then
				f38_local7 = f38_local8
			else
				f38_local7 = not f38_local6
			end
		end
		local f38_local8 = f32_arg0( f32_arg0, f38_local2 )
		local f38_local9 = LOOT.GetItemID( f38_local2 )
		local f38_local10 = CONDITIONS.IsMobileOrMobileSim()
		if f38_local10 then
			if LUI.IsItemInArray( LOOT.mobileComingSoonItemIds, f38_local9 ) ~= nil then
				f38_local10 = not Dvar[0x9E5BE3B4BBA4E0E]( 0x400E64D176DA3A4 )
			else
				f38_local10 = false
			end
		end
		local f38_local11 = {
			removeTextBacker = true,
			smallerFontForGamepad = true,
			imageSize = "1x1",
			buttonData = f32_arg0._allFieldUpgrades[f38_local0 + 1],
			isComingSoon = f38_local10
		}
		f38_local11.buttonData.image = f32_arg0._allFieldUpgrades[f38_local0 + 1].superBundle[0xAB612888528489A]
		f38_local11.buttonData.header = f32_arg0._allFieldUpgrades[f38_local0 + 1].superBundle[0x4BCADBA8E631B86]
		f38_local11.buttonData.isUnlocked = f38_local7
		f38_local3:SetupButton( f38_local11 )
		f38_local3:SetEquipped( f38_local8 )
		f38_local3:SetRestricted( f38_local6 )
		f38_local3:SetPrimaryPromptText( 0xCA07A93FADF9E95 )
		if f38_arg0.SetDisabled then
			local f38_local12 = f38_arg0
			local f38_local13 = f38_arg0.SetDisabled
			local f38_local14
			if f38_local7 then
				f38_local14 = f38_local10
			else
				f38_local14 = true
			end
			f38_local13( f38_local12, f38_local14 )
		else
			local f38_local12 = f38_local3
			local f38_local13 = f38_local3.SetDisabled
			local f38_local14
			if f38_local7 then
				f38_local14 = f38_local10
			else
				f38_local14 = true
			end
			f38_local13( f38_local12, f38_local14 )
		end
		if f38_local8 and f38_local2 == f32_arg0.upgrades[SUPER.Slot.LEFT].ref then
			f32_arg0.upgrades[SUPER.Slot.LEFT].button = f38_local3
			if f32_arg0._slotInUse ~= SUPER.Slot.LEFT then
				f38_local3:SetDisabled( true )
				f38_local3:SetPrimaryPromptText( 0xC9E9B620BF2E623 )
			end
		elseif f38_local8 then
			f32_arg0.upgrades[SUPER.Slot.RIGHT].button = f38_local3
			if f32_arg0._slotInUse ~= SUPER.Slot.RIGHT then
				f38_local3:SetDisabled( true )
				f38_local3:SetPrimaryPromptText( 0xC9E9C620BF2E7D6 )
			end
		end
		if f38_arg0.InventoryQuantity then
			f38_arg0.InventoryQuantity:Setup( f32_arg0._allFieldUpgrades[f38_local0 + 1].quantity )
		end
	end
	
	local f32_local2 = function ()
		local f37_local0 = 1
		for f37_local4, f37_local5 in ipairs( f32_arg0._allFieldUpgrades ) do
			local f37_local6 = f37_local5.ref
			local f37_local7 = f32_arg0.upgrades
			local f37_local8 = f32_arg0._slotInUse
			local f37_local9 = f32_arg0._slotInUse
			if f37_local6 == f37_local7[f37_local8 and f32_arg0._slotInUse or SUPER.Slot.LEFT].ref then
				f37_local0 = f37_local4
				break
			end
		end
		return f32_arg0:GetPositionForIndex( f37_local0 - 1, {
			relativePosition = false
		} )
	end
	
	local f32_local3 = math.min( #f32_arg0._allFieldUpgrades, f32_arg0._defaultMaxVisibleColumns )
	local f32_local4 = #f32_arg0._allFieldUpgrades
	f32_local0:SetMaxVisibleColumns( f32_local3 )
	f32_local0:SetNumChildren( f32_local4 )
	local f32_local5 = f32_local2()
	f32_local0:SetPosition( {
		y = 0,
		x = f32_local5.x or 0
	}, true )
	f32_local0:SetDefaultFocus( f32_local2 )
	f32_local0:TouchMouseSetActiveToDefaultFocusMenuCreate( f32_arg1 )
	f32_local0:SetRefreshChild( f32_local1 )
	if not f32_arg2 then
		f32_arg0:addEventHandler( "menu_create", function ()
			f32_arg0:RefreshContent()
			f32_arg0:processEvent( {
				name = "lose_focus"
			} )
			f32_arg0.FieldUpgrade1:processEvent( {
				name = "gain_focus"
			} )
		end )
		f32_local0:processEvent( {
			name = "lose_focus"
		} )
		f32_arg0.FieldUpgrade1:processEvent( {
			name = "gain_focus"
		} )
	end
	f32_local0:SetSnapOnScrollBarMouseDrag( true )
	local f32_local6 = f32_arg0.SideArrows
	local f32_local7 = f32_arg0.MouseArea
	if f32_local0 and f32_local6 and f32_local7 then
		f32_local6:SetupSideButtons( f32_local0, f32_local4 )
		f32_local6:UpdateSideButtons()
		f32_local0:addEventHandler( "gamepad_button", function ( f35_arg0, f35_arg1 )
			if f32_arg0 and CONDITIONS.IsMouseWheelEvent( f35_arg1 ) and f35_arg1.down then
				return f32_arg0:ExternalScroll( f35_arg1 )
			else
				
			end
		end )
		f32_local0._onNewTargetFocusPosition = function ( f34_arg0, f34_arg1 )
			if f32_arg0 then
				f32_arg0:AddScrollWatch()
			end
		end
		
		f32_arg0:SubscribeToInputTypeModel( f32_arg1, function ( f33_arg0, f33_arg1 )
			if not LUI.IsLastInputMouseNavigation( f32_arg0 ) then
				if f33_arg1._gridOpen then
					ACTIONS.GainFocus( f33_arg1, f33_arg1.FieldUpgradesGrid.id, f32_arg0 )
				else
					ACTIONS.GainFocus( f33_arg1, f33_arg1.FieldUpgrade1.id, f32_arg0 )
				end
			end
		end )
		f32_local0:SetMouseScrollArea( f32_local7 )
	end
end

local f0_local16 = function ( f31_arg0, f31_arg1 )
	local f31_local0 = f31_arg0.upgrades[SUPER.Slot.RIGHT].ref
	f31_arg0.upgrades[SUPER.Slot.RIGHT].ref = SUPER.superNoneValue
	f31_arg0.FieldUpgrade2:SetHeaderText( SUPER.GetName( f31_arg0.upgrades[SUPER.Slot.RIGHT].ref ) )
	f31_arg0.FieldUpgrade2:SetImage( SUPER.GetImage( f31_arg0.upgrades[SUPER.Slot.RIGHT].ref ) )
	f31_arg0.FieldUpgrade2:SetEmpty( true )
	f31_arg0.FieldUpgrade2.ButtonHighlight:ClearSecondaryPrompt()
	f31_arg0.FieldUpgrade2.ButtonHighlight:UpdatePromptVisibility( f31_arg1 )
	LOOT.SendDlogLootEquipped( f31_arg1, LOOT.itemTypes.SUPER, nil, nil, f31_local0, SUPER.superNoneValue )
	f0_local0( f31_arg0, f31_arg1 )
	f0_local0( f31_arg0, f31_arg1 )
end

local f0_local17 = function ( f28_arg0, f28_arg1 )
	local f28_local0 = PROGRESSION.GetPlayerRank( f28_arg1 )
	local f28_local1 = false
	f28_arg0.proMode = SUPER.ProMode.DISABLED
	if CONDITIONS.AreRestrictionsActive() or CoD.IsDMZMatch() then
		f28_arg0._proModeAvailable = false
	else
		local f28_local2 = PROGRESSION.IsUnlocked( f28_arg1, LOOT.itemTypes.FEATURE, LOOT.fieldUpgradeProRef )
		if not f28_local2 then
			f28_local2 = CONDITIONS.IsDevelopmentBuild()
		end
		f28_arg0._proModeAvailable = f28_local2
	end
	if CONDITIONS.AreRestrictionsActive() then
		f28_arg0._proModeUnlockText = Engine[0xED84C33EC5F01EA]( 0x29F2EDBE9428982 )
	else
		f28_arg0._proModeUnlockText = PROGRESSION.GetUnlockText( LOOT.itemTypes.FEATURE, LOOT.fieldUpgradeProRef ) or ""
	end
	f28_arg0:AddGamepadEventCallback( "button_alt1", function ( f30_arg0, f30_arg1 )
		if f30_arg0.FieldUpgrade2._isFocused then
			Engine[0xC4146BA76D0F982]( f28_arg0.FieldUpgrade2.ButtonHighlight.SecondaryButton.actionSFX )
			f28_arg0( f30_arg0, f28_arg0 )
		end
	end )
	local f28_local2 = {
		localizeHeader = false,
		removeTextBacker = true,
		hasEmptyState = true,
		removeEquipBanner = true,
		buttonSize = "LargeTall",
		imageSize = "1x1",
		buttonData = {
			header = nil,
			image = SUPER.GetImage( f28_arg0.upgrades[SUPER.Slot.RIGHT].ref )
		},
		doubleAction = {
			text = 0xF45C394F4B8A31F,
			prompt = 0x21E44BE45534168,
			callback = function ()
				f28_arg0.FieldUpgrade2.ButtonHighlight.PrimaryButton:setFocus( true )
				return f28_arg0( f28_arg0, f28_arg0 )
			end
		}
	}
	if f28_arg0._proModeAvailable then
		f28_arg0.proMode = SUPER.ProMode.ENABLED
		f28_local1 = true
		f28_arg0.FieldUpgrade2:SetDisabled( false )
		f28_local2.buttonData.header = SUPER.GetName( f28_arg0.upgrades[SUPER.Slot.RIGHT].ref )
		f28_arg0.FieldUpgrade2:SetEmpty( f28_arg0.upgrades[SUPER.Slot.RIGHT].ref == SUPER.superNoneValue )
	else
		f28_arg0.upgrades[SUPER.Slot.RIGHT].ref = SUPER.superNoneValue
		f28_arg0.FieldUpgrade2:SetDisabled( true )
		f28_arg0.FieldUpgrade2:SetEmpty( true )
		f28_local2.buttonData.header = f28_arg0._proModeUnlockText
	end
	f28_arg0.FieldUpgrade2:SetupButton( f28_local2 )
	f28_arg0.FieldUpgrade2:SetRestricted( MatchRules[0xFB2C9897F2DED4D]( f28_arg0.upgrades[SUPER.Slot.RIGHT].ref ) )
	f28_arg0.FieldUpgrade2:SetPrimaryPromptText( 0xAA4B3526A3C0AC4 )
	f28_arg0.FieldUpgrade2.ButtonHighlight.SecondaryButton:setActionSFX( SOUND_SETS.default.selectAlt )
end

local f0_local18 = function ( f27_arg0 )
	if DMZ.IsInstanceInventoryEnabledFrontend() then
		f27_arg0.upgrades = {
			[SUPER.Slot.LEFT] = {
				isActive = true,
				ref = DMZ.GetEquippedInstanceFieldUpgradeRef()
			},
			[SUPER.Slot.RIGHT] = {
				isActive = false,
				ref = "none"
			}
		}
	else
		f27_arg0.upgrades = {
			[SUPER.Slot.LEFT] = {
				isActive = true,
				ref = f27_arg0._loadoutData.fieldUpgrades[0]:get()
			},
			[SUPER.Slot.RIGHT] = {
				isActive = true,
				ref = f27_arg0._loadoutData.fieldUpgrades[1]:get()
			}
		}
	end
end

local f0_local19 = function ( f26_arg0, f26_arg1 )
	if CONDITIONS.IsSplitscreen() then
		ACTIONS.AnimateSequence( f26_arg0, "ShowGrid_Splitscreen" )
	else
		ACTIONS.AnimateSequence( f26_arg0, "ShowGrid" )
	end
	f26_arg0.HorizontalMinimalScrollbar:SetMouseFocusBlockerForAllChildren( false )
	f26_arg0.SideArrows:SetMouseFocusBlocker( false )
	f26_arg1:processEvent( {
		name = "lose_focus"
	} )
	f26_arg0.FieldUpgradesGrid:processEvent( {
		name = "gain_focus"
	} )
	f26_arg0.FieldUpgradesGrid:SetMouseFocusBlocker( false )
	f26_arg0._gridOpen = true
end

local f0_local20 = function ( f25_arg0, f25_arg1, f25_arg2, f25_arg3 )
	f25_arg0._slotInUse = f25_arg2
	ACTIONS.AnimateSequence( f25_arg0, f25_arg3 )
	f25_arg0.FieldUpgradesGrid:RefreshContent()
	f0_local0( f25_arg0, f25_arg1 )
end

local f0_local21 = function ( f24_arg0, f24_arg1 )
	f24_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0x3DE7DE0C6E455AF ) )
	f24_arg0.MenuTitle:SetupBackButton( f24_arg1 )
end

local f0_local22 = function ( f23_arg0 )
	if CONDITIONS.IsSplitscreen() then
		f23_arg0.FieldUpgradesGrid:SetMask( f23_arg0.SplitscreenGridMask )
		f23_arg0.FieldUpgradesGrid:SetMaxVisibleColumns( 6 )
		ACTIONS.AnimateSequence( f23_arg0, "HideGrid_Splitscreen" )
	else
		ACTIONS.AnimateSequence( f23_arg0, "HideGrid" )
	end
end

local f0_local23 = function ( f22_arg0 )
	f22_arg0.FieldUpgrade1:SetupButton( {
		removeTextBacker = true,
		removeEquipBanner = true,
		buttonSize = "LargeTall",
		imageSize = "1x1",
		buttonData = {
			image = SUPER.GetImage( f22_arg0.upgrades[SUPER.Slot.LEFT].ref ),
			header = SUPER.GetNameUnlocalized( f22_arg0.upgrades[SUPER.Slot.LEFT].ref )
		}
	} )
	f22_arg0.FieldUpgrade1:SetRestricted( MatchRules[0xFB2C9897F2DED4D]( f22_arg0.upgrades[SUPER.Slot.LEFT].ref ) )
	f22_arg0.FieldUpgrade1:SetPrimaryPromptText( 0xAA4B3526A3C0AC4 )
end

local f0_local24 = function ( f17_arg0, f17_arg1 )
	if f17_arg0.FieldUpgrade2 then
		f17_arg0.FieldUpgrade1.navigation = {
			right = f17_arg0.FieldUpgrade2
		}
		f17_arg0.FieldUpgrade2.navigation = {
			left = f17_arg0.FieldUpgrade1
		}
		f17_arg0.FieldUpgrade2:addEventHandler( "button_action", function ( f21_arg0, f21_arg1 )
			f17_arg0( f17_arg0, f21_arg0, SUPER.Slot.RIGHT, "FU1Unfocused" )
		end )
		f17_arg0.FieldUpgrade2:addEventHandler( "button_over", function ( f19_arg0, f19_arg1 )
			f17_arg0._isFocused = true
			if f17_arg0.upgrades[SUPER.Slot.RIGHT].ref ~= SUPER.superNoneValue then
				local f19_local0 = {
					text = 0xF45C394F4B8A31F,
					prompt = 0x21E44BE45534168,
					callback = function ()
						f19_arg0.FieldUpgrade2.ButtonHighlight.PrimaryButton:setFocus( true )
						return f19_arg0( f19_arg0, f19_arg0 )
					end
				}
				f17_arg0.FieldUpgrade2.ButtonHighlight:SetSecondaryPrompt( f19_local0.prompt, f19_local0.text, f19_local0.callback )
				f17_arg0._currentRef = f17_arg0.upgrades[SUPER.Slot.RIGHT].ref
				f17_arg0( f17_arg0, f17_arg0 )
			else
				f17_arg0.FieldUpgrade2.ButtonHighlight:ClearSecondaryPrompt()
				f17_arg0( f17_arg0, f17_arg0 )
			end
		end )
		f17_arg0.FieldUpgrade2:addEventHandler( "button_up", function ( f18_arg0, f18_arg1 )
			f17_arg0._isFocused = false
		end )
		f0_local0( f17_arg0, f17_arg1 )
	end
end

local f0_local25 = function ( f14_arg0, f14_arg1, f14_arg2 )
	if f14_arg2 then
		f0_local0( f14_arg0, f14_arg1, f14_arg2 )
		f14_arg0._slotInUse = SUPER.Slot.LEFT
		f14_arg0.FieldUpgradesGrid:RefreshContent()
		f14_arg0._gridOpen = true
		ACTIONS.AnimateSequence( f14_arg0, "ShowGridDMZ" )
		f14_arg0.HorizontalMinimalScrollbar:SetMouseFocusBlockerForAllChildren( false )
		f14_arg0.SideArrows:SetMouseFocusBlocker( false )
		f14_arg0.FieldUpgrade1:processEvent( {
			name = "lose_focus"
		} )
		f14_arg0.FieldUpgradesGrid:processEvent( {
			name = "gain_focus"
		} )
		f14_arg0.FieldUpgradesGrid:SetMouseFocusBlocker( false )
	else
		f14_arg0.FieldUpgradesGrid:SetMouseFocusBlocker( true )
		f14_arg0.FieldUpgrade1:addEventHandler( "button_action", function ( f16_arg0, f16_arg1 )
			f14_arg0( f14_arg0, f16_arg0, SUPER.Slot.LEFT, "FU2Unfocused" )
		end )
		f14_arg0.FieldUpgrade1:addEventHandler( "button_over", function ( f15_arg0, f15_arg1 )
			f14_arg0._currentRef = f14_arg0.upgrades[SUPER.Slot.LEFT].ref
			f14_arg0( f14_arg0, f14_arg0 )
		end )
		f0_local0( f14_arg0, f14_arg1 )
	end
end

local f0_local26 = function ( f12_arg0, f12_arg1 )
	f12_arg0:addEventHandler( "menu_close", function ( f13_arg0, f13_arg1 )
		f12_arg0( f12_arg0, f12_arg0 )
		if Engine[0x12586A3F4FB490E]() then
			Engine[0x3DACD106DDC0D71]()
		end
	end )
end

local f0_local27 = function ( f10_arg0 )
	if not Engine[0x12586A3F4FB490E]() then
		f10_arg0:AddGamepadEventCallback( "button_start", function ( f11_arg0, f11_arg1 )
			LUI.FlowManager.RequestCloseAllMenus( f11_arg0.id, false, f11_arg1.controller )
			return true
		end )
		MenuUtils.AddDismissPauseMenuKBMHandler( f10_arg0 )
	end
end

local f0_local28 = function ( f7_arg0, f7_arg1 )
	if Engine[0x12586A3F4FB490E]() then
		local f7_local0 = function ( f9_arg0, f9_arg1 )
			if not Onboarding.ProFieldUpgrade.WasCompleted( f9_arg0, f9_arg1 ) then
				f7_arg0( f9_arg0, f9_arg1 )
				Onboarding.ProFieldUpgrade.MarkCompleted( f9_arg0, f9_arg1 )
			end
		end
		
		if not Onboarding.FieldUpgrade.WasCompleted( f7_arg0, f7_arg1 ) then
			local f7_local1 = ONBOARDING_DATA.GetOnboardingFieldUpgradeData()
			if f7_arg0._proModeAvailable then
				f7_local1.confirmButton.action = function ( f8_arg0, f8_arg1 )
					ACTIONS.LeaveMenu( f8_arg0 )
					f7_arg0( f8_arg0, f8_arg1 )
				end
				
			end
			LUI.FlowManager.RequestPopupMenu( f7_arg0, "onboardingpopup", true, f7_arg1, false, f7_local1 )
			Onboarding.FieldUpgrade.MarkCompleted( f7_arg0, f7_arg1 )
		elseif f7_arg0._proModeAvailable then
			f7_local0( f7_arg0, f7_arg1 )
		end
	end
end

local f0_local29 = function ( f5_arg0, f5_arg1 )
	f5_arg0:AddGamepadEventCallback( "button_secondary", function ( f6_arg0, f6_arg1 )
		if f6_arg0._gridOpen and not f6_arg1.fromMenuTitle and not f5_arg0 then
			if CONDITIONS.IsSplitscreen() then
				ACTIONS.AnimateSequence( f6_arg0, "HideGrid_Splitscreen" )
			else
				ACTIONS.AnimateSequence( f6_arg0, "HideGrid" )
			end
			f6_arg0.HorizontalMinimalScrollbar:SetMouseFocusBlockerForAllChildren( true )
			f6_arg0.SideArrows:SetMouseFocusBlocker( true )
			ACTIONS.AnimateSequence( f6_arg0, "AllFUFocused" )
			f6_arg0.FieldUpgradesGrid:processEvent( {
				name = "lose_focus"
			} )
			local f6_local0 = nil
			if f6_arg0._slotInUse == SUPER.Slot.LEFT then
				f6_local0 = f6_arg0.FieldUpgrade1
			else
				f6_local0 = f6_arg0.FieldUpgrade2
			end
			f6_local0:processEvent( {
				name = "gain_focus"
			} )
			f6_arg0.FieldUpgradesGrid:SetMouseFocusBlocker( true )
			f6_arg0._gridOpen = false
		else
			ACTIONS.LeaveMenu( f6_arg0 )
		end
	end )
end

local f0_local30 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.ButtonAction = f0_local0
	f3_arg0.ButtonOver = f0_local0
	assert( f3_arg2.loadoutIndex, "The Field Upgrades menu requires a loadout index passed into options, otherwise it cannot grab the correct data!" )
	f3_arg0._defaultMaxVisibleColumns = f3_arg0.FieldUpgradesGrid:GetMaxVisibleColumns()
	local f3_local0 = LOADOUT.GetLoadoutSquadMember( f3_arg1 )
	f3_arg0._loadoutData = f3_local0.loadouts[f3_arg2.loadoutIndex]
	f3_arg0._allFieldUpgrades = f0_local0( f3_arg0, f3_arg1 )
	f3_arg0._currentRef = f3_arg0._allFieldUpgrades[1].ref
	f3_arg0._prevImage = nil
	f0_local0( f3_arg0, f3_arg1 )
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0 )
	if f3_arg0.SideArrows then
		f3_arg0.SideArrows:SetMouseFocusBlocker( true )
	end
	assert( f3_arg0.ItemDetails )
	f3_arg0.ItemDetails:SetupForFieldUpgrades()
	f3_arg0.HorizontalMinimalScrollbar:SetMouseFocusBlockerForAllChildren( true )
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0, f3_arg1 )
	f0_local0( f3_arg0, f3_arg1, f3_arg2.defaultSlotOne )
	f0_local0( f3_arg0, f3_arg1 )
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0, f3_arg1 )
	f0_local0( f3_arg0, f3_arg2.defaultSlotOne )
	f3_arg0:addEventHandler( "restore_focus", function ( f4_arg0, f4_arg1 )
		return true
	end )
end

local f0_local31 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function FieldUpgradesBase( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "FieldUpgradesBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local f1_local3 = self
	SUPER.SetupFieldUpgradesMenu( self, f1_local1, controller )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "FieldUpgradesBase", FieldUpgradesBase )
LockTable( _M )
