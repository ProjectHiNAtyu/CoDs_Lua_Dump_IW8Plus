-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
module( ..., package.seeall )
require( "ui.generated.widgets.togglebutton" )
local f0_local0 = "channel_toggle_update_timer"
local f0_local1 = 250
local f0_local2 = function ( f17_arg0 )
	local f17_local0 = f17_arg0._isConnected and 0x9CAB7D7A8514321 or 0xC76DBFACBB6C7B
	local f17_local1 = {
		verticalAlignment = true,
		horizontalAlignment = true,
		promptsData = {
			{
				button_ref = "button_channel_connect",
				keyprompt_text = "[{channel_connect}]",
				helper_text = Engine[0xED84C33EC5F01EA]( f17_local0 ),
				helper_definition = Engine[0xED84C33EC5F01EA]( f17_local0 )
			}
		},
		orientation = LUI.ORIENTATION.down
	}
	if not f17_arg0._tooTipAdded then
		f17_arg0.ToggleButton:AddTooltipData( f17_arg0._controllerIndex, f17_local1 )
		f17_arg0._tooTipAdded = true
	else
		f17_arg0.ToggleButton:RefreshTooltipData( f17_arg0._controllerIndex, f17_local1 )
	end
end

local f0_local3 = function ( f16_arg0 )
	f16_arg0._isConnected = f16_arg0._voicePartyID == f16_arg0._channelID
	f16_arg0.ToggleButton:SetToggleState( f16_arg0._isConnected )
	f16_arg0.PlayerCount:setText( tostring( CHANNELS.GetMemberInVoiceCount( CHANNELS.GetChannelDetails( f16_arg0._controllerIndex, f16_arg0._channelID ) ) ) )
	local f16_local0 = ACTIONS.AnimateSequence
	local f16_local1 = f16_arg0
	local f16_local2
	if f16_arg0._isConnected then
		f16_local2 = "Connected"
	else
		f16_local2 = "Disconnected"
	end
	f16_local0( f16_local1, f16_local2 )
	f0_local0( f16_arg0 )
end

local f0_local4 = function ( f10_arg0, f10_arg1 )
	local f10_local0
	if not f10_arg1 then
		f10_local0 = f10_arg1
	else
		f10_local0 = {}
	end
	if not f10_local0.channelID then
		assert( false, "Invalid channel id" )
	end
	if CHANNELS.IsValidPartyID( f10_local0.channelID ) then
		f10_arg0._channelID = f10_local0.channelID
		f10_arg0._voicePartyID = CHANNELS.GetVoiceParty( f10_arg0._controllerIndex )
		f10_arg0.ToggleButton:SetButtonDisabled( false )
		f10_arg0:SetVisible( true )
		f0_local0( f10_arg0 )
		f10_arg0.ToggleButton.Action = function ( f14_arg0 )
			if FEATURE_BAN[0x28E912203808C04]( f10_arg0._controllerIndex ) then
				LUI.FlowManager.RequestPopupMenu( nil, "AgeRestrictedVoiceChatPopup", true, f10_arg0._controllerIndex, false )
			elseif CONDITIONS.IsVoiceChatEnabled() then
				CHANNELS.ToggleVoicePartyConnection( f10_arg0._controllerIndex, f10_arg0._channelID )
				f10_arg0._voicePartyID = CHANNELS.GetVoiceParty( f10_arg0._controllerIndex )
				f10_arg0( f10_arg0 )
			else
				CHANNELS.OpenEnableVoiceChatPopup( f10_arg0._controllerIndex, function ()
					Social[0x2DCEF319E8CCDEF]( f14_arg0._controllerIndex, CHANNELS.GetChannelType( f14_arg0._channelID ), f14_arg0._channelID )
					f14_arg0._voicePartyID = f14_arg0._channelID
					f14_arg0( f14_arg0 )
				end )
			end
			Engine[0xC4146BA76D0F982]( SOUND_SETS.mpMainMenu.toggleSwitch )
		end
		
		f10_arg0:CreateEventTimer( f0_local0, f0_local0, {
			immediate = false,
			callbackFunc = function ( f13_arg0, f13_arg1 )
				f10_arg0._voicePartyID = CHANNELS.GetVoiceParty( f10_arg0._controllerIndex )
				f10_arg0( f13_arg0 )
			end
		} )
		if f10_local0.hookGamepadEvents then
			f10_arg0:AddGamepadEventCallback( "button_right_trigger", function ( f12_arg0, f12_arg1 )
				if CONDITIONS.IsGamepadInput( f12_arg1 ) and f12_arg0.ToggleButton.Action then
					f12_arg0.ToggleButton:Action()
					return true
				else
					
				end
			end )
			f10_arg0:AddGamepadEventCallback( "button_channel_connect", function ( f11_arg0, f11_arg1 )
				if CONDITIONS.IsKeyboardInput( f11_arg1 ) and f11_arg0.ToggleButton.Action then
					f11_arg0.ToggleButton:Action()
					return true
				else
					
				end
			end )
		end
	else
		f10_arg0._voicePartyID = nil
		f10_arg0._channelID = nil
		f10_arg0.ToggleButton:SetButtonDisabled( true )
		f10_arg0:SetVisible( false )
	end
end

local f0_local5 = function ( f9_arg0 )
	f9_arg0.ToggleButton:processEvent( {
		name = "leftmouseup"
	} )
end

local f0_local6 = function ( f8_arg0, f8_arg1 )
	f8_arg0.ToggleButton:SetToggleWarningState( f8_arg1 )
end

local f0_local7 = function ( f7_arg0, f7_arg1 )
	if f7_arg0._tootipDataAdded then
		f7_arg0.ToggleButton:RefreshTooltipData( f7_arg0._controllerIndex, f7_arg1 )
		return 
	else
		f7_arg0.ToggleButton:AddTooltipData( f7_arg0._controllerIndex, f7_arg1 )
		f7_arg0._tootipDataAdded = true
	end
end

local f0_local8 = function ( f6_arg0, f6_arg1, f6_arg2 )
	f6_arg0.SetupToggleButton = f0_local0
	f6_arg0.SetToggleWarningState = f0_local0
	f6_arg0.Toggle = f0_local0
	f6_arg0._controllerIndex = f6_arg1
	f6_arg0._channelId = nil
	f6_arg0._voicePartyID = nil
	f6_arg0._isConnected = false
	f6_arg0._toolTipAdded = false
end

States = {
	[0xAD14C6E7156B923] = function ( f2_arg0, f2_arg1 )
		local f2_local0 = function ( f5_arg0, f5_arg1 )
			
		end
		
		f2_arg0.HeadphoneImage:RegisterAnimationSequence( "Connected", {
			{
				value = 0,
				duration = 0,
				property = TWEEN_PROPERTY.RGB
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.Material,
				value = RegisterMaterial( "icon_social_voice_sm" )
			}
		} )
		local f2_local1 = function ( f4_arg0, f4_arg1 )
			f4_arg0.HeadphoneImage:AnimateSequence( "Connected" )
		end
		
		f2_arg0.HeadphoneImage:RegisterAnimationSequence( "Disconnected", {
			{
				value = 16777215,
				duration = 0,
				property = TWEEN_PROPERTY.RGB
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.Material,
				value = RegisterMaterial( "icon_social_voice_disabled_sm" )
			}
		} )
		f2_arg0._sequences = {
			DefaultSequence = f2_local0,
			Connected = f2_local1,
			Disconnected = function ( f3_arg0, f3_arg1 )
				f3_arg0.HeadphoneImage:AnimateSequence( "Disconnected" )
			end
		}
		f2_arg0._sequenceLengths = {
			Disconnected = 0,
			DefaultSequence = 0,
			Connected = 0
		}
	end
}
function ChannelConnectToggle( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 120 * _1080p, 0, 48 * _1080p )
	self.id = "ChannelConnectToggle"
	self.__states = States
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local ToggleBacker = nil
	
	ToggleBacker = LUI.UIImage.new()
	ToggleBacker.id = "ToggleBacker"
	ToggleBacker:SetRGBFromInt( 2829099, 0 )
	ToggleBacker:setImage( RegisterMaterial( 0x4FC19F907B34C1B ), 0 )
	ToggleBacker:Setup9SliceImage( _1080p * 24, _1080p * 12, 0.5, 0.5 )
	ToggleBacker:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 120, 0, _1080p * 48 )
	self:addElement( ToggleBacker )
	self.ToggleBacker = ToggleBacker
	
	local ToggleButton = nil
	
	ToggleButton = MenuBuilder.BuildRegisteredType( "ToggleButton", {
		controllerIndex = f1_local1
	} )
	ToggleButton.id = "ToggleButton"
	ToggleButton:SetScale( 0.5, 0 )
	ToggleButton:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 55, _1080p * 103, _1080p * 12, _1080p * 36 )
	self:addElement( ToggleButton )
	self.ToggleButton = ToggleButton
	
	local HeadphoneImage = nil
	
	HeadphoneImage = LUI.UIImage.new()
	HeadphoneImage.id = "HeadphoneImage"
	HeadphoneImage:SetScale( 0, 0 )
	HeadphoneImage:setImage( RegisterMaterial( 0x6B0B797F94F9CC0 ), 0 )
	HeadphoneImage:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 85, _1080p * 109, _1080p * 12, _1080p * 36 )
	self:addElement( HeadphoneImage )
	self.HeadphoneImage = HeadphoneImage
	
	local PlayerCount = nil
	
	PlayerCount = LUI.UIText.new()
	PlayerCount.id = "PlayerCount"
	PlayerCount:SetRGBFromTable( SWATCHES.IW9StyleGuide.styleGuideCool01, 0 )
	PlayerCount:setText( "0", 0 )
	PlayerCount:SetFont( FONTS.GetFont( FONTS.SecondaryMedium.File ) )
	PlayerCount:SetFontSize( 28 * _PT )
	PlayerCount:SetMinFontSize( 28 * _PT )
	PlayerCount:SetWordWrap( false )
	PlayerCount:SetAlignment( LUI.Alignment.Center )
	PlayerCount:SetVerticalAlignment( LUI.Alignment.Middle )
	PlayerCount:SetAnchorsAndPosition( 1, 0, 0.5, 0.5, _1080p * -111, _1080p * -83, _1080p * -11, _1080p * 17 )
	self:addElement( PlayerCount )
	self.PlayerCount = PlayerCount
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "ChannelConnectToggle", ChannelConnectToggle )
LockTable( _M )
