-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
LUI.FrontEndZoomManager = LUI.Class()
local f0_local0, f0_local1, f0_local2 = nil
LUI.FrontEndZoomManager.init = function ( f22_arg0, f22_arg1 )
	local f22_local0 = assert
	local f22_local1
	if f22_arg1.zoomModel ~= nil and type( f22_arg1.zoomModel ) ~= "userdata" then
		f22_local1 = false
	else
		f22_local1 = true
	end
	f22_local0( f22_local1 )
	f22_local0 = assert
	if f22_arg1.minZoom ~= nil and type( f22_arg1.minZoom ) ~= "number" then
		f22_local1 = false
	else
		f22_local1 = true
	end
	f22_local0( f22_local1 )
	f22_local0 = assert
	if f22_arg1.maxZoom ~= nil and type( f22_arg1.maxZoom ) ~= "number" then
		f22_local1 = false
	else
		f22_local1 = true
	end
	f22_local0( f22_local1 )
	f22_local0 = assert
	if f22_arg1.widgetInfo == nil or f22_arg1.widgetInfo.widget == nil then
		f22_local1 = false
	else
		f22_local1 = true
	end
	f22_local0( f22_local1, "Frontend zoom needs a widget to zoom on" )
	f22_arg0._skipMove = false
	f22_arg0._useCustomEvents = false
	f22_arg0._initialTouch = {
		x = 0,
		y = 0
	}
	f22_arg0._moveOffset = {
		x = 0,
		y = 0
	}
	f22_arg0._zoomModel = f22_arg1.zoomModel
	if f22_arg1.minZoom == f22_arg1.maxZoom then
		f22_arg1.maxZoom = f22_arg1.maxZoom + 1
	end
	f22_arg0._minZoom = f22_arg1.minZoom
	f22_arg0._maxZoom = f22_arg1.maxZoom
	f22_local0 = f22_arg1.widgetInfo.widget
	local f22_local2 = {
		widget = f22_local0,
		width = f0_local0( f22_local0.width, f22_local0:getWidth() ),
		height = f0_local0( f22_local0.height, f22_local0:getHeight() )
	}
	if f22_local0.anchorsAndPos then
		f22_local1 = f22_local0.anchorsAndPos
		if not f22_local1 then
		
		else
			f22_local2.anchorsAndPos = f22_local1
			f22_arg0._widgetInfo = f22_local2
			f22_arg0._margins = {
				left = f0_local0( f22_arg1.margins.left, 0 ),
				right = f0_local0( f22_arg1.margins.right, 0 ),
				top = f0_local0( f22_arg1.margins.top, 0 ),
				bottom = f0_local0( f22_arg1.margins.bottom, 0 )
			}
			f0_local0( f22_arg0 )
		end
	end
	f22_local1 = f22_local0:GetAnchorsAndPosition()
end

LUI.FrontEndZoomManager.GetMinZoom = function ( f21_arg0 )
	return f21_arg0._minZoom
end

LUI.FrontEndZoomManager.GetMaxZoom = function ( f20_arg0 )
	return f20_arg0._maxZoom
end

LUI.FrontEndZoomManager.GetZoomModel = function ( f19_arg0 )
	return f19_arg0._zoomModel
end

LUI.FrontEndZoomManager.SetMinZoom = function ( f18_arg0, f18_arg1 )
	assert( f18_arg1 )
	if f18_arg0._maxZoom ~= nil and f18_arg0._maxZoom <= f18_arg1 then
		f18_arg1 = f18_arg0._maxZoom - 1
	end
	f18_arg0._minZoom = f18_arg1
end

LUI.FrontEndZoomManager.SetMaxZoom = function ( f17_arg0, f17_arg1 )
	assert( f17_arg1 )
	if f17_arg0._minZoom ~= nil and f17_arg1 <= f17_arg0._minZoom then
		f17_arg1 = f17_arg0._minZoom + 1
	end
	f17_arg0._maxZoom = f17_arg1
end

LUI.FrontEndZoomManager.SetMargin = function ( f16_arg0, f16_arg1, f16_arg2 )
	local f16_local0 = assert
	local f16_local1
	if f16_arg2 then
		f16_local1 = f16_arg2
	else
		f16_local1 = 0 <= f16_arg2
	end
	f16_local0( f16_local1 )
	if f16_arg0._margins[f16_arg1] then
		f16_arg0._margins[f16_arg1] = f16_arg2
	end
	f0_local0( f16_arg0, {
		x = 0,
		y = 0
	}, DataModel[0x614D394F6F9A18D]( f16_arg0:GetZoomModel() ) )
end

LUI.FrontEndZoomManager.SetUseCustomEvents = function ( f15_arg0, f15_arg1 )
	f15_arg0._useCustomEvents = f15_arg1 == true
end

LUI.FrontEndZoomManager.BindSlider = function ( f13_arg0, f13_arg1 )
	f13_arg1:BindZoomManager( f13_arg0 )
	f13_arg1:SubscribeToModel( f13_arg0:GetZoomModel(), function ( f14_arg0 )
		f13_arg0:UpdateSliderValue( f13_arg0:GetMinZoom(), f13_arg0:GetMaxZoom(), DataModel[0x614D394F6F9A18D]( f14_arg0 ) )
	end )
end

local f0_local3 = function ( f11_arg0 )
	f11_arg0._widgetInfo.widget:addEventHandler( "touchbegin", function ( f12_arg0, f12_arg1 )
		if Engine[0x8E249AF085176E3]() == 2 and f11_arg0._useCustomEvents then
			f12_arg0:processEvent( {
				name = "zoom_begin"
			} )
		end
		f11_arg0._initialTouch = {
			x = f12_arg1.unitsX,
			y = f12_arg1.unitsY
		}
		return true
	end )
end

local f0_local4 = function ( f9_arg0 )
	f9_arg0._widgetInfo.widget:addEventHandler( "touchend", function ( f10_arg0, f10_arg1 )
		local f10_local0 = Engine[0x8E249AF085176E3]()
		if f10_local0 == 1 then
			f9_arg0._skipMove = true
		elseif f10_local0 == 0 and f9_arg0._useCustomEvents then
			f10_arg0:processEvent( {
				name = "zoom_end"
			} )
		end
		return true
	end )
end

local f0_local5 = function ( f7_arg0 )
	f7_arg0._widgetInfo.widget:addEventHandler( "touchmove", function ( f8_arg0, f8_arg1 )
		if Engine[0x8E249AF085176E3]() == 1 then
			if f7_arg0._skipMove then
				f7_arg0._skipMove = false
			else
				f7_arg0( f7_arg0, {
					x = f8_arg1.unitsX - f7_arg0._initialTouch.x,
					y = f8_arg1.unitsY - f7_arg0._initialTouch.y
				}, DataModel[0x614D394F6F9A18D]( f7_arg0:GetZoomModel() ) )
			end
			f7_arg0._initialTouch = {
				x = f8_arg1.unitsX,
				y = f8_arg1.unitsY
			}
		end
		return true
	end )
end

local f0_local6 = function ( f5_arg0 )
	f5_arg0._widgetInfo.widget:addEventHandler( "gesturePinchZoom", function ( f6_arg0, f6_arg1 )
		local f6_local0 = LUI.clamp( f6_arg1.radius * (DataModel[0x614D394F6F9A18D]( f5_arg0._zoomModel ) + 1) / (f6_arg1.radius - f6_arg1.deltaRadius) - 1, f5_arg0._minZoom, f5_arg0._maxZoom )
		DataModel[0x83C9B5DE1D9371]( f5_arg0._zoomModel, f6_local0 )
		if f6_arg1.deltaPosX ~= 0 or f6_arg1.deltaPosY ~= 0 then
			f5_arg0( f5_arg0, {
				x = f6_arg1.deltaPosX,
				y = f6_arg1.deltaPosY
			}, f6_local0 )
		end
		return true
	end )
end

f0_local0 = function ( f3_arg0 )
	local f3_local0 = f3_arg0._widgetInfo.widget
	f3_local0:SetHandleTouchInput( true )
	f3_local0:SetHandleMultiFinger( true )
	f3_local0:SubscribeToModel( f3_arg0._zoomModel, function ( f4_arg0 )
		local f4_local0 = DataModel[0x614D394F6F9A18D]( f4_arg0 )
		f3_arg0:SetScale( f4_local0 )
		f3_arg0( f3_arg0, {
			x = 0,
			y = 0
		}, f4_local0 )
	end, true )
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0 )
	f0_local0( f3_arg0 )
end

f0_local1 = function ( f2_arg0, f2_arg1, f2_arg2 )
	local f2_local0 = 0.5 * f2_arg2
	local f2_local1 = f2_local0 * f2_arg0._widgetInfo.width
	local f2_local2 = f2_local0 * f2_arg0._widgetInfo.height
	local f2_local3 = -f2_local1 + f2_arg2 * f2_arg0._margins.right
	local f2_local4 = f2_local1 - f2_arg2 * f2_arg0._margins.left
	local f2_local5 = -f2_local2 + f2_arg2 * f2_arg0._margins.bottom
	local f2_local6 = f2_local2 - f2_arg2 * f2_arg0._margins.top
	local f2_local7 = LUI.clamp( f2_arg0._moveOffset.x + f2_arg1.x, f2_local3, f2_local4 )
	local f2_local8 = LUI.clamp( f2_arg0._moveOffset.y + f2_arg1.y, f2_local5, f2_local6 )
	local f2_local9 = f2_arg0._widgetInfo.anchorsAndPos
	f2_arg0._widgetInfo.widget:SetLeft( f2_local9.left + f2_local7 )
	f2_arg0._widgetInfo.widget:SetRight( f2_local9.right + f2_local7 )
	f2_arg0._widgetInfo.widget:SetTop( f2_local9.top + f2_local8 )
	f2_arg0._widgetInfo.widget:SetBottom( f2_local9.bottom + f2_local8 )
	f2_arg0._moveOffset = {
		x = f2_local7,
		y = f2_local8
	}
end

f0_local2 = function ( f1_arg0, f1_arg1 )
	local f1_local0
	if f1_arg0 ~= nil and 0 < f1_arg0 and not f1_arg0 then
		f1_local0 = f1_arg0
	else
		f1_local0 = f1_arg1
	end
	return f1_local0
end

