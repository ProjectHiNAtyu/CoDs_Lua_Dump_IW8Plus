-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 17-11-2025 01:22
SQUAD = SQUAD or {}
SQUAD.SquadState = {
	AVAILABLE = 1,
	EMPTY = 0,
	FULL = 2
}
SQUAD.JoinedSquadType = {
	NORMAL = 1,
	RANDOM = 2,
	LEAVE = 3
}
SQUAD.EmptyMember = nil
SQUAD.GetDebugAllSquadList = function ()
	local f32_local0 = {
		input = nil,
		name = "Jim",
		socialPlatForm = nil,
		rankIcon = "white",
		displayRank = 20
	}
	local f32_local1 = {}
	for f32_local2 = 1, 20, 1 do
		local f32_local5 = {
			memberList = {}
		}
		table.insert( f32_local5.memberList, f32_local0 )
		table.insert( f32_local5.memberList, f32_local0 )
		table.insert( f32_local5.memberList, f32_local0 )
		table.insert( f32_local5.memberList, f32_local0 )
		f32_local5.squadIndex = f32_local2
		f32_local5.size = #f32_local5.memberList
		f32_local5.fullSize = 4
		f32_local5.IsSquadFull = f32_local5.size == f32_local5.fullSize
		table.insert( f32_local1, f32_local5 )
	end
	return f32_local1
end

SQUAD.ToastSquadUpdate = function ( f31_arg0, f31_arg1, f31_arg2 )
	f31_arg0:dispatchEventToRoot( {
		name = "send_toast_notification",
		immediate = true,
		options = {
			displayTime = 3000,
			icon = "hud_info_alert",
			description = f31_arg2,
			type = LUI.ToastManager.NotificationType.WZSquadUpdated,
			controllerIndex = f31_arg1
		}
	} )
end

WarzoneSquadTeam = WarzoneSquadTeam or {}
WarzoneSquadTeam.new = function ( f23_arg0, f23_arg1, f23_arg2 )
	local f23_local0 = {}
	setmetatable( f23_local0, f23_arg0 )
	f23_arg0._index = f23_arg0
	f23_local0.memberList = {}
	f23_local0.fullSize = f23_arg2
	f23_local0.squadIndex = f23_arg1
	f23_local0.GetSize = function ( f30_arg0 )
		return #f30_arg0.memberList
	end
	
	f23_local0.GetAvailableSize = function ( f29_arg0 )
		local f29_local0 = 0
		for f29_local1 = 1, #f29_arg0.memberList, 1 do
			if type( f29_arg0.memberList[f29_local1] ) == "table" then
				f29_local0 = f29_local0 + 1
			end
		end
		return f29_local0
	end
	
	f23_local0.IsSquadFull = function ( f28_arg0 )
		return #f28_arg0.memberList == f28_arg0.fullSize
	end
	
	f23_local0.IsSquadEmpty = function ( f27_arg0 )
		return #f27_arg0.memberList == 0
	end
	
	f23_local0.AddTeamMember = function ( f26_arg0, f26_arg1 )
		assert( not f26_arg0:IsSquadFull() )
		local f26_local0 = #f26_arg0.memberList + 1
		if f26_arg1 == SQUAD.EmptyMember then
			f26_arg1 = f26_local0
		else
			f26_arg1.index = f26_local0
		end
		f26_arg0.memberList[f26_local0] = f26_arg1
	end
	
	f23_local0.GetSquadState = function ( f25_arg0 )
		local f25_local0 = f25_arg0:GetAvailableSize()
		if f25_local0 == 0 then
			return SQUAD.SquadState.EMPTY
		elseif f25_local0 == f25_arg0.fullSize then
			return SQUAD.SquadState.FULL
		elseif 0 < f25_local0 and f25_local0 < f25_arg0.fullSize then
			return SQUAD.SquadState.AVAILABLE
		else
			return nil
		end
	end
	
	f23_local0.IsPlayerInSquad = function ( f24_arg0 )
		for f24_local0 = 1, #f24_arg0.memberList, 1 do
			if type( f24_arg0.memberList[f24_local0] ) == "table" and f24_arg0.memberList[f24_local0].isMyPlayer then
				return true
			end
		end
		return false
	end
	
	return f23_local0
end

local f0_local0 = function ( f22_arg0 )
	assert( f22_arg0 )
	local f22_local0 = f22_arg0:GetSize()
	local f22_local1 = f22_arg0.fullSize
	for f22_local2 = f22_local0 + 1, f22_local1, 1 do
		local f22_local5 = f22_local2
		f22_arg0:AddTeamMember( SQUAD.EmptyMember )
	end
end

SQUAD.GetAllSquadCount = function ()
	if MatchRules.EAIEFBHGJ() then
		return MatchRules.BIJEDCBCBH( "commonOption", "teamCount" )
	else
		assert( false, "Trying to access to match rule data when the recipe is not loaded. " )
		return 0
	end
end

SQUAD.GetSquadSize = function ()
	if MatchRules.EAIEFBHGJ() then
		return MatchRules.BIJEDCBCBH( "commonOption", "squadSize" )
	else
		assert( false, "Trying to access to match rule data when the recipe is not loaded. " )
		return 0
	end
end

SQUAD.GetAllPlayersList = function ( f19_arg0 )
	local f19_local0 = Lobby.BDCAFCJEFC()
	if f19_arg0 then
		local f19_local1 = SQUAD.GetAllSquadCount() * SQUAD.GetSquadSize()
		for f19_local2 = #f19_local0 + 1, f19_local1, 1 do
			f19_local0[f19_local2] = f19_local2
		end
	end
	return f19_local0
end

SQUAD.GetCurrentSquadCount = function ()
	local f18_local0 = SQUAD.GetAllPlayersList()
	if not f18_local0 then
		return 0
	end
	local f18_local1 = -1
	for f18_local2 = 1, #f18_local0, 1 do
		if f18_local0[f18_local2].isMyPlayer then
			f18_local1 = f18_local0[f18_local2].squadIndex
			break
		end
	end
	if f18_local1 == -1 then
		return 0
	end
	local f18_local2 = 0
	for f18_local3 = 1, #f18_local0, 1 do
		if f18_local0[f18_local3].squadIndex == f18_local1 then
			f18_local2 = f18_local2 + 1
		end
	end
	if MatchRules.EAIEFBHGJ() then
		assert( f18_local2 <= MatchRules.BIJEDCBCBH( "commonOption", "squadSize" ) )
	end
	return f18_local2
end

SQUAD.GetPlayerSquadIndex = function ()
	local f17_local0 = SQUAD.GetAllPlayersList()
	if f17_local0 ~= nil then
		for f17_local1 = 1, #f17_local0, 1 do
			if f17_local0[f17_local1].isMyPlayer then
				return f17_local0[f17_local1].squadIndex
			end
		end
	end
	return -1
end

SQUAD.GetAllSquadList = function ( f16_arg0 )
	local f16_local0 = SQUAD.GetAllPlayersList()
	local f16_local1 = {}
	if f16_arg0 then
		local f16_local2 = SQUAD.GetAllSquadCount()
		local f16_local3 = SQUAD.GetSquadSize()
		local f16_local4 = 0
		local f16_local5 = 0
		for f16_local6 = 1, #f16_local0, 1 do
			local f16_local9 = f16_local0[f16_local6]
			if f16_local9.squadIndex ~= -1 then
				local f16_local10 = f16_local1[f16_local9.squadIndex]
				f16_local5 = f16_local5 + 1
				if f16_local10 == nil then
					f16_local10 = WarzoneSquadTeam:new( f16_local9.squadIndex, f16_local3 )
				end
				assert( not f16_local10:IsSquadFull() )
				f16_local10:AddTeamMember( f16_local9 )
				f16_local1[f16_local9.squadIndex] = f16_local10
				if f16_local10:GetSquadState() == SQUAD.SquadState.FULL then
					f16_local4 = f16_local4 + 1
				end
			end
		end
		f16_local1.availableSquadCount = f16_local2 - f16_local4
		f16_local1.playerCount = f16_local5
		f16_local1.totalPlayerCount = f16_local3 * f16_local2
		for f16_local6 = 1, f16_local2, 1 do
			if f16_local1[f16_local6] == nil then
				f16_local1[f16_local6] = WarzoneSquadTeam:new( f16_local6, f16_local3 )
			end
			f0_local0( f16_local1[f16_local6] )
		end
		return f16_local1
	else
		return nil
	end
end

SQUAD.ProcessJoinSquadSuccessAction = function ( f15_arg0, f15_arg1, f15_arg2 )
	if LUI.FlowManager.IsMenuOnTop( "JoinSquadPopup" ) then
		LUI.FlowManager.RequestLeaveMenuByName( "JoinSquadPopup", true, true )
	end
	SQUAD.ToastSquadUpdate( f15_arg0, f15_arg1, f15_arg2 )
	ACTIONS.LeaveMenu( f15_arg0 )
end

SQUAD.ProcessJoinSquadFailureAction = function ( f14_arg0, f14_arg1 )
	if LUI.FlowManager.IsMenuOnTop( "JoinRandomSquadPopup" ) then
		LUI.FlowManager.RequestLeaveMenuByName( "JoinRandomSquadPopup", true, true )
	end
	if LUI.FlowManager.IsMenuOnTop( "JoinSquadPopup" ) then
		LUI.FlowManager.RequestLeaveMenuByName( "JoinSquadPopup", true, true )
	end
	LUI.FlowManager.RequestLeaveMenu( f14_arg0 )
	LUI.FlowManager.RequestPopupMenu( f14_arg0, "JoinSquadFailurePopup", false, f14_arg1 )
end

SQUAD.ProcessJoinRandomSquadSuccessAction = function ( f13_arg0, f13_arg1, f13_arg2 )
	if LUI.FlowManager.IsMenuOnTop( "JoinRandomSquadPopup" ) then
		LUI.FlowManager.RequestLeaveMenuByName( "JoinRandomSquadPopup", true, true )
	end
	SQUAD.ToastSquadUpdate( f13_arg0, f13_arg1, f13_arg2 )
	ACTIONS.LeaveMenu( f13_arg0 )
end

SQUAD.ProcessJoinRandomSquadFailureAction = function ( f12_arg0, f12_arg1 )
	if LUI.FlowManager.IsMenuOnTop( "JoinRandomSquadPopup" ) then
		LUI.FlowManager.RequestLeaveMenuByName( "JoinRandomSquadPopup", true, true )
	end
	LUI.FlowManager.RequestLeaveMenu( f12_arg0 )
	LUI.FlowManager.RequestPopupMenu( f12_arg0, "JoinSquadFailurePopup", false, f12_arg1 )
end

SQUAD.ProcessLeaveSquadSuccessAction = function ( f11_arg0, f11_arg1, f11_arg2 )
	if LUI.FlowManager.IsMenuOnTop( "LeaveSquadPopup" ) then
		LUI.FlowManager.RequestLeaveMenuByName( "LeaveSquadPopup", true, true )
	end
	SQUAD.ToastSquadUpdate( f11_arg0, f11_arg1, f11_arg2 )
	ACTIONS.LeaveMenu( f11_arg0 )
end

SQUAD.ProcessLeaveSquadFailureAction = function ( f10_arg0, f10_arg1 )
	if LUI.FlowManager.IsMenuOnTop( "LeaveSquadPopup" ) then
		LUI.FlowManager.RequestLeaveMenuByName( "LeaveSquadPopup", true, true )
	end
	LUI.FlowManager.RequestLeaveMenu( f10_arg0 )
	LUI.FlowManager.RequestPopupMenu( f10_arg0, "LeaveSquadFailurePopup", false, f10_arg1 )
end

SQUAD.JoinSquad = function ( f9_arg0, f9_arg1 )
	assert( f9_arg1 )
	DebugPrint( "warzone private match joined squad index: " .. tostring( f9_arg1 ) )
	return {
		squadIndex = f9_arg1,
		requestSquadSent = Lobby.CHCHDGJGJG( f9_arg0, f9_arg1 )
	}
end

SQUAD.JoinRandomSquad = function ( f8_arg0, f8_arg1 )
	local f8_local0 = SQUAD.GetAllSquadList( f8_arg1 )
	local f8_local1 = {}
	for f8_local2 = 1, #f8_local0, 1 do
		local f8_local5 = f8_local0[f8_local2]
		local f8_local6 = f8_local5:GetSquadState()
		if f8_local6 == SQUAD.SquadState.EMPTY or f8_local6 == SQUAD.SquadState.AVAILABLE then
			f8_local1[#f8_local1 + 1] = f8_local5.squadIndex
		end
	end
	if #f8_local1 == 0 then
		DebugPrint( "warzone private lobby all squads are full. Please check." )
		return 
	end
	local f8_local3 = f8_local1[math.random( 1, #f8_local1 )]
	if f8_local3 == SQUAD.GetPlayerSquadIndex() then
		
	else
		
	end
	DebugPrint( "warzone private match auto assign squad index: " .. tostring( f8_local3 ) )
	return {
		squadIndex = f8_local3,
		requestSquadSent = Lobby.CHCHDGJGJG( f8_arg0, f8_local3 )
	}
end

SQUAD.ProcessJoinRandomSquadAction = function ( f6_arg0, f6_arg1 )
	local f6_local0 = f6_arg1.menu
	assert( f6_local0 )
	if not MatchRules.EAIEFBHGJ() then
		LUI.FlowManager.RequestPopupMenu( f6_local0, "JoinSquadFailurePopup", false )
	elseif Lobby.BJFFDBJHDD() then
		if LUI.FlowManager.IsMenuOnTop( "WarzonePrivateMatchSquadMenu" ) then
			LUI.FlowManager.RequestLeaveMenuByName( "WarzonePrivateMatchSquadMenu", true, true )
			LUI.FlowManager.RequestPopupMenu( f6_local0, "LeaveSquadMenuPopup", false, f6_arg0, false, {
				autoCloseTime = 3000
			} )
		else
			LUI.FlowManager.RequestPopupMenu( f6_local0, "JoinSquadFailurePopup", false )
		end
	end
	local f6_local1 = SQUAD.JoinRandomSquad( f6_arg0, f6_arg1.matchmakerSettings )
	assert( f6_local1 )
	if not f6_local1.requestSquadSent then
		f6_local0:processEvent( {
			name = "squad_request_failure",
			joinedSquadType = SQUAD.JoinedSquadType.RANDOM
		} )
		DebugPrint( "request_squad_sent is false \n" )
	end
	if f6_local1 then
		f6_local0:processEvent( {
			name = "request_squad_sent",
			requestResultReceived = false,
			requestSquadData = f6_local1,
			joinedSquadType = SQUAD.JoinedSquadType.RANDOM
		} )
		LUI.FlowManager.RequestPopupMenu( f6_local0, "JoinRandomSquadPopup", false, f6_arg0, false, {
			autoCloseTime = 5000
		} )
		Lobby.CFFJAEECFA( f6_arg0 )
		local f6_local2 = f6_local0:Wait( 5000 )
		f6_local2.onComplete = function ( f7_arg0, f7_arg1 )
			local f7_local0 = true
			if f6_arg0.GetSquadRequestResult then
				f7_local0 = f6_arg0:GetSquadRequestResult()
			end
			if not f7_local0 then
				SQUAD.ProcessJoinSquadFailureAction( f7_arg0, f6_arg0 )
			end
		end
		
	else
		LUI.FlowManager.RequestPopupMenu( f6_local0, "JoinRandomSquadFailurePopup", false )
	end
end

SQUAD.ProcessJoinSquadAction = function ( f4_arg0, f4_arg1 )
	local f4_local0 = f4_arg1.menu
	if not MatchRules.EAIEFBHGJ() then
		LUI.FlowManager.RequestPopupMenu( f4_local0, "JoinSquadFailurePopup", false )
	elseif Lobby.BJFFDBJHDD() then
		if LUI.FlowManager.IsMenuOnTop( "WarzonePrivateMatchSquadMenu" ) then
			LUI.FlowManager.RequestLeaveMenuByName( "WarzonePrivateMatchSquadMenu", true, true )
			LUI.FlowManager.RequestPopupMenu( f4_local0, "LeaveSquadMenuPopup", false, f4_arg0, false, {
				autoCloseTime = 3000
			} )
		else
			LUI.FlowManager.RequestPopupMenu( f4_local0, "JoinSquadFailurePopup", false )
		end
	end
	local f4_local1 = f4_arg1.squadTeamData
	local f4_local2 = f4_local1:GetSquadState()
	if not f4_local1:IsPlayerInSquad() and (f4_local2 == SQUAD.SquadState.EMPTY or f4_local2 == SQUAD.SquadState.AVAILABLE) then
		local f4_local3 = SQUAD.JoinSquad( f4_arg0, f4_local1.squadIndex )
		assert( f4_local0 )
		assert( f4_local3 )
		if not f4_local3.requestSquadSent then
			f4_local0:processEvent( {
				name = "squad_request_failure",
				joinedSquadType = SQUAD.JoinedSquadType.NORMAL
			} )
			DebugPrint( "request_squad_sent is false \n" )
		end
		DebugPrint( "request_squad_sent event has been sent. \n" )
		f4_local0:processEvent( {
			name = "request_squad_sent",
			requestResultReceived = false,
			requestSquadData = f4_local3,
			joinedSquadType = SQUAD.JoinedSquadType.NORMAL
		} )
		LUI.FlowManager.RequestPopupMenu( f4_local0, "JoinSquadPopup", false, f4_arg0, false, {
			autoCloseTime = 5000
		} )
		Lobby.CFFJAEECFA( f4_arg0 )
		local f4_local4 = f4_local0:Wait( 5000 )
		f4_local4.onComplete = function ( f5_arg0, f5_arg1 )
			local f5_local0 = true
			if f4_arg0.GetSquadRequestResult then
				f5_local0 = f4_arg0:GetSquadRequestResult()
			end
			if not f5_local0 then
				SQUAD.ProcessJoinSquadFailureAction( f5_arg0, f4_arg0 )
			end
		end
		
	end
end

SQUAD.ProcessLeaveSquadAction = function ( f2_arg0, f2_arg1 )
	local f2_local0 = f2_arg1.menu
	if not MatchRules.EAIEFBHGJ() then
		LUI.FlowManager.RequestPopupMenu( f2_local0, "JoinSquadFailurePopup", false )
	elseif Lobby.BJFFDBJHDD() then
		if LUI.FlowManager.IsMenuOnTop( "WarzonePrivateMatchSquadMenu" ) then
			LUI.FlowManager.RequestLeaveMenuByName( "WarzonePrivateMatchSquadMenu", true, true )
			LUI.FlowManager.RequestPopupMenu( f2_local0, "LeaveSquadMenuPopup", false, f2_arg0, false, {
				autoCloseTime = 3000
			} )
		else
			LUI.FlowManager.RequestPopupMenu( f2_local0, "JoinSquadFailurePopup", false )
		end
	end
	local f2_local1 = SQUAD.JoinSquad( f2_arg0, -1 )
	assert( f2_local0 )
	assert( f2_local1 )
	if not f2_local1.requestSquadSent then
		f2_local0:processEvent( {
			name = "squad_request_failure",
			joinedSquadType = SQUAD.JoinedSquadType.LEAVE
		} )
		DebugPrint( "request_squad_sent is false \n" )
	end
	DebugPrint( "request_squad_sent event has been sent. \n" )
	f2_local0:processEvent( {
		name = "request_squad_sent",
		requestResultReceived = false,
		requestSquadData = f2_local1,
		joinedSquadType = SQUAD.JoinedSquadType.LEAVE
	} )
	LUI.FlowManager.RequestPopupMenu( f2_local0, "LeaveSquadPopup", false, f2_arg0, false, {
		autoCloseTime = 5000
	} )
	local f2_local2 = f2_local0:Wait( 5000 )
	f2_local2.onComplete = function ( f3_arg0, f3_arg1 )
		local f3_local0 = true
		if f2_arg0.GetSquadRequestResult then
			f3_local0 = f2_arg0:GetSquadRequestResult()
		end
		if not f3_local0 then
			SQUAD.ProcessLeaveSquadFailureAction( f3_arg0, f2_arg0 )
		end
	end
	
end

SQUAD.RefreshAnimation = function ( f1_arg0, f1_arg1 )
	if f1_arg0._lastState ~= f1_arg1 then
		f1_arg0._lastState = f1_arg1
		ACTIONS.AnimateSequence( f1_arg0, f1_arg1 )
	end
end

