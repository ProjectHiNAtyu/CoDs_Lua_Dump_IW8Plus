-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
WEAPONSTATS = WEAPONSTATS or {}
WEAPONSTATS.GetAttributeBaseValue = function ( f15_arg0, f15_arg1 )
	local f15_local0 = nil
	if f15_arg1.equipped then
		f15_local0 = f15_arg1.weaponData[f15_arg0] + f15_arg1.prevWeaponTableWeaponData[f15_arg0] - f15_arg1.modData[f15_arg0]
	else
		f15_local0 = f15_arg1.weaponData[f15_arg0] + f15_arg1.prevWeaponTableWeaponData[f15_arg0]
	end
	return f15_local0
end

WEAPONSTATS.GetAttributeModValue = function ( f14_arg0, f14_arg1 )
	local f14_local0 = nil
	if f14_arg1.equipped then
		f14_local0 = f14_arg1.modData[f14_arg0]
	else
		f14_local0 = f14_arg1.modData[f14_arg0] - f14_arg1.prevWeaponTableWeaponData[f14_arg0]
	end
	return f14_local0
end

WEAPONSTATS.RemoveEquippedAttachmentsFromWeaponTable = function ( f13_arg0, f13_arg1 )
	local f13_local0 = LUI.DeepCopy( f13_arg0 )
	for f13_local5, f13_local6 in pairs( f13_arg1.attachments ) do
		if ATTACHMENT.HasAttachment( f13_arg0.attachments, f13_local6.ref ) then
			local f13_local4 = ATTACHMENT.GetAttachmentIndex( f13_arg0.attachments, f13_local6.ref )
			f13_local0.attachments[f13_local4].ref = "none"
			f13_local0.attachments[f13_local4].variantID = -1
		end
	end
	return f13_local0
end

WEAPONSTATS.GetDifferenceBetweenTables = function ( f12_arg0, f12_arg1 )
	local f12_local0 = LUI.DeepCopy( f12_arg1 )
	for f12_local5, f12_local6 in pairs( f12_arg0.attachments ) do
		if ATTACHMENT.HasAttachment( f12_local0.attachments, f12_local6.ref ) then
			local f12_local4 = ATTACHMENT.GetAttachmentIndex( f12_local0.attachments, f12_local6.ref )
			f12_local0.attachments[f12_local4].ref = "none"
			f12_local0.attachments[f12_local4].variantID = -1
		end
	end
	return f12_local0
end

WEAPONSTATS.CreateAttributeData = function ( f11_arg0, f11_arg1, f11_arg2, f11_arg3 )
	return {
		weaponData = f11_arg0,
		prevWeaponTableWeaponData = f11_arg1,
		modData = f11_arg2,
		equipped = f11_arg3
	}
end

WEAPONSTATS.CreateModificationData = function ( f10_arg0, f10_arg1 )
	local f10_local0 = CSV.ReadRow( CSV.weapons, StringTable[0x8073B436CDE1BF]( CSV.weapons.file, CSV.weapons.cols.ref, f10_arg1 ) )
	return {
		statAccuracy = f10_arg0.statAccuracy - f10_local0.statAccuracy,
		statDamage = f10_arg0.statDamage - f10_local0.statDamage,
		statRange = f10_arg0.statRange - f10_local0.statRange,
		statFireRate = f10_arg0.statFireRate - f10_local0.statFireRate
	}
end

WEAPONSTATS.GetDetailedStatsSetupTable = function ()
	local f9_local0 = {
		Firepower = {},
		Speed = {},
		Accuracy = {},
		Ammo = {}
	}
	for f9_local1 = 0, StringTable[0xFD4E49A34DD43AE]( CSV.weaponDetailedStats.file ) - 1, 1 do
		local f9_local4 = StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f9_local1, CSV.weaponDetailedStats.cols.category )
		if f9_local0[f9_local4] ~= nil then
			local f9_local5 = {
				component = StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f9_local1, CSV.weaponDetailedStats.cols.component ),
				componentLocKey = StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f9_local1, CSV.weaponDetailedStats.cols.componentLocKey ),
				higherIsBetter = StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f9_local1, CSV.weaponDetailedStats.cols.higherIsBetter ) == "1",
				valueLocKey = StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f9_local1, CSV.weaponDetailedStats.cols.valueLocKey ),
				valueMultiplier = tonumber( StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f9_local1, CSV.weaponDetailedStats.cols.valueMultiplier ) ),
				valueBaseAmount = tonumber( StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f9_local1, CSV.weaponDetailedStats.cols.valueBaseAmount ) ),
				valueLocKey = f9_local5.valueLocKey and f9_local5.valueLocKey or nil
			}
			table.insert( f9_local0[f9_local4], f9_local5 )
		end
	end
	return f9_local0
end

WEAPONSTATS.GetComponentFromCategory = function ( f8_arg0, f8_arg1 )
	local f8_local0 = nil
	for f8_local1 = 1, #f8_arg0, 1 do
		if f8_arg0[f8_local1].component == f8_arg1 then
			f8_local0 = f8_arg0[f8_local1]
			f8_local0.categoryIndex = f8_local1
			break
		end
	end
	return f8_local0
end

WEAPONSTATS.GetDetailedStatsConditionalAttachments = function ( f7_arg0, f7_arg1 )
	local f7_local0 = {
		Firepower = {},
		Speed = {},
		Accuracy = {},
		Ammo = {}
	}
	for f7_local1 = 0, StringTable[0xFD4E49A34DD43AE]( CSV.conditionalAttachments.file ) - 1, 1 do
		if ATTACHMENT.HasAttachment( f7_arg0, StringTable[0x2077452C28AB2FC]( CSV.conditionalAttachments.file, f7_local1, CSV.conditionalAttachments.cols.attachmentRef ) ) and WEAPONSTATS.ConditionalAttachmentHasWeapon( StringTable[0x2077452C28AB2FC]( CSV.conditionalAttachments.file, f7_local1, CSV.conditionalAttachments.cols.weaponRefs ), f7_arg1 ) then
			local f7_local4 = StringTable[0x2077452C28AB2FC]( CSV.conditionalAttachments.file, f7_local1, CSV.conditionalAttachments.cols.category )
			assert( f7_local0[f7_local4] )
			f7_local0[f7_local4][StringTable[0x2077452C28AB2FC]( CSV.conditionalAttachments.file, f7_local1, CSV.conditionalAttachments.cols.component )] = true
		end
	end
	return f7_local0
end

WEAPONSTATS.ConditionalAttachmentHasWeapon = function ( f6_arg0, f6_arg1 )
	if f6_arg0 == "*" then
		return true
	else
		return LUI.IsItemInArray( LUI.Split( f6_arg0, "|" ), f6_arg1 )
	end
end

WEAPONSTATS.GetComponentsFromCategory = function ( f5_arg0 )
	local f5_local0 = {}
	for f5_local1 = 1, #f5_arg0, 1 do
		assert( f5_arg0[f5_local1].component )
		table.insert( f5_local0, f5_arg0[f5_local1].component )
	end
	return f5_local0
end

WEAPONSTATS.GetCategoryMinMaxValues = function ( f4_arg0, f4_arg1, f4_arg2 )
	local f4_local0 = {}
	for f4_local1 = 1, #f4_arg0, 1 do
		local f4_local4 = f4_arg0[f4_local1]
		local f4_local5, f4_local6 = WEAPONSTATS.GetComponentMinMaxValue( f4_local4, f4_arg1 )
		if f4_arg2 and WEAPON.GetWeaponClass( f4_arg2 ) ~= WEAPON.GetWeaponClass( f4_arg1 ) then
			local f4_local7, f4_local8 = WEAPONSTATS.GetComponentMinMaxValue( f4_local4, f4_arg2 )
			f4_local5 = math.min( f4_local5, f4_local7 )
			f4_local6 = math.max( f4_local6, f4_local8 )
		end
		f4_local0[f4_local4] = {
			minValue = f4_local5,
			maxValue = f4_local6
		}
	end
	return f4_local0
end

WEAPONSTATS.GetComponentMinMaxValue = function ( f3_arg0, f3_arg1 )
	local f3_local0 = StringTable[0x8073B436CDE1BF]( CSV.weaponDetailedStats.file, CSV.weaponDetailedStats.cols.component, f3_arg0 )
	assert( f3_local0 )
	local f3_local1 = "_"
	local f3_local2 = "Min"
	local f3_local3 = "Max"
	local f3_local4 = LUI.Split( WEAPON.GetWeaponClass( f3_arg1 ), f3_local1 )
	f3_local4 = f3_local4[2]
	return StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f3_local0, CSV.weaponDetailedStats.cols[f3_local4 .. f3_local2] ), StringTable[0x2077452C28AB2FC]( CSV.weaponDetailedStats.file, f3_local0, CSV.weaponDetailedStats.cols[f3_local4 .. f3_local3] )
end

WEAPONSTATS.NormalizeComponentValue = function ( f2_arg0, f2_arg1, f2_arg2, f2_arg3 )
	if f2_arg0 == f2_arg1 then
		return 1
	end
	local f2_local0 = (f2_arg2 - f2_arg0) / (f2_arg1 - f2_arg0)
	if f2_arg3 then
		f2_local0 = LUI.clamp( f2_local0, 0, 1 )
	end
	return f2_local0
end

WEAPONSTATS.CalculateCategoryBarValueForDetailedStats = function ( f1_arg0, f1_arg1, f1_arg2, f1_arg3 )
	if #f1_arg0 == 0 then
		return 1
	end
	local f1_local0 = WEAPONSTATS.GetCategoryMinMaxValues( f1_arg0, f1_arg1, f1_arg2 )
	local f1_local1 = 0
	for f1_local2 = 1, #f1_arg0, 1 do
		assert( f1_local0[f1_arg0[f1_local2]] ~= nil )
		assert( f1_arg3[f1_arg0[f1_local2]] ~= nil )
		f1_local1 = f1_local1 + WEAPONSTATS.NormalizeComponentValue( f1_local0[f1_arg0[f1_local2]].minValue, f1_local0[f1_arg0[f1_local2]].maxValue, f1_arg3[f1_arg0[f1_local2]], true )
	end
	return f1_local1 / #f1_arg0
end

