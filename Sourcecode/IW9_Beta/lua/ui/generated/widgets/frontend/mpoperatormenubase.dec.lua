-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:02
module( ..., package.seeall )
local f0_local0 = function ( f19_arg0, f19_arg1 )
	LUI.DeferredFence.Attach( f19_arg0, f19_arg1, "CLIENT_CONNECT", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f20_arg0, f20_arg1 )
		if f20_arg1.fenceState == LUI.Fence.FenceObjectState.PASSING then
			local f20_local0 = {}
			local f20_local1 = {}
			local f20_local2 = FrontEndScene
			if f20_local2 then
				f20_local2 = FrontEndScene.ClientCharacters.MainMenuWest
			end
			f20_local1.characterID = f20_local2
			f20_local1.superFaction = OPERATOR.SuperFaction.WEST
			f20_local0[1] = f20_local1
			f20_local1 = {}
			f20_local2 = FrontEndScene
			if f20_local2 then
				f20_local2 = FrontEndScene.ClientCharacters.MainMenuEast
			end
			f20_local1.characterID = f20_local2
			f20_local1.superFaction = OPERATOR.SuperFaction.EAST
			f20_local0[2] = f20_local1
			f20_local1 = {}
			if CONDITIONS.IsFrontendSceneEnabled() then
				f20_local2 = f19_arg0:Wait( 10 )
				f20_local2.onComplete = function ()
					FrontEndScene.SetCharacterVisible( FrontEndScene.ClientCharacters.MainOperator, false )
				end
				
				f20_local2 = OPERATOR.GetWeaponPosesTable()
				local f20_local3 = {}
				local f20_local4 = LOADOUT.GetLoadoutSquadMember( f19_arg0 )
				f20_local4 = f20_local4.loadouts[0].weaponSetups[0].weapon:get()
				local f20_local5 = WEAPON.GetWeaponClass( f20_local4 )
				if f20_local2[f20_local5] == nil then
					local f20_local6 = LOADOUT.GetDefaultLoadouts( f19_arg0 )
					f20_local4 = f20_local6[5].weapons[1].ref
					f20_local5 = WEAPON.GetWeaponClass( f20_local4 )
					assert( f20_local2[f20_local5] ~= nil )
				end
				local f20_local6 = {}
				local f20_local7 = {}
				local f20_local8 = {}
				for f20_local9 = 1, #f20_local0, 1 do
					local f20_local12 = f20_local0[f20_local9].characterID
					local f20_local13 = f20_local0[f20_local9].superFaction
					local f20_local14 = OPERATOR.GetEquippedOperatorData( f19_arg0, f20_local13 )
					f20_local1[f20_local14.ref] = f20_local13
					table.insert( f20_local3, WEAPON.GetWeaponModelNameFromRef( f20_local4, {
						useOperatorOverride = true,
						includeCamos = false,
						includeAttachments = false,
						includeStickers = false
					} ) )
					local f20_local15 = f20_local2[f20_local5][f20_local14.superfaction][f20_local14.gender]
					assert( 0 < #f20_local15 )
					table.insert( f20_local8, f20_local15[math.random( 1, #f20_local15 )] or f20_local14.defaultPose )
					if f19_arg0.OperatorNametagWest and f19_arg0.OperatorNametagEast then
						local f20_local16 = f19_arg0.OperatorNametagWest
						if f20_local13 == OPERATOR.SuperFaction.EAST then
							f20_local16 = f19_arg0.OperatorNametagEast
						end
						f20_local16.Name:setText( ToUpperCase( Engine[0xED84C33EC5F01EA]( f20_local14.name ) ) )
						local f20_local17 = 275 * _1080p
						local f20_local18 = LAYOUT.GetTextWidth( f20_local16.Name )
						local f20_local19 = 80 * _1080p
						if f20_local19 + f20_local18 >= f20_local17 or not f20_local17 then
							f20_local17 = f20_local19 + f20_local18
						end
						if f20_local13 == OPERATOR.SuperFaction.EAST then
							local f20_local20 = f20_local16
							local f20_local21 = f20_local16.SetRight
							local f20_local22 = f20_local16:GetAnchorsAndPosition()
							f20_local21( f20_local20, f20_local22.left + f20_local17 )
						else
							local f20_local20 = f20_local16
							local f20_local21 = f20_local16.SetLeft
							local f20_local22 = f20_local16:GetAnchorsAndPosition()
							f20_local21( f20_local20, f20_local22.right - f20_local17 )
						end
					end
					local f20_local16, f20_local17 = OPERATOR.GetEquippedOperatorSkin( f19_arg0, f20_local13 )
					if f20_local16 and f20_local17 and f20_local16 ~= "" and f20_local17 ~= "" then
						table.insert( f20_local6, f20_local16 )
						table.insert( f20_local7, f20_local17 )
					end
				end
				FrontEndScene.RequestHeadModels( f20_local7 )
				FrontEndScene.RequestBodyModels( f20_local6 )
				local f20_local9, f20_local10 = OPERATOR.GetWeaponDataFromLoadout( f19_arg0 )
				local f20_local11 = WEAPON.GetWeaponDetailsFromModel( f20_local10 )
				f20_local11 = f20_local11.weaponClass
				local f20_local23
				if f20_local11 ~= WEAPON.LAUNCHERClass and f20_local11 ~= WEAPON.MELEEClass then
					f20_local23 = false
				else
					f20_local23 = true
				end
				if f20_local23 then
					f20_local10 = nil
				end
				local f20_local12 = OPERATOR.GetWeaponAccessoryModelFromLoadout( f19_arg0 )
				local f20_local13 = {
					f20_local12,
					f20_local12,
					[1] = OPERATOR.ValidateAccessoryModel( f20_local13[1], f20_local6[1] ),
					[2] = OPERATOR.ValidateAccessoryModel( f20_local13[2], f20_local6[2] )
				}
				FrontEndScene.RequestWeaponWorldModels( {
					f20_local9,
					f20_local10,
					f20_local13[1],
					f20_local13[2]
				} )
				for f20_local14 = 1, #f20_local0, 1 do
					local f20_local25 = f20_local0[f20_local14].characterID
					local f20_local16 = f20_local6[f20_local14]
					local f20_local17 = f20_local7[f20_local14]
					local f20_local18 = f20_local8[f20_local14]
					local f20_local19 = f20_local13[f20_local14]
					if f20_local16 and f20_local17 and 0 < #f20_local16 and 0 < #f20_local17 then
						OPERATOR.UpdateClientCharacter( f20_local25, f19_arg0, f20_local16, f20_local17, f20_local18, f19_arg0, f20_local9, f20_local10, true, f20_local19 )
					end
				end
			else
				for f20_local2 = 1, #f20_local0, 1 do
					local f20_local6 = f20_local0[f20_local2].characterID
					local f20_local7 = f20_local0[f20_local2].superFaction
					local f20_local8 = OPERATOR.GetEquippedOperatorData( f19_arg0, f20_local7 )
					f20_local1[f20_local8.ref] = f20_local7
				end
			end
			if f19_arg0.NearestCompletedEast and f19_arg0.NearestCompletedWest then
				f20_local2 = OPERATOR.GetOutfitMissionQuestsForOperators( f20_local1, f19_arg0 )
				for f20_local6, f20_local7 in pairs( f20_local1 ) do
					local f20_local8 = f20_local2[f20_local6] or {}
					table.sort( f20_local8, OPERATOR.OutfitMissionSortFn )
					local f20_local9 = f19_arg0.NearestCompletedWest
					if f20_local7 == OPERATOR.SuperFaction.EAST then
						f20_local9 = f19_arg0.NearestCompletedEast
					end
					f20_local9:SetMission( f20_local8[0] )
				end
			end
		end
	end )
end

local f0_local1 = function ( f3_arg0, f3_arg1, f3_arg2 )
	if CONDITIONS.IsFrontendSceneEnabled() then
		FrontEndScene.HideAllCharacters()
		Engine[0x685AE31DEDA30A4]( "character_tango" )
		Engine[0x3DACD106DDC0D71]()
	end
	if f3_arg0.OperatorNametagWest and f3_arg0.OperatorNametagEast then
		f3_arg0._operatorNametags = {
			f3_arg0.OperatorNametagEast,
			f3_arg0.OperatorNametagWest
		}
		f3_arg0.OperatorNametagEast:SetNametagAlignmentLeft( true )
		f3_arg0.OperatorNametagWest:SetNametagAlignmentLeft( false )
		f3_arg0.OperatorNametagWest:addEventHandler( "button_action", function ( f18_arg0, f18_arg1 )
			LUI.FlowManager.RequestAddMenu( OPERATOR.SelectMenuRef, true, f18_arg1.controller or f3_arg0, false, {
				faction = OPERATOR.SuperFaction.WEST
			} )
		end )
		f3_arg0.OperatorNametagEast:addEventHandler( "button_action", function ( f17_arg0, f17_arg1 )
			LUI.FlowManager.RequestAddMenu( OPERATOR.SelectMenuRef, true, f17_arg1.controller or f3_arg0, false, {
				faction = OPERATOR.SuperFaction.EAST
			} )
		end )
		f3_arg0.OperatorNametagWest:SetSuperfactionIndex( OPERATOR.SuperFaction.WEST, f3_arg1 )
		f3_arg0.OperatorNametagEast:SetSuperfactionIndex( OPERATOR.SuperFaction.EAST, f3_arg1 )
	end
	if CONDITIONS.IsFrontendSceneEnabled() then
		local f3_local0 = MenuBuilder.BuildRegisteredType( "FrontendCameraMover", {
			enableSway = true,
			controllerIndex = f3_arg1
		} )
		f3_local0:SetLimits( -2, 2, -2, 2 )
		f3_local0:SetSwayValues( 2000, 0.06, 0.1 )
		f3_arg0:addElement( f3_local0 )
	end
	MenuUtils.SetupSceneChangeCallback( f3_arg0, function ()
		local f15_local0 = LOOT.AttachFence
		f15_local0( f3_arg0, f3_arg0, function ( f16_arg0, f16_arg1 )
			if f16_arg1.fenceState ~= LUI.Fence.FenceObjectState.PASSING then
				return 
			elseif CONDITIONS.IsMobileOrMobileSim() then
				f15_local0( f16_arg0, f16_arg1.controllerIndex )
			end
		end )
	end )
	local f3_local0 = function ( f14_arg0 )
		local f14_local0 = 0
		if 1 < Engine[0x70187FE84AE61FD]() then
			local f14_local1 = LUI.DataSourceInGlobalModel.new( "menu.spltscreenDisplay.controllerIndex" )
			return f14_local1:GetValue( f3_arg0 ) == f14_arg0
		else
			return true
		end
	end
	
	local f3_local1 = function ( f13_arg0, f13_arg1 )
		local f13_local0, f13_local1 = nil
		local f13_local2 = f13_arg0
		if 1 < Engine[0x70187FE84AE61FD]() then
			local f13_local3 = LUI.DataSourceInGlobalModel.new( "menu.spltscreenDisplay.controllerIndex" )
			f13_local2 = f13_local3:GetValue( f3_arg0 )
		end
		local f13_local3
		if not f13_arg1 then
			f13_local3 = f13_arg1
		else
			f13_local3 = OPERATOR.GetSelectedOperatorIndex( f13_local2 )
		end
		if f13_local3 == OPERATOR.SuperFaction.WEST then
			f13_local1 = 0x14CEEC5BBD03E16
			f13_local0 = OPERATOR.SuperFaction.EAST
		else
			f13_local1 = 0x9FE7B37EB72C70C
			f13_local0 = OPERATOR.SuperFaction.WEST
		end
		OPERATOR.SetSelectedOperatorIndex( f13_local2, f13_local0 )
		Lobby.PreloadViewHandsForLocalPlayer( f3_arg0 )
		if f3_arg0.OperatorNametagWest and f3_arg0.OperatorNametagEast then
			f3_arg0.OperatorNametagEast:UpdateForFavoriteSuperfaction( f13_local0 )
			f3_arg0.OperatorNametagWest:UpdateForFavoriteSuperfaction( f13_local0 )
		end
		Engine[0xC4146BA76D0F982]( SOUND_SETS.default.selectAlt )
		LUI.ToastManager.CreateToast( f3_arg0, LUI.ToastManager.StandardEmphasisToast( Engine[0xED84C33EC5F01EA]( 0x4753FE4B1D9F57B ), Engine[0xED84C33EC5F01EA]( f13_local1 ), LUI.ToastManager.ToastNotificationType.Gear ) )
	end
	
	local f3_local2 = function ()
		if f3_arg0.OperatorGridWest and f3_arg0.OperatorGridEast then
			f3_arg0.OperatorNametagEast.LoadoutItemButtonBackground:SetupContextualMenu()
			f3_arg0.OperatorNametagWest.LoadoutItemButtonBackground:SetupContextualMenu()
			local f8_local0 = {
				button = "button_alt1",
				id = "favoriteFaction",
				actionName = Engine[0xED84C33EC5F01EA]( 0x2486425DD7EC08A ),
				conditionFunction = function ( f12_arg0, f12_arg1 )
					local f12_local0 = f8_local0( nil, f12_arg1 )
					local f12_local1 = OPERATOR.IsSuperFactionAlreadySelected( f12_arg1, OPERATOR.SuperFaction.EAST )
					local f12_local2
					if f12_local0 then
						f12_local2 = f12_local0
					else
						f12_local2 = not f12_local1
					end
					return f12_local2
				end,
				actionFunction = function ()
					f8_local0( f8_local0, OPERATOR.SuperFaction.WEST )
				end
			}
			f3_arg0.OperatorNametagEast.LoadoutItemButtonBackground:AddContextualMenuAction( f8_local0 )
			f3_arg0.OperatorNametagWest.LoadoutItemButtonBackground:AddContextualMenuAction( {
				button = "button_alt1",
				id = "favoriteFaction",
				actionName = Engine[0xED84C33EC5F01EA]( 0x2486425DD7EC08A ),
				conditionFunction = function ( f10_arg0, f10_arg1 )
					local f10_local0 = f8_local0( nil, f10_arg1 )
					local f10_local1 = OPERATOR.IsSuperFactionAlreadySelected( f10_arg1, OPERATOR.SuperFaction.WEST )
					local f10_local2
					if f10_local0 then
						f10_local2 = f10_local0
					else
						f10_local2 = not f10_local1
					end
					return f10_local2
				end,
				actionFunction = function ()
					f8_local0( f8_local0, OPERATOR.SuperFaction.EAST )
				end
			} )
		end
	end
	
	f3_arg0.bindButton = LUI.UIBindButton.new()
	f3_arg0.bindButton.id = "selfBindButton"
	f3_arg0:addElement( f3_arg0.bindButton )
	if not CONDITIONS.InFrontend() then
		f3_arg0.bindButton:addEventHandler( "button_secondary", function ( f7_arg0, f7_arg1 )
			ACTIONS.LeaveMenu( f3_arg0 )
		end )
	end
	if f3_arg0.NearestCompletedEast and f3_arg0.NearestCompletedWest and f3_arg0.OperatorNametagWest and f3_arg0.OperatorNametagEast then
		f3_arg0.bindButton:addEventHandler( "button_alt1", function ( f6_arg0, f6_arg1 )
			if f3_arg0( f6_arg1.controller ) then
				f3_arg0( f6_arg1.controller )
			end
		end )
		f3_arg0.bindButton:addEventHandler( "button_left_stick", function ( f5_arg0, f5_arg1 )
			if Dvar[0x9E5BE3B4BBA4E0E]( 0xF5F221A98F7AAE1 ) then
				Engine[0xC4146BA76D0F982]( SOUND_SETS.default.selectAlt )
				OPERATOR.ClearOperatorBreadcrumbs( f5_arg1.controller )
				f3_arg0.OperatorNametagWest.NewItemSmallIcon:UpdateAlpha( 0, 0 )
				f3_arg0.OperatorNametagEast.NewItemSmallIcon:UpdateAlpha( 0, 0 )
			end
		end )
		local f3_local3 = LUI.DataSourceInGlobalModel.new( "menu.spltscreenDisplay.controllerIndex" )
		local f3_local4 = function ()
			local f4_local0 = f3_arg0:GetValue( f3_arg0 )
			if not f4_local0 then
				f4_local0 = Engine[0x45B054C920178E9]()
			end
			if 1 < Engine[0x70187FE84AE61FD]() then
				f3_arg0.OperatorNametagWest:SetSuperfactionIndex( OPERATOR.SuperFaction.WEST, f4_local0 )
				f3_arg0.OperatorNametagEast:SetSuperfactionIndex( OPERATOR.SuperFaction.EAST, f4_local0 )
			end
			f3_arg0:SubscribeToModel( f3_arg0:GetModel( f3_arg0 ), UpdateDisplayForSplitScreen )
			f3_arg0( f3_arg0 )
			local f4_local1 = OPERATOR.FactionHasNewLoots( f3_arg0, OPERATOR.SuperFaction.WEST )
			local f4_local2 = f3_arg0.OperatorNametagWest.NewItemSmallIcon
			local f4_local3 = f4_local2
			f4_local2 = f4_local2.UpdateAlpha
			local f4_local4
			if f4_local1 then
				f4_local4 = 1
			else
				f4_local4 = 0
			end
			f4_local2( f4_local3, f4_local4, 0 )
			f4_local2 = OPERATOR.FactionHasNewLoots( f3_arg0, OPERATOR.SuperFaction.EAST )
			local f4_local5 = f3_arg0.OperatorNametagEast.NewItemSmallIcon
			f4_local4 = f4_local5
			f4_local5 = f4_local5.UpdateAlpha
			local f4_local6
			if f4_local2 then
				f4_local6 = 1
			else
				f4_local6 = 0
			end
			f4_local5( f4_local4, f4_local6, 0 )
			f4_local5 = LAYOUT.GetElementWidth( f3_arg0.NearestCompletedEast )
			f4_local3 = 30 * _1080p
			f4_local4 = f3_arg0.OperatorNametagEast:GetAnchorsAndPosition()
			f4_local4 = f4_local4.right
			f3_arg0.NearestCompletedEast:SetLeft( f4_local4 + f4_local3 )
			f3_arg0.NearestCompletedEast:SetRight( f4_local4 + f4_local5 + f4_local3 )
			f4_local6 = f3_arg0.OperatorNametagWest:GetAnchorsAndPosition()
			f4_local6 = f4_local6.left
			f3_arg0.NearestCompletedWest:SetRight( f4_local6 - f4_local3 )
			f3_arg0.NearestCompletedWest:SetLeft( f4_local6 - f4_local5 - f4_local3 )
		end
		
		f3_arg0.operators, f3_arg0.factionOrdering = OPERATOR.GetAllOperators( f3_arg1 )
	end
end

local f0_local2 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function MPOperatorMenuBase( menu, controller )
	local self = LUI.UIHorizontalNavigator.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "MPOperatorMenuBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "MPOperatorMenuBase", MPOperatorMenuBase )
LockTable( _M )
