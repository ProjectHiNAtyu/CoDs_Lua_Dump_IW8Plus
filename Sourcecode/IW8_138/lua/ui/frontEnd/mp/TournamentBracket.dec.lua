-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 02-09-2025 10:42
module( ..., package.seeall )
LUI.FlowManager.RegisterFenceGroup( "TournamentBracket", {
	nil,
	"tournament"
} )
LUI.FlowManager.RequestSetStack( "TournamentBracket", {
	{
		name = "MainLockoutMenu"
	},
	{
		name = "MainMenu"
	},
	{
		name = "MPMainMenu"
	}
} )
local f0_local0 = "frontEnd.mp.tournamentbracket"
local f0_local1 = function ()
	WipeGlobalModelsAtPath( f0_local0 )
end

function LeaveTournament( f9_arg0, f9_arg1 )
	assert( f9_arg1.TournamentBracket )
	local f9_local0 = {
		title = Engine.CBBHFCGDIC( "MENU/NOTICE" )
	}
	local f9_local1 = Tournament.BEFJGJJBEI()
	if f9_local1 ~= MP.TournamentParticipationStatus.ELIMINATED and f9_local1 ~= MP.TournamentParticipationStatus.VICTORIOUS then
		Engine.BJDBIAGIDA( SOUND_SETS.prestige.prestigeCancel )
	end
	if Lobby.GFFECBCCF() and not Lobby.BGIADHIHAG() then
		f9_local0.message = Engine.CBBHFCGDIC( "XBOXLIVE/LEAVEPARTYANDLOBBY" )
	else
		f9_local0.message = Engine.CBBHFCGDIC( "XBOXLIVE/LEAVELOBBY" )
	end
	f9_local0.yesAction = function ( f11_arg0, f11_arg1 )
		Tournament.DCEADJJC()
		Engine.EBIDFIDHIE( "xstopprivateparty" )
		Engine.EBIDFIDHIE( "xstartprivateparty" )
		LUI.FlowManager.RequestLeaveMenu( f9_arg0.TournamentBracket, true, true )
	end
	
	f9_local0.noAction = function ()
		
	end
	
	local f9_local2 = MenuBuilder.BuildRegisteredType( "PopupYesNo", f9_local0 )
	f9_local2.id = "LeaveTournament"
	return f9_local2
end

MenuBuilder.registerType( "LeaveTournament", LeaveTournament )
function UpdateBracket( f8_arg0 )
	local f8_local0 = Tournament.DEAFAIEJGI()
	for f8_local1 = 1, f8_local0 + 1, 1 do
		local f8_local4 = 2 * 2 ^ (f8_local0 - f8_local1)
		for f8_local5 = 1, f8_local4, 1 do
			local f8_local8 = f8_local1 - 1
			local f8_local9 = (f8_local5 - 1) / 2
			local f8_local10 = (f8_local5 - 1) % 2
			local f8_local11 = Tournament.BCGGEDJHCG( f8_local8, f8_local9, f8_local10 )
			if 0 <= f8_local11 then
				local f8_local12 = Engine.CBBHFCGDIC( Tournament.DGEFHBHJDJ( f8_local11 ) ) .. ":" .. Tournament.DCFJHHBECC( f8_local8, f8_local9, f8_local10 )
				if f8_local11 == Tournament.CCHGIAABHJ() then
					f8_local12 = "->" .. f8_local12
				end
				f8_arg0.bracketList.roundList[f8_local1].teamButton[f8_local5].Text:setText( f8_local12, 0 )
			else
				f8_arg0.bracketList.roundList[f8_local1].teamButton[f8_local5].Text:setText( "" )
			end
			if Tournament.BEBDGHGIEG( f8_local8, f8_local9 ) then
				f8_arg0.bracketList.roundList[f8_local1].teamButton[f8_local5].Text:SetRGBFromTable( COLORS.HighlightBlue )
			else
				f8_arg0.bracketList.roundList[f8_local1].teamButton[f8_local5].Text:SetRGBFromTable( COLORS.white )
			end
		end
	end
	local f8_local1 = Tournament.BEFJGJJBEI()
	if f8_local1 == 0 then
		f8_arg0.ReadyButton.Text:setText( "NOT PARTICIPATING" )
	elseif f8_local1 == 1 then
		if Tournament.DBEBAGHJCA() then
			f8_arg0.ReadyButton.Text:setText( "READY UP (READY)" )
		else
			f8_arg0.ReadyButton.Text:setText( "READY UP (NOT READY)" )
		end
	elseif f8_local1 == 2 then
		f8_arg0.ReadyButton.Text:setText( "ELIMINATED" )
	elseif f8_local1 == 3 then
		f8_arg0.ReadyButton.Text:setText( "VICTORIOUS" )
	end
end

local f0_local2 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0:SetAlpha( 0, 0 )
	f3_arg0:SetAlpha( 1, 400, LUI.EASING.outQuadratic )
	f3_arg0.menuModelPath = f0_local0
	DebugPrint( "TournamentBracket - PostLoadFunc" )
	local f3_local0 = _1080p * 35
	
	local bracketList = LUI.UIHorizontalList.new()
	bracketList:SetAnchorsAndPosition( 0, 1, 0, 1, 100 * _1080p, 200 * _1080p, 600 * _1080p, 700 * _1080p )
	bracketList:SetAlignment( LUI.Alignment.Left )
	bracketList:SetSpacing( f3_local0 )
	bracketList.id = "bracketList"
	bracketList:SetNoWrap( true )
	f3_arg0:addElement( bracketList )
	f3_arg0.bracketList = bracketList
	
	local f3_local2 = Tournament.DEAFAIEJGI()
	bracketList.roundList = {}
	for f3_local3 = 1, f3_local2 + 1, 1 do
		local f3_local6 = 40 * _1080p
		local f3_local7 = f3_local6 + 40 * _1080p
		local f3_local8 = LUI.UIVerticalList.new( {
			verticalAlignment = LUI.Alignment.Middle
		} )
		f3_local8:SetAnchorsAndPosition( 0, 1, 0, 1, 0 * _1080p, 250 * _1080p, 0 * _1080p, 40 * _1080p )
		f3_local8:SetSpacing( f3_local7 * 2 ^ (f3_local3 - 1) - f3_local6 )
		f3_local8.id = "roundList" .. f3_local3
		f3_local8:SetNoWrap( true )
		bracketList:addElement( f3_local8 )
		bracketList.roundList[f3_local3] = f3_local8
		local f3_local9 = 2 * 2 ^ (f3_local2 - f3_local3)
		f3_local8.teamButton = {}
		for f3_local10 = 1, f3_local9, 1 do
			local f3_local13 = MenuBuilder.BuildRegisteredType( "GenericButton", {
				controllerIndex = f3_arg1
			} )
			f3_local13:SetAnchorsAndPosition( 0, 1, 0, 1, 0 * _1080p, 250 * _1080p, 0 * _1080p, f3_local6 )
			f3_local13.id = "teamButton" .. f3_local3 .. "-" .. f3_local10
			f3_local13.roundIndex = f3_local3 - 1
			f3_local13.matchIndex = (f3_local10 - 1) / 2
			f3_local13.Text:SetAlignment( LUI.Alignment.Left )
			f3_local13:addEventHandler( "button_action", function ( f7_arg0 )
				Tournament.CIIGEAICBD( f7_arg0.roundIndex, f7_arg0.matchIndex )
			end )
			f3_local8:addElement( f3_local13 )
			f3_local8.teamButton[f3_local10] = f3_local13
		end
	end
	f3_arg0.ReadyButton:addEventHandler( "button_action", function ( f6_arg0 )
		if Tournament.DBEBAGHJCA() then
			Tournament.DCEGEADDJG( 0 )
		else
			Tournament.DCEGEADDJG( 1 )
		end
	end )
	f3_arg0.bindButton:addEventHandler( "button_secondary", function ( f5_arg0, f5_arg1 )
		local f5_local0 = f5_arg1.controller or f3_arg0
		if not Lobby.AreWePrivatePartyHost() then
			LUI.FlowManager.RequestPopupMenu( nil, "LeaveTournament", true, f5_local0, false, {
				TournamentBracket = f3_arg0
			} )
		else
			Tournament.DCEADJJC()
			ACTIONS.LeaveMenu( f3_arg0 )
		end
		return true
	end )
	if not Lobby.GFFECBCCF() then
		Engine.DAGFFDGFII( "xstartprivateparty", f3_arg1 )
	end
	f3_arg0.ReadyButton.navigation = {}
	f3_arg0.ReadyButton.navigation.down = f3_arg0.bracketList
	f3_arg0.ReadyButton.navigation.left = f3_arg0.LobbyMembers
	f3_arg0.ReadyButton.navigation.right = f3_arg0.LobbyMembers
	f3_arg0.bracketList.navigation = {}
	f3_arg0.bracketList.navigation.up = f3_arg0.ReadyButton
	f3_arg0.bracketList.navigation.left = f3_arg0.LobbyMembers
	f3_arg0.bracketList.navigation.right = f3_arg0.LobbyMembers
	f3_arg0.LobbyMembers.navigation = {}
	f3_arg0.LobbyMembers.navigation.left = f3_arg0.ReadyButton
	f3_arg0.LobbyMembers.navigation.right = f3_arg0.ReadyButton
	local f3_local3 = LUI.UITimer.new( {
		interval = 1000,
		event = {
			name = "refreshBracket"
		}
	} )
	f3_local3.id = "RefreshBracketTimer"
	f3_arg0:addElement( f3_local3 )
	f3_arg0:registerEventHandler( "refreshBracket", function ( element, event )
		UpdateBracket( element )
	end )
	f3_arg0:processEvent( {
		name = "refreshBracket"
	} )
end

function TournamentBracket( menu, controller )
	local self = LUI.UIHorizontalNavigator.new()
	self.id = "TournamentBracket"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	self.HelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	self.HelperBar.id = "HelperBar"
	self.HelperBar:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -85, 0 )
	self.HelperBar:setPriority( 10 )
	self:addElement( self.HelperBar )
	local f1_local2 = self
	local ReadyButton = nil
	
	ReadyButton = MenuBuilder.BuildRegisteredType( "GenericButton", {
		controllerIndex = f1_local1
	} )
	ReadyButton.id = "ReadyButton"
	ReadyButton.Text:SetLeft( _1080p * 20, 0 )
	ReadyButton.Text:setText( ToUpperCase( "READY" ), 0 )
	ReadyButton.Text:SetAlignment( LUI.Alignment.Left )
	ReadyButton:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 130, _1080p * 550, _1080p * 185, _1080p * 223 )
	self:addElement( ReadyButton )
	self.ReadyButton = ReadyButton
	
	local LobbyMembers = nil
	
	LobbyMembers = MenuBuilder.BuildRegisteredType( "LobbyMembers", {
		controllerIndex = f1_local1
	} )
	LobbyMembers.id = "LobbyMembers"
	LobbyMembers:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -589, _1080p * -96, _1080p * 215, _1080p * 859 )
	self:addElement( LobbyMembers )
	self.LobbyMembers = LobbyMembers
	
	local MenuTitle = nil
	
	MenuTitle = MenuBuilder.BuildRegisteredType( "MenuTitle", {
		controllerIndex = f1_local1
	} )
	MenuTitle.id = "MenuTitle"
	MenuTitle.MenuTitle:setText( ToUpperCase( "Tournament Bracket" ), 0 )
	MenuTitle.Line:SetLeft( 0, 0 )
	MenuTitle:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 1020, 0, _1080p * 100 )
	self:addElement( MenuTitle )
	self.MenuTitle = MenuTitle
	
	local FrontendCameraMover = nil
	
	FrontendCameraMover = MenuBuilder.BuildRegisteredType( "FrontendCameraMover", {
		controllerIndex = f1_local1
	} )
	FrontendCameraMover.id = "FrontendCameraMover"
	FrontendCameraMover:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -300, _1080p * 200, _1080p * -400, _1080p * 400 )
	self:addElement( FrontendCameraMover )
	self.FrontendCameraMover = FrontendCameraMover
	
	local f1_local7 = nil
	if CONDITIONS.InFrontendPublicMP( self ) then
		f1_local7 = MenuBuilder.BuildRegisteredType( "MPPlayerDetails", {
			controllerIndex = f1_local1
		} )
		f1_local7.id = "MPPlayerDetails"
		f1_local7:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1404, _1080p * 1824, _1080p * 54, _1080p * 114 )
		self:addElement( f1_local7 )
		self.MPPlayerDetails = f1_local7
	end
	self.HelperBar.ButtonHelperText:PushButtonPrompt( {
		side = "left",
		button_ref = "button_secondary",
		priority = 1,
		helper_text = Engine.CBBHFCGDIC( "MENU/BACK" )
	} )
	self.HelperBar.ButtonHelperText:PushButtonPrompt( {
		side = "left",
		button_ref = "button_primary",
		priority = 2,
		helper_text = Engine.CBBHFCGDIC( "LUA_MENU/SELECT" )
	} )
	self.HelperBar.ButtonHelperText:PushButtonPrompt( {
		side = "left",
		priority = 1,
		kbmTooltipPromptOverload = "button_quick_options",
		button_ref = "button_start",
		helper_text = Engine.CBBHFCGDIC( "LUA_MENU/OPTIONS" )
	} )
	
	local bindButton = LUI.UIBindButton.new()
	bindButton.id = "selfBindButton"
	self:addElement( bindButton )
	self.bindButton = bindButton
	
	self.bindButton:addEventHandler( "button_start", function ( f2_arg0, f2_arg1 )
		ACTIONS.OpenOptionsMenu( f2_arg1.controller or menu, "" )
	end )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "TournamentBracket", TournamentBracket )
LUI.FlowManager.RegisterStackPopBehaviour( "TournamentBracket", f0_local1 )
LockTable( _M )
