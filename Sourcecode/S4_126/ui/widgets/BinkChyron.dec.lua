-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
module( ..., package.seeall )
require( "ui.widgets.ChyronDisplay" )
local f0_local0 = 150
local f0_local1 = 1000
local f0_local2 = 5000
local f0_local3 = function ( f6_arg0, f6_arg1 )
	f6_arg0._chyronStarted = true
	f6_arg0.ChyronDisplay:SetVisible( true )
	local f6_local0 = {
		f6_arg1.chyronLine1,
		f6_arg1.chyronLine2,
		f6_arg1.chyronLine3,
		f6_arg1.chyronLine4,
		f6_arg1.chyronLine5
	}
	local f6_local1 = function ()
		f6_arg0.ChyronDisplay:ResetChyron()
	end
	
	f6_arg0.ChyronDisplay:StartChyron( f6_local0, f6_arg1.transitionInAnim, function ()
		local f7_local0 = f6_arg0:Wait( f6_arg0.displayTime, true )
		f7_local0.onComplete = function ()
			f7_local0.ChyronDisplay:EndChyron( f7_local0.transitionOutAnim, f7_local0, f7_local0._controllerIndex )
		end
		
	end, f6_arg0._controllerIndex )
end

local f0_local4 = function ( f4_arg0, f4_arg1 )
	if not f4_arg0.frameCheckTimer then
		local self = LUI.UITimer.new( {
			interval = 1,
			event = {
				name = "bink_chyron_frame_poll"
			}
		} )
		self.id = "frameCheckTimer"
		f4_arg0.frameCheckTimer = self
		f4_arg0:addElement( self )
		f4_arg0.frameCheckTimer:registerEventHandler( "bink_chyron_frame_poll", function ()
			local f5_local0 = Engine[0xC54490BA7C61D26]()
			if not f4_arg0._chyronStarted then
				if f4_arg0.showFrame <= f5_local0 and f5_local0 <= f4_arg0.showFrame + f4_arg0 then
					f4_arg0( f4_arg0, f4_arg0 )
				end
			elseif f4_arg0.showFrame + f4_arg0 <= f5_local0 then
				f4_arg0._chyronStarted = false
				f4_arg0.ChyronDisplay:SetVisible( false )
			end
		end )
	end
end

local f0_local5 = function ( f3_arg0, f3_arg1 )
	if f3_arg0._videoName == f3_arg1 then
		return 
	end
	f3_arg0._videoName = f3_arg1
	f3_arg0._chyronStarted = false
	f3_arg0.ChyronDisplay:SetVisible( false )
	local f3_local0 = StringTable[0x8073B436CDE1BF]( CSV.levelsMovieChyrons.file, CSV.levelsMovieChyrons.cols.movieName, f3_arg1 )
	if f3_local0 and -1 < f3_local0 then
		local f3_local1 = CSV.ReadRow( CSV.levelsMovieChyrons, f3_local0 )
		f3_local1.showFrame = tonumber( f3_local1.showFrame ) or 0
		f3_local1.displayTime = tonumber( f3_local1.displayTime ) or f0_local0
		if not f3_local1.transitionInAnim or f3_local1.transitionInAnim == "" then
			f3_local1.transitionInAnim = "TransitionIn"
		end
		f0_local0( f3_arg0, f3_local1 )
	else
		assert( false, "Missing chyron data for " .. f3_arg0._videoName .. ".  Add chyron data to levels_movie_chyrons.csv" )
	end
end

local f0_local6 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.UpdateBinkChyron = f0_local0
	f2_arg0.ChyronDisplay:ResetChyron()
	f2_arg0._controllerIndex = f2_arg1
end

function BinkChyron( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "BinkChyron"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local ChyronDisplay = nil
	
	ChyronDisplay = MenuBuilder.BuildRegisteredType( "ChyronDisplay", {
		controllerIndex = f1_local1
	} )
	ChyronDisplay.id = "ChyronDisplay"
	ChyronDisplay.ChyronLine5:SetLeft( 0, 0 )
	ChyronDisplay.ChyronLine4:SetLeft( 0, 0 )
	ChyronDisplay.ChyronLine3:SetLeft( 0, 0 )
	ChyronDisplay.ChyronLine2:SetLeft( 0, 0 )
	ChyronDisplay.ChyronLine1:SetLeft( 0, 0 )
	ChyronDisplay:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 130, _1080p * 1105, _1080p * 713, _1080p * 954 )
	self:addElement( ChyronDisplay )
	self.ChyronDisplay = ChyronDisplay
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "BinkChyron", BinkChyron )
LockTable( _M )
