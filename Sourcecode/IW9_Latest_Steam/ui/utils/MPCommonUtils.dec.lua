-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:48
MP_COMMON = MP_COMMON or {}
MP_COMMON.postShipFlags = {
	forcedWZControllerLayoutReset = 1,
	overkillSwap = 0
}
MP_COMMON.LEAVE_MAIN_GAMEMODE_MENU_POPUP_NAME = "LeaveMainGamemodeMenuPopup"
MP_COMMON.RATE_LIMITED_LEAVE_MAIN_GAMEMODE_MENU_POPUP_NAME = "RateLimitedLeaveMainGamemodeMenuPopup"
MP_COMMON.SetupOnline = function ()
	Dvar[0x8EA06EEDB58D872]( 0x62400405F9F3C0B, true )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xCC8C81329E0BDBF ) then
		Dvar[0x8EA06EEDB58D872]( 0xCC8C81329E0BDBF, false )
		Dvar[0x8EA06EEDB58D872]( 0x539B36C7ADB4813, true )
	end
end

MP_COMMON.SetupParty = function ( f18_arg0 )
	local f18_local0 = Engine[0x45B054C920178E9]()
	if not Lobby[0x63537242F1D48FF]() then
		Social[0x4CFFBE37F5E69BB]( f18_local0, f18_arg0 )
	end
end

MP_COMMON.StopGameLobbyAndWakePrivateParty = function ()
	Engine[0xB81A5136C5503E4]( "xstopparty", Engine[0x45B054C920178E9]() )
end

MP_COMMON.StartPrivateMatchLobbyDs = function ( f16_arg0 )
	if BuiltInEsports[0x9894ED459E76619]() and f16_arg0 ~= "big" then
		f16_arg0 = "esports"
	end
	local f16_local0 = Dvar[0x54084D7CA2317BB]( 0xCEE007DC8631609 )
	if f16_local0 and f16_local0 ~= "" then
		f16_arg0 = f16_local0
	end
	Dvar[0xE3CB005036E0C0F]( 0xD59DD7C536C9DC, f16_arg0 )
	Engine[0xB81A5136C5503E4]( "xstartprivatematchlobby" )
end

MP_COMMON.StartPrivateMatchLobbyDsRequired = function ( f15_arg0 )
	Dvar[0x2414681ECAB880F]( 0x2FFBD81B5FEF078, Enum[0x870710B3AC3F3C9][0x1DD3CEAFC43A598] )
	MP_COMMON.StartPrivateMatchLobbyDs( f15_arg0 )
end

MP_COMMON.StartPrivateMatchLobbyDsOptional = function ( f14_arg0 )
	Dvar[0x2414681ECAB880F]( 0x2FFBD81B5FEF078, Enum[0x870710B3AC3F3C9][0xB30D3FC90392A8E] )
	MP_COMMON.StartPrivateMatchLobbyDs( f14_arg0 )
end

MP_COMMON.StartPrivateMatchLobbyDsNone = function ( f13_arg0 )
	Dvar[0x2414681ECAB880F]( 0x2FFBD81B5FEF078, Enum[0x870710B3AC3F3C9][0x80A6307B27393DA] )
	MP_COMMON.StartPrivateMatchLobbyDs( f13_arg0 )
end

MP_COMMON.IsPrivateMatchLobbyUsingDs = function ()
	return Enum[0x870710B3AC3F3C9][0x80A6307B27393DA] < Dvar[0x22EAAB59AA27E9B]( 0x2FFBD81B5FEF078 )
end

MP_COMMON.SetupPrivateMatchParty = function ()
	Engine[0xB81A5136C5503E4]( "xsetupprivatematchparty" )
	if CONDITIONS.IsThirdGameMode() then
		Engine[0xB81A5136C5503E4]( "exec private_match_cp_globals.cfg" )
	else
		Engine[0xB81A5136C5503E4]( "exec private_match_mp_globals.cfg" )
	end
end

MP_COMMON.StartPrivateMatch = function ( f10_arg0 )
	Lobby[0x34DCEF780B7406B]( f10_arg0 )
end

MP_COMMON.SetupStreaming = function ( f9_arg0, f9_arg1 )
	Streaming[0xE493C1B436663F6]( true )
	f9_arg0:addElement( MP.GetGameModeMaterialStreamer() )
	f9_arg0:addElement( Lobby.GetMPMapMaterialStreamer() )
	f9_arg0:addElement( MPLobbyHints.GetMPMapPreloadStreamer( f9_arg1 ) )
	MP_COMMON.LoadStreamingModels( f9_arg0, f9_arg1, LOADOUT.GetFavoriteLoadoutIndex( f9_arg1 ) )
end

MP_COMMON.LoadStreamingModels = function ( f8_arg0, f8_arg1, f8_arg2, f8_arg3 )
	local f8_local0 = LOADOUT.GetLoadoutSquadMember( f8_arg1 )
	f8_local0 = f8_local0.loadouts
	if not f8_arg3 then
		local f8_local1 = {}
		for f8_local2 = 0, 1, 1 do
			local f8_local5 = f8_local0[f8_arg2].weaponSetups[f8_local2]
			local f8_local6 = WEAPON.GetWeaponModelNameFromPlayerData( f8_local5.weapon:get(), f8_local5, {
				includeCamos = true,
				includeAttachments = true,
				includeStickers = true,
				controllerIndex = f8_arg1
			} )
			if f8_local6 and 0 < #f8_local6 then
				table.insert( f8_local1, f8_local6 )
			end
		end
		local f8_local3 = WATCH.GetFullModelName( WATCH.GetEquippedWatch( f8_arg1 ) )
		if f8_local3 and 0 < #f8_local3 then
			table.insert( f8_local1, f8_local3 )
		end
		if 0 < #f8_local1 then
			STREAMING.RequestModels( f8_arg1, {
				requesterWidget = f8_arg0,
				modelType = STREAMING.ModelTypes.WeaponView,
				models = f8_local1
			} )
		end
	end
	local f8_local1 = {}
	local f8_local2 = {}
	for f8_local3 = 0, 1, 1 do
		local f8_local6, f8_local8 = OPERATOR.GetEquippedOperatorSkin( f8_arg1, f8_local3 )
		if f8_local6 and f8_local6 ~= "" then
			table.insert( f8_local1, f8_local6 )
		end
		if f8_local8 and f8_local8 ~= "" then
			table.insert( f8_local2, f8_local8 )
		end
	end
	if 0 < #f8_local1 and 0 < #f8_local2 then
		STREAMING.RequestModels( f8_arg1, {
			requesterWidget = f8_arg0,
			modelType = STREAMING.ModelTypes.Body,
			models = f8_local1
		} )
		STREAMING.RequestModels( f8_arg1, {
			requesterWidget = f8_arg0,
			modelType = STREAMING.ModelTypes.Head,
			models = f8_local2
		} )
	end
end

MP_COMMON.TriggerLeaveMainGamemodeMenu = function ( f7_arg0, f7_arg1 )
	local f7_local0 = true
	if CONDITIONS.ArePartiesEnabledInMainMenu() and Lobby[0x6957722EF74F5D2]() then
		f7_local0 = false
	end
	if CONDITIONS.IsLFPEnabled() then
		LFP.StopSearchAndClearPreferences( f7_arg1.controller )
	end
	if Lobby.IsNotAloneInPrivateParty() and f7_local0 then
		if Engine[0x688D9FAA39ECE94]() then
			LUI.FlowManager.RequestPopupMenu( f7_arg0, MP_COMMON.RATE_LIMITED_LEAVE_MAIN_GAMEMODE_MENU_POPUP_NAME, true, f7_arg1.controller, false, {
				rateLimitIntervalMS = 5000,
				rateLimitAttempts = 3,
				menu = f7_arg0
			} )
		elseif PARTY.IsLocalPlayerPartyQueuing() then
			PARTY.LeaveParty( f7_arg0, f7_arg1.controller, Social[0xBE9B627D9C821F6]() )
		else
			LUI.FlowManager.RequestPopupMenu( f7_arg0, MP_COMMON.LEAVE_MAIN_GAMEMODE_MENU_POPUP_NAME, true, f7_arg1.controller, false, {
				menu = f7_arg0
			} )
		end
	else
		Lobby.LeaveMainGamemodeMenu( f7_arg0, f7_arg1.controller )
	end
	return true
end

MP_COMMON.RefreshDataForFirstController = function ()
	if 0 < Engine[0x70187FE84AE61FD]() then
		local f6_local0 = Engine[0x45B054C920178E9]()
		if f6_local0 and Engine[0xD2813B521711C11]( f6_local0 ) then
			Engine[0x404BD1F5B45E2F]()
		end
	end
end

MP_COMMON.IsMatchRulesCODCastingEnabled = function ( f5_arg0 )
	local f5_local0 = true
	if MatchRules[0x1A6D0B2E15DF8CF]() then
		f5_local0 = MatchRules[0x3A9F1F51625857F]( "commonOption", "codcasterEnabled" )
	end
	local f5_local1 = false
	if f5_arg0 then
		f5_local1 = 1 < Engine[0x70187FE84AE61FD]()
	end
	local f5_local2
	if f5_local0 then
		f5_local2 = f5_local0
	else
		f5_local2 = not f5_local1
	end
	return f5_local2
end

MP_COMMON.IsMatchRulesSpectateModeFree = function ()
	local f4_local0 = MatchRules[0x1A6D0B2E15DF8CF]()
	if f4_local0 then
		f4_local0 = MatchRules[0x3A9F1F51625857F]( Lobby.MatchRulesClasses.CommonOption, Lobby.MatchRulesMembers.SpectateModeAllowed ) == 2
	end
	return f4_local0
end

MP_COMMON.IsMatchRulesTeamAssignmentEnabled = function ()
	if MatchRules[0x1A6D0B2E15DF8CF]() then
		return MatchRules[0x3A9F1F51625857F]( "commonOption", "teamAssignmentAllowed" )
	else
		return true
	end
end

MP_COMMON.ValidatePlayerData = function ( f2_arg0, f2_arg1 )
	PERK.ValidatePlayerData( f2_arg0, f2_arg1 )
	MP_COMMON.ResetWZControllerLayout( f2_arg0, f2_arg1 )
end

MP_COMMON.ResetWZControllerLayout = function ( f1_arg0, f1_arg1 )
	local f1_local0 = PLAYER_DATA.IO( f1_arg0, CoD.StatsGroup.NonGame, CoD.PlayMode.Core, f1_arg1 )
	local f1_local1 = MP_COMMON.postShipFlags.forcedWZControllerLayoutReset
	if f1_local0.postShipFlags[f1_local1]:get() < 1 then
		local f1_local2 = Engine[0x7B17D94988FD5D0]( "gpadBRButtonsConfig", f1_arg0 )
		if f1_local2 == "buttons_br_ping_lb" or f1_local2 == "buttons_br_ping_lb_alt" then
			Engine[0x23F1D3C77CE5C6]( Engine[0x7B17D94988FD5D0]( "gpadButtonsConfig", f1_arg0 ), f1_arg0, true )
		end
		f1_local0.postShipFlags[f1_local1]:set( 1 )
	end
end

