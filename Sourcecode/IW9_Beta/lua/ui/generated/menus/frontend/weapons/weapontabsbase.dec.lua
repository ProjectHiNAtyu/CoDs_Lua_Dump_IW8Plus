-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:01
module( ..., package.seeall )
local f0_local0 = 3
local f0_local1 = {
	description = nil,
	iconScale = 4.667263495923649E-62,
	displayTime = 3000,
	icon = "cac_equip_fill",
	controllerIndex = 0,
	iconColor = SWATCHES.genericMenu.notificationHighlight,
	header = Engine[0xED84C33EC5F01EA]( 0xE1DD4086AE4AD11 ),
	type = LUI.ToastManager.NotificationType.WeaponEquipped
}
local f0_local2 = function ( f38_arg0, f38_arg1, f38_arg2 )
	local f38_local0 = {}
	table.insert( f38_local0, f38_arg0._otherSelectedModel )
	table.insert( f38_local0, f38_arg0._equippedWatchModel )
	local f38_local1 = LUI.FlowManager.GetScopedData( f38_arg0 )
	local f38_local2 = nil
	for f38_local3 = f38_arg2 - 1, f38_arg2 + 1, 1 do
		local f38_local6
		if #f38_arg0._currentWeapons < f38_local3 then
			f38_local6 = 1
		elseif f38_local3 == 0 then
			f38_local6 = #f38_arg0._currentWeapons
		end
		local f38_local7 = assert
		local f38_local8
		if 0 >= f38_local6 or f38_local6 > #f38_arg0._currentWeapons then
			f38_local8 = false
		else
			f38_local8 = true
		end
		f38_local7( f38_local8 )
		local f38_local9 = WEAPON.GetWeaponModelNameFromRef( f38_arg0._currentWeapons[f38_local6].bundleData[0x9E9C01960F4C582] )
		if not LUI.IsItemInArray( f38_local0, f38_local9 ) then
			if f38_local6 == f38_arg2 then
				f38_local2 = f38_local9
			else
				table.insert( f38_local0, f38_local9 )
			end
		end
	end
	if f38_local2 then
		table.insert( f38_local0, f38_local2 )
	end
	if 0 < #f38_local0 then
		FrontEndScene.RequestWeaponViewModels( f38_local0, f38_arg1 )
	end
end

local f0_local3 = function ( f37_arg0, f37_arg1, f37_arg2 )
	local f37_local0 = {}
	for f37_local1 = f37_arg2 - 1, f37_arg2 + 1, 1 do
		if 1 <= f37_local1 and f37_local1 <= #f37_arg0._tabsData and f37_local1 ~= f37_arg2 then
			local f37_local4 = WEAPON.GetWeaponModelNameFromRef( f37_arg0._tabsData[f37_local1].weaponData[1].bundleData[0x9E9C01960F4C582] )
			if not LUI.IsItemInArray( f37_local0, f37_local4 ) then
				table.insert( f37_local0, f37_local4 )
			end
		end
	end
	if not LUI.IsItemInArray( f37_local0, f37_arg0._otherSelectedModel ) then
		table.insert( f37_local0, f37_arg0._otherSelectedModel )
		table.insert( f37_local0, f37_arg0._equippedWatchModel )
	end
	if 0 < #f37_local0 then
		FrontEndScene.RequestWeaponViewModels( f37_local0, f37_arg1 )
	end
end

local f0_local4 = function ( f36_arg0, f36_arg1, f36_arg2, f36_arg3 )
	if f36_arg2.isBlueprint then
		return WEAPON.GetWeaponModelName( f36_arg2.weaponData.bundleData[0x9E9C01960F4C582], f36_arg2.weaponData.blueprint, {
			includeAttachments = true,
			controllerIndex = f36_arg1
		} )
	else
		return WEAPON.GetWeaponModelNameFromRef( f36_arg2.weaponData.bundleData[0x9E9C01960F4C582] )
	end
end

local f0_local5 = function ( f32_arg0, f32_arg1, f32_arg2, f32_arg3, f32_arg4, f32_arg5 )
	local f32_local0 = f0_local0( f32_arg0, f32_arg1, f32_arg2, f32_arg5.weaponSetups[f32_arg4] )
	if f32_arg0._currentWeaponModel then
		local f32_local1 = function ()
			local f34_local0 = WEAPON.GetWeaponClass( f32_arg0._weaponData.ref )
			if f32_arg0 == FrontEndScene.ClientWeapons.GunTableSecondary and f34_local0 == "weapon_projectile" then
				CLIENT_MODEL.SetLauncherCase( f32_arg0._weaponData.ref )
				ClientWeapon[0x59B77D6F41ED417]( FrontEndScene.ClientWeapons.GunTableSecondary, false )
			else
				assert( f32_arg0._nextWeaponModel )
				f32_arg0._currentWeaponModel = f32_arg0._nextWeaponModel
				f32_arg0._nextWeaponModel = nil
				f32_arg0:SetWeaponModel( f32_arg0._currentWeaponModel )
				local f34_local1 = f32_arg0:Wait( 5, true )
				f34_local1.onComplete = function ()
					if f34_local0._secondaryWeaponModel and f34_local0 == WEAPON.PrimarySlot then
						f34_local0._secondaryWeaponModel:SetOffsetsAndRotations( f34_local0._otherSelectedModel )
					elseif f34_local0 == WEAPON.SecondarySlot then
						f34_local0:SetOffsetsAndRotations( f34_local0._currentWeaponModel )
					end
				end
				
				if f32_arg0.hidden then
					f32_arg0:SetAnchorsAndPosition( 0, 0, 0, 1, _1080p * -302, _1080p * 779, _1080p * 290, _1080p * 740, 0 )
					f32_arg0.hidden = false
				end
				local f34_local2 = LUI.Split( f32_arg0._otherSelectedModel, "+" )
				local f34_local3 = WEAPON.StripSuffix( f34_local2[1], "_mp" )
				local f34_local4 = WEAPON.GetWeaponClass( f34_local3 )
				CLIENT_MODEL.SetLauncherCase( f34_local3 )
				if f34_local4 == "weapon_projectile" then
					ClientWeapon[0x59B77D6F41ED417]( FrontEndScene.ClientWeapons.GunTableSecondary, false )
				end
			end
		end
		
		f32_arg0._nextWeaponModel = f32_local0
		assert( f32_arg0._nextWeaponModel )
		if Streaming[0xBE636A91711ED30]( {
			f32_arg0._nextWeaponModel
		}, f32_arg1 ) then
			f32_local1()
		else
			local f32_local2 = nil
			local f32_local3 = function ()
				if f32_arg0._nextWeaponModel then
					if Streaming[0xBE636A91711ED30]( {
						f32_arg0._nextWeaponModel
					}, f32_arg0 ) then
						f32_arg0()
					else
						local f33_local0 = f32_arg0:Wait( 100, true )
						f33_local0.onComplete = f32_arg0
						f32_arg0:SetAnchorsAndPosition( 0, 0, 0, 1, _1080p * -302, _1080p * 779, _1080p * 1500, _1080p * 1500, 0 )
						f32_arg0.hidden = true
					end
				end
			end
			
			f32_local3()
		end
	end
	if f32_arg4 == FrontEndScene.ClientWeapons.GunTableSecondary and WEAPON.GetWeaponClass( f32_arg2._weaponData.ref ) == "weapon_projectile" then
		CLIENT_MODEL.SetLauncherCase( f32_arg2._weaponData.ref )
		ClientWeapon[0x59B77D6F41ED417]( FrontEndScene.ClientWeapons.GunTableSecondary, false )
	else
		f32_arg3:SetWeaponModel( f32_local0 )
		f32_arg0._currentWeaponModel = f32_local0
		f32_arg0._nextWeaponModel = nil
		local f32_local2 = LUI.Split( f32_arg0._otherSelectedModel, "+" )
		local f32_local3 = WEAPON.StripSuffix( f32_local2[1], "_mp" )
		local f32_local4 = WEAPON.GetWeaponClass( f32_local3 )
		CLIENT_MODEL.SetLauncherCase( f32_local3 )
		if f32_local4 == "weapon_projectile" then
			ClientWeapon[0x59B77D6F41ED417]( FrontEndScene.ClientWeapons.GunTableSecondary, false )
		end
	end
end

local f0_local6 = function ( f31_arg0, f31_arg1 )
	if CONDITIONS.InFrontend() then
		f31_arg0._secondaryWeaponModel = WEAPON.GetWeaponModel( f31_arg1, WEAPON.SecondarySlot )
		f31_arg0:addElement( f31_arg0._secondaryWeaponModel )
		FrontEndScene.SetExclusiveWeaponModels( {
			FrontEndScene.ClientWeapons.GunTablePrimary,
			FrontEndScene.ClientWeapons.GunTableSecondary,
			FrontEndScene.ClientWeapons.Watch
		} )
		local f31_local0 = MenuBuilder.BuildRegisteredType( "FrontendCameraMover", {
			enableSway = true,
			controllerIndex = f31_arg1
		} )
		f31_local0:SetSwayValues( 2000, 0.1, 0.1 )
		f31_arg0.FrontendCameraMover = f31_local0
		f31_arg0:addElement( f31_local0 )
	end
end

local f0_local7 = function ( f30_arg0, f30_arg1 )
	local f30_local0 = -0.6
	local f30_local1 = 0.6
	local f30_local2 = -0.6
	local f30_local3 = 0.6
	local f30_local4 = 3500
	local f30_local5 = ""
	local f30_local6 = WEAPON.GetWeaponClass( f30_arg1 )
	if f30_arg0._weaponSlot == WEAPON.PrimarySlot then
		f30_local5 = "loadout_showcase_p"
	else
		f30_local5 = WEAPON.GetGunTableSecondPositionScene( f30_arg1 )
		if f30_local5 == "loadout_showcase_s" then
			local f30_local7 = -0.3
			local f30_local8 = 0.3
			local f30_local9 = -0.3
			f30_local3 = 0.3
			f30_local2 = f30_local9
			f30_local1 = f30_local8
			f30_local0 = f30_local7
			f30_local4 = 4500
		end
	end
	if f30_arg0._currentCamera ~= f30_local5 then
		f30_arg0._currentCamera = f30_local5
		Engine[0x685AE31DEDA30A4]( f30_arg0._currentCamera )
	end
	f30_arg0.FrontendCameraMover:SetLimits( f30_local0, f30_local1, f30_local2, f30_local3 )
	f30_arg0.FrontendCameraMover:SetSwayValues( f30_local4, 0.06, 0.1 )
end

local f0_local8 = function ( f29_arg0, f29_arg1, f29_arg2 )
	if f29_arg2._equippedWeapon ~= f29_arg0.weaponData.ref and not CONDITIONS.IsMobileOrMobileSim() then
		f0_local0.description = Engine[0xED84C33EC5F01EA]( f29_arg0.weaponData.name )
		f0_local0.controllerIndex = f29_arg1
		f29_arg2:dispatchEventToRoot( {
			name = "send_toast_notification",
			immediate = true,
			options = f0_local0
		} )
	end
	if DMZ.IsLimitedInventoryEnabled() and DMZ.IsInstanceInventoryEnabled() then
		DMZ.EquipInstanceInventoryWeapon( f29_arg2._weaponSlot, f29_arg0.weaponData.ref, f29_arg0.weaponData.blueprint )
	elseif f29_arg0.isBlueprint then
		WEAPON.EquipModification( f29_arg2._loadoutPlayerData.weaponSetups[f29_arg2._weaponSlot], f29_arg0.weaponData.blueprint, f29_arg1 )
	else
		WEAPON.EquipBaseWeapon( f29_arg2._loadoutPlayerData.weaponSetups[f29_arg2._weaponSlot], f29_arg0.weaponData.ref )
		GUNSMITH.EquipBaseWeaponPartsAttachment( f29_arg1, f29_arg2._loadoutPlayerData.weaponSetups[f29_arg2._weaponSlot] )
	end
end

local f0_local9 = function ( f28_arg0, f28_arg1, f28_arg2 )
	local f28_local0 = f28_arg0._equippedWeapon.weapon
	local f28_local1 = f28_arg2.bundleData[0x9E9C01960F4C582]
	if f28_local0 ~= f28_local1 and not CONDITIONS.IsMobileOrMobileSim() then
		f0_local0.description = Engine[0xED84C33EC5F01EA]( f28_arg2.bundleData[0x4BCADBA8E631B86] )
		f0_local0.controllerIndex = f28_arg1
		f28_arg0:dispatchEventToRoot( {
			name = "send_toast_notification",
			immediate = true,
			options = f0_local0
		} )
	end
	WEAPON.EquipBaseWeapon( f28_arg0._loadoutPlayerData.weaponSetups[f28_arg0._weaponSlot], f28_local1 )
	GUNSMITH.EquipBaseWeaponPartsAttachment( f28_arg1, f28_arg0._loadoutPlayerData.weaponSetups[f28_arg0._weaponSlot] )
	LUI.FlowManager.RequestLeaveMenu( f28_arg0, false )
end

local f0_local10 = function ( f26_arg0, f26_arg1, f26_arg2, f26_arg3, f26_arg4 )
	return function ( f27_arg0, f27_arg1 )
		if Engine[0x12586A3F4FB490E]() then
			f26_arg0( f26_arg0, f26_arg0._weaponData.ref )
		end
		f26_arg0.InfoPanel:UpdatePanel( f26_arg0._weaponData, WEAPON.GenerateWeaponTable( f26_arg0.weaponSetups[f26_arg0._weaponSlot] ) )
		f26_arg0._currentSelection = {
			weapon = f26_arg0._weaponData.ref,
			blueprint = f26_arg0._weaponData.blueprint
		}
		if Engine[0x12586A3F4FB490E]() then
			f26_arg0( f26_arg0, f26_arg0, f26_arg0.gridIndex, f26_arg0 )
			f26_arg0( f26_arg0, f26_arg0, f26_arg0, f26_arg0._weaponModel, f26_arg0._weaponSlot, f26_arg0 )
		end
		local f27_local0 = LUI.FlowManager.GetScopedData( f26_arg0 )
		f27_local0.previousFocusedButton = f26_arg0
	end
	
end

local f0_local11 = function ( f23_arg0, f23_arg1, f23_arg2, f23_arg3, f23_arg4, f23_arg5 )
	local f23_local0 = 1 - f23_arg0._weaponSlot
	local f23_local1 = f23_arg5.weaponSetups[f23_arg0._weaponSlot]
	local f23_local2 = f23_arg5.weaponSetups[f23_local0]
	local f23_local3 = f23_local1.weapon:get()
	local f23_local4 = f23_local2.weapon:get()
	f23_arg2.weaponData = f23_arg3
	f23_arg2.gridIndex = f23_arg4
	local f23_local5 = f23_arg3.bundleData[0x9E9C01960F4C582]
	local f23_local6 = f23_local4 == f23_local5
	local f23_local7
	if f23_local3 ~= f23_local5 then
		f23_local7 = f23_local6
	else
		f23_local7 = true
	end
	local f23_local8 = PROGRESSION.GetWeaponDisplayLevel( f23_arg1, f23_local5 )
	local f23_local9 = PROGRESSION.GetMaxWeaponDisplayLevel( f23_local5 ) + 1
	local f23_local10 = WEAPON.GenerateWeaponTableFromRef( f23_local5 )
	f23_local10.header = Engine[0xED84C33EC5F01EA]( f23_arg3.bundleData[0x4BCADBA8E631B86] )
	f23_local10.desc = WEAPON.GetDesc( f23_local5 )
	f23_local10.subHeader = Engine[0xED84C33EC5F01EA]( 0x4A671D1E2689A57, f23_local8, f23_local9 )
	f23_local10.numBlueprints = f23_arg0._blueprintsByWeapon[f23_local5] and #f23_arg0._blueprintsByWeapon[f23_local5] - 1 or 0
	f23_local10.savedMods = GUNSMITH.GetCustomModsForWeapon( f23_arg1, f23_local5 )
	f23_local10.isAlreadyEquipped = f23_local6
	f23_local10.isEquipped = f23_local7
	f23_local10.isUnlocked = f23_arg3.isUnlocked
	f23_local10.weaponLevel = f23_local8
	f23_local10.weaponSlot = f23_arg0._weaponSlot
	f23_local10.ref = f23_local5
	f23_arg2:Setup( f23_arg1, f23_local10, f23_arg4, f23_local7, function ( f25_arg0, f25_arg1, f25_arg2 )
		if f23_arg0.weaponSetups[f23_arg0._weaponSlot].weapon:get() ~= f25_arg2.ref and not CONDITIONS.IsMobileOrMobileSim() then
			f23_arg0.description = f25_arg2.header
			f23_arg0.controllerIndex = f25_arg1
			f25_arg0:dispatchEventToRoot( {
				name = "send_toast_notification",
				immediate = true,
				options = f23_arg0
			} )
		end
		local f25_local0 = f25_arg0:getParent()
		f25_local0 = f25_local0:getParent()
		WEAPON.EquipBaseWeapon( f25_local0._loadoutPlayerData.weaponSetups[f25_local0._weaponSlot], f25_arg2.ref )
		GUNSMITH.EquipBaseWeaponPartsAttachment( f25_arg1, f25_local0._loadoutPlayerData.weaponSetups[f25_local0._weaponSlot] )
		LUI.FlowManager.RequestLeaveMenu( f25_arg0, false )
	end )
	if not f23_arg2._handlersAdded then
		if CONDITIONS.IsMobileOrMobileSim() then
			f23_arg2:addEventHandler( "button_over_active", f0_local0( f23_arg0, f23_arg2, f23_arg1, f23_arg5, f23_local3 ) )
			f23_arg2:addEventHandler( "button_active", f0_local0( f23_arg0, f23_arg2, f23_arg1, f23_arg5, f23_local3 ) )
			f23_arg2:addEventHandler( "button_over_disable_active", f0_local0( f23_arg0, f23_arg2, f23_arg1, f23_arg5, f23_local3 ) )
		else
			f23_arg2:addEventHandler( "button_over", f0_local0( f23_arg0, f23_arg2, f23_arg1, f23_arg5, f23_local3 ) )
			f23_arg2:addEventHandler( "button_over_disable", f0_local0( f23_arg0, f23_arg2, f23_arg1, f23_arg5, f23_local3 ) )
		end
		f23_arg2:addEventHandler( "tab_changed", f0_local0( f23_arg0, f23_arg2, f23_arg1, f23_arg5, f23_local3 ) )
		f23_arg2:addEventHandler( "button_action", function ( f24_arg0 )
			if GL_HACK.IsInfluencerBuild() then
				f23_arg0( f23_arg0, f23_arg0, f24_arg0.ButtonLarge._config.buttonData )
			else
				LUI.FlowManager.RequestAddMenu( LOADOUT.GetWeaponArmoryMenuRef(), true, f23_arg0, false, {
					selectingForWeapon = true,
					weaponSlot = f23_arg0._weaponSlot,
					loadoutIndex = f23_arg0._loadoutIndex,
					weaponRef = f24_arg0.weaponData.bundleData[0x9E9C01960F4C582]
				} )
			end
		end )
		f23_arg2._handlersAdded = true
	end
	if f23_arg2.WeaponCooldown then
		f23_arg2:SetupWeaponCooldown( f23_arg0._blueprintsByWeapon[f23_arg3.ref] )
	end
	return f23_arg2
end

local f0_local12 = function ( f19_arg0 )
	local f19_local0 = {}
	local f19_local1 = {}
	local f19_local2 = BATTLEPASS.GetLootTierMap()
	for f19_local12, f19_local13 in ipairs( WEAPON.GetWeapons() ) do
		local f19_local14 = f19_local13[0x9E9C01960F4C582]
		local f19_local15 = WEAPON.GetWeaponDataForRef( f19_local14 )
		if f19_local15 then
			local f19_local6
			if not DMZ.IsLimitedInventoryEnabled() then
				f19_local6 = f19_local15[0x4FB3C98AEEAB347]
				if f19_local6 then
					if 0 > f19_local15[0x4FB3C98AEEAB347] then
						f19_local6 = false
					else
						f19_local6 = true
					end
				end
			else
				f19_local6 = false
			end
			local f19_local7 = DMZ.IsLimitedInventoryEnabled()
			if f19_local7 then
				f19_local7 = f19_arg0._blueprintsByWeapon[f19_local14]
			end
			if f19_local6 or f19_local7 then
				local f19_local8 = MatchRules[0x966A6F3A93A1200]( f19_local14 )
				if not f19_local8 then
					local f19_local9 = {
						bundleData = f19_local15
					}
					if not f19_local0[f19_local15[0x56143152458180A]] then
						f19_local0[f19_local15[0x56143152458180A]] = {}
					end
					f19_local9.isUnlocked = PROGRESSION.IsUnlocked( f19_arg0._controllerIndex, LOOT.itemTypes.WEAPON, f19_local14 )
					if not f19_local9.isUnlocked then
						local f19_local10 = f19_local2[LOOT.GetItemID( LOOT.itemTypes.WEAPON, f19_local14 )]
						if f19_local10 then
							f19_local9.unlockCriteria = Engine[0xED84C33EC5F01EA]( 0x86929D0FF4B6624, f19_local10 )
						else
							f19_local9.unlockCriteria = PROGRESSION.GetUnlockText( LOOT.itemTypes.WEAPON, f19_local14 )
						end
					end
					local f19_local11
					if f19_local9.isUnlocked or f19_local15[0xB948E07290E363] ~= true then
						f19_local11 = false
					else
						f19_local11 = true
					end
					if not f19_local11 then
						f19_local9.isRestricted = f19_local8
						if f19_local8 then
							if not f19_local1[f19_local15[0x56143152458180A]] then
								f19_local1[f19_local15[0x56143152458180A]] = {}
							end
							table.insert( f19_local1[f19_local15[0x56143152458180A]], f19_local9 )
						end
						table.insert( f19_local0[f19_local15[0x56143152458180A]], f19_local9 )
					end
				end
			end
		end
	end
	for f19_local12, f19_local13 in pairs( f19_local0 ) do
		table.sort( f19_local13, function ( f22_arg0, f22_arg1 )
			return tonumber( f22_arg0.bundleData[0x4FB3C98AEEAB347] ) < tonumber( f22_arg1.bundleData[0x4FB3C98AEEAB347] )
		end )
	end
	for f19_local12, f19_local13 in pairs( f19_local1 ) do
		table.sort( f19_local13, function ( f21_arg0, f21_arg1 )
			return tonumber( f21_arg0.bundleData[0x4FB3C98AEEAB347] ) < tonumber( f21_arg1.bundleData[0x4FB3C98AEEAB347] )
		end )
	end
	for f19_local12, f19_local13 in pairs( f19_local1 ) do
		for f19_local7, f19_local8 in pairs( f19_local13 ) do
			table.insert( f19_local0[f19_local12], f19_local8 )
		end
	end
	f19_arg0.WeaponsGrid:SetRefreshChild( function ( f20_arg0, f20_arg1, f20_arg2 )
		if f19_arg0._currentWeapons then
			f19_arg0( f19_arg0, f19_arg0._controllerIndex, f20_arg0, f19_arg0._currentWeapons[f20_arg1 + 1], f20_arg1 + 1, f19_arg0._loadoutPlayerData )
		end
	end )
	return f19_local0
end

local f0_local13 = function ( f18_arg0, f18_arg1, f18_arg2 )
	local f18_local0
	if not f18_arg2 then
		f18_local0 = f18_arg2
	else
		f18_local0 = {}
	end
	f18_local0.weaponTable = WEAPON.GenerateWeaponTableFromRef( f18_arg0._currentSelection.weapon )
	LUI.FlowManager.RequestAddMenu( "WeaponPreview", true, f18_arg1, nil, f18_local0, true )
end

local f0_local14 = function ( f15_arg0, f15_arg1, f15_arg2 )
	if CONDITIONS.InFrontend() and CONDITIONS.IsFrontendFiringRangeEnabled() then
		f15_arg0.bindButton:addEventHandler( "button_alt2", function ( f17_arg0, f17_arg1 )
			local f17_local0 = f17_arg0:getParent()
			local f17_local1 = {}
			local f17_local2 = f17_local0.WeaponsGrid:GetFocusPositionIndex()
			if not f17_local2 then
				return 
			end
			local f17_local3 = f17_local0.WeaponsGrid:GetPositionForIndex( f17_local2 )
			local f17_local4 = f17_local0.WeaponsGrid:GetElementAtPosition( f17_local3.x, f17_local3.y )
			local f17_local5 = f17_local4.weaponData
			if not f17_local5.isUnlocked then
				return 
			end
			f17_local1.currentWeaponTable = {
				reticle = nil,
				cosmeticAttachment = nil,
				camo = nil,
				weapon = f17_local5.bundleData[0x9E9C01960F4C582],
				attachments = {}
			}
			f17_local1.fromGunsmith = true
			if f17_local1.currentWeaponTable.variantID and 0 < tonumber( f17_local1.currentWeaponTable.variantID ) then
				f17_local1.currentWeaponTable.lootName = WEAPON.GetLootWeaponName( f17_local1.currentWeaponTable.weapon, f17_local1.currentWeaponTable.lootID )
			end
			LUI.FlowManager.RequestAddMenu( "FiringRangeMenu", true, f15_arg0, false, f17_local1, true )
		end )
		f15_arg0.HelperBar.ButtonHelperText:PushButtonPrompt( {
			side = "left",
			button_ref = "button_alt2",
			helper_text = Engine[0xED84C33EC5F01EA]( 0x142AAF5CD0DA682 )
		} )
	end
	f15_arg0.bindButton:addEventHandler( "button_alt1", function ( f16_arg0, f16_arg1 )
		local f16_local0 = f16_arg0:getParent()
		local f16_local1 = f16_local0.WeaponsGrid:GetFocusPositionIndex()
		if not f16_local1 then
			return 
		end
		local f16_local2 = f16_local0.WeaponsGrid:GetPositionForIndex( f16_local1 )
		local f16_local3 = f16_local0.WeaponsGrid:GetElementAtPosition( f16_local2.x, f16_local2.y )
		local f16_local4 = f16_local3.weaponData
		if not f16_local4.isUnlocked then
			return 
		elseif f16_local3:IsDisabled() then
			return 
		elseif f16_local4.isUnlocked then
			f15_arg0( f16_local0, f15_arg0, f16_local4 )
		end
	end )
end

local f0_local15 = function ( f13_arg0, f13_arg1 )
	if f13_arg1 ~= nil then
		if not f13_arg0.bindButton then
			f13_arg0.bindButton = LUI.UIBindButton.new()
			f13_arg0.bindButton.id = "selfBindButton"
			f13_arg0:addElement( f13_arg0.bindButton )
		end
		f13_arg0.bindButton:registerEventHandler( "button_secondary", function ( element, event )
			local f14_local0 = f13_arg0.activeTabWidget
			local f14_local1 = true
			if f14_local0 and f14_local0.BackButtonOverride then
				f14_local1 = f14_local0.BackButtonOverride( element, event )
			end
			if f14_local1 then
				f13_arg0( element, event )
			end
		end )
	end
end

local f0_local16 = function ( f11_arg0, f11_arg1, f11_arg2, f11_arg3, f11_arg4 )
	local f11_local0 = f11_arg0.WeaponsGrid:GetFocusPositionIndex()
	local f11_local1 = f11_arg0.WeaponsGrid
	local f11_local2 = #f11_arg4
	f11_arg0._currentWeapons = f11_arg4
	f11_local1._shouldFocus = false
	f11_local1:SetNumChildren( f11_local2 )
	f11_local1:RefreshContent()
	f11_local1:SetSnapOnScrollBarMouseDrag( true )
	local f11_local3 = f11_arg0.SideArrows
	if f11_local3 then
		f11_local3:SetupSideButtons( f11_local1, f11_local2, {
			useSetupRowHeight = false
		} )
		f11_local3:UpdateSideButtons()
	end
	local f11_local4 = 0
	for f11_local8, f11_local9 in ipairs( f11_arg4 ) do
		if f11_arg0._equippedWeapon == f11_local9.ref then
			f11_local4 = f11_local8 - 1
			break
		end
	end
	f11_local5 = f11_arg0.WeaponsGrid:GetPositionForIndex( f11_local4, {
		relativePosition = false
	} )
	f11_arg0.WeaponsGrid:ResetMouseActiveOnGridUpdate( f11_arg1, f11_local5 )
	f11_arg0.WeaponsGrid:SetFocusedPosition( f11_local5, true )
	if not CONDITIONS.IsMobileOrMobileSim() then
		f11_arg0.Tabs:addEventHandler( "restore_focus", function ( f12_arg0, f12_arg1 )
			if LUI.IsLastInputMouseNavigation( f12_arg1.controller ) and f12_arg1.data and f12_arg1.data.targetPosition then
				f11_arg0.WeaponsGrid:ResetMouseActiveOnGridUpdate( f12_arg1.controller, f12_arg1.data.targetPosition )
				return true
			else
				
			end
		end )
	end
	if LUI.IsLastInputMouseNavigation( f11_arg1 ) then
		Engine[0xC4146BA76D0F982]( SOUND_SETS.default.tabHighlight )
	end
	f11_local6 = f11_arg0.WeaponsGrid:GetElementAtPosition( f11_local5.x, f11_local5.y )
	if Engine[0x12586A3F4FB490E]() then
		f0_local0( f11_arg0, f11_arg1, f11_arg2, f11_arg3 )
	end
	if f11_local6 then
		f11_local6:processEvent( {
			name = "tab_changed"
		} )
	end
end

local f0_local17 = function ( f9_arg0, f9_arg1, f9_arg2, f9_arg3 )
	local f9_local0 = WEAPON.GetWeaponClassesBundle()
	local f9_local1 = {}
	for f9_local2 = 1, #f9_local0, 1 do
		if f9_local0[f9_local2][0x8B6F2336E5960E5] ~= nil then
			local f9_local5 = Engine[0x6093D047200548]( 0x31E89190F5116C0 .. f9_local0[f9_local2][0x8B6F2336E5960E5] )
			local f9_local6 = WEAPON.AllClassesAllowed()
			if not f9_local6 then
				f9_local6 = f9_local5[0x4F2871862458025] == f9_arg0._availableWeaponSlot + 1
			end
			if f9_local5[0xCAAC3893B4B0135] and f9_local6 and f9_arg3[f9_local5[0xD49626C84A5882C]] then
				if not isInGame or not MatchRules[0xB0FA3D79A09CF96]( f9_local5[0xD49626C84A5882C] ) then
					local f9_local7 = {
						classRef = f9_local5[0xD49626C84A5882C],
						name = Engine[0xED84C33EC5F01EA]( f9_local5[0xAF7FB76CC61B6B8] ),
						focusFunction = function ( f10_arg0, f10_arg1, f10_arg2 )
							f9_arg0._lastTabIndex = f9_arg0._currentTabIndex
							f9_arg0._currentTabIndex = f10_arg2 + 1
							if not f9_arg0._lastTabIndex then
								f9_arg0._lastTabIndex = f9_arg0._currentTabIndex
							end
							f9_arg0( f9_arg0, f10_arg1, f9_arg0, f9_arg0._loadoutPlayerData, f9_arg0[f9_arg0[0xD49626C84A5882C]] )
						end,
						weaponData = f9_arg3[f9_local5[0xD49626C84A5882C]]
					}
					if f9_local5[0xD49626C84A5882C] == WEAPON.GetWeaponClass( f9_arg0._equippedWeapon ) then
						f9_local7.hasDefaultFocus = true
					end
					table.insert( f9_local1, f9_local7 )
				end
			end
		end
	end
	return f9_local1
end

local f0_local18 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0._controllerIndex = f3_arg1
	f3_arg0._loadoutIndex = f3_arg2.loadoutIndex
	f3_arg0._weaponSlot = f3_arg2.weaponSlot
	f3_arg0.GetWeaponTabsData = f0_local0
	f3_arg0.GetWeaponTable = f0_local0
	if f3_arg2.streamedImageTable and 0 < #f3_arg2.streamedImageTable then
		DYN_ATTACHMENT.SetupWidgetStreamer( f3_arg0, f3_arg2.streamedImageTable )
	end
	f0_local0( f3_arg0, f3_arg1 )
	if Engine[0x12586A3F4FB490E]() then
		MenuUtils.SetupSceneChangeCallback( f3_arg0, function ()
			local f8_local0 = WATCH.GetEquippedWatch( f3_arg0 )
			local f8_local1 = WEAPON.GetWeaponModel( f3_arg0, FrontEndScene.ClientWeapons.Watch, CSV.weaponOffsets.watchFile )
			f3_arg0:addElement( f8_local1 )
			WATCH.SetWatchModelIfLoaded( f3_arg0, f3_arg0, f8_local1, f8_local0 )
		end )
	end
	f3_arg0.MenuTitle:SetTitle( f3_arg2.weaponSlot and Engine[0xED84C33EC5F01EA]( 0xA08603E720CE45D ) or Engine[0xED84C33EC5F01EA]( 0x80F8A4A7F7F35B1 ) )
	if f3_arg0.MenuTitle.Line then
		f3_arg0.MenuTitle.Line:SetVisibility( LUI.Visibility.Hidden )
	end
	f3_arg0.WeaponsGrid:SetMask( f3_arg0.GridMask )
	local f3_local0 = {}
	if DMZ.IsLimitedInventoryEnabled() then
		f3_local0.exclusiveInventoryItems = true
	else
		f3_local0.excludeBaseWeapons = true
	end
	f3_arg0._blueprintsByWeapon = WEAPON.GetModificationsByWeapon( f3_arg1, f3_local0 )
	local f3_local1 = LOADOUT.GetLoadoutSquadMember( f3_arg1 )
	f3_arg0._loadoutPlayerData = f3_local1.loadouts[f3_arg0._loadoutIndex]
	f3_arg0._equippedWeapon = f3_arg0._loadoutPlayerData.weaponSetups[f3_arg0._weaponSlot].weapon:get()
	local f3_local2 = PERK.GetPerkPackageData( f3_arg1, f3_arg0._loadoutPlayerData.equippedPerkPackageIndex:get() )
	local f3_local3 = PERK.DoesPerkPackageContainOverkill( f3_local2 )
	local f3_local4
	if f3_arg0._weaponSlot == WEAPON.SecondarySlot then
		f3_local4 = f3_local3
	else
		f3_local4 = false
	end
	local f3_local5 = PERK.DoesPerkPackageContainUnderkill( f3_local2 )
	local f3_local6
	if f3_arg0._weaponSlot == WEAPON.PrimarySlot then
		f3_local6 = f3_local5
	else
		f3_local6 = false
	end
	local _weaponModel
	if f3_local4 then
		_weaponModel = WEAPON.PrimarySlot
		if not _weaponModel then
		
		else
			f3_arg0._availableWeaponSlot = _weaponModel
			if f3_local6 then
				f3_arg0._availableWeaponSlot = 1
			end
			if Engine[0x12586A3F4FB490E]() then
				f0_local0( f3_arg0, f3_arg0._equippedWeapon )
				_weaponModel = WEAPON.GetWeaponModel( f3_arg1, f3_arg0._weaponSlot )
				f3_arg0:addElement( _weaponModel )
				f3_arg0._weaponModel = _weaponModel
				
				local f3_local8 = f3_arg0._loadoutPlayerData.weaponSetups[1 - f3_arg0._weaponSlot]
				f3_arg0._otherSelectedModel = WEAPON.GetWeaponModelNameFromPlayerData( f3_local8.weapon:get(), f3_local8, {
					includeCamos = true,
					includeAttachments = true,
					includeStickers = true,
					controllerIndex = f3_arg1
				} )
				f3_arg0._equippedWatchModel = WATCH.GetFullModelName( WATCH.GetEquippedWatch( f3_arg1 ) )
			end
			f0_local0( f3_arg0, function ( f7_arg0, f7_arg1 )
				ACTIONS.LeaveMenu( f7_arg0 )
			end )
			_weaponModel = f3_arg0.WeaponsGrid
			f3_arg0.MouseButtonArea:addEventHandler( "gamepad_button", function ( f6_arg0, f6_arg1 )
				if f6_arg1.qualifier == "mousewheel" then
					f6_arg1.forceScrollMove = true
					f3_arg0:processEvent( f6_arg1 )
				end
			end )
			f0_local0( f3_arg0, f3_arg1, f3_arg2 )
			if f3_arg0.SideArrows then
				_weaponModel._onNewTargetFocusPosition = function ( f5_arg0, f5_arg1 )
					if f3_arg0 then
						f3_arg0:AddScrollWatch()
					end
				end
				
				_weaponModel:addEventHandler( "gamepad_button", function ( f4_arg0, f4_arg1 )
					if f3_arg0 and CONDITIONS.IsMouseWheelEvent( f4_arg1 ) and f4_arg1.down then
						return f3_arg0:ExternalScroll( f4_arg1 )
					else
						
					end
				end )
			end
		end
	end
	_weaponModel = f3_arg0._weaponSlot
end

local f0_local19 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function WeaponTabsBase( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "WeaponTabsBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	self.HelperBar = MenuBuilder.BuildRegisteredType( "ButtonHelperBar", {
		controllerIndex = f1_local1
	} )
	self.HelperBar.id = "HelperBar"
	self.HelperBar:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -85, 0 )
	self.HelperBar:setPriority( 10 )
	self:addElement( self.HelperBar )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "WeaponTabsBase", WeaponTabsBase )
LockTable( _M )
