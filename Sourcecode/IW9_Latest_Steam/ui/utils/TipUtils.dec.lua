-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 21-11-2025 08:49
TIP = TIP or {}
TIP.tipWidget = nil
TIP.currentTipSet = nil
TIP.currentTipIndex = 0
TIP.totalTips = 0
TIP.isLast = false
TIP.priorityQueue = {}
local f0_local0 = function ()
	TIP.tipWidget = nil
	TIP.currentTipSet = nil
	TIP.currentTipIndex = 0
	TIP.totalTips = 0
	TIP.isLast = false
end

TIP.PriorityEnqueue = function ( f9_arg0 )
	if f9_arg0.priority == nil then
		table.insert( TIP.priorityQueue, #TIP.priorityQueue + 1, f9_arg0 )
		return 
	end
	local f9_local0 = #TIP.priorityQueu
	for f9_local1 = 1, #TIP.priorityQueue, 1 do
		if TIP.priorityQueue[f9_local1].priority == nil or TIP.priorityQueue[f9_local1].priority < f9_arg0.priority then
			f9_local0 = f9_local1
			break
		end
	end
	table.insert( TIP.priorityQueue, f9_local0, f9_arg0 )
end

TIP.PriorityDequeue = function ()
	return table.remove( TIP.priorityQueue )
end

TIP.CreateTips = function ( f7_arg0 )
	if (CONDITIONS.IsSony() or CONDITIONS.IsXbox()) and GL_HACK.IsGlobalPanelTipKilled() then
		return 
	elseif not TIP.tipWidget or not CONDITIONS.IsMenuInStack( TIP.tipWidget ) then
		f0_local0()
	end
	if 0 < TIP.totalTips then
		TIP.PriorityEnqueue( f7_arg0 )
		return 
	end
	TIP.currentTipIndex = 1
	local f7_local0 = {}
	for f7_local4, f7_local5 in ipairs( f7_arg0 ) do
		if f7_local5.skipIf == nil or not f7_local5.skipIf() then
			table.insert( f7_local0, f7_local5 )
		end
	end
	TIP.currentTipSet = f7_local0
	TIP.totalTips = #f7_local0
	if TIP.totalTips == 0 then
		return 
	end
	LUI.FlowManager.RequestPopupMenu( nil, "ContextualTipMenu", true, f7_local0[1].controllerIndex and f7_local0[1].controllerIndex or Engine[0x45B054C920178E9](), false, {} )
end

TIP.SetupTipsMenu = function ( f5_arg0 )
	TIP.tipWidget = f5_arg0
	if not TIP.tipWidget then
		
	else
		
	end
	if TIP.currentTipIndex == TIP.totalTips then
		TIP.currentTipSet[1].isLast = true
		TIP.isLast = true
	end
	TIP.tipWidget.ContextualTip:SetTip( TIP.currentTipSet[1] )
	TIP.tipWidget.ContextualTip:StartTipTimer()
	if not TIP.tipWidget:MoveTip( TIP.currentTipSet[1] ) then
		local f5_local0 = TIP.tipWidget:Wait( 1 )
		f5_local0.onComplete = function ()
			TIP.tipWidget:MoveTip( TIP.currentTipSet[1] )
		end
		
	end
end

TIP.CancelTip = function ()
	if TIP.tipWidget and TIP.currentTipSet then
		local f3_local0 = function ()
			
		end
		
		if TIP.tipWidget.ContextualTip._tipData and TIP.tipWidget.ContextualTip._tipData.onComplete then
			f3_local0 = TIP.tipWidget.ContextualTip._tipData.onComplete
		end
		local f3_local1 = {
			tip_name = Engine[0xED84C33EC5F01EA]( TIP.currentTipSet[TIP.currentTipIndex].title ),
			tip_step_total_count = #TIP.currentTipSet,
			tip_step_number = TIP.currentTipIndex,
			tip_desc = Engine[0xED84C33EC5F01EA]( TIP.currentTipSet[TIP.currentTipIndex].description ),
			tip_duration = TIP.tipWidget.ContextualTip:GetTipDuration()
		}
		local f3_local2
		if TIP.currentTipIndex == #TIP.currentTipSet then
			f3_local2 = "Completed"
		else
			f3_local2 = "Cancelled"
		end
		f3_local1.tip_exit_reason = f3_local2
		TIP.tipWidget.ContextualTip:RecordTipDLOG( f3_local1 )
		if 0 < #TIP.priorityQueue then
			f3_local2 = TIP.PriorityDequeue()
			TIP.totalTips = #f3_local2
			TIP.currentTipIndex = 1
			TIP.currentTipSet = f3_local2
			assert( CONDITIONS.IsMenuInStack( "ContextualTipMenu" ) )
			TIP.SetupTipsMenu( TIP.tipWidget )
			return 
		end
		ACTIONS.LeaveMenu( TIP.tipWidget )
		f0_local0()
		f3_local0()
	end
end

TIP.NextTip = function ()
	if TIP.tipWidget and TIP.currentTipSet then
		local f1_local0 = function ()
			
		end
		
		if TIP.tipWidget.ContextualTip._tipData and TIP.tipWidget.ContextualTip._tipData.onComplete then
			f1_local0 = TIP.tipWidget.ContextualTip._tipData.onComplete
		end
		if TIP.currentTipIndex == TIP.totalTips then
			TIP.CancelTip()
		else
			TIP.currentTipIndex = TIP.currentTipIndex + 1
			if TIP.currentTipIndex == TIP.totalTips then
				TIP.currentTipSet[TIP.currentTipIndex].isLast = true
				TIP.isLast = true
			end
			TIP.tipWidget.ContextualTip:SetTip( TIP.currentTipSet[TIP.currentTipIndex] )
			TIP.tipWidget:MoveTip( TIP.currentTipSet[TIP.currentTipIndex] )
			local f1_local1 = TIP.tipWidget.ContextualTip:GetTipDuration()
			TIP.tipWidget.ContextualTip:StartTipTimer()
			TIP.tipWidget.ContextualTip:RecordTipDLOG( {
				tip_exit_reason = "Next Step",
				tip_name = Engine[0xED84C33EC5F01EA]( TIP.currentTipSet[TIP.currentTipIndex].title ),
				tip_step_total_count = #TIP.currentTipSet,
				tip_step_number = TIP.currentTipIndex - 1,
				tip_desc = Engine[0xED84C33EC5F01EA]( TIP.currentTipSet[TIP.currentTipIndex].description ),
				tip_duration = f1_local1
			} )
			f1_local0()
		end
	end
end

