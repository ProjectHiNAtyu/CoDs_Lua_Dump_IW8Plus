-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:02
STREAMING = STREAMING or {}
STREAMING.ModelTypes = {
	Head = Enum[0x703D605148ADB91][0xC843D6F1BF4C6D9],
	Body = Enum[0x703D605148ADB91][0xFC7E61BDA84220B],
	HandView = Enum[0x703D605148ADB91][0x233EC364C330B98],
	WeaponWorld = Enum[0x703D605148ADB91][0x6AEEEA2BFB9AF53],
	WeaponView = Enum[0x703D605148ADB91][0xF8D1630783C706B],
	ClientModel = Enum[0x703D605148ADB91][0x39D2A38B9FFC82F],
	Animation = Enum[0x703D605148ADB91][0x9F6E971F0B7729B]
}
STREAMING.Queues = {
	[STREAMING.ModelTypes.ClientModel] = {},
	[STREAMING.ModelTypes.Head] = {},
	[STREAMING.ModelTypes.Body] = {},
	[STREAMING.ModelTypes.HandView] = {},
	[STREAMING.ModelTypes.WeaponWorld] = {},
	[STREAMING.ModelTypes.WeaponView] = {},
	[STREAMING.ModelTypes.Animation] = {}
}
STREAMING.QueueTypes = {
	Client = 1,
	Global = 0
}
STREAMING.GlobalPriority = 0
STREAMING.Priority = {
	High = 1,
	Low = 4294967295,
	General = 0
}
STREAMING.MenuSet = {}
STREAMING.MenusRegisteredForCleanup = {}
STREAMING.ModelTypeAttributes = {
	[STREAMING.ModelTypes.Head] = {
		modelLimit = 48,
		queueType = STREAMING.QueueTypes.Global,
		RequestFunction = Streaming[0x18B8E5AB5004CAE],
		HasFunction = Streaming[0xB419364AFE8EA47]
	},
	[STREAMING.ModelTypes.Body] = {
		modelLimit = 48,
		queueType = STREAMING.QueueTypes.Global,
		RequestFunction = Streaming[0x2692B1B59144830],
		HasFunction = Streaming[0x7AC12FC69537581]
	},
	[STREAMING.ModelTypes.HandView] = {
		modelLimit = 20,
		queueType = STREAMING.QueueTypes.Client,
		RequestFunction = Streaming[0x7668EB1A3FE3FB4],
		HasFunction = Streaming[0x43A7A19BC7D53B9]
	},
	[STREAMING.ModelTypes.WeaponWorld] = {
		modelLimit = -64,
		queueType = STREAMING.QueueTypes.Global,
		RequestFunction = Streaming[0x4E036CF79BBA158],
		HasFunction = Streaming[0x1FCAC710627207]
	},
	[STREAMING.ModelTypes.WeaponView] = {
		modelLimit = 24,
		queueType = STREAMING.QueueTypes.Client,
		RequestFunction = Streaming[0x74B584089FA8531],
		HasFunction = Streaming[0xBE636A91711ED30]
	},
	[STREAMING.ModelTypes.ClientModel] = {
		modelLimit = 32,
		queueType = STREAMING.QueueTypes.Client,
		RequestFunction = Streaming[0xC6CF6514F4ACB1F],
		HasFunction = Streaming[0xDBA0813A4480D56]
	},
	[STREAMING.ModelTypes.Animation] = {
		modelLimit = 32,
		queueType = STREAMING.QueueTypes.Client,
		RequestFunction = Streaming[0x570FEC8A2459FC8],
		HasFunction = Streaming[0xB1B9FEF484BA6DB]
	}
}
STREAMING.EnableStreaming = function ()
	if not Streaming[0x19E17A0E38F313A]() then
		Streaming[0xE493C1B436663F6]( true )
	end
end

STREAMING.Init = function ( f13_arg0 )
	if f13_arg0 then
		STREAMING.EnableStreaming()
		for f13_local6, f13_local7 in pairs( STREAMING.ModelTypes ) do
			STREAMING.ModelTypeAttributes[f13_local7].modelLimit = Streaming[0xFC6A290A59B360C]( f13_local7 )
			if STREAMING.ModelTypeAttributes[f13_local7].queueType == STREAMING.QueueTypes.Client then
				for f13_local3 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
					STREAMING.Queues[f13_local7][f13_local3] = {}
				end
			end
		end
	end
end

local f0_local0 = function ( f12_arg0, f12_arg1, f12_arg2 )
	if 0 < #f12_arg0 then
		local f12_local0 = {}
		local f12_local1 = STREAMING.ModelTypeAttributes[f12_arg1]
		local f12_local2 = math.min( #f12_arg0, f12_local1.modelLimit )
		if Dvar[0x9E5BE3B4BBA4E0E]( 0x97DE89FC39603 ) and f12_arg2 then
			
		else
			
		end
		for f12_local3 = 1, f12_local2, 1 do
			local f12_local6 = f12_local2 - f12_local3 + 1
			table.insert( f12_local0, f12_arg0[f12_local6].model )
			local f12_local7 = Dvar[0x9E5BE3B4BBA4E0E]( 0x97DE89FC39603 ) and f12_arg0[f12_local6]
		end
		local f12_local3 = f12_local1.RequestFunction
		if f12_local1.queueType == STREAMING.QueueTypes.Global then
			f12_local3( f12_local0 )
		elseif f12_local1.queueType == STREAMING.QueueTypes.Client then
			f12_local3( f12_local0, f12_arg2 )
		end
	end
end

local f0_local1 = function ( f11_arg0, f11_arg1 )
	local f11_local0 = nil
	if STREAMING.ModelTypeAttributes[f11_arg0].queueType == STREAMING.QueueTypes.Global then
		if not STREAMING.Queues[f11_arg0] then
			STREAMING.Queues[f11_arg0] = {}
		end
		f11_local0 = STREAMING.Queues[f11_arg0]
	elseif STREAMING.ModelTypeAttributes[f11_arg0].queueType == STREAMING.QueueTypes.Client then
		if not STREAMING.Queues[f11_arg0][f11_arg1] then
			STREAMING.Queues[f11_arg0][f11_arg1] = {}
		end
		f11_local0 = STREAMING.Queues[f11_arg0][f11_arg1]
	end
	return f11_local0
end

local f0_local2 = function ( f10_arg0, f10_arg1 )
	for f10_local3, f10_local4 in ipairs( f10_arg1 ) do
		Table.RemoveSingleItemFromArray( f10_arg0, f10_local4 )
	end
	Table.AppendArray( f10_arg0, f10_arg1 )
end

local f0_local3 = function ( f9_arg0, f9_arg1 )
	for f9_local0 = #f9_arg0, 1, -1 do
		if f9_arg0[f9_local0].model == f9_arg1.model then
			f0_local0( f9_arg1.menuNames, f9_arg0[f9_local0].menuNames )
			f0_local0( f9_arg1.requestIds, f9_arg0[f9_local0].requestIds )
			table.remove( f9_arg0, f9_local0 )
		end
	end
	local f9_local0 = 1
	for f9_local1 = 1, #f9_arg0, 1 do
		if f9_arg0[f9_local1].priority <= f9_arg1.priority then
			f9_local0 = f9_local1
			break
		end
	end
	table.insert( f9_arg0, f9_local0, f9_arg1 )
end

local f0_local4 = function ( f8_arg0, f8_arg1 )
	for f8_local0 = #f8_arg0, 1, -1 do
		local f8_local3 = Table.FindItemIndexInArray( f8_arg0[f8_local0].menuNames, f8_arg1 )
		if f8_local3 then
			table.remove( f8_arg0[f8_local0].menuNames, f8_local3 )
			if #f8_arg0[f8_local0].menuNames == 0 then
				table.remove( f8_arg0, f8_local0 )
			end
		end
	end
end

local f0_local5 = function ( f7_arg0 )
	local f7_local0 = Streaming[0x19E17A0E38F313A]()
	Streaming[0xE493C1B436663F6]( true )
	for f7_local8, f7_local9 in pairs( STREAMING.ModelTypes ) do
		if STREAMING.ModelTypeAttributes[f7_local9].queueType == STREAMING.QueueTypes.Global then
			local f7_local4 = STREAMING.Queues[f7_local9]
			f0_local0( STREAMING.Queues[f7_local9], f7_arg0 )
			f0_local0( f7_local4, f7_local9 )
		end
		if STREAMING.ModelTypeAttributes[f7_local9].queueType == STREAMING.QueueTypes.Client then
			for f7_local4 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
				if Engine[0x10A5732AB1DAE9F]( f7_local4 ) then
					local f7_local7 = STREAMING.Queues[f7_local9]
					f0_local0( STREAMING.Queues[f7_local9][f7_local4], f7_arg0 )
					f0_local0( f7_local7, f7_local9, f7_local4 )
				end
			end
		end
	end
	Streaming[0xE493C1B436663F6]( f7_local0 )
end

STREAMING.RequestModels = function ( f5_arg0, f5_arg1 )
	STREAMING.EnableStreaming()
	local f5_local0 = f5_arg1.requesterWidget
	local f5_local1 = f5_arg1.modelType
	local f5_local2 = f5_arg1.models
	local f5_local3 = f5_local0:GetCurrentMenu()
	local f5_local4
	if f5_local3 ~= nil then
		f5_local4 = f5_local3.id
		if not f5_local4 then
		
		else
			local f5_local5 = f5_arg1.requestId or f5_local0.id
			if not STREAMING.MenuSet[f5_local4] then
				STREAMING.MenuSet[f5_local4] = true
				STREAMING.GlobalPriority = STREAMING.GlobalPriority + 1
				if not STREAMING.MenusRegisteredForCleanup[f5_local4] then
					STREAMING.MenusRegisteredForCleanup[f5_local4] = true
					LUI.FlowManager.RegisterStackPopBehaviour( f5_local4, function ()
						if STREAMING.MenuSet[f5_arg0] then
							f5_arg0( f5_arg0 )
							STREAMING.MenuSet[f5_arg0] = false
							STREAMING.GlobalPriority = STREAMING.GlobalPriority - 1
						end
					end )
				end
			end
			local f5_local6 = f5_arg1.priority
			if not f5_local6 then
				f5_local6 = STREAMING.Priority.General
			end
			local f5_local7 = STREAMING.GlobalPriority + LUI.clamp( f5_local6, STREAMING.Priority.Low, STREAMING.Priority.High )
			local f5_local8 = f0_local0( f5_local1, f5_arg0 )
			for f5_local12, f5_local13 in ipairs( f5_local2 ) do
				if f5_local13 and 0 < #f5_local13 then
					f0_local0( f5_local8, {
						model = f5_local13,
						priority = f5_local7,
						menuNames = {
							f5_local4
						},
						requestIds = {
							f5_local5
						}
					} )
					if Dvar[0x9E5BE3B4BBA4E0E]( 0xD21E6686636F874 ) then
						Engine[0x15D98DF5F61904B]( 0, "dlog_event_lui_log_streaming_request", {
							model = tostring( f5_local13 ),
							priority = tonumber( f5_local7 ),
							menu_name = tostring( f5_local4 ),
							request_id = tostring( f5_local5 )
						} )
					end
				end
			end
			f0_local0( f5_local8, f5_local1, f5_arg0 )
		end
	end
	f5_local4 = f5_local0.id
end

STREAMING.CancelRequest = function ( f4_arg0, f4_arg1, f4_arg2 )
	local f4_local0 = f0_local0( f4_arg1, f4_arg0 )
	for f4_local1 = #f4_local0, 1, -1 do
		local f4_local4 = f4_local0[f4_local1]
		local f4_local5 = Table.FindItemIndexInArray( f4_local4.requestIds, f4_arg2 )
		if f4_local5 then
			table.remove( f4_local4.requestIds, f4_local5 )
			if #f4_local4.requestIds == 0 then
				table.remove( f4_local0, f4_local1 )
			end
		end
	end
	f0_local0( f4_local0, f4_arg1, f4_arg0 )
end

STREAMING.AreXModelsReadyToDisplay = function ( f3_arg0, f3_arg1, f3_arg2 )
	local f3_local0 = true
	for f3_local4, f3_local5 in ipairs( f3_arg2 ) do
		if not f3_local5.loaded then
			if f3_arg1 == nil or f3_arg1 == -1 then
				f3_local5.loaded = Streaming[0x15960C84AEC7C3C]( f3_local5.name, f3_local5.type )
			else
				f3_local5.loaded = Streaming[0x15960C84AEC7C3C]( f3_local5.name, f3_local5.type, f3_arg1 )
			end
			if f3_local0 then
				f3_local0 = f3_local5.loaded
			end
		end
	end
	return f3_local0
end

STREAMING.StreamImages = function ( f2_arg0, f2_arg1 )
	local f2_local0 = {}
	for f2_local4, f2_local5 in ipairs( f2_arg1 ) do
		if type( f2_local5 ) == "string" or type( f2_local5 ) == "xhash" then
			table.insert( f2_local0, RegisterMaterial( f2_local5 ) )
		end
		if type( f2_local5 ) == "userdata" and f2_local5._typeName == "uiimage" then
			table.insert( f2_local0, f2_local5:GetImage() )
		end
		if type( f2_local5 ) == "userdata" then
			table.insert( f2_local0, f2_local5 )
		else
			error( "Unsupported image type, must be string, xhash, material, or uiimage" )
		end
	end
	if not f2_arg0._imageStreamerInternal then
		f2_arg0._imageStreamerInternal = LUI.UIElement.new()
		f2_arg0._imageStreamerInternal.id = "_imageStreamer"
		f2_arg0:addElement( f2_arg0._imageStreamerInternal )
		f2_arg0._imageStreamerInternal:SetupImageTableStreamer( f2_local0 )
	else
		f2_arg0._imageStreamerInternal:SetupImageTableStreamer( f2_local0, true )
	end
end

STREAMING.ClearStreamedImages = function ( f1_arg0 )
	if f1_arg0._imageStreamerInternal then
		f1_arg0._imageStreamerInternal:closeTree()
		f1_arg0._imageStreamerInternal = nil
	end
end

