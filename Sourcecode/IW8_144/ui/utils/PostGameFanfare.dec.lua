-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 27-09-2025 22:41
PostGameFanfare = {
	states = {
		AAR_SUMMARY = 0,
		AAR_CP_POINTS = 1,
		AAR_START = 4294967295
	}
}
local f0_local0 = function ( f6_arg0, f6_arg1 )
	f6_arg0._state = f6_arg1
	if f6_arg0._state == PostGameFanfare.states.AAR_SUMMARY then
		Lobby.OpenAfterActionReport( f6_arg0._controllerIndex, false, true, nil, f6_arg0._forceOpenAAR )
	end
	if f6_arg0._state == PostGameFanfare.states.AAR_CP_POINTS then
		Lobby.OpenAfterActionReport( f6_arg0._controllerIndex, false, false, true )
	end
end

local f0_local1 = function ( f5_arg0, f5_arg1 )
	if f5_arg0._state == f5_arg1 then
		LUI.FlowManager.RequestLeaveMenuByName( "AARContainer", true )
	end
	f5_arg0._state = nil
end

local f0_local2 = function ( f4_arg0, f4_arg1 )
	if f4_arg1 == nil then
		f0_local0( f4_arg0, f4_arg0._state )
	end
	f0_local0( f4_arg0, f4_arg1 )
end

PostGameFanfare.start = function ( f3_arg0 )
	f3_arg0._forceOpenAAR = false
	f0_local0( f3_arg0, PostGameFanfare.states.AAR_START )
	f3_arg0._controllerIndex = Engine.IJEBHJIJF()
	InitAARDataSources( f3_arg0._controllerIndex )
	f3_arg0:advance()
end

PostGameFanfare.debugStart = function ( f2_arg0 )
	f2_arg0._forceOpenAAR = true
	f0_local0( f2_arg0, PostGameFanfare.states.AAR_START )
	f2_arg0._controllerIndex = Engine.IJEBHJIJF()
	InitAARDataSources( f2_arg0._controllerIndex )
	f2_arg0:advance()
end

PostGameFanfare.advance = function ( f1_arg0 )
	if f1_arg0._state == nil then
		LUI.FlowManager.RequestLeaveMenuByName( "AARContainer", true )
		return 
	end
	assert( f1_arg0._controllerIndex )
	local f1_local0 = f1_arg0._controllerIndex == Engine.IJEBHJIJF()
	if f1_arg0._state < PostGameFanfare.states.AAR_SUMMARY then
		f0_local0( f1_arg0, PostGameFanfare.states.AAR_SUMMARY )
		return 
	elseif f1_arg0._state < PostGameFanfare.states.AAR_CP_POINTS and Dvar.DHEEJCCJBH( "MOLPOSLOMO" ) == CP.SPEC_OPS and Dvar.IBEGCHEFE( "NMSNLMKKQS" ) then
		f0_local0( f1_arg0, PostGameFanfare.states.AAR_CP_POINTS )
		return 
	end
	local f1_local1 = f1_arg0._controllerIndex
	local f1_local2 = Engine.DCJGJDDEHE() - 1
	for f1_local3 = f1_arg0._controllerIndex + 1, f1_local2, 1 do
		if Engine.BBHAECABBD( f1_local3 ) then
			f1_arg0._controllerIndex = f1_local3
			break
		end
	end
	f0_local0( f1_arg0, nil )
	if f1_arg0._controllerIndex ~= f1_local1 then
		f1_arg0._state = PostGameFanfare.states.AAR_START
		return f1_arg0:advance()
	end
	local f1_local3 = Engine.IJEBHJIJF()
	if Engine.HEEFCICJE() and not Engine.CFHBIHABCB( f1_local3 ) and CONDITIONS.IsMagmaEnabled() then
		if Dvar.IBEGCHEFE( "MKKKSTPNQL" ) and Dvar.DHEEJCCJBH( "MOLPOSLOMO" ) ~= "br" then
			local f1_local6 = PlayerData.BFFBGAJGD( f1_local3, CoD.StatsGroup.Ranked )
			if f1_local6.pulsedPlaylistActive and f1_local6.pulsedPlaylistActive:get() == 1 and f1_local6.pulsedMatchesPlayed then
				local f1_local7 = f1_local6.pulsedMatchesPlayed:get() + 1
				local f1_local8 = Dvar.CFHDGABACF( "QNPTOQOPL" )
				if f1_local8 and f1_local8 == f1_local7 then
					LUI.FlowManager.RequestPopupMenu( f1_arg0, "MagmaUpsellPopup", true, f1_local3, false, nil )
				end
				f1_local6.pulsedMatchesPlayed:set( f1_local7 )
				ACTIONS.UploadStats( f1_arg0, f1_local3 )
			end
		end
	end
end

