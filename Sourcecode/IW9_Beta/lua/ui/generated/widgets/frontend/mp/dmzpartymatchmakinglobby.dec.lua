-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:02
module( ..., package.seeall )
require( "ui.generated.widgets.frontend.menutitle" )
require( "ui.generated.widgets.frontend.mp.mpplayerdetails" )
require( "ui.generated.widgets.frontend.mp.lobby.lobbymap" )
require( "ui.generated.widgets.buttons.buttonmedium" )
require( "ui.generated.widgets.dmztasklist" )
require( "ui.generated.widgets.countdownlarge" )
local f0_local0 = 3
local f0_local1 = function ( f9_arg0, f9_arg1 )
	f9_arg0.bindButton:addEventHandler( "button_secondary", function ( f14_arg0, f14_arg1 )
		ACTIONS.LeaveMenu( f9_arg0 )
	end )
	f9_arg0.XPButton:addEventHandler( "button_action", function ( f13_arg0, f13_arg1 )
		if f13_arg1.qualifier then
			Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
		end
		if f9_arg0._playerHasToken then
			f9_arg0.XPButton:SetVisibility( LUI.Visibility.Visible )
			LUI.FlowManager.RequestPopupMenu( nil, "FlyInPopup", true, f13_arg1.controller, false, {
				flyInLeftNarrow = true,
				disableQuickAccessShortcuts = false,
				widget = MenuBuilder.BuildRegisteredType( "TokenMenu", {
					controllerIndex = f13_arg1.controller,
					sourceMenu = f9_arg0:GetCurrentMenu()
				} )
			} )
		end
	end )
	f9_arg0.bindButton:addEventHandler( "button_secondary", function ( f12_arg0, f12_arg1 )
		LUI.FlowManager.RequestPopupMenu( nil, "leave_public_mp_lobby", true, f12_arg1.controller, false )
	end )
	f9_arg0:registerEventHandler( "lobby_member_on_over", function ( element, event )
		element:SetDataSource( event.dataSource, event.controller )
		return true
	end )
	f9_arg0.bindButton:addEventHandler( "closing_quick_access_menu", function ( f10_arg0, f10_arg1 )
		for f10_local0 = 0, f9_arg0, 1 do
			ClientCharacter[0xAA614EB46957F3B]( f10_local0, GL_HACK.GetMatchMakingAnimationForIndex( f10_local0 + 1 ), 0 )
			ClientCharacter[0x813BDB5DDDF1A24]( f10_local0, false )
		end
	end )
end

local f0_local2 = function ( f7_arg0, f7_arg1 )
	local f7_local0 = LUI.DataSourceInGlobalModel.new( "alwaysLoaded.activeParty.squadMembers.count" )
	local f7_local1 = function ()
		local f8_local0 = f7_arg0:GetValue( f7_arg0 )
		local f8_local1 = Dvar[0x22EAAB59AA27E9B]( 0x5115EF896CA26F2 )
		f8_local0 = math.min( f8_local0, f8_local1 )
		if f8_local0 ~= nil then
			f7_arg0.lobbyMemberGrid.LobbyListHeader.Count:setText( Engine[0xED84C33EC5F01EA]( 0x74821ADAF79FD0F, f8_local0, f8_local1 ) )
		end
	end
	
	f7_arg0.lobbyMemberGrid = MenuBuilder.BuildRegisteredType( "LobbyMemberGrid", {
		isDMZ = true,
		controllerIndex = f7_arg1,
		modelPath = Lobby.SquadMembersPath,
		parent = f7_arg0
	} )
	f7_arg0.lobbyMemberGrid:setPriority( -100 )
	f7_arg0:addElement( f7_arg0.lobbyMemberGrid )
	f7_arg0.lobbyMemberGrid.PlayerCount:SetAlpha( 0 )
	f7_arg0.lobbyMemberGrid.LobbyListHeader.Count:SetAlpha( 1 )
	f7_arg0.lobbyMemberGrid.LobbyListHeader.Title:setText( Engine[0xED84C33EC5F01EA]( 0x8F9C0161A6C4899 ) )
	ACTIONS.AnimateSequence( f7_arg0.lobbyMemberGrid.LobbyListHeader, "Friendly" )
	f7_arg0.lobbyMemberGrid:SetAlpha( 0 )
	f7_arg0:SubscribeToModel( f7_local0:GetModel( f7_arg1 ), f7_local1 )
end

local f0_local3 = function ( f6_arg0, f6_arg1 )
	if AAR.IsMatchClientDataAvailable() and Dvar[0x22EAAB59AA27E9B]( 0xBC373211683E0B6 ) ~= 0 then
		Lobby.OpenAfterActionReport( f6_arg1.controller, false, false )
	end
end

local f0_local4 = function ( f2_arg0, f2_arg1, f2_arg2 )
	GL_HACK.SetDMZModeDVar( true )
	Streaming[0xE493C1B436663F6]( true )
	FrontEndScene.HideAllCharacters()
	Engine[0x685AE31DEDA30A4]( "squad_lobby" )
	Dvar[0x2414681ECAB880F]( 0x710284BDC98DCFB, 0 )
	f2_arg0.DMZTaskList:PopulateTasks()
	LUI.DeferredFence.Attach( f2_arg0, f2_arg1, "CLIENT_CONNECT", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f5_arg0, f5_arg1 )
		if f5_arg1.fenceState == LUI.Fence.FenceObjectState.PASSING then
			CLIENTCHARACTER.BuildContainerAndWidgets( f2_arg0, f2_arg0, {
				showDetailWidget = true,
				dataSourcePath = Lobby.SquadMembersPath
			} )
			for f5_local0 = 0, f2_arg0, 1 do
				local f5_local3, f5_local4 = GL_HACK.GetMatchMakingAnimationForIndex( f5_local0 + 1 )
				ClientCharacter[0xAA614EB46957F3B]( f5_local0, f5_local4, 0 )
			end
		end
	end )
	Engine[0x6055C55456F05DF]( "lobby_members_changed", 1 )
	f0_local0( f2_arg0, f2_arg1 )
	f0_local0( f2_arg0, f2_arg1 )
	if CONDITIONS.IsMatchSimToolEnabled( f2_arg0 ) then
		f2_arg0.lobbyMemberGrid.navigation = {}
		f2_arg0.lobbyMemberGrid.navigation.right = f2_arg0.StartSim
		f2_arg0.StartSim.navigation = {}
		f2_arg0.StartSim.navigation.left = f2_arg0.lobbyMemberGrid
	end
	local f2_local0 = function ()
		local f4_local0 = Lobby.GetStatusString( f2_arg0 )
		if Tournament[0xC48AB424B715B40]( f2_arg0 ) and not Engine[0xCBCF315DE9B8AC6]() then
			if Tournament[0x6DA8A40563B2BF3]() and f4_local0 then
				f2_arg0.GameLobbyStatus:setText( f4_local0 )
			else
				f2_arg0.GameLobbyStatus:setText( "" )
			end
		else
			local f4_local1, f4_local2 = Lobby[0xE282396C3A4C54B]()
			if f4_local1 == Lobby.PartyState.STARTING then
				assert( f4_local2.timeRemaining )
				f2_arg0.GameLobbyStatus:setText( f4_local0 )
				f2_arg0.XPButton:SetAlpha( 0 )
				f2_arg0.AARButton:SetAlpha( 0 )
				f2_arg0.DMZTaskList:SetAlpha( 0 )
				f2_arg0.CountdownLarge:SetAlpha( 1 )
				f2_arg0.lobbyMemberGrid:SetAlpha( 1 )
				f2_arg0.CountdownLarge:UpdateTick( math.ceil( f4_local2.timeRemaining / 1000 ) )
			end
		end
	end
	
	ACTIONS.AnimateSequence( f2_arg0.CountdownLarge, "Light" )
	local self = LUI.UITimer.new( {
		interval = 1000,
		event = "update_lobby_status"
	} )
	self.id = "lobbyStatusTimer"
	f2_arg0:addElement( self )
	f2_arg0:registerEventHandler( "update_lobby_status", f2_local0 )
	local f2_local2 = {
		buttonSize = "Medium",
		imageSize = "1x1",
		removeEquipBanner = true,
		buttonData = {
			header = 0xDD5727A43B4EB36
		}
	}
	f2_arg0.XPButton:SetupButton( f2_local2 )
	f2_arg0.XPButton:SetPrimaryPromptText( 0x7D9DC9E3291E103 )
	f2_local2.buttonData.header = 0x8A2C731C66BE385
	f2_arg0.AARButton:SetupButton( f2_local2 )
	f2_arg0.AARButton:SetPrimaryPromptText( 0x7D9DC9E3291E103 )
	f2_arg0.XPButton:SetAlpha( 0 )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xBB22E2FB1A57873 ) then
		f2_arg0.AARButton:SetVisibility( LUI.Visibility.Visible )
		Dvar[0x2414681ECAB880F]( 0xAC88C27F50F8A69, AAR.MagmaSummaryState.DMZ_SUMMARY_READY )
		f2_arg0.AARButton:addEventHandler( "button_action", function ( f3_arg0, f3_arg1 )
			f2_arg0()
		end )
	else
		f2_arg0.AARButton:SetAlpha( 0 )
	end
end

function DMZPartyMatchmakingLobby( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "DMZPartyMatchmakingLobby"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local MenuTitle = nil
	
	MenuTitle = MenuBuilder.BuildRegisteredType( "MenuTitle", {
		controllerIndex = f1_local1
	} )
	MenuTitle.id = "MenuTitle"
	MenuTitle.MenuTitle:setText( Engine[0xED84C33EC5F01EA]( 0x3F89231DEF8F276 ), 0 )
	MenuTitle:SetAnchorsAndPosition( 0, 0, 0, 1, _1080p * 2, _1080p * 2, _1080p * -2, _1080p * 82 )
	self:addElement( MenuTitle )
	self.MenuTitle = MenuTitle
	
	local f1_local3 = nil
	if CONDITIONS.IsUserSignedInDemonware( f1_local1 ) then
		f1_local3 = MenuBuilder.BuildRegisteredType( "MPPlayerDetails", {
			controllerIndex = f1_local1
		} )
		f1_local3.id = "MPPlayerDetails"
		f1_local3:SetAlpha( 0, 0 )
		f1_local3:SetAnchorsAndPosition( 1, 0, 0, 1, _1080p * -596, _1080p * -96, _1080p * 38, _1080p * 98 )
		self:addElement( f1_local3 )
		self.MPPlayerDetails = f1_local3
	end
	local LobbyMap = nil
	
	LobbyMap = MenuBuilder.BuildRegisteredType( "LobbyMap", {
		controllerIndex = f1_local1
	} )
	LobbyMap.id = "LobbyMap"
	LobbyMap:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 86, _1080p * 510, _1080p * -342, _1080p * -138 )
	self:addElement( LobbyMap )
	self.LobbyMap = LobbyMap
	
	local GameLobbyStatus = nil
	
	GameLobbyStatus = LUI.UIText.new()
	GameLobbyStatus.id = "GameLobbyStatus"
	GameLobbyStatus:SetRGBFromTable( SWATCHES.IW9StyleGuide.styleGuideCool01, 0 )
	GameLobbyStatus:setText( Engine[0xED84C33EC5F01EA]( 0x3DA423A9B3D6636 ), 0 )
	GameLobbyStatus:SetFont( FONTS.GetFont( FONTS.SecondaryMedium.File ) )
	GameLobbyStatus:SetFontSize( 28 * _PT )
	GameLobbyStatus:SetMinFontSize( 28 * _PT )
	GameLobbyStatus:SetWordWrap( false )
	GameLobbyStatus:SetAlignment( LUI.Alignment.Left )
	GameLobbyStatus:SetOptOutRightToLeftAlignmentFlip( true )
	GameLobbyStatus:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 86, _1080p * 510, _1080p * 700, _1080p * 728 )
	self:addElement( GameLobbyStatus )
	self.GameLobbyStatus = GameLobbyStatus
	
	local MutePrompt = nil
	
	MutePrompt = LUI.UIStyledText.new()
	MutePrompt.id = "MutePrompt"
	MutePrompt:setText( Engine[0xED84C33EC5F01EA]( 0x862087F5507E79E ), 0 )
	MutePrompt:SetFont( FONTS.GetFont( FONTS.PrimaryBold.File ) )
	MutePrompt:SetFontSize( 20 * _PT )
	MutePrompt:SetMinFontSize( 20 * _PT )
	MutePrompt:SetWordWrap( false )
	MutePrompt:SetAlignment( LUI.Alignment.Right )
	MutePrompt:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1324, _1080p * 1824, _1080p * 964, _1080p * 984 )
	self:addElement( MutePrompt )
	self.MutePrompt = MutePrompt
	
	local XPButton = nil
	
	XPButton = MenuBuilder.BuildRegisteredType( "ButtonMedium", {
		controllerIndex = f1_local1
	} )
	XPButton.id = "XPButton"
	XPButton:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 530, _1080p * 734, _1080p * -342, _1080p * -138 )
	self:addElement( XPButton )
	self.XPButton = XPButton
	
	local AARButton = nil
	
	AARButton = MenuBuilder.BuildRegisteredType( "ButtonMedium", {
		controllerIndex = f1_local1
	} )
	AARButton.id = "AARButton"
	AARButton:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 754, _1080p * 958, _1080p * -342, _1080p * -138 )
	self:addElement( AARButton )
	self.AARButton = AARButton
	
	local f1_local9 = nil
	if CONDITIONS.IsDemoBuildOrDevBuildOrAreDevFeaturesEnabled() then
		f1_local9 = MenuBuilder.BuildRegisteredType( "DMZTaskList", {
			controllerIndex = f1_local1
		} )
		f1_local9.id = "DMZTaskList"
		f1_local9:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 86, _1080p * 336, _1080p * 183, _1080p * 683 )
		self:addElement( f1_local9 )
		self.DMZTaskList = f1_local9
	end
	local CountdownLarge = nil
	
	CountdownLarge = MenuBuilder.BuildRegisteredType( "CountdownLarge", {
		controllerIndex = f1_local1
	} )
	CountdownLarge.id = "CountdownLarge"
	CountdownLarge:SetAlpha( 0, 0 )
	CountdownLarge:SetAnchorsAndPosition( 0, 1, 1, 0, _1080p * 532, _1080p * 732, _1080p * -338, _1080p * -138 )
	self:addElement( CountdownLarge )
	self.CountdownLarge = CountdownLarge
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "DMZPartyMatchmakingLobby", DMZPartyMatchmakingLobby )
LockTable( _M )
