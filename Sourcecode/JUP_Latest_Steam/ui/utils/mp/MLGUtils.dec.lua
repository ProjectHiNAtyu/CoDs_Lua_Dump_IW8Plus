-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:02
MLG = MLG or {}
MLG.GetRulesVersionNumber = function ()
	local f14_local0 = MatchRules[0x3A9F1F51625857F]( "mlgVersion" )
	if f14_local0 == nil or f14_local0 == "" then
		f14_local0 = "0.0.0"
	end
	return Engine[0x7D3158A9539A355]( f14_local0 )
end

MLG.IsFeatureAvailable = function ()
	local f13_local0 = Dvar[0x9E5BE3B4BBA4E0E]( 0x3DDB961100B5F47 )
	if not f13_local0 then
		local f13_local1 = IsPrivateMatch
		if f13_local1 then
			f13_local0 = f13_local1
		else
			f13_local0 = IsPrivateMatch()
		end
	end
	if f13_local0 then
		f13_local0 = not Engine[0xCA085C21FCBD7CA]()
	end
	if f13_local0 then
		f13_local0 = Dvar[0x9E5BE3B4BBA4E0E]( 0x934C347DA5A59A7 )
	end
	return f13_local0
end

MLG.CanIAdjustMLGSettings = function ()
	if not MLG.IsFeatureAvailable() then
		return false
	end
	local f12_local0 = Dvar[0x9E5BE3B4BBA4E0E]( 0x3DDB961100B5F47 )
	if not f12_local0 then
		f12_local0 = Lobby[0x867E2628CAA1981]()
	end
	return f12_local0
end

MLG.AreMLGRulesEnabled = function ()
	if not MLG.IsFeatureAvailable() then
		return false
	end
	local f11_local0 = Dvar[0x9E5BE3B4BBA4E0E]( 0x3DDB961100B5F47 )
	if Dvar[0x9E5BE3B4BBA4E0E]( 0xCC8C81329E0BDBF ) == nil then
		Dvar[0x8EA06EEDB58D872]( 0xCC8C81329E0BDBF, false )
	end
	return Lobby[0x86DF9C05C3A75BA]()
end

MLG.SetUsingMLGRules = function ( f10_arg0 )
	Dvar[0x8EA06EEDB58D872]( 0xCC8C81329E0BDBF, f10_arg0 )
	Lobby[0x73BA4B980F071BC]( f10_arg0 )
end

MLG.ToggleMLGRules = function ( f9_arg0 )
	if MLG.CanIAdjustMLGSettings() then
		if not MLG.AreMLGRulesEnabled() then
			if GameType.ActiveAvailableForCDL() and MatchRules[0x13579400938A3B4]() then
				MLG.SetUsingMLGRules( true )
				MatchRules[0x3C80CD558DAA2CF]()
			elseif not Engine[0xA50293282E72559]( f9_arg0 ) then
				LUI.FlowManager.RequestPopupMenu( self, "mlg_error_no_rules_available_offline", false, f9_arg0, false )
			else
				LUI.FlowManager.RequestPopupMenu( self, "mlg_error_no_rules_available", false, f9_arg0, false )
			end
		else
			MLG.SetUsingMLGRules( false )
			MatchRules[0xE859FDA0484D3DE]()
		end
	end
end

MLG.Refresh = function ( f8_arg0 )
	local f8_local0 = MLG.AreMLGRulesEnabled()
	f8_arg0.properties = f8_arg0.properties or {}
	if f8_arg0.properties.cacheMLGenabled ~= f8_local0 then
		local f8_local1 = "mlg_"
		local f8_local2
		if f8_local0 then
			f8_local2 = "enabled"
		else
			f8_local2 = "disabled"
		end
		f8_arg0:dispatchEventToRoot( {
			immediate = true,
			name = f8_local1 .. f8_local2
		} )
		MLG.SetButtonHelper( f8_arg0, f8_local0 )
		f8_arg0.properties.cacheMLGenabled = f8_local0
	end
end

MLG.SetButtonHelper = function ( f7_arg0, f7_arg1 )
	local f7_local0 = ""
	if MLG.CanIAdjustMLGSettings() then
		if f7_arg1 then
			f7_local0 = Engine[0xED84C33EC5F01EA]( 0x99C9F577CDD2C04 )
		else
			f7_local0 = Engine[0xED84C33EC5F01EA]( 0x1B2C75147CED545 )
		end
	end
	f7_arg0:processEvent( {
		clickable = true,
		side = "right",
		name = "add_button_helper_text",
		button_ref = "button_start",
		helper_text = f7_local0
	} )
end

MLG.Toggle = function ( f6_arg0, f6_arg1 )
	if MLG.CanIAdjustMLGSettings() then
		MLG.ToggleMLGRules( f6_arg1.controller )
	end
	MLG.Refresh( f6_arg0 )
end

MLG.Hide = function ( f5_arg0 )
	f5_arg0:processEvent( {
		name = "mlg_disabled"
	} )
	f5_arg0:processEvent( {
		button_ref = "button_start",
		name = "add_button_helper_text",
		helper_text = nil,
		side = "right"
	} )
end

MLG.IsCDLActive = function ()
	if not Dvar[0x9E5BE3B4BBA4E0E]( 0x126F25096B7BBC ) then
		return false
	elseif CONDITIONS.IsMagmaGameMode() then
		return false
	elseif not Engine[0x12586A3F4FB490E]() and Dvar[0x9E5BE3B4BBA4E0E]( 0x5C2395EF96FC773 ) then
		return false
	elseif MatchRules[0x1A6D0B2E15DF8CF]() then
		return MatchRules[0x3A9F1F51625857F]( "cwlRulesEnabled" )
	else
		
	end
end

MLG.IsHost = function ()
	local f3_local0 = Lobby[0xF1D2956B0C99DF6]()
	local f3_local1
	if f3_local0 then
		f3_local1 = Lobby[0x867E2628CAA1981]()
		if not f3_local1 then
			if not f3_local0 then
				f3_local1 = Lobby[0x6957722EF74F5D2]()
			else
				f3_local1 = false
			end
		end
	elseif not f3_local0 then
		f3_local1 = Lobby[0x6957722EF74F5D2]()
	else
		f3_local1 = false
	end
	return f3_local1
end

MLG.ArbitrarilySetCDLRuleset = function ( f2_arg0 )
	if MLG.IsHost() then
		if MP.GetLastQuickplayFilter( f2_arg0 ) == MP.PLAYLIST_FILTER_MODE.CDLRules and (not Lobby[0x63537242F1D48FF]() or Lobby[0x6957722EF74F5D2]()) then
			MatchRules[0xE9D78FD5E7578ED]()
			MLG.SetUsingMLGRules( true )
		else
			MLG.ResetMatchRulesData()
		end
	elseif not onlyIfHost then
		if Lobby[0x86DF9C05C3A75BA]() then
			MatchRules[0xE9D78FD5E7578ED]()
		else
			MLG.ResetMatchRulesData()
		end
	end
end

MLG.ResetMatchRulesData = function ()
	if MatchRules[0x1A6D0B2E15DF8CF]() and MatchRules[0x3A9F1F51625857F]( "cwlRulesEnabled" ) then
		MatchRules[0xE859FDA0484D3DE]()
		MLG.SetUsingMLGRules( false )
	end
end

