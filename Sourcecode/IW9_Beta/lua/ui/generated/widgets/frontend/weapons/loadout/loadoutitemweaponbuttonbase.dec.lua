-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:02
module( ..., package.seeall )
local f0_local0 = function ( f14_arg0, f14_arg1, f14_arg2, f14_arg3 )
	local f14_local0 = WEAPON.GetBWImage( f14_arg2 )
	if f14_arg3 then
		local f14_local1 = WEAPON.GetVariantOverridenIcon( f14_arg3.weapon, f14_arg3.variantID )
		if f14_local1 and 0 < #f14_local1 then
			f14_local0 = f14_local1
		end
	end
	f14_arg0.WeaponIcon:setImage( RegisterMaterial( f14_local0 ) )
	if Engine[0x5B4AB50CF5D1DDD]( RegisterMaterial( f14_local0 ) ) == 1 then
		ACTIONS.AnimateSequence( f14_arg0, "Ratio1x1" )
	else
		ACTIONS.AnimateSequence( f14_arg0, "Ratio2x1" )
	end
end

local f0_local1 = function ( f13_arg0 )
	if f13_arg0.Attachments == nil then
		return 
	end
	f13_arg0.Attachments:closeChildren()
	local f13_local0 = false
	local f13_local1 = ATTACHMENT.GetTableFromWeaponSetup( f13_arg0._weaponSetup )
	for f13_local2 = 1, #f13_local1, 1 do
		if f13_local1[f13_local2] ~= ATTACHMENT.none and ATTACHMENT.GetCategory( f13_local1[f13_local2] ) ~= "receiver" then
			local f13_local5 = 32
			if f13_local0 then
				local f13_local6 = 36
				local f13_local7 = 16
				local self = LUI.UIImage.new()
				self:setImage( RegisterMaterial( "icon_plus" ) )
				self:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, -(f13_local7 / 2) * _1080p, f13_local7 / 2 * _1080p, -(f13_local7 / 2) * _1080p, f13_local7 / 2 * _1080p )
				local f13_local9 = LUI.UIElement.new()
				f13_local9:SetAnchorsAndPosition( 0, 1, 0, 1, 0, f13_local6 * _1080p, 0, f13_local5 * _1080p )
				f13_local9:addElement( self )
				f13_arg0.Attachments:addElement( f13_local9 )
			end
			local f13_local6 = RegisterMaterial( ATTACHMENT.GetImage( f13_local1[f13_local2] ) )
			local f13_local7 = LUI.UIImage.new()
			f13_local7:setImage( f13_local6 )
			f13_local7:SetAnchorsAndPosition( 0, 1, 0, 1, 0, f13_local5 * _1080p, 0, f13_local5 * _1080p )
			f13_arg0.Attachments:addElement( f13_local7 )
			f13_local0 = true
		end
	end
	f13_arg0.Attachments:SetAlpha( 1 )
end

local f0_local2 = function ( f12_arg0 )
	f0_local0( f12_arg0 )
end

local f0_local3 = function ( f11_arg0 )
	f11_arg0.Attachments:SetAlpha( 0 )
end

local f0_local4 = function ( f10_arg0 )
	local f10_local0 = f10_arg0._defaultLoadoutWeapon and f10_arg0._defaultLoadoutWeapon.ref or f10_arg0._weaponSetup.weapon:get()
	local f10_local1
	if f10_arg0._defaultLoadoutWeapon then
		f10_local1 = ""
	else
		f10_local1 = GUNSMITH.GetCustomModName( f10_arg0._weaponSetup.blueprintName:get() )
	end
	local f10_local2 = ""
	if 0 < #f10_local1 then
		f10_arg0._isBlueprint = true
		f10_arg0.BlueprintIcon:setImage( RegisterMaterial( "icon_mod" ) )
		f10_local2 = f10_local1
	elseif f10_arg0._weaponSetup and f10_arg0._weaponSetup.lootItemID:get() ~= LOOT.emptyID and not f10_arg0._defaultLoadoutWeapon then
		f10_arg0._isBlueprint = true
		f10_arg0.BlueprintIcon:setImage( RegisterMaterial( "icon_blueprint" ) )
		f10_local2 = WEAPON.GetLootWeaponName( f10_local0, f10_arg0._weaponSetup.lootItemID:get() )
	else
		f10_arg0._isBlueprint = false
		local f10_local3 = ""
		if f10_arg0._weaponSetup then
			local f10_local4 = WEAPON.GenerateWeaponTable( f10_arg0._weaponSetup )
			for f10_local5 = 1, #f10_local4.attachments, 1 do
				local f10_local8 = f10_local4.attachments[f10_local5]
				if f10_local8.ref and 0 < #f10_local8.ref and ATTACHMENT.IsDisplayNameAvailable( f10_local8.ref ) then
					if f10_local3 == "" then
						f10_local3 = ATTACHMENT.GetName( f10_local8.ref )
					else
						f10_local3 = f10_local3 .. " " .. ATTACHMENT.GetName( f10_local8.ref )
					end
				end
			end
		end
		f10_local2 = WEAPON.GetName( f10_local0 ) .. " " .. f10_local3
	end
	f10_arg0.BlueprintIcon:SetVisibility( f10_arg0._isBlueprint and LUI.Visibility.Visible or LUI.Visibility.Hidden )
	return f10_local2
end

local f0_local5 = function ( f6_arg0, f6_arg1, f6_arg2, f6_arg3, f6_arg4, f6_arg5 )
	f6_arg0._weaponIndex = f6_arg2
	f6_arg0._weaponSetup = f6_arg3
	f6_arg0._defaultLoadoutWeapon = f6_arg4
	if f6_arg4 then
		f6_arg4.weapon = f6_arg4.ref
	end
	local f6_local0 = f6_arg4
	local f6_local1
	if f6_local0 and not f6_arg4 then
		f6_local1 = f6_arg4
	else
		f6_local1 = WEAPON.GenerateWeaponTable( f6_arg3 )
	end
	local f6_local2 = PROGRESSION.GetWeaponDisplayLevel( f6_arg1, f6_local1.weapon )
	local f6_local3 = PROGRESSION.GetMaxWeaponDisplayLevel( f6_local1.weapon ) + 1
	local f6_local4 = 1 < f6_local2
	f6_arg0.WeaponLevelProgress:Setup( f6_arg1, f6_local1.weapon )
	local f6_local5 = f6_arg0.WeaponLevelProgress.Fill
	local f6_local6 = f6_local5
	f6_local5 = f6_local5.SetRGBFromTable
	local f6_local7
	if f6_local4 then
		f6_local7 = SWATCHES.IW9StyleGuide.styleGuideAccentMain
		if not f6_local7 then
		
		else
			f6_local5( f6_local6, f6_local7 )
			f6_local5 = f6_arg0.WeaponLevelProgress.Fill
			f6_local6 = f6_local5
			f6_local5 = f6_local5.SetAlpha
			if f6_local4 then
				f6_local7 = 0.7
			else
				f6_local7 = 0.6
			end
			f6_local5( f6_local6, f6_local7 )
			f6_local5 = f6_arg0.WeaponLevelProgress.Gradient
			f6_local6 = f6_local5
			f6_local5 = f6_local5.SetRGBFromTable
			if f6_local4 then
				f6_local7 = SWATCHES.IW9StyleGuide.styleGuideAccentDark
				if not f6_local7 then
				
				else
					f6_local5( f6_local6, f6_local7 )
					f6_local5 = {
						header = f0_local0( f6_arg0, f6_arg3, f6_arg4 ),
						subHeader = Engine[0xED84C33EC5F01EA]( 0x4A671D1E2689A57, f6_local2, f6_local3 )
					}
					local f6_local8
					if f6_arg4 then
						f6_local8 = f6_arg4.ref
						if not f6_local8 then
						
						else
							f6_arg0.selectedWeapon = f6_local8
							f6_arg0.WeaponIcon:SetAlpha( 1 )
							if f6_arg0.RenderWeaponIcon then
								f6_arg0.RenderWeaponIcon:SetAlpha( 0 )
								f6_arg0.Attachments:SetAlpha( 0 )
							end
							f0_local0( f6_arg0, f6_arg1, f6_arg0.selectedWeapon, f6_local1 )
							if not WEAPON.IsWeaponNoneValue( f6_arg0.selectedWeapon ) then
								if CONDITIONS.IsRenderWeaponIconEnabled() then
									if f6_arg0.DynamicWeaponIcon ~= nil then
										f6_arg0.DynamicWeaponIcon:SetAlpha( 0 )
									end
									f6_local8 = WEAPON.GetFrontendLoadoutWeaponSlot( f6_arg5.isPrimary, f6_arg2 )
									f6_local6 = WEAPON.GetWeaponModelName( f6_local1.weapon, f6_local1, {
										includeCamos = false,
										includeAttachments = true,
										includeStickers = false,
										isDefault = f6_local0
									} )
									WEAPON.UpdateWeaponRenderIcon( f6_arg0, f6_arg1, {
										slot = f6_local8,
										weaponModelName = f6_local6,
										attachmentHighlights = WEAPON.GetAttachmentHighlights( f6_arg1, f6_local6 )
									}, f6_arg0.RenderWeaponIcon, f6_arg0.WeaponIcon, f0_local0, f0_local0 )
								else
									if f6_arg0.DynamicWeaponIcon then
										f6_local8 = WEAPON.IsBulletWeapon( WEAPON.GetWeaponClass( f6_arg0.selectedWeapon ) )
									end
									if not f6_local0 and f6_arg3 == nil then
										f6_local8 = false
									end
									if f6_local8 then
										f6_local7 = DYN_ATTACHMENT.GetDynamicAttachmentsTable( WEAPON.GetWeaponModelName( f6_arg0.selectedWeapon, f6_local1, {
											includeStickers = true,
											includeAttachments = true,
											keepAkimbo = true,
											includeCamos = true,
											isDefault = f6_local0,
											controllerIndex = f6_arg1
										} ) )
										if f6_arg0.DynamicWeaponIcon ~= nil then
											f6_arg0.DynamicWeaponIcon:PerformUpdate( f6_arg1, {
												isInteractive = false,
												attachmentsData = f6_local7,
												weaponRef = f6_arg0.selectedWeapon
											} )
											f6_arg0.DynamicWeaponIcon:SetAlpha( 1 )
										end
										f6_arg0.WeaponIcon:SetAlpha( 0 )
									elseif f6_arg0.DynamicWeaponIcon then
										f6_arg0.DynamicWeaponIcon:SetAlpha( 0 )
									end
								end
							else
								if not WEAPON.IsWeaponFists( f6_arg0.selectedWeapon ) then
									f6_arg0.WeaponIcon:SetAlpha( 0 )
								end
								f6_local5.subHeader = ""
								if CONDITIONS.IsDMZMatch() then
									f6_arg0.WeaponName:setText( Engine[0xED84C33EC5F01EA]( 0xB6A4275A3437C60 ) )
									f6_arg0.WeaponIcon:setImage( RegisterMaterial( BRLOOT.DEFAULT_IW_EMPTY_TEXTURE ) )
								end
							end
							f6_local8 = {
								localizeSubHeader = false,
								removeTextBacker = true,
								removeEquipBanner = true,
								localizeHeader = false,
								imageSize = "Image2x1",
								buttonData = f6_local5,
								doubleAction = {
									text = 0xC19D2A5DCF4877A,
									prompt = 0x21E44BE45534168,
									callback = function ()
										local f9_local0 = LUI.FlowManager.GetScopedData( f6_arg0 )
										return GUNSMITH.OpenGunsmith( f6_arg0, f9_local0.selectedLoadoutIndex, f9_local0.selectedWeaponSlot )
									end
								}
							}
							if not Dvar[0x9E5BE3B4BBA4E0E]( 0x4F74CEB67644978 ) or GUNSMITH.IsDisabled( f6_local1.weapon ) and not CONDITIONS.InFrontend() then
								f6_local8.doubleAction = nil
							end
							f6_local6 = f6_arg0.WeaponSlot
							local f6_local9 = f6_local6
							f6_local6 = f6_local6.setText
							local f6_local10 = Engine[0xEB2A2834B76AEA4]
							local f6_local11
							if f6_arg2 == WEAPON.PrimarySlot then
								f6_local11 = Engine[0xED84C33EC5F01EA]( 0xCB74A303611CCB3 )
								if not f6_local11 then
								
								else
									f6_local6( f6_local9, f6_local10( f6_local11 ) )
									f6_arg0.Button:SetPrimaryPromptText( 0x7D9DC9E3291E103 )
									f6_arg0.Button:SetupButton( f6_local8 )
									f6_arg0.BlueprintIcon:SetVisibility( f6_arg0._isBlueprint and LUI.Visibility.Visible or LUI.Visibility.Hidden )
									if f6_arg0.IconBacker then
										f6_arg0.IconBacker:SetVisibility( f6_arg0._isBlueprint and LUI.Visibility.Visible or LUI.Visibility.Hidden )
									end
									if f6_arg0.AttachmentEquipPips then
										f6_local6 = GUNSMITH.GetEquipCounts( f6_local1.weapon, f6_local1, f6_local1.attachments, {
											isDefault = f6_local0
										} )
										f6_arg0.AttachmentEquipPips:UpdatePips( f6_local6.attachmentCount )
									end
									if DMZ.IsLimitedInventoryEnabled() then
										f6_local6 = #DMZ.GetInventoryItemsOfType( f6_arg1, LOOT.itemTypes.WEAPON ) <= 0
										f6_arg0:SetButtonDisabled( f6_local6 )
										f6_arg0.Button:SetButtonDisabled( f6_local6 )
									end
									if Dvar[0x9E5BE3B4BBA4E0E]( 0x721F4950DF33C2F ) and f6_arg3 then
										f6_arg0:registerEventHandler( "gamepad_button", function ( element, event )
											if event.button == "start" and element:isInFocus() then
												WEAPON.EquipModification( f6_arg0, WEAPON.GetRandomVariant( f6_arg0, f6_arg0 ), f6_arg0 )
											end
										end )
									end
									if Engine[0x12586A3F4FB490E]() and CoD.IsDMZMatch() then
										f6_arg0._weapon = f6_arg3.weapon:get()
										if not f6_arg0.bindButton then
											f6_arg0.bindButton = LUI.UIBindButton.new()
											f6_arg0.bindButton.id = "selfBindButton"
											f6_arg0:addElement( f6_arg0.bindButton )
										end
										f6_arg0.bindButton:registerEventHandler( "button_alt1", function ()
											if f6_arg0:isInFocus() and f6_arg0.weapon:get() ~= "iw9_me_fists" then
												f6_arg0.weapon:set( "iw9_me_fists" )
												WEAPON.WipeWeaponSetup( f6_arg0 )
												f6_arg0:SetupButton( f6_arg0, f6_arg0, f6_arg0 )
												local f7_local0 = LOADOUT.GetLoadoutSquadMember( f6_arg0 )
												f7_local0 = f7_local0.loadouts[0]
												assert( f7_local0, "Loadout player data is nil at path squadMembers.loadouts" )
												local f7_local1 = f7_local0.weaponSetups[f6_arg0]
												ClientWeapon[0xA3A4ADD436F6EB0]( f6_arg0, WEAPON.GetWeaponModelNameFromPlayerData( f7_local1.weapon:get(), f7_local1, {
													includeCamos = false,
													includeAttachments = false,
													includeStickers = false,
													controllerIndex = f6_arg0
												} ) )
												f6_arg0.Clear:SetAlpha( 0 )
											end
										end )
									end
								end
							end
							f6_local11 = Engine[0xED84C33EC5F01EA]( 0xEC8F813D58DEE57 )
						end
					end
					f6_local8 = f6_arg3.weapon:get()
				end
			end
			f6_local7 = SWATCHES.IW9StyleGuide.styleGuideCool04
		end
	end
	f6_local7 = SWATCHES.IW9StyleGuide.styleGuideCool02
end

local f0_local6 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.SetupButton = f0_local0
	f3_arg0.GetWeaponName = f0_local0
	f3_arg0._weapon = nil
	f3_arg0._isBlueprint = false
	f3_arg0:addEventHandler( "button_over", function ( f5_arg0, f5_arg1 )
		ACTIONS.AnimateSequence( f3_arg0, "ButtonOver" )
		if f3_arg0.Clear then
			local f5_local0 = f3_arg0.Clear
			local f5_local1 = f5_local0
			f5_local0 = f5_local0.SetAlpha
			local f5_local2
			if f3_arg0._weapon ~= "iw9_me_fists" then
				f5_local2 = 1
			else
				f5_local2 = 0
			end
			f5_local0( f5_local1, f5_local2 )
		end
	end )
	f3_arg0:addEventHandler( "button_up", function ( f4_arg0, f4_arg1 )
		ACTIONS.AnimateSequence( f3_arg0, "ButtonUp" )
		if f3_arg0.Clear then
			f3_arg0.Clear:SetAlpha( 0 )
		end
	end )
end

local f0_local7 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function LoadoutItemWeaponButtonBase( menu, controller )
	local self = LUI.UIButton.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 336 * _1080p, 0, 204 * _1080p )
	self.id = "LoadoutItemWeaponButtonBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f0_local0( self, LUI.ValidateControllerIndex( self, f1_local1 ), controller )
	return self
end

MenuBuilder.registerType( "LoadoutItemWeaponButtonBase", LoadoutItemWeaponButtonBase )
LockTable( _M )
