-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
module( ..., package.seeall )
require( "ui.widgets.HorizontalMinimalScrollbar" )
local f0_local0 = _1080p * 10
local f0_local1 = function ( f12_arg0 )
	local f12_local0 = MenuBuilder.BuildRegisteredType( "AARUnlockItemGeneric", {
		controllerIndex = f12_arg0
	} )
	f12_local0.id = "AARUnlockItemGeneric"
	f12_local0:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 1840, _1080p * 2356, _1080p * 130, _1080p * 530 )
	return f12_local0
end

local f0_local2 = function ( f11_arg0, f11_arg1 )
	local f11_local0 = math.max( 0, f11_arg0.UnlocksList:GetNumChildren() )
	if f11_arg0.matchInfoPackage.preRank ~= f11_arg0.matchInfoPackage.rank then
		for f11_local1 = f11_arg0.matchInfoPackage.preRank + 1, f11_arg0.matchInfoPackage.rank, 1 do
			local f11_local4 = {}
			for f11_local13, f11_local14 in pairs( PROGRESSION.GetCurrentRankUnlocks( f11_local1 ) ) do
				local f11_local15 = {}
				for f11_local8, f11_local9 in pairs( f11_local14 ) do
					local f11_local11 = {
						typeString = ToUpperCase( Engine[0xED84C33EC5F01EA]( LOOT.typeNameStrings[f11_local9.lootType] ) ),
						type = f11_local9.lootType,
						lootID = f11_local9.lootID
					}
					local f11_local12 = f11_local9.lootRef
					f11_local11.name = LOOT.GetItemName( f11_local9.lootType, f11_local12, f11_local9.lootID )
					f11_local11.image = LOOT.GetItemImage( f11_local9.lootType, f11_local12, f11_local9.lootID )
					table.insert( f11_local15, f11_local11 )
				end
				table.insert( f11_local4, f11_local15 )
			end
			if 0 < #f11_local4 then
				f11_local5 = f0_local0( f11_arg1 )
				f11_local5:SetTitleData( f11_arg1, Engine[0xED84C33EC5F01EA]( "AAR/MILITARY_RANK_TITLE" ), Engine[0xED84C33EC5F01EA]( "LUA_MENU/RANK_VALUE", f11_local1 + 1 ) )
				f11_local5:SetUnlockData( f11_arg1, f11_local4 )
				f11_arg0.UnlocksList:AddElement( f11_local5 )
				f11_local0 = f11_local0 + 1
			end
		end
	end
end

local f0_local3 = function ( f10_arg0, f10_arg1 )
	local f10_local0 = math.max( 0, f10_arg0.UnlocksList:GetNumChildren() )
	if 0 < #f10_arg0.matchInfoPackage.weaponsRankedUp then
		for f10_local6, f10_local7 in pairs( f10_arg0.matchInfoPackage.weaponsRankedUp ) do
			local f10_local8 = PROGRESSION.GetWeaponRankFromXP( f10_arg1, f10_local7.startXP, f10_local7.weaponRef )
			local f10_local9 = PROGRESSION.GetWeaponRankFromXP( f10_arg1, f10_local7.currentXP, f10_local7.weaponRef )
			local f10_local10 = WEAPON.GetName( f10_local7.weaponRef )
			local f10_local11 = f0_local0( f10_arg1 )
			f10_local11:SetTitleData( f10_arg1, f10_local10, Engine[0xED84C33EC5F01EA]( "AAR/LEVEL_VALUE", f10_local9 + 1 ) )
			for f10_local5 = f10_local9, f10_local8 + 1, -1 do
				local f10_local4 = PROGRESSION.GetProgressionDataFromAllUnlocks( f10_arg1, PROGRESSION.GetCurrentWeaponUnlocks( f10_local7.weaponRef, f10_local5, false ), f10_local7.weaponRef )
				if 0 < #f10_local4 then
					f10_local11:AddUnlockData( f10_arg1, f10_local4 )
				end
			end
			f10_local0 = f10_local0 + 1
			f10_local11:FinalizeGrid( f10_arg1 )
			f10_arg0.UnlocksList:AddElement( f10_local11 )
		end
	end
end

local f0_local4 = function ( f9_arg0, f9_arg1 )
	local f9_local0 = math.max( 0, f9_arg0.UnlocksList:GetNumChildren() )
	if 0 < #f9_arg0.matchInfoPackage.operatorsRankedUp then
		for f9_local6, f9_local7 in pairs( f9_arg0.matchInfoPackage.operatorsRankedUp ) do
			local f9_local8 = OPERATOR.GetRankFromXP( f9_arg1, f9_local7.startXP, f9_local7.operatorRef )
			local f9_local9 = OPERATOR.GetRankFromXP( f9_arg1, f9_local7.currentXP, f9_local7.operatorRef )
			local f9_local10 = Engine[0xED84C33EC5F01EA]( OPERATOR.GetName( f9_local7.operatorRef ) )
			local f9_local11 = f0_local0( f9_arg1 )
			f9_local11:SetTitleData( f9_arg1, f9_local10, Engine[0xED84C33EC5F01EA]( "AAR/LEVEL_VALUE", f9_local9 + 1 ) )
			for f9_local5 = f9_local9, f9_local8 + 1, -1 do
				local f9_local4 = PROGRESSION.GetProgressionDataFromAllUnlocks( f9_arg1, OPERATOR.GetCurrentOperatorUnlocks( f9_local7.operatorRef, f9_local5 ), f9_local7.operatorRef )
				if 0 < #f9_local4 then
					f9_local11:AddUnlockData( f9_arg1, f9_local4 )
				end
			end
			f9_local0 = f9_local0 + 1
			f9_local11:FinalizeGrid( f9_arg1 )
			f9_arg0.UnlocksList:AddElement( f9_local11 )
		end
	end
end

local f0_local5 = function ( f8_arg0, f8_arg1, f8_arg2 )
	local f8_local0 = f8_arg2.matchDataPackage.challenges
	local f8_local1 = {}
	for f8_local22, f8_local23 in ipairs( f8_local0 ) do
		if Challenge.IsModernS4AEKindID( f8_local23.type ) then
			local f8_local5 = not LUI.IsItemInArray( f8_local1, f8_local23.ID )
			local f8_local6
			if f8_local5 then
				f8_local6 = Challenge.GetChallengeAndProgress( f8_arg1, f8_local23.ID, f8_local23.type )
				if not f8_local6 then
				
				elseif f8_local5 and f8_local6 and f8_local6.complete then
					local f8_local7 = f8_local6.tiers[f8_local6.topCompletedTier].rewards
					local f8_local8 = {}
					local f8_local9 = {}
					local f8_local10, f8_local11 = nil
					for f8_local17, f8_local18 in pairs( f8_local7 ) do
						local f8_local19 = {}
						local f8_local20 = LOOT.GetTypeForID( f8_local18.rewardValueOrID )
						f8_local19.type = f8_local20
						f8_local19.lootID = tonumber( f8_local18.rewardValueOrID )
						local f8_local21 = LOOT.GetItemRef( f8_local20, tonumber( f8_local18.rewardValueOrID ) )
						f8_local19.name = LOOT.GetItemName( f8_local20, f8_local21 )
						f8_local19.image = LOOT.GetItemImage( f8_local20, f8_local21, f8_local18.rewardValueOrID )
						if not LUI.IsStringNilOrEmpty( f8_local19.image ) then
							f8_local19.typeString = ToUpperCase( Engine[0xED84C33EC5F01EA]( LOOT.typeNames[f8_local20] ) )
							f8_local10 = f8_local19.name
							f8_local11 = 0
							local f8_local15 = OPERATOR.IsOperatorCustomization( f8_local20 )
							if f8_local20 == LOOT.itemTypes.WEAPON then
								f8_local11 = PROGRESSION.GetWeaponRankFromXP( f8_arg1, PROGRESSION.GetWeaponXP( f8_arg1, f8_local21 ), f8_local21 )
							elseif f8_local20 == LOOT.itemTypes.OPERATOR or f8_local15 then
								local f8_local16 = f8_local21
								if f8_local15 then
									f8_local16 = OPERATOR.GetOperatorCustomizationOwnerRef( f8_local20, f8_local21 )
									f8_local10 = Engine[0xED84C33EC5F01EA]( OPERATOR.GetName( f8_local16 ) )
								end
								f8_local11 = OPERATOR.GetRankFromXP( f8_arg1, OPERATOR.GetOperatorXP( f8_arg1, f8_local16 ), f8_local21 )
							end
							table.insert( f8_local9, f8_local19 )
						end
					end
					if 0 < #f8_local9 then
						table.insert( f8_local8, f8_local9 )
					end
					table.insert( f8_local1, f8_local23.ID )
					if 0 < #f8_local8 then
						f8_local12 = f0_local0( f8_arg1 )
						f8_local12:SetTitleData( f8_arg1, f8_local10, Engine[0xED84C33EC5F01EA]( "AAR/LEVEL_VALUE", f8_local11 + 1 ) )
						f8_local12:SetUnlockData( f8_arg1, f8_local8 )
						f8_local12:FinalizeGrid( f8_arg1 )
						f8_arg0.UnlocksList:AddElement( f8_local12 )
					end
				end
			end
			f8_local6 = nil
		end
	end
end

local f0_local6 = function ( f7_arg0, f7_arg1 )
	for f7_local0 = 1, 3, 1 do
		local f7_local3 = Engine[0x7D3158A9539A355]( "Debug Data" )
		local f7_local4 = f0_local0( f7_arg1 )
		f7_local4:SetTitleData( f7_arg1, f7_local3, Engine[0xED84C33EC5F01EA]( "AAR/LEVEL_VALUE", 99 ) )
		local f7_local5 = PROGRESSION.GetOperatorProgressionData( f7_arg1, "roland" )
		f7_local5[math.floor( #f7_local5 / f7_local0 )] = nil
		if 0 < #f7_local5 then
			f7_local4:AddUnlockData( f7_arg1, f7_local5 )
		end
		f7_local4:FinalizeGrid( f7_arg1 )
		f7_arg0.UnlocksList:AddElement( f7_local4 )
	end
end

local f0_local7 = function ( f4_arg0 )
	f4_arg0.UnlocksList._scrollbars[1]:SetKBMStyle( true )
	f4_arg0:registerEventHandler( "gamepad_sticks", function ( element, event )
		f4_arg0._lastRightStickYaw = event.rightStickYaw
		f4_arg0._lastLeftStickYaw = event.leftStickYaw
		return true
	end )
	f4_arg0:registerEventHandler( "update_grid_scroll", function ( element, event )
		local f5_local0 = (element._lastRightStickYaw or 0) + (element._lastLeftStickYaw or 0)
		local f5_local1 = 0.1
		local f5_local2 = element.UnlocksList
		local f5_local3 = f5_local2
		f5_local2 = f5_local2.ScrollAmount
		local f5_local4
		if f5_local0 < 0 then
			f5_local4 = "left"
		else
			f5_local4 = "right"
		end
		f5_local2( f5_local3, f5_local4, math.abs( f5_local0 * f5_local1 ) )
		return true
	end )
	f4_arg0._scrollUpdateTimer = LUI.UITimer.new( {
		interval = 16,
		event = {
			name = "update_grid_scroll"
		}
	} )
	f4_arg0._scrollUpdateTimer.id = "_scrollUpdateTimer"
	f4_arg0:addElement( f4_arg0._scrollUpdateTimer )
end

local f0_local8 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.matchInfoPackage = f2_arg2.matchDataPackage
	local f2_local0 = {
		spacingY = 20,
		scrollingThresholdX = 0,
		maxVelocity = 5000,
		forcePrimaryAxisScrolling = true,
		adjustSizeToContent = false,
		scrollingThresholdY = 1,
		wrapX = false,
		maxVisibleColumns = 6,
		maxVisibleRows = 1,
		wrapY = false,
		maxColumns = 50,
		maxRows = 1,
		springCoefficient = 400,
		controllerIndex = f2_arg1,
		spacingX = f0_local0,
		primaryAxis = LUI.DIRECTION.horizontal,
		horizontalAlignment = LUI.Alignment.Left,
		verticalAlignment = LUI.Alignment.Top
	}
	local UnlocksList = nil
	
	UnlocksList = LUI.UIGrid.new( f2_local0 )
	UnlocksList.id = "AllUnlocksList"
	UnlocksList:setUseStencil( true )
	UnlocksList:SetActiveOnMouseOverBehavior( f2_arg1 )
	UnlocksList:SetAnchorsAndPosition( 0, 1, 0, 1, _1080p * 130, _1080p * 1790, _1080p * 200, _1080p * 1011 )
	f2_arg0:addElement( UnlocksList )
	f2_arg0.UnlocksList = UnlocksList
	
	local f2_local2 = LUI.UIScrollbar.new
	local f2_local3 = {
		direction = LUI.DIRECTION.horizontal,
		eventListener = f2_arg0.HorizontalScrollbar,
		startCap = f2_arg0.HorizontalScrollbar.startCap,
		endCap = f2_arg0.HorizontalScrollbar.endCap,
		sliderArea = f2_arg0.HorizontalScrollbar.sliderArea
	}
	local f2_local4 = f2_arg0.HorizontalScrollbar.sliderArea
	if f2_local4 then
		f2_local4 = f2_arg0.HorizontalScrollbar.sliderArea.slider
	end
	f2_local3.slider = f2_local4
	f2_local4 = f2_arg0.HorizontalScrollbar.sliderArea
	if f2_local4 then
		f2_local4 = f2_arg0.HorizontalScrollbar.sliderArea.fixedSizeSlider
	end
	f2_local3.fixedSizeSlider = f2_local4
	f2_arg0.Scrollbar = f2_local2( f2_local3 )
	UnlocksList:AddScrollbar( f2_arg0.Scrollbar )
	f2_arg0:registerAndCallEventHandler( "update_input_type", function ( f3_arg0, f3_arg1 )
		if LUI.IsLastInputKeyboardMouse( f3_arg1.controllerIndex ) then
			f3_arg0.UnlocksList:SetDirectionalInputEnabled( true )
			if f3_arg0._scrollUpdateTimer then
				f3_arg0._scrollUpdateTimer:closeTree()
			end
		else
			f3_arg0.UnlocksList:SetDirectionalInputEnabled( false )
			f2_arg0( f3_arg0 )
		end
	end, {
		controllerIndex = f2_arg1
	} )
	f0_local0( f2_arg0, f2_arg1, f2_arg2 )
	f0_local0( f2_arg0, f2_arg1 )
	f0_local0( f2_arg0, f2_arg1 )
	f0_local0( f2_arg0, f2_arg1 )
	if Dvar[0x9E5BE3B4BBA4E0E]( "#x3fab7b999cca2bfff" ) then
		f0_local0( f2_arg0, f2_arg1 )
	end
	f2_arg0.UnlocksList:SetNumColumns( f2_arg0.UnlocksList:GetNumChildren() )
	if f2_arg0.UnlocksList and 0 < f2_arg0.UnlocksList:GetNumChildren() then
		f2_arg0.Mask:SetVisibility( LUI.Visibility.Visible )
		f2_arg0.HorizontalScrollbar:SetVisibility( LUI.Visibility.Visible )
		f2_arg0.UnlocksList:SetMask( f2_arg0.Mask )
		f2_arg0.UnlocksList:processEvent( {
			immediate = true,
			name = "gain_focus"
		} )
		f2_arg0.UnlocksList:SetNumColumns( f2_arg0.UnlocksList:GetNumChildren() )
		f2_arg0.UnlocksList:setPriority( -100 )
	else
		f2_arg0.Mask:SetVisibility( LUI.Visibility.Hidden )
		f2_arg0.HorizontalScrollbar:SetVisibility( LUI.Visibility.Hidden )
	end
end

function AARAllUnlocks( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "AARAllUnlocks"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local Mask = nil
	
	Mask = LUI.UIImage.new()
	Mask.id = "Mask"
	Mask:SetVisibility( LUI.Visibility.Hidden )
	Mask:setImage( RegisterMaterial( "stencil_mask" ), 0 )
	Mask:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -960, _1080p * 960, _1080p * -324, _1080p * 439 )
	self:addElement( Mask )
	self.Mask = Mask
	
	local HorizontalScrollbar = nil
	
	HorizontalScrollbar = MenuBuilder.BuildRegisteredType( "HorizontalMinimalScrollbar", {
		controllerIndex = f1_local1
	} )
	HorizontalScrollbar.id = "HorizontalScrollbar"
	HorizontalScrollbar:SetVisibility( LUI.Visibility.Hidden )
	HorizontalScrollbar:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -830, _1080p * 830, _1080p * 379, _1080p * 390 )
	self:addElement( HorizontalScrollbar )
	self.HorizontalScrollbar = HorizontalScrollbar
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "AARAllUnlocks", AARAllUnlocks )
LockTable( _M )
