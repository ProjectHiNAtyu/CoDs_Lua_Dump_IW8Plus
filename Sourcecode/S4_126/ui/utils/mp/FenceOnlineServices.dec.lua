-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
module( ..., package.seeall )
FenceOnlineServices = LUI.Class( LUI.Fence )
FenceOnlineServices.CODE_FENCE = "ONLINE"
FenceOnlineServices.CODE_STATE = {
	queued = 5,
	downloading = 2,
	registering = 6,
	inactive = 0,
	success = 3,
	requested = 1,
	failure = 4
}
FenceOnlineServices.REGISTRATION_STATE = {
	OTP_THROTTLED = 4,
	UPGRADING = 5,
	IDLE = 0,
	PENDING = 1,
	REGISTERING = 2,
	OTP_NEEDED = 3
}
FenceOnlineServices.AUTO_REGISTRATION_STATE = {
	SUCCESS = 2,
	IN_PROGRESS = 1,
	IDLE = 0,
	FAIL = 3
}
FenceOnlineServices.CONTROLLER_FENCE_STATE = {
	pass = 2,
	block = 3,
	fail = 4,
	inactive = 1
}
FenceOnlineServices.init = function ( f38_arg0, f38_arg1 )
	LUI.Fence.init( f38_arg0 )
	f38_arg0._perController = {}
	f38_arg0._noPremium = f38_arg1
	f38_arg0._errorController = nil
	f38_arg0._registrationState = AccountRegistration[0x30C898D33E650B7]()
	local f38_local0 = CODACCOUNT.AccountRegistrationEnabled()
	if f38_local0 then
		f38_local0 = AccountRegistration[0x2FDA14ECB499A34]()
	end
	f38_arg0._autoRegistrationEnabled = f38_local0
	f38_arg0._autoRegistrationState = FenceOnlineServices.AUTO_REGISTRATION_STATE.IDLE
	for f38_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		f38_arg0._perController[f38_local0] = {
			isCancelling = false,
			fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.inactive
		}
		Fences[0x30A2BFD9B34742]( f38_local0 )
	end
	if f38_arg1 then
		DebugPrint( "FenceOnlineServices.Init with No Premium" )
	else
		DebugPrint( "FenceOnlineServices.Init with Premium" )
	end
end

FenceOnlineServices.Start = function ( f37_arg0 )
	DebugPrint( "FenceOnlineServices.Start" )
end

FenceOnlineServices.Stop = function ( f36_arg0 )
	DebugPrint( "FenceOnlineServices.Stop" )
	if f36_arg0._openedWaitPopup then
		DebugPrint( "FenceOnlineServices.Stop closing: " .. f36_arg0._openedWaitPopup )
		LUI.FlowManager.RequestLeaveMenuByName( f36_arg0._openedWaitPopup, true )
		f36_arg0._openedWaitPopup = nil
	end
end

FenceOnlineServices.OpenOTPPopup = function ( f32_arg0 )
	if not f32_arg0._openedOTPPopup then
		local f32_local0 = {
			controllerIndex = f32_arg0._registeringController,
			onSuccess = function ()
				f32_arg0._openedOTPPopup = false
			end,
			onCancel = function ()
				f32_arg0._openedOTPPopup = false
			end,
			onError = function ()
				f32_arg0._openedOTPPopup = false
			end
		}
		if CODACCOUNT.AccountRegistrationEnabled() then
			LUI.FlowManager.RequestPopupMenu( nil, "CODAccountAuthentication", true, f32_arg0._registeringController, false, f32_local0, nil, true, true )
			f32_arg0._openedOTPPopup = true
		end
	end
end

FenceOnlineServices.OpenRegisteringPopup = function ( f28_arg0, f28_arg1 )
	if not f28_arg0._openedRegisteringPopup then
		local f28_local0 = {
			controllerIndex = f28_arg0._registeringController,
			isAnonymousAccount = f28_arg1,
			onSuccess = function ()
				f28_arg0._openedRegisteringPopup = false
				f28_arg0._registeringController = nil
				if f28_arg0 then
					f28_arg0._hasSeenGreeting = true
				else
					f28_arg0._openedWaitPopup = nil
				end
			end,
			onCancelRegister = function ()
				f28_arg0._openedRegisteringPopup = false
			end,
			onCancelFence = function ()
				f28_arg0._registrationCancelled = true
				f28_arg0._registeringController = nil
				f28_arg0._openedRegisteringPopup = false
			end
		}
		if CODACCOUNT.AccountRegistrationEnabled() and not CONDITIONS.IsQABotRunning() then
			if not LUI.FlowManager.IsInStack( "CODAccountRegisterPopup" ) then
				LUI.FlowManager.RequestPopupMenu( nil, "CODAccountFencePopup", true, f28_arg0._registeringController, true, f28_local0, nil, true, true )
				f28_arg0._openedRegisteringPopup = true
			end
		else
			if not f28_arg1 then
				AccountRegistration[0x34E06AC87784A76]( f28_arg0._registeringController )
			end
			f28_local0.onSuccess()
		end
	end
end

FenceOnlineServices.OpenSummaryPopup = function ( f25_arg0 )
	if not f25_arg0._openedSummary and not LUI.FlowManager.IsInStack( "CODAccountRestartingPopup" ) then
		f25_arg0._openedSummary = true
		local f25_local0 = {
			controllerIndex = f25_arg0._summaryController,
			okButtonHandler = function ( f27_arg0, f27_arg1 )
				LUI.FlowManager.RequestLeaveMenuByName( "CODAccountSummary", true, true )
				local f27_local0 = true
				if f25_arg0._summaryController then
					f25_arg0:SetHasSeenCODAccount( f25_arg0._summaryController )
					if Engine[0x7B17D94988FD5D0]( "hasEverSeen_CODAccountOTP", f25_arg0._summaryController ) ~= 1 then
						if not Dvar[0x9E5BE3B4BBA4E0E]( "#x34dea9ce5ae95ad76" ) and CODACCOUNT.AccountRegistrationEnabled() and not Engine[0x757E77CA15D6B8F]( f25_arg0._summaryController ) then
							f27_local0 = false
							LUI.FlowManager.RequestPopupMenu( nil, "CODAccountAuthenticationAdv", true, f25_arg0._summaryController, false, {
								state = f25_arg0
							}, nil, true, true )
						else
							f25_arg0:SetHasSeenCODAccountOTP( f25_arg0._summaryController )
						end
					end
				end
				if f27_local0 then
					f25_arg0:SetHasSeenSummary()
				end
			end
		}
		if CODACCOUNT.AccountRegistrationEnabled() and not Engine[0x757E77CA15D6B8F]( f25_arg0._summaryController ) and not CONDITIONS.IsQABotRunning() then
			local f25_local1 = Engine[0x5A049446C78B2A4]( f25_arg0._summaryController )
			local f25_local2
			if f25_local1 then
				f25_local2 = f25_local1
			else
				f25_local2 = Engine[0x8C5525AAE2164E3]( f25_arg0._summaryController, f25_local1 )
			end
			if Engine[0x9DD5167C6D720F1]() and (Dvar[0x9E5BE3B4BBA4E0E]( "#x33d77dc1ef4c05a2e" ) or f25_local2) then
				LUI.FlowManager.RequestPopupMenu( nil, "CODAccountForceRenamePopup", true, f25_arg0._summaryController, false, {
					isUsername = true,
					title = ToUpperCase( Engine[0xED84C33EC5F01EA]( "CODACCOUNT/CHANGE_NAME" ) ),
					controller = f25_arg0._controllerIndex,
					confirmAction = function ( f26_arg0, f26_arg1 )
						if AccountRegistration[0x56732A0CF0D13F6]( f26_arg0, f26_arg1 ) then
							Engine[0x34C623E28A1C5E7]( "" )
						end
					end
				}, nil, true, true )
			else
				LUI.FlowManager.RequestPopupMenu( nil, "CODAccountSummary", true, f25_arg0._summaryController, false, f25_local0, nil, true, true )
			end
		else
			f25_local0.okButtonHandler()
		end
	end
end

FenceOnlineServices.OpenConnectingPopup = function ( f23_arg0 )
	local f23_local0 = f23_arg0
	LUI.FlowManager.RequestPopupMenu( nil, "popup_connecting", false, nil, false, {
		onCancel = function ( f24_arg0, f24_arg1 )
			DebugPrint( "Cancelling FenceOnlineServices" )
			f23_arg0._perController[f24_arg1].isCancelling = true
		end
	}, nil, true, true )
	f23_arg0._openedWaitPopup = "popup_connecting"
end

FenceOnlineServices.OpenQueuedPopup = function ( f21_arg0 )
	local f21_local0 = f21_arg0
	LUI.FlowManager.RequestPopupMenu( nil, "popup_online_queue", false, nil, false, {
		onCancel = function ( f22_arg0, f22_arg1 )
			f21_arg0._perController[f22_arg1].isCancelling = true
		end
	}, nil, true, true )
	f21_arg0._openedWaitPopup = "popup_online_queue"
end

FenceOnlineServices.OnBackOut = function ( f20_arg0 )
	DebugPrint( "FenceOnlineServices.OnBackOut" )
	for f20_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		Fences[0x30A2BFD9B34742]( f20_local0 )
	end
	if not f20_arg0._noPremium then
		Dvar[0x8EA06EEDB58D872]( "#x34e9ab8c76756925d", false )
		Engine[0xFD5CC176E60A5A9]()
		Engine[0xB81A5136C5503E4]( "xstopparty 0" )
		Engine[0xB81A5136C5503E4]( "xstopprivateparty 0" )
	end
end

FenceOnlineServices.GetErrorString = function ( f19_arg0 )
	local f19_local0 = Fences[0xA7D80C060789546]( f19_arg0, FenceOnlineServices.CODE_FENCE )
	assert( f19_local0 )
	if f19_local0 then
		return Engine[0x7D3158A9539A355]( f19_local0 )
	else
		return Engine[0xED84C33EC5F01EA]( "ONLINE/ONLINE_SERVICES_ERROR" )
	end
end

local f0_local0 = function ( f18_arg0, f18_arg1 )
	if f18_arg1 then
		return Engine[0xED84C33EC5F01EA]( "PLATFORM/TU_REQUIRED" )
	elseif not Engine[0x8B495DC361731F7]( f18_arg0 ) then
		return Engine[0xBF1C14F525F953C]( f18_arg0 )
	else
		return FenceOnlineServices.GetErrorString( f18_arg0 )
	end
end

FenceOnlineServices.PostFail = function ( f17_arg0 )
	if f17_arg0._state == LUI.Fence.STATE.fail then
		local f17_local0 = Engine[0x45B054C920178E9]()
		local f17_local1 = {
			controllerIndex = f17_local0,
			noPremium = f17_arg0._noPremium
		}
		if f17_arg0._errorController and not f17_arg0._perController[f17_arg0._errorController].isCancelling then
			f17_local1.tuRequired = Fences[0x449BC2682302327]( f17_arg0._errorController, FenceOnlineServices.CODE_FENCE )
			f17_local1.errorString = f0_local0( f17_arg0._errorController, f17_local1.tuRequired )
			LUI.FlowManager.RequestPopupMenu( nil, "popup_connecting_error", false, f17_local0, false, f17_local1, nil, false, false )
			Fences[0x30573612E3550FF]( f17_local0 )
		else
			f17_local1.tuRequired = Fences[0x449BC2682302327]( f17_local0, FenceOnlineServices.CODE_FENCE )
			LUI.FlowManager.RequestPopupMenu( nil, "popup_connecting_cancelled", false, f17_local0, false, f17_local1, nil, false, false )
		end
	end
end

FenceOnlineServices.ShouldBlockForRegistration = function ( f16_arg0, f16_arg1 )
	if (f16_arg0._registeringController ~= nil) or f16_arg1 == AccountRegistration[0xFAC8D846FC98123]() then
		if f16_arg0._registeringController == nil and not f16_arg0._registrationCancelled then
			f16_arg0._registeringController = f16_arg1
		end
		return true
	else
		return false
	end
end

FenceOnlineServices.ShouldAbortRegistration = function ( f15_arg0, f15_arg1 )
	local f15_local0 = false
	if Engine[0x5575DCFF312365A]() then
		if Engine[0x5B772BB3A07C3B5]() ~= BattleNetAuthState.ERROR then
			f15_local0 = f15_arg0._registrationCancelled
		else
			f15_local0 = true
		end
	elseif Engine[0xBE5345D3926D620]() then
		f15_local0 = f15_arg0._registrationCancelled
	else
		f15_local0 = true
	end
	if f15_local0 then
		AccountRegistration[0x7E83EAA4B387E3B]( f15_arg1 )
		if f15_arg0._registrationCancelled then
			f15_arg0._registrationCancelled = false
		end
	end
	return f15_local0
end

FenceOnlineServices.ShouldBlockforEULA_B = function ( f14_arg0, f14_arg1 )
	if Engine[0x7B17D94988FD5D0]( "acceptedEULA_B", f14_arg1 ) < Dvar[0x22EAAB59AA27E9B]( "#x3a2d28a2ecb2a21e5" ) then
		f14_arg0._eulaController = f14_arg1
		return true
	else
		f14_arg0._eulaController = nil
		return false
	end
end

FenceOnlineServices.ShouldBlockforSummary = function ( f13_arg0, f13_arg1 )
	if not Engine[0x7B17D94988FD5D0]( "hasEverSeen_CODAccount", f13_arg1 ) and not Dvar[0x9E5BE3B4BBA4E0E]( "#x3db605c8e3b0ad2a6" ) then
		f13_arg0._summaryController = f13_arg1
		if f13_arg0._summaryController == f13_arg0._registeringController then
			f13_arg0._registeringController = nil
		end
		return true
	elseif Engine[0x7B17D94988FD5D0]( "hasEverSeen_CODAccountOTP", f13_arg1 ) == 0 and not Dvar[0x9E5BE3B4BBA4E0E]( "#x3db605c8e3b0ad2a6" ) then
		f13_arg0._summaryController = f13_arg1
		if f13_arg0._summaryController == f13_arg0._registeringController then
			f13_arg0._registeringController = nil
		end
		return true
	else
		return false
	end
end

FenceOnlineServices.SetHasSeenCODAccount = function ( f12_arg0, f12_arg1 )
	Engine[0x9694388D6DAC134]( "hasEverSeen_CODAccount", true, f12_arg1 )
	Engine[0xB81A5136C5503E4]( "updategamerprofile " .. f12_arg1 )
end

FenceOnlineServices.SetHasSeenCODAccountOTP = function ( f11_arg0, f11_arg1 )
	Engine[0x9694388D6DAC134]( "hasEverSeen_CODAccountOTP", 1, f11_arg1 )
	Engine[0xB81A5136C5503E4]( "updategamerprofile " .. f11_arg1 )
end

FenceOnlineServices.SetHasSeenSummary = function ( f10_arg0 )
	f10_arg0._openedSummary = false
	f10_arg0._summaryController = nil
end

FenceOnlineServices.UpdateState = function ( f8_arg0 )
	assert( f8_arg0._state ~= LUI.Fence.STATE.fail )
	f8_arg0._queued = false
	if f8_arg0._autoRegistrationEnabled and f8_arg0._autoRegistrationState <= FenceOnlineServices.AUTO_REGISTRATION_STATE.IN_PROGRESS then
		f8_arg0._autoRegistrationState = AccountRegistration[0xA9D16A466625AE6]()
	end
	for f8_local0 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		if Engine[0x10A5732AB1DAE9F]( f8_local0 ) then
			local f8_local3 = Fences[0x2A0168FAF745ADF]( f8_local0 )
			if f8_local3 == FenceOnlineServices.CODE_STATE.inactive then
				Fences[0xCE25840730DD633]( f8_local0 )
				f8_local3 = Fences[0x2A0168FAF745ADF]( f8_local0 )
			end
			if f8_local3 == FenceOnlineServices.CODE_STATE.failure then
				f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.fail
			elseif f8_local3 == FenceOnlineServices.CODE_STATE.queued then
				f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.block
				f8_arg0._queued = true
			elseif f8_local3 == FenceOnlineServices.CODE_STATE.registering then
				f8_arg0._registrationState = AccountRegistration[0x30C898D33E650B7]()
				if FenceOnlineServices.ShouldBlockForRegistration( f8_arg0, f8_local0 ) then
					if FenceOnlineServices.ShouldAbortRegistration( f8_arg0, f8_local0 ) then
						f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.fail
					else
						f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.block
					end
				else
					f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.pass
				end
			elseif f8_local3 ~= FenceOnlineServices.CODE_STATE.success then
				f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.block
			elseif FenceOnlineServices.ShouldBlockforSummary( f8_arg0, f8_local0 ) then
				f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.block
			elseif FenceOnlineServices.ShouldBlockforEULA_B( f8_arg0, f8_local0 ) then
				f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.block
			else
				f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.pass
			end
			if f8_arg0._perController[f8_local0].isCancelling then
				f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.fail
			end
		end
		f8_arg0._perController[f8_local0].fenceState = FenceOnlineServices.CONTROLLER_FENCE_STATE.inactive
		f8_arg0._perController[f8_local0].isCancelling = false
	end
	local f8_local0 = 0
	local f8_local1 = 0
	local f8_local2 = 0
	for f8_local4 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
		if f8_arg0._perController[f8_local4].fenceState == FenceOnlineServices.CONTROLLER_FENCE_STATE.pass then
			f8_local0 = f8_local0 + 1
		end
		if f8_arg0._perController[f8_local4].fenceState == FenceOnlineServices.CONTROLLER_FENCE_STATE.block then
			f8_local1 = f8_local1 + 1
		end
		if f8_arg0._perController[f8_local4].fenceState == FenceOnlineServices.CONTROLLER_FENCE_STATE.fail then
			f8_local2 = f8_local2 + 1
		end
	end
	assert( 0 < f8_local2 + f8_local1 + f8_local0, "No active local clients" )
	if 0 < f8_local2 then
		for f8_local4 = 0, Engine[0xB686A0A723E6442]() - 1, 1 do
			if f8_arg0._perController[f8_local4].fenceState == FenceOnlineServices.CONTROLLER_FENCE_STATE.fail then
				if 0 < f8_local0 and not Lobby[0xEA249848147F9EA]( f8_local4 ) then
					DebugPrint( "Controller #" .. tostring( f8_local4 ) .. " does not meet requirements for online play. Making client inactive." )
					f8_arg0._state = LUI.Fence.STATE.block
					Engine[0x54DE5FB69D3BA90]( f8_local4 )
				end
				f8_arg0._errorController = f8_local4
				f8_arg0._state = LUI.Fence.STATE.fail
			end
		end
	elseif 0 < f8_local1 then
		f8_arg0._state = LUI.Fence.STATE.block
	elseif 0 < f8_local0 then
		f8_arg0._state = LUI.Fence.STATE.pass
	else
		f8_arg0._state = LUI.Fence.STATE.block
	end
	if f8_arg0._state == LUI.Fence.STATE.block then
		local f8_local4 = function ( f9_arg0 )
			if f8_arg0._openedWaitPopup ~= nil and f8_arg0._openedWaitPopup ~= f9_arg0 then
				LUI.FlowManager.RequestLeaveMenuByName( f8_arg0._openedWaitPopup, true )
				f8_arg0._openedWaitPopup = nil
				return true
			elseif f8_arg0._openedWaitPopup == nil then
				return true
			else
				return false
			end
		end
		
		if f8_arg0._queued then
			if f8_local4( "popup_online_queue" ) then
				f8_arg0:OpenQueuedPopup()
			end
		elseif f8_local4( "popup_connecting" ) then
			f8_arg0:OpenConnectingPopup()
		end
		if f8_arg0._registeringController ~= nil then
			if not f8_arg0._autoRegistrationEnabled or f8_arg0._autoRegistrationState == FenceOnlineServices.AUTO_REGISTRATION_STATE.FAIL then
				if not f8_arg0._openedRegisteringPopup then
					f8_arg0:OpenRegisteringPopup()
				end
				f8_local5 = CONDITIONS.IsMenuInStack( "CODAccountLogin" )
				if f8_arg0._registrationState ~= FenceOnlineServices.REGISTRATION_STATE.OTP_NEEDED and f8_arg0._registrationState ~= FenceOnlineServices.REGISTRATION_STATE.OTP_THROTTLED then
					f8_local3 = false
				else
					local f8_local3 = true
				end
				if f8_local3 and f8_local5 and not f8_arg0._openedOTPPopup then
					f8_arg0:OpenOTPPopup()
					f8_arg0:SetHasSeenCODAccountOTP( f8_arg0._registeringController )
				end
				if f8_arg0._registrationState == FenceOnlineServices.REGISTRATION_STATE.REGISTERING and f8_local5 then
					if not f8_arg0._openedLoggingInPopup then
						LUI.FlowManager.RequestPopupMenu( unused, "CODAccountLoggingInPopup", true, f8_arg0._registeringController, false, {
							controllerIndex = f8_arg0._registeringController
						}, nil, true, true )
						f8_arg0._openedLoggingInPopup = true
					end
				elseif f8_arg0._openedLoggingInPopup then
					LUI.FlowManager.RequestLeaveMenuByName( "CODAccountLoggingInPopup", true, true )
					f8_arg0._openedLoggingInPopup = false
				end
			end
		elseif f8_arg0._summaryController ~= nil then
			if AccountRegistration ~= nil and not AccountRegistration[0xAE7E83248289443]( f8_arg0._summaryController ) then
				f8_local5 = not Engine[0x757E77CA15D6B8F]( f8_arg0._summaryController )
			else
				local f8_local5 = false
			end
			if f8_local5 and not f8_arg0._hasSeenGreeting then
				f8_arg0._registeringController = f8_arg0._summaryController
				f8_arg0:OpenRegisteringPopup( f8_local5 )
				return 
			elseif Engine[0x7B17D94988FD5D0]( "acceptedEULA_B", f8_arg0._summaryController ) < Dvar[0x22EAAB59AA27E9B]( "#x3a2d28a2ecb2a21e5" ) and not Dvar[0x9E5BE3B4BBA4E0E]( "#x347e752f9a90a1ece" ) then
				LUI.FlowManager.RequestPopupMenu( nil, "CODAccountEULAPopupB", true, f8_arg0._summaryController, false, {
					existingAccount = true
				}, nil, true, true )
				return 
			end
			f8_arg0:OpenSummaryPopup()
		elseif f8_arg0._eulaController ~= nil and not Dvar[0x9E5BE3B4BBA4E0E]( "#x347e752f9a90a1ece" ) then
			LUI.FlowManager.RequestPopupMenu( nil, "CODAccountEULAPopupB", true, f8_arg0._summaryController, false, {
				existingAccount = true
			}, nil, true, true )
		end
	end
end

function PopupConnecting( f7_arg0, f7_arg1 )
	local f7_local0 = assert
	local f7_local1
	if f7_arg1 then
		f7_local1 = f7_arg1
	else
		f7_local1 = f7_arg1.onCancel
	end
	f7_local0( f7_local1 )
	f7_local0 = {
		message = Engine[0xED84C33EC5F01EA]( "XBOXLIVE/POPUP_CONNECTION" ),
		cancel_func = f7_arg1.onCancel
	}
	local f7_local2 = nil
	if CONDITIONS.IsInternalAlphaEnabled() then
		f7_local2 = MenuBuilder.BuildRegisteredType( "LiveTextboxPopup", f7_local0 )
	else
		f7_local2 = MenuBuilder.BuildRegisteredType( "LiveTextBoxWithCancelPopup", f7_local0 )
	end
	f7_local2.id = "popup_connecting"
	return f7_local2
end

function PopupConnectingError( f6_arg0, f6_arg1 )
	local f6_local0 = assert
	local f6_local1
	if f6_arg1 then
		f6_local1 = f6_arg1
	else
		f6_local1 = f6_arg1.errorString
	end
	f6_local0( f6_local1 )
	f6_local0 = {
		darkenerAlpha = 4.6672616413205735E-62,
		controllerIndex = f6_arg1.controllerIndex,
		title = Engine[0xED84C33EC5F01EA]( "MENU/CONNECTION_FAILED" ),
		message = f6_arg1.errorString
	}
	local f6_local2 = not Engine[0xCA404C71196D651]( f6_arg1.controllerIndex )
	if f6_local2 then
		if Engine[0x9D348E40740E9A8]() then
			f6_local0.message = Engine[0xED84C33EC5F01EA]( "LUA_MENU/N_NEWLINE_M", Engine[0x7D3158A9539A355]( "" ), f6_local0.message )
		else
			f6_local0.message = Engine[0xED84C33EC5F01EA]( "LUA_MENU/N_NEWLINE_M", Engine[0x7D3158A9539A355]( Engine[0x29680E4E30C45C2]( f6_arg1.controllerIndex ) ), f6_local0.message )
		end
	end
	if f6_local2 or f6_arg1.noPremium then
		f6_local0.buttons = BOOT.GetOkayPopupButtons()
	else
		f6_local0.buttons = BOOT.GetRetryPopupButtons( f6_arg1.controllerIndex, f6_arg1.tuRequired )
	end
	f6_local1 = MenuBuilder.BuildRegisteredType( "GenericImagePopup", f6_local0 )
	f6_local1.id = "popup_connecting_error"
	return f6_local1
end

function PopupConnectingCancelled( f5_arg0, f5_arg1 )
	local f5_local0 = MenuBuilder.BuildRegisteredType( "GenericImagePopup", {
		controllerIndex = f5_arg1.controllerIndex,
		title = Engine[0xED84C33EC5F01EA]( "MENU/CONNECTION_FAILED" ),
		message = Engine[0xED84C33EC5F01EA]( "MENU/CONNECTION_CANCELLED" ),
		buttons = BOOT.GetRetryPopupButtons( f5_arg1.controllerIndex, f5_arg1.tuRequired )
	} )
	f5_local0.id = "popup_connecting_cancelled"
	return f5_local0
end

function PopupOnlineQueue( f3_arg0, f3_arg1 )
	assert( f3_arg1 )
	local f3_local0 = {
		message = Engine[0xED84C33EC5F01EA]( "LUA_MENU_MP/SERVER_QUEUE" ),
		description = Engine[0xED84C33EC5F01EA]( "LUA_MENU_MP/SERVER_QUEUE_MSG" )
	}
	local f3_local1 = f3_arg1.controllerIndex
	if not f3_local1 then
		f3_local1 = Engine[0x45B054C920178E9]()
	end
	f3_local0.controllerIndex = f3_local1
	if Engine[0x575E9C5B9AAB6F4]() then
		f3_local0.buttons = {
			label = Engine[0xED84C33EC5F01EA]( "LUA_MENU/QUIT_DESKTOP" ),
			alignment = LUI.Alignment.Center,
			action = function ()
				Engine[0xDEE6107B26F8BB6]()
			end
		}
	end
	f3_local1 = MenuBuilder.BuildRegisteredType( "FenceOnlineQueueDialogPopupWithDescription", f3_local0 )
	f3_local1.id = "popup_online_queue"
	return f3_local1
end

MenuBuilder.registerType( "popup_online_queue", PopupOnlineQueue )
MenuBuilder.registerType( "popup_connecting", PopupConnecting )
MenuBuilder.registerType( "popup_connecting_error", PopupConnectingError )
MenuBuilder.registerType( "popup_connecting_cancelled", PopupConnectingCancelled )
FenceOnlineServicesPremium = LUI.Class( FenceOnlineServices )
FenceOnlineServicesPremium.init = function ( f2_arg0 )
	FenceOnlineServicesPremium.super.init( f2_arg0, false )
end

LUI.Fence.Register( "onlineServices", FenceOnlineServicesPremium )
FenceOnlineServicesNoPremium = LUI.Class( FenceOnlineServices )
FenceOnlineServicesNoPremium.init = function ( f1_arg0 )
	FenceOnlineServicesNoPremium.super.init( f1_arg0, true )
end

LUI.Fence.Register( "onlineServicesNoPremium", FenceOnlineServicesNoPremium )
LockTable( _M )
