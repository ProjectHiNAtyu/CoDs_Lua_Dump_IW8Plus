-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:03
Install = {
	GAME_IDS = {
		MP = "mp22",
		SP = "sp22"
	},
	MODE_IDS = {
		CP = "cp",
		MP = "mp",
		BR = "br",
		SP = "sp"
	},
	DiscErrorPopupMenu = "DiscCheckErrorPopup",
	GetGameAndModeIds = function ()
		local f16_local0, f16_local1 = nil
		if CONDITIONS.IsMultiplayer() then
			f16_local0 = Install.GAME_IDS.MP
			if Engine[0xD151EC5B41223B5]() and not CONDITIONS.IsMagmaGameMode() then
				f16_local1 = Install.MODE_IDS.MP
			elseif CONDITIONS.IsThirdGameMode() then
				f16_local1 = Install.MODE_IDS.CP
			elseif CONDITIONS.IsMagmaGameMode() then
				f16_local1 = Install.MODE_IDS.BR
			end
		else
			f16_local0 = Install.GAME_IDS.SP
			f16_local1 = Install.MODE_IDS.SP
		end
		return f16_local0, f16_local1
	end,
	IsDiscCheckRequired = function ( f15_arg0, f15_arg1 )
		if CONDITIONS.IsPS5() or CONDITIONS.IsPC() and CONDITIONS[0x2DA54CF5D6B7F02]() then
			if CONDITIONS.IsDiscCheckDisabled() then
				return false
			end
			local f15_local0, f15_local1 = Install.GetGameAndModeIds()
			local f15_local2
			if not CONDITIONS.IsMagmaGameMode() then
				f15_local2 = not CONDITIONS.IsBRGameType()
			else
				f15_local2 = false
			end
			local f15_local3
			if f15_arg1 then
				f15_local3 = f15_arg1()
				if not f15_local3 then
				
				else
					local f15_local4 = f15_arg0 ~= nil
					if not f15_local4 then
						
					else
						
					end
					local f15_local5
					if f15_local4 then
						f15_local5 = f15_local4
					elseif not f15_local2 then
						f15_local5 = f15_local2
					else
						f15_local5 = f15_local3
					end
					local f15_local6 = false
					if f15_local5 then
						f15_local6 = GameInstall[0x52734240103F85D]( f15_arg0, f15_local1, f15_local0 )
					end
					return f15_local6
				end
			end
			f15_local3 = false
		else
			return false
		end
	end,
	StartDiscCheck = function ( f14_arg0 )
		local f14_local0, f14_local1 = Install.GetGameAndModeIds()
		local f14_local2 = GameInstall[0xAE9C79A2BA2E3C8]( f14_arg0, f14_local1, f14_local0 )
		if not f14_local2 then
			local f14_local3, f14_local4, f14_local5 = GameInstall[0x99B8431B960629A]( f14_arg0, f14_local1, f14_local0 )
			if f14_local3 then
				if CONDITIONS.IsSingleplayer() then
					SPSharedUtils.QuitToFrontend()
				else
					LUI.FlowManager.RequestRestoreMenu( "MainMenu", nil, f14_arg0, true )
				end
				return 
			end
		end
		return f14_local2
	end
}
local f0_local0 = function ( f12_arg0, f12_arg1, f12_arg2 )
	local f12_local0, f12_local1 = Install.GetGameAndModeIds()
	local f12_local2, f12_local3, f12_local4 = GameInstall[0x99B8431B960629A]( f12_arg1, f12_local1, f12_local0 )
	LUI.UIElement.CreateEventTimer( f12_arg0, "discCheckTimer", 10, {
		callbackFunc = function ()
			f12_arg0, f12_arg0, f12_arg0 = GameInstall[0x99B8431B960629A]( f12_arg0, f12_arg0, f12_arg0 )
			if f12_arg0 then
				f12_arg0:RemoveEventTimer( f12_arg0 )
				f12_arg0( f12_arg0 )
			elseif 30 < f12_arg0 then
				f12_arg0:RemoveEventTimer( f12_arg0 )
				f12_arg0( false )
			end
		end
	} )
end

Install.CheckDiscStatusSP = function ( f7_arg0, f7_arg1 )
	if not Install.IsDiscCheckRequired( f7_arg0._controllerIndex ) then
		Engine[0x434BCB5EBE2F3FA]()
	end
	if f7_arg1 and 0 < f7_arg1 then
		local f7_local0 = f7_arg0:Wait( f7_arg1 )
		f7_local0.onComplete = function ()
			Install.CheckDiscStatusWrap( f7_arg0, f7_arg0._controllerIndex, nil, function ()
				Engine[0x434BCB5EBE2F3FA]()
			end )
		end
		
	else
		LUI.UIElement.CreateEventTimer( f7_arg0, "check_open_popup", 50, {
			callbackFunc = function ()
				if not Engine[0xA05373E0E0F8B2C]() then
					LUI.UIElement.RemoveEventTimer( "check_open_popup" )
					Install.CheckDiscStatusWrap( f7_arg0, f7_arg0._controllerIndex, nil, function ()
						Engine[0x434BCB5EBE2F3FA]()
					end )
				end
			end
		} )
	end
end

Install.CheckDiscStatusWrap = function ( f1_arg0, f1_arg1, f1_arg2, f1_arg3, f1_arg4 )
	local f1_local0 = function ()
		if f1_arg0 then
			f1_arg0()
		end
	end
	
	local f1_local1 = function ()
		if f1_arg0 then
			return f1_arg0()
		else
			return true
		end
	end
	
	if not f1_local1() then
		f1_local0()
		return 
	end
	local f1_local1, f1_local2 = Install.GetGameAndModeIds()
	if not Install.IsDiscCheckRequired( f1_arg1 ) then
		f1_local0()
		return 
	end
	Install.StartDiscCheck( f1_arg1 )
	local f1_local3 = {
		popupCallbackFunc = function ()
			f1_arg0()
		end,
		popupCancelFunc = function ()
			if CONDITIONS.IsSingleplayer() then
				SPSharedUtils.QuitToFrontend()
			else
				local f3_local0 = LUI.FlowManager.RequestRestoreMenu
				local f3_local1
				if Engine[0xBBF0609667DBEA]() then
					f3_local1 = "MainMenu"
				else
					f3_local1 = "MainMenuOffline"
				end
				f3_local0( f3_local1, nil, f1_arg0, true )
			end
		end
	}
	local f1_local4 = function ( f2_arg0 )
		if not f2_arg0 then
			LUI.FlowManager.RequestPopupMenu( f1_arg0, Install.DiscErrorPopupMenu, true, f1_arg0, false, f1_arg0 )
		end
	end
	
	if f1_arg4 and f1_arg4.checkDiscBeforePopup then
		f0_local0( f1_arg0, f1_arg1, f1_local4 )
	else
		f1_local4( false )
	end
end

