-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:51
module( ..., package.seeall )
local f0_local0 = function ( f11_arg0, f11_arg1, f11_arg2 )
	assert( f11_arg0.ClipCountR )
	assert( f11_arg0.ClipCountL )
	assert( f11_arg0.StockCount )
	f11_arg0.ClipCountR:SetWordWrap( false )
	f11_arg0.ClipCountL:SetWordWrap( false )
	f11_arg0.StockCount:SetWordWrap( false )
	local f11_local0 = 8 * _1080p
	local f11_local1 = 0
	local f11_local2 = Engine.CAADCDEEIA()
	local f11_local3 = Engine.EAAHGICFBD()
	f11_arg0._currentStockValue = 0
	local f11_local4 = function ( f21_arg0, f21_arg1 )
		f21_arg0._currentStockValue = f21_arg1
		f21_arg0.StockCount:setText( Engine.JCBDICCAH( f21_arg1 ) )
	end
	
	local f11_local5 = function ( f20_arg0 )
		if CONDITIONS.IsRealismBR() then
			f11_arg0.StockCount:SetAlignment( LUI.Alignment.Center )
			if f20_arg0 and f20_arg0.isShowingTwoAmmoClips then
				f11_arg0.ClipCountR:SetAlignment( LUI.Alignment.Right )
				ACTIONS.AnimateSequence( f11_arg0, "CenterDualAmmoLayout" )
			else
				f11_arg0.ClipCountR:SetAlignment( LUI.Alignment.Center )
				ACTIONS.AnimateSequence( f11_arg0, "CenterSingleAmmoLayout" )
			end
		end
	end
	
	f11_local5( {
		isShowingTwoAmmoClips = false
	} )
	f11_local5 = function ()
		if f11_arg0.ticking then
			
		else
			
		end
		f11_arg0.ticking = true
		local f17_local0 = nil
		local f17_local1 = function ()
			local f18_local0 = f17_local0._currentStockValue
			local f18_local1 = f17_local0.targetValue - f18_local0
			if f18_local1 <= 0 then
				f17_local0( f17_local0, f17_local0.targetValue )
				f17_local0.ticking = false
			else
				f17_local0( f17_local0, f18_local0 + math.ceil( f18_local1 * 0.1 ) )
				local f18_local2 = f17_local0:Wait( 45 )
				f18_local2.onComplete = function ()
					f18_local0()
				end
				
			end
		end
		
		f17_local1()
	end
	
	local f11_local6 = function ( f16_arg0 )
		f11_arg0.targetValue = DataModel.JJEHAEBDF( f16_arg0 )
		local f16_local0 = f11_arg0._currentStockValue
		local f16_local1 = Game.BFEEGCHICA( f11_arg0, "damage_feedback_other" )
		local f16_local2 = DataSources.inGame.player.currentWeapon.name:GetValue( f11_arg0 )
		if f11_arg0 then
			if f16_local0 < f11_arg0.targetValue and f16_local2 == f11_arg0._previousWeapon and not f11_arg0._wasInAltMode then
				f11_arg0()
			else
				f11_arg0( f11_arg0, f11_arg0.targetValue )
			end
		elseif f11_arg0 then
			if f16_local0 < f11_arg0.targetValue and f16_local2 == f11_arg0._previousWeapon and not f11_arg0._wasInAltMode and f16_local1 == "scavenger" then
				f11_arg0()
			else
				f11_arg0( f11_arg0, f11_arg0.targetValue )
			end
		end
		f11_arg0._wasInAltMode = DataSources.inGame.player.currentWeapon.inAltMode:GetValue( f11_arg0 )
		f11_arg0._previousWeapon = f16_local2
		if f11_arg0.targetValue == 0 then
			f11_arg0.StockCount:SetRGBFromTable( SWATCHES.HUD.warning )
		else
			f11_arg0.StockCount:SetRGBFromTable( SWATCHES.HUD.HUDSecondary )
		end
	end
	
	local f11_local7 = function ()
		local f15_local0 = DataSources.inGame.player.currentWeapon.ammoWarningStateRight:GetValue( f11_arg0 )
		local f15_local1 = DataSources.inGame.player.currentWeapon.ammoWarningStateLeft:GetValue( f11_arg0 )
		local f15_local2 = DataSources.inGame.player.currentWeapon.clipAmmoRightDisplay:GetValue( f11_arg0 )
		if Engine.EAAHGICFBD() then
			local f15_local3 = DataSources.inGame.player.perk.overcharge:GetValue( f11_arg0 )
			local f15_local4 = SWATCHES.HUD.HUDMain
			if f15_local3 then
				f15_local4 = SWATCHES.HUD.overcharged
			end
			if CONDITIONS.IsMagmaGameMode() and DataSources.inGame.player.perk.chemRounds:GetValue( f11_arg0 ) then
				f15_local4 = SWATCHES.HUD.chemRounds
			end
			if f15_local0 == AmmoWarningState.OK then
				f11_arg0.ClipCountR:SetRGBFromTable( f15_local4 )
			else
				f11_arg0.ClipCountR:SetRGBFromTable( SWATCHES.HUD.warning )
			end
			if f15_local1 == AmmoWarningState.OK then
				f11_arg0.ClipCountL:SetRGBFromTable( f15_local4 )
			else
				f11_arg0.ClipCountL:SetRGBFromTable( SWATCHES.HUD.warning )
			end
		else
			if f15_local0 == AmmoWarningState.OK then
				f11_arg0.ClipCountR:SetRGBFromTable( SWATCHES.HUD.HUDMain )
			else
				f11_arg0.ClipCountR:SetRGBFromTable( SWATCHES.HUD.warning )
			end
			if f15_local1 == AmmoWarningState.OK then
				f11_arg0.ClipCountL:SetRGBFromTable( SWATCHES.HUD.HUDMain )
			else
				f11_arg0.ClipCountL:SetRGBFromTable( SWATCHES.HUD.warning )
			end
		end
		if f15_local2 and 9 < f15_local2 then
			if f11_arg0 then
				ACTIONS.AnimateSequence( f11_arg0, "Double" )
			end
		elseif f11_arg0 then
			ACTIONS.AnimateSequence( f11_arg0, "Single" )
		end
	end
	
	f11_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.stockAmmoDisplay:GetModel( f11_arg1 ), f11_local6 )
	f11_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoRightDisplay:GetModel( f11_arg1 ), f11_local7 )
	f11_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoLeftDisplay:GetModel( f11_arg1 ), f11_local7 )
	f11_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.displayName:GetModel( f11_arg1 ), f11_local7 )
	if Engine.EAAHGICFBD() then
		f11_arg0:SubscribeToModel( DataSources.inGame.player.perk.overcharge:GetModel( f11_arg1 ), f11_local7 )
	end
	if CONDITIONS.IsMagmaGameMode() then
		f11_arg0:SubscribeToModel( DataSources.inGame.player.perk.chemRounds:GetModel( f11_arg1 ), f11_local7 )
	end
	local f11_local8 = DataSources.inGame.player.currentWeapon.isDualWielding
	local f11_local9 = function ()
		local f14_local0 = DataSources.inGame.player.isOnLadder:GetValue( f11_arg0 )
		local f14_local1
		if DataSources.inGame.player.currentWeapon.ammoWarningStateLeft:GetValue( f11_arg0 ) ~= AmmoWarningState.OK or DataSources.inGame.player.currentWeapon.clipAmmoLeftDisplay:GetValue( f11_arg0 ) ~= 0 then
			f14_local1 = false
		else
			f14_local1 = true
		end
		local f14_local2
		if not f14_local0 and not f14_local1 then
			f14_local2 = f11_arg0:GetValue( f11_arg0 )
		else
			f14_local2 = false
		end
		local f14_local3
		if f14_local2 then
			f14_local3 = 0.85
		else
			f14_local3 = 0
		end
		f11_arg0.ClipCountL:SetAlpha( f14_local3 )
		f11_arg0.Divider:SetAlpha( f14_local3 )
		f11_arg0( {
			isShowingTwoAmmoClips = f14_local2
		} )
	end
	
	f11_arg0:SubscribeToModel( f11_local8:GetModel( f11_arg1 ), f11_local9 )
	f11_arg0:SubscribeToModel( DataSources.inGame.player.isOnLadder:GetModel( f11_arg1 ), f11_local9 )
	f11_arg0:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoLeftDisplay:GetModel( f11_arg1 ), f11_local9 )
	local f11_local10 = LUI.DataSourceInControllerModel.new( "cg.player.currentWeapon.clipAmmoVisible" )
	f11_arg0:SubscribeToModel( f11_local10:GetModel( f11_arg1 ), function ( f13_arg0 )
		local f13_local0
		if DataModel.JJEHAEBDF( f13_arg0 ) then
			f13_local0 = 0.85
		else
			f13_local0 = 0
		end
		f11_arg0.ClipCountR:SetAlpha( f13_local0 )
	end )
	local f11_local11 = LUI.DataSourceInControllerModel.new( "cg.player.currentWeapon.stockAmmoVisible" )
	f11_arg0:SubscribeToModel( f11_local11:GetModel( f11_arg1 ), function ( f12_arg0 )
		local f12_local0
		if DataModel.JJEHAEBDF( f12_arg0 ) then
			f12_local0 = 1
		else
			f12_local0 = 0
		end
		f11_arg0.StockCount:SetAlpha( f12_local0 )
	end )
	if IsLanguageJapanese() then
		ACTIONS.AnimateSequence( f11_arg0, "JP" )
	end
	if CONDITIONS.IsMagmaGameMode() then
		ACTIONS.AnimateSequence( f11_arg0, "WZSetup" )
	end
end

function AmmoCounter( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 100 * _1080p, 0, 75 * _1080p )
	self.id = "AmmoCounter"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	local StockCount = nil
	
	StockCount = LUI.UIStyledText.new()
	StockCount.id = "StockCount"
	StockCount:SetRGBFromTable( SWATCHES.HUD.HUDSecondary, 0 )
	StockCount:setText( "145", 0 )
	StockCount:SetFont( FONTS.GetFont( FONTS.MainRegular.File ) )
	StockCount:SetAlignment( LUI.Alignment.Right )
	StockCount:SetShadowMinDistance( -0.2, 0 )
	StockCount:SetShadowMaxDistance( 0.2, 0 )
	StockCount:SetShadowUOffset( -0.002, 0 )
	StockCount:SetShadowRGBFromTable( SWATCHES.HUD.HUDShadow, 0 )
	StockCount:SetAnchorsAndPosition( 0, 0, 1, 0, 0, 0, _1080p * -30, 0 )
	self:addElement( StockCount )
	self.StockCount = StockCount
	
	local ClipCountR = nil
	
	ClipCountR = LUI.UIStyledText.new()
	ClipCountR.id = "ClipCountR"
	ClipCountR:SetRGBFromTable( SWATCHES.HUD.HUDMain, 0 )
	ClipCountR:SetFont( FONTS.GetFont( FONTS.MainBold.File ) )
	ClipCountR:SetAlignment( LUI.Alignment.Right )
	ClipCountR:SetShadowMinDistance( -0.2, 0 )
	ClipCountR:SetShadowMaxDistance( 0.2, 0 )
	ClipCountR:SetShadowUOffset( -0.002, 0 )
	ClipCountR:SetShadowRGBFromTable( SWATCHES.HUD.HUDShadow, 0 )
	ClipCountR:SetAnchorsAndPosition( 0, 0, 0, 1, 0, 0, 0, _1080p * 50 )
	ClipCountR:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoRightDisplay:GetModel( f1_local1 ), function ()
		local f10_local0 = DataSources.inGame.player.currentWeapon.clipAmmoRightDisplay:GetValue( menu )
		if f10_local0 ~= nil then
			menu:setText( MarkLocalized( f10_local0 ), 0 )
		end
	end )
	self:addElement( ClipCountR )
	self.ClipCountR = ClipCountR
	
	local ClipCountL = nil
	
	ClipCountL = LUI.UIStyledText.new()
	ClipCountL.id = "ClipCountL"
	ClipCountL:SetRGBFromTable( SWATCHES.HUD.HUDMain, 0 )
	ClipCountL:SetAlpha( Clamp( 0.85, 0, 0.85 ), 0 )
	ClipCountL:SetFont( FONTS.GetFont( FONTS.MainBold.File ) )
	ClipCountL:SetWordWrap( false )
	ClipCountL:SetAlignment( LUI.Alignment.Right )
	ClipCountL:SetOptOutRightToLeftAlignmentFlip( true )
	ClipCountL:SetShadowMinDistance( -0.2, 0 )
	ClipCountL:SetShadowMaxDistance( 0.2, 0 )
	ClipCountL:SetShadowUOffset( -0.002, 0 )
	ClipCountL:SetShadowRGBFromTable( SWATCHES.HUD.HUDShadow, 0 )
	ClipCountL:SetAnchorsAndPosition( 0, 0, 0, 1, _1080p * -57, _1080p * -57, 0, _1080p * 50 )
	ClipCountL:SubscribeToModel( DataSources.inGame.player.currentWeapon.clipAmmoLeftDisplay:GetModel( f1_local1 ), function ()
		local f9_local0 = DataSources.inGame.player.currentWeapon.clipAmmoLeftDisplay:GetValue( menu )
		if f9_local0 ~= nil then
			menu:setText( MarkLocalized( f9_local0 ), 0 )
		end
	end )
	self:addElement( ClipCountL )
	self.ClipCountL = ClipCountL
	
	local Divider = nil
	
	Divider = LUI.UIStyledText.new()
	Divider.id = "Divider"
	Divider:SetRGBFromTable( SWATCHES.HUD.HUDMain, 0 )
	Divider:SetAlpha( 0.85, 0 )
	Divider:setText( "/", 0 )
	Divider:SetFont( FONTS.GetFont( FONTS.MainBold.File ) )
	Divider:SetAlignment( LUI.Alignment.Center )
	Divider:SetShadowMinDistance( -0.2, 0 )
	Divider:SetShadowMaxDistance( 0.2, 0 )
	Divider:SetShadowUOffset( -0.002, 0 )
	Divider:SetShadowRGBFromTable( SWATCHES.HUD.HUDShadow, 0 )
	Divider:SetAnchorsAndPosition( 0, 0, 0, 1, _1080p * 8, _1080p * 8, _1080p * 4, _1080p * 40 )
	self:addElement( Divider )
	self.Divider = Divider
	
	local f1_local7 = nil
	if CONDITIONS.IsRealismBR() then
		f1_local7 = LUI.UIImage.new()
		f1_local7.id = "VertDivider"
		f1_local7:SetRGBFromTable( SWATCHES.CAC.border, 0 )
		f1_local7:SetAlpha( 0, 0 )
		f1_local7:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * 6, _1080p * 52, _1080p * 8.5, _1080p * 10.5 )
		self:addElement( f1_local7 )
		self.VertDivider = f1_local7
	end
	self._sequences.DefaultSequence = function ()
		
	end
	
	local f1_local8 = nil
	StockCount:RegisterAnimationSequence( "JP", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * -28
		}
	} )
	ClipCountR:RegisterAnimationSequence( "JP", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 46
		}
	} )
	ClipCountL:RegisterAnimationSequence( "JP", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 46
		}
	} )
	Divider:RegisterAnimationSequence( "JP", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Top,
			value = _1080p * 1
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Bottom,
			value = _1080p * 42
		}
	} )
	self._sequences.JP = function ()
		menu:AnimateSequence( "JP" )
		menu:AnimateSequence( "JP" )
		menu:AnimateSequence( "JP" )
		menu:AnimateSequence( "JP" )
	end
	
	local f1_local9 = nil
	ClipCountL:RegisterAnimationSequence( "Single", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -57
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -57
		}
	} )
	Divider:RegisterAnimationSequence( "Single", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * 8
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * 8
		}
	} )
	self._sequences.Single = function ()
		menu:AnimateSequence( "Single" )
		menu:AnimateSequence( "Single" )
	end
	
	local f1_local10 = nil
	ClipCountL:RegisterAnimationSequence( "Double", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -76
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -76
		}
	} )
	Divider:RegisterAnimationSequence( "Double", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -11
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -11
		}
	} )
	self._sequences.Double = function ()
		menu:AnimateSequence( "Double" )
		menu:AnimateSequence( "Double" )
	end
	
	local f1_local11 = nil
	if CONDITIONS.IsRealismBR() then
		f1_local7:RegisterAnimationSequence( "CenterSingleAmmoLayout", {
			{
				value = 5.29462817E-315,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.Left,
				value = _1080p * -32
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.Right,
				value = _1080p * 32
			}
		} )
	end
	self._sequences.CenterSingleAmmoLayout = function ()
		if CONDITIONS.IsRealismBR() then
			menu:AnimateSequence( "CenterSingleAmmoLayout" )
		end
	end
	
	local f1_local12 = nil
	ClipCountR:RegisterAnimationSequence( "CenterDualAmmoLayout", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -8
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -8
		}
	} )
	ClipCountL:RegisterAnimationSequence( "CenterDualAmmoLayout", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.Left,
			value = _1080p * -65
		},
		{
			duration = 0,
			property = TWEEN_PROPERTY.Right,
			value = _1080p * -65
		}
	} )
	Divider:RegisterAnimationSequence( "CenterDualAmmoLayout", {
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Left
		},
		{
			value = 0,
			duration = 0,
			property = TWEEN_PROPERTY.Right
		}
	} )
	if CONDITIONS.IsRealismBR() then
		f1_local7:RegisterAnimationSequence( "CenterDualAmmoLayout", {
			{
				value = 5.29462817E-315,
				duration = 0,
				property = TWEEN_PROPERTY.Alpha
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.Right,
				value = _1080p * 32
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.Left,
				value = _1080p * -32
			}
		} )
	end
	self._sequences.CenterDualAmmoLayout = function ()
		menu:AnimateSequence( "CenterDualAmmoLayout" )
		menu:AnimateSequence( "CenterDualAmmoLayout" )
		menu:AnimateSequence( "CenterDualAmmoLayout" )
		if CONDITIONS.IsRealismBR() then
			menu:AnimateSequence( "CenterDualAmmoLayout" )
		end
	end
	
	local f1_local13 = nil
	StockCount:RegisterAnimationSequence( "WZSetup", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.RGB,
			value = SWATCHES.WZGlobalSwatches.WZDescription
		}
	} )
	ClipCountR:RegisterAnimationSequence( "WZSetup", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.RGB,
			value = SWATCHES.WZGlobalSwatches.WZText
		}
	} )
	ClipCountL:RegisterAnimationSequence( "WZSetup", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.RGB,
			value = SWATCHES.WZGlobalSwatches.WZText
		}
	} )
	Divider:RegisterAnimationSequence( "WZSetup", {
		{
			duration = 0,
			property = TWEEN_PROPERTY.RGB,
			value = SWATCHES.WZGlobalSwatches.WZText
		}
	} )
	if CONDITIONS.IsRealismBR() then
		f1_local7:RegisterAnimationSequence( "WZSetup", {
			{
				duration = 0,
				property = TWEEN_PROPERTY.Material,
				value = RegisterMaterial( "ui_mp_wz_sep_menu_title" )
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.Bottom,
				value = _1080p * 11.5
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.Top,
				value = _1080p * 7.5
			},
			{
				duration = 0,
				property = TWEEN_PROPERTY.RGB,
				value = SWATCHES.WZGlobalSwatches.WZLineSeperator
			}
		} )
	end
	self._sequences.WZSetup = function ()
		menu:AnimateSequence( "WZSetup" )
		menu:AnimateSequence( "WZSetup" )
		menu:AnimateSequence( "WZSetup" )
		menu:AnimateSequence( "WZSetup" )
		if CONDITIONS.IsRealismBR() then
			menu:AnimateSequence( "WZSetup" )
		end
	end
	
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "AmmoCounter", AmmoCounter )
LockTable( _M )
