-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-10-2025 14:16
module( ..., package.seeall )
local f0_local0 = function ( f26_arg0, f26_arg1 )
	for f26_local3, f26_local4 in ipairs( f26_arg1 ) do
		if f26_arg0._equippedSkin.variantID == f26_local4.variantID then
			return f26_local3 - 1
		end
	end
	return 1
end

local f0_local1 = function ( f25_arg0, f25_arg1 )
	for f25_local3, f25_local4 in ipairs( f25_arg1 ) do
		if f25_arg0 == f25_local4.variantID then
			return f25_local4
		end
	end
	return f25_arg1[0]
end

local f0_local2 = function ( f24_arg0, f24_arg1, f24_arg2 )
	local f24_local0 = f24_arg0.equipmentData.ref
	local f24_local1 = f24_arg0.equipmentData.lootID
	local f24_local2 = CONDITIONS.IsDMZMatch()
	if f24_local2 then
		if f24_arg2.lootID ~= LOOT.emptyID then
			local f24_local3 = f24_arg2.lootID
			if not f24_local3 then
				f24_local1 = f24_local3
			end
		end
		f24_local1 = f24_arg0.equipmentData.lootID
	end
	if not EQUIPMENT.IsEquipmentEquipped( f24_arg1, f24_local0 ) or f24_local2 then
		EQUIPMENT.SetEquippedEquipment( f24_arg1, f24_arg0.loadoutIndex, f24_arg0.equipmentIndex, f24_local0 )
	end
	if not f24_local2 then
		EQUIPMENT.SetEquippedSkin( f24_arg1, f24_arg0.equipmentIndex, f24_arg0.loadoutIndex, f24_arg2.variantID, f24_local1 )
	end
	if CONDITIONS.InGame() then
		Engine[0x6055C55456F05DF]( "equip_item_ingame", 1 )
	end
	LOOT.SendDlogLootEquipped( f24_arg1, LOOT.itemTypes.EQUIPMENT, nil, nil, EQUIPMENT.GetEquippedEquipment( f24_arg1, f24_arg0.loadoutIndex, f24_arg0.equipmentIndex ), f24_local0 )
	local f24_local4 = LUI.FlowManager.GetMenuStack()
	local f24_local5
	if 1 < #f24_local4 then
		f24_local5 = f24_local4[#f24_local4 - 1].name
		if not f24_local5 then
		
		else
			if f24_local5 == LOADOUT.GetEquipmentSelectMenuRef() and 2 < #f24_local4 then
				LUI.FlowManager.RequestRestoreMenu( f24_local4[#f24_local4 - 2].name )
			else
				LUI.FlowManager.RequestLeaveMenu()
			end
		end
	end
	f24_local5 = nil
end

local f0_local3 = function ( f20_arg0, f20_arg1, f20_arg2, f20_arg3 )
	f20_arg2.skinData = f20_arg3.skinData
	f20_arg2.skinDetails = EQUIPMENT.GetVariantDetails( f20_arg1, f20_arg2.skinData, f20_arg0.equipmentData )
	local f20_local0 = f20_arg2.skinData.variantID ~= EQUIPMENT.baseVariant
	local f20_local1 = f20_arg2.skinDetails.lootID
	local f20_local2 = {
		removeTextBacker = true,
		hasEmptyState = true,
		doNotRemoveBackground = true,
		buttonData = {
			image = f20_arg2.skinDetails.image
		}
	}
	local f20_local3
	if f20_local0 then
		f20_local3 = "1x1"
	else
		f20_local3 = "ImageFull"
	end
	f20_local2.imageSize = f20_local3
	f20_local2.primaryActionText = Engine[0xED84C33EC5F01EA]( 0xCA07A93FADF9E95 )
	f20_arg2:SetupButton( f20_local2 )
	f20_arg2:SetEquipped( f20_arg2.skinDetails.isEquipped )
	f20_arg2:SetEmpty( false )
	f20_arg2:SetButtonDisabled( not f20_arg2.skinDetails.isUnlocked )
	f20_arg2:setActionSFX( SOUND_SETS.equipmentMenu.equipmentSelect )
	f20_local3 = function ( f22_arg0, f22_arg1 )
		return function ( f23_arg0, f23_arg1 )
			if f22_arg0 and f22_arg0.menu then
				f22_arg0.menu:UpdatePreviewData( f22_arg0, f22_arg0.skinDetails )
				f22_arg0.menu:UpdateEquipmentModel( f22_arg0, f22_arg0 )
			end
		end
		
	end
	
	if not f20_arg2.eventHandlerAdded then
		f20_arg2:addEventHandler( "button_action", function ( f21_arg0, f21_arg1 )
			f20_arg0( f20_arg0, f21_arg1.controller, f20_arg0.skinData )
		end )
		f20_arg2:addEventHandler( "button_over", f20_local3( f20_arg2, {
			menu = f20_arg0
		} ) )
		f20_arg2:addEventHandler( "button_over_disable", f20_local3( f20_arg2, {
			menu = f20_arg0
		} ) )
		f20_arg2.eventHandlerAdded = true
	end
end

local f0_local4 = function ( f19_arg0 )
	f19_arg0.MenuTitle:SetTitle( Engine[0xED84C33EC5F01EA]( 0x8AF68DFD90CD7C3, f19_arg0.equipmentData.nameRef ) )
end

local f0_local5 = function ( f18_arg0 )
	f18_arg0.ItemDetails:SetupForEquipment()
end

local f0_local6 = function ( f17_arg0, f17_arg1 )
	f17_arg0.EquipmentSkinGrid:SetFocusedPosition( f17_arg0.EquipmentSkinGrid:GetPositionForIndex( f0_local0( f17_arg0, f17_arg1 ), {
		relativePosition = false
	} ), true )
end

local f0_local7 = function ( f16_arg0 )
	if f16_arg0._equippedSkin.variantID ~= EQUIPMENT.baseVariant then
		f16_arg0:SetFocusedEquipmentSkin( f16_arg0.equipmentData.skinVariants )
	else
		f16_arg0.EquipmentSkinGrid:SetFocusedPosition( f16_arg0.EquipmentSkinGrid:GetPositionForIndex( 1, {
			relativePosition = false
		} ), true )
	end
end

local f0_local8 = function ( f14_arg0, f14_arg1 )
	f14_arg0.EquipmentSkinGrid:SetNumChildren( #f14_arg0.equipmentData.skinVariants )
	f14_arg0.EquipmentSkinGrid:SetRefreshChild( function ( f15_arg0, f15_arg1, f15_arg2 )
		local f15_local0 = f14_arg0[f15_arg1 + 1]
		f14_arg0( f14_arg0, f14_arg0, f15_arg0, {
			skinData = f15_local0,
			isEquipped = f15_local0.variantID == f14_arg0._equippedSkin.variantID
		} )
	end )
	f14_arg0.EquipmentSkinGrid:TouchMouseSetActiveToDefaultFocusMenuCreate( f14_arg1 )
	f14_arg0.EquipmentSkinGrid:RefreshContent()
	f14_arg0:UpdateGrid( f14_arg1 )
	f0_local0( f14_arg0 )
end

local f0_local9 = function ( f13_arg0, f13_arg1, f13_arg2 )
	if not CONDITIONS.InFrontend() then
		return 
	end
	local f13_local0 = WATCH.GetEquippedWatch( f13_arg1 )
	FrontEndScene.SetExclusiveWeaponModels( {
		FrontEndScene.ClientWeapons.GunTablePrimary,
		FrontEndScene.ClientWeapons.GunTableSecondary,
		FrontEndScene.ClientWeapons.Watch
	} )
	local f13_local1 = WEAPON.GetWeaponModel( f13_arg1, FrontEndScene.ClientWeapons.Watch, CSV.weaponOffsets.watchFile )
	f13_arg0:addElement( f13_local1 )
	LOADOUT.RequestWatchAndWeaponModels( f13_arg1, f13_arg0.loadoutIndex )
	WATCH.SetWatchModelIfLoaded( f13_arg0, f13_arg1, f13_local1, f13_local0 )
	ClientWeapon[0x59B77D6F41ED417]( FrontEndScene.ClientWeapons.Preview, false )
	local f13_local2 = nil
	if f13_arg0.equipmentData.ref == "equip_throwing_knife" then
		if f13_arg2 == GL_HACK.THROWING_KNIFE_CRYSTAL_LOOT_ID then
			f13_local2 = GL_HACK.THROWING_KNIFE_CRYSTAL_MODEL
		elseif f13_arg2 == GL_HACK.THROWING_KNIFE_ICE_FLOW_LOOT_ID then
			f13_local2 = GL_HACK.THROWING_KNIFE_ICE_FLOW_MODEL
		else
			f13_local2 = GL_HACK.THROWING_KNIFE_MODEL
		end
	elseif f13_arg0.equipmentData.ref == "equip_frag" then
		if f13_arg2 == GL_HACK.WAMPA_GRENADE_LOOT_ID then
			f13_local2 = GL_HACK.FRAG_GRENADE_WAMPA_MODEL
		elseif f13_arg2 == GL_HACK.DARK_RITUALS_GRENADE_LOOT_ID then
			f13_local2 = GL_HACK.FRAG_GRENADE_DARK_RITUALS_MODEL
		else
			f13_local2 = GL_HACK.FRAG_GRENADE_MODEL
		end
	elseif f13_arg0.equipmentData.ref == "equip_smoke" then
		if f13_arg2 == GL_HACK.SMOKE_GRENADE_VARIANT_LOOT_ID then
			f13_local2 = GL_HACK.SMOKE_GRENADE_VARIANT_MODEL
		else
			f13_local2 = GL_HACK.SMOKE_GRENADE_MODEL
		end
	end
	local f13_local3 = CLIENT_MODEL.coreMPModels.LETHAL
	if f13_arg0.equipmentData.ref == "equip_smoke" then
		f13_local3 = CLIENT_MODEL.coreMPModels.TACTICAL
	end
	CLIENT_MODEL.SetModel( f13_local3, f13_local2 )
end

local f0_local10 = function ( f12_arg0, f12_arg1, f12_arg2 )
	f12_arg0.ItemDetails:UpdateDetails( f12_arg2 )
	if f12_arg0.BundleUpsellButton then
		local f12_local0 = Dvar[0x9E5BE3B4BBA4E0E]( 0x62400405F9F3C0B )
		if f12_local0 then
			if f12_arg2.isUnlocked or f12_arg2.variantID == EQUIPMENT.baseVariant then
				f12_local0 = false
			else
				f12_local0 = true
			end
		end
		if f12_local0 then
			f12_arg0.BundleUpsellButton:SetupUpsellButtonWithLootID( f12_arg1, f12_arg2.lootID )
		else
			f12_arg0.BundleUpsellButton:HideButton()
		end
	end
end

local f0_local11 = function ( f11_arg0, f11_arg1 )
	local f11_local0 = 0
	local f11_local1 = #f11_arg0.equipmentData.skinVariants - 1
	for f11_local6, f11_local7 in ipairs( f11_arg0.equipmentData.skinVariants ) do
		local f11_local5 = f11_local7.lootID
		if f11_local5 then
			if not WEAPON.IsBaseWeapon( LOOT.GetItemRef( f11_local7.lootID ) ) then
				f11_local5 = LOOT.IsUnlockedWithID( f11_arg1, f11_local7.lootID )
			else
				f11_local5 = false
			end
		end
		if f11_local5 then
			f11_local0 = f11_local0 + 1
		end
	end
	f11_arg0.UnlockCount.Text:setText( ToUpperCase( Engine[0xED84C33EC5F01EA]( 0x48D718D82BA33FF, f11_local0, f11_local1 ) ) )
	f11_arg0.UnlockCount:UpdateSize( false )
end

local f0_local12 = function ( f10_arg0, f10_arg1 )
	if f10_arg0.UnlockCount then
		f0_local0( f10_arg0, f10_arg1 )
	end
	f10_arg0.EquipmentSkinGrid:RemoveFocusFromChild()
	f10_arg0.EquipmentSkinGrid:SetNumChildren( #f10_arg0.equipmentData.skinVariants )
	f10_arg0:UpdatePreviewData( f10_arg1, f10_arg0._equippedSkin, f10_arg0.equipmentData )
	f10_arg0.EquipmentSkinGrid:RefreshContent()
end

local f0_local13 = function ( f6_arg0, f6_arg1 )
	f6_arg0:addEventHandler( "menu_create", function ( f9_arg0, f9_arg1 )
		f9_arg0.EquipmentSkinGrid:RefreshContent()
		local f9_local0 = f9_arg1.controller or f6_arg0
		local f9_local1 = LUI.IsLastInputGamepad( f9_local0 )
		if not f9_local1 then
			f9_local1 = LUI.IsLastInputKeyboardNavigation( f9_local0 )
		end
		if not f9_arg0.EquipmentSkinGrid:GetFocusPositionIndex() and f9_local1 then
			f9_arg0.EquipmentSkinGrid:SetFocusedPosition( {
				y = 0,
				x = f6_arg0( f6_arg0, f6_arg0.equipmentData.skinVariants )
			}, true )
		end
	end )
	f6_arg0:addEventHandler( "update_input_type", function ( f8_arg0, f8_arg1 )
		f8_arg0.EquipmentSkinGrid:restoreState()
	end )
	f6_arg0:AddGamepadEventCallback( "button_secondary", function ( f7_arg0, f7_arg1 )
		ACTIONS.LeaveMenu( f7_arg0 )
	end )
end

local f0_local14 = function ( f5_arg0, f5_arg1 )
	local f5_local0 = f5_arg1 == EQUIPMENT[0x74F9D21004E6324][0x2B1AD16803854BB]
	local f5_local1 = Engine[0x685AE31DEDA30A4]
	local f5_local2
	if f5_local0 then
		f5_local2 = "loadout_showcase_l"
	else
		f5_local2 = "loadout_showcase_t"
	end
	f5_local1( f5_local2 )
end

local f0_local15 = function ( f4_arg0, f4_arg1, f4_arg2 )
	if CONDITIONS.InFrontend() then
		f0_local0( f4_arg0, f4_arg1, f4_arg0._equippedSkin.lootID )
		local f4_local0 = LUI.FlowManager.GetScopedData( f4_arg0 )
		if f4_local0.returnFromBundle or CONDITIONS.IsDMZMatch() then
			f0_local0( f4_arg0, f4_arg0.equipmentIndex )
			CLIENT_MODEL.SendClientModelTagDataToServer( f4_arg2, f4_arg2, f4_arg1 )
			f4_local0 = LUI.FlowManager.GetScopedData( f4_arg0 )
			f4_local0.returnFromBundle = false
		end
	end
end

local f0_local16 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0.UpdateGrid = f0_local0
	f3_arg0.SetFocusedEquipmentSkin = f0_local0
	f3_arg0.UpdatePreviewData = f0_local0
	f3_arg0.UpdateEquipmentModel = f0_local0
	f3_arg0.SetupSkinButton = f0_local0
	f3_arg0.equipmentData = f3_arg2.equipmentData
	f3_arg0.equipmentIndex = f3_arg2.equipmentIndex
	f3_arg0.loadoutIndex = f3_arg2.loadoutIndex
	f3_arg0.returnFromBundle = false
	local f3_local0 = LUI.FlowManager.GetScopedData( f3_arg0 )
	if f3_local0.returnFromBundle or not f3_arg0.equipmentData.skinVariants then
		if type( f3_arg0.equipmentData ) == "string" then
			f3_local0 = f3_arg0.equipmentData
			if not f3_local0 then
				f3_local0 = f3_arg0.equipmentData
				if f3_local0 then
					f3_local0 = f3_arg0.equipmentData.ref
				end
			end
		else
			f3_local0 = f3_arg0.equipmentData
			if f3_local0 then
				f3_local0 = f3_arg0.equipmentData.ref
			end
		end
		local f3_local1 = EQUIPMENT.GetEquipmentData( f3_arg1, f3_local0 )
		f3_local1.skinVariants = EQUIPMENT.GetEquipmentSkins( f3_arg1, f3_local1.useWeapon, f3_local1.lootID )
		f3_arg0.equipmentData = f3_local1
	end
	local f3_local1
	if EQUIPMENT.IsEquipmentEquipped( f3_arg1, f3_arg0.equipmentData.ref ) then
		f3_local1 = EQUIPMENT.GetEquippedSkin( f3_arg1, f3_arg0.loadoutIndex, f3_arg0.equipmentIndex )
		if not f3_local1 then
		
		else
			f3_arg0._equippedSkin = f0_local0( f3_local1, f3_arg0.equipmentData.skinVariants )
			f0_local0( f3_arg0, f3_arg1, f3_arg0.equipmentData.ref )
			f0_local0( f3_arg0 )
			f0_local0( f3_arg0 )
			f0_local0( f3_arg0, f3_arg1 )
			MenuUtils.SetupSideArrows( f3_arg0, f3_arg0.EquipmentSkinGrid, true )
			f0_local0( f3_arg0, f3_arg1 )
		end
	end
	f3_local1 = EQUIPMENT.baseVariant
end

local f0_local17 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function EquipmentSkinSelectBase( menu, controller )
	local self = LUI.UIElement.new()
	self.id = "EquipmentSkinSelectBase"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local f1_local3 = self
	EQUIPMENT.SetupEquipmentSelectMenu( self, f1_local1, controller )
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "EquipmentSkinSelectBase", EquipmentSkinSelectBase )
LockTable( _M )
