-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
GAMEBATTLES = GAMEBATTLES or {}
GAMEBATTLES.INVALID_MATCH_ID = "0"
GAMEBATTLES.MATCH_LOBBY_BUTTON_COOLDOWN = 2000
GAMEBATTLES.INPUT_CHANGE_DEBOUNCE_TIME = 1000
GAMEBATTLES.shouldShowAllCharacters = Dvar[0x9E5BE3B4BBA4E0E]( "#x3bcc5d9bb1f594dec" )
GAMEBATTLES.shouldShowFenceToRefreshSchedule = false
GAMEBATTLES.GAMEBATTLES_LOBBY_CHARACTERS_POSITION = {
	nil,
	1,
	0,
	3,
	2,
	4,
	5,
	7,
	6,
	9,
	8,
	10,
	11
}
GAMEBATTLES.MAX_LOBBY_CHARACTERS_POSITIONS = #GAMEBATTLES.GAMEBATTLES_LOBBY_CHARACTERS_POSITION
GAMEBATTLES.URL = {
	MLG_TERMS_OF_SERVICE = "https://accounts.majorleaguegaming.com/terms_of_service",
	MLG_PRIVACY_POLICY = "https://accounts.majorleaguegaming.com/privacy_policy"
}
MLG.ResetGameBattleMatchId = function ( f46_arg0 )
	MLG[0x23E9FB74DC18CF9]( GAMEBATTLES.INVALID_MATCH_ID )
end

GAMEBATTLES.MLG_ACCOUNT_STATE = {
	ACCOUNT_ERROR = 4,
	NO_ACCOUNT = 3,
	UNAVAILABLE = 0,
	HAS_ACCOUNT = 2,
	RETRIEVING = 1
}
GAMEBATTLES.MLG_RECIPE_PRESET = {
	RECIPE_CWL = 1,
	RECIPE_MAX = 3,
	RECIPE_GB = 2,
	RECIPE_DEFAULT = 0
}
GAMEBATTLES.MLG_INPUT_TYPE_PRESET = {
	KBM = 0,
	GPad = 1,
	KBM_GPad = 2
}
GAMEBATTLES.MLG_SCHEDULE_STATE = {
	AVAILABLE = 2,
	RETRIEVAL_ERROR = 3,
	RETRIEVING = 1,
	UNAVAILABLE = 0
}
GAMEBATTLES.MLG_CODE_STATE = {
	AVAILABLE = 2,
	RETRIEVAL_ERROR = 3,
	RETRIEVING = 1,
	UNAVAILABLE = 0
}
GAMEBATTLES.MLG_ERR_CODE = {
	MATCH_HISTORY_RETRIEVAL_ERROR = 3,
	NO_SOCIAL_PRIVILEGES = 4,
	FIRST_TIME_ENTRY = 2,
	USER_NOT_REGISTERED = 1,
	CANNOT_CONNECT = 0
}
GAMEBATTLES.MLG_REPORT_STATE = {
	SEND_SUCCESS = 3,
	IDLE = 0,
	SEND_ERROR = 4,
	DS_SENDING = 2,
	SENDING = 1
}
GAMEBATTLES.MLG_GAME_STATUS = {
	WON_AWAY = 2,
	UNPLAYED = 0,
	WON_HOME = 1,
	NO_SHOW = 3
}
GAMEBATTLES.MLG_MATCH_JOIN_STATE = {
	JOIN_ERROR = 4,
	CANT_HOST = 5,
	IDLE = 0,
	CLIENT = 3,
	TRY_CREATE = 1,
	HOST = 2
}
GAMEBATTLES.MLG_MATCH_HISTORY_STATE = {
	AVAILABLE = 2,
	RETRIEVAL_ERROR = 3,
	RETRIEVING = 1,
	UNAVAILABLE = 0
}
GAMEBATTLES.LOBBY_ANIMATION_STATE = {
	HAS_LEFT_MATCH = 2,
	HAS_NOT_JOINED = 0,
	HAS_JOINED = 1
}
GAMEBATTLES.ApplyGameSettings = function ( f45_arg0, f45_arg1 )
	Dvar[0xE3CB005036E0C0F]( "#x3a30c33efc8281eb1", f45_arg0.gametype )
	Dvar[0xE3CB005036E0C0F]( "#x36d16f02578d0ee10", f45_arg0.map )
	MLG[0x4BA677416BD9A94]( f45_arg1 )
end

GAMEBATTLES.GetCodcastersCount = function ( f44_arg0 )
	assert( f44_arg0 ~= nil )
	return f44_arg0.totalPlayerCount - f44_arg0.teams[1].playerCount + f44_arg0.teams[2].playerCount
end

GAMEBATTLES.GetNoshowTime = function ()
	local f43_local0 = Dvar[0x22EAAB59AA27E9B]( "#x3c76d3612d6955e9e" )
	if f43_local0 ~= nil and f43_local0 ~= 0 then
		return f43_local0
	else
		return 600
	end
end

GAMEBATTLES.GetNoBackOutTime = function ()
	return 30
end

GAMEBATTLES.GetIntermissionTime = function ()
	local f41_local0 = Dvar[0x22EAAB59AA27E9B]( "#x3fba6a9904ee85df4" )
	if f41_local0 ~= nil and f41_local0 ~= 0 then
		return f41_local0
	else
		return 300
	end
end

GAMEBATTLES.GetScheduleRefreshInterval = function ()
	return Dvar[0x22EAAB59AA27E9B]( "#x35d96d102bce17c1c" ) * 1000
end

GAMEBATTLES.SetScheduleRefreshInterval = function ( f39_arg0 )
	Dvar[0x2414681ECAB880F]( "#x35d96d102bce17c1c", f39_arg0 / 1000 )
end

GAMEBATTLES.GetMatchHistoryRefreshInterval = function ()
	return Dvar[0x22EAAB59AA27E9B]( "#x37b5260b9cb7e9772" ) * 1000
end

GAMEBATTLES.SetMatchHistoryRefreshInterval = function ( f37_arg0 )
	Dvar[0x2414681ECAB880F]( "#x37b5260b9cb7e9772", f37_arg0 / 1000 )
end

GAMEBATTLES.GetMatchProgressInfo = function ( f36_arg0 )
	local f36_local0 = GAMEBATTLES.GetSecondsUntilNoShow( f36_arg0 ) <= 0
	local f36_local1 = false
	local f36_local2, f36_local3, f36_local4 = GAMEBATTLES.GetMatchVictoryInfo( f36_arg0 )
	if f36_local2 ~= 0 or f36_local3 ~= 0 then
		f36_local0 = true
		local f36_local5 = f36_arg0.gameCount / 2
		if f36_local5 < f36_local2 or f36_local5 < f36_local3 then
			f36_local1 = true
		end
	end
	local f36_local5 = f36_local0
	local f36_local6
	if not f36_local1 then
		f36_local6 = f36_local1
	else
		f36_local6 = f36_local4
	end
	return f36_local5, f36_local6
end

GAMEBATTLES.GetMatchVictoryInfo = function ( f35_arg0 )
	local f35_local0 = 0
	local f35_local1 = 0
	local f35_local2 = false
	for f35_local6, f35_local7 in ipairs( f35_arg0.games ) do
		if f35_local7.status == GAMEBATTLES.MLG_GAME_STATUS.WON_AWAY then
			f35_local0 = f35_local0 + 1
		end
		if f35_local7.status == GAMEBATTLES.MLG_GAME_STATUS.WON_HOME then
			f35_local1 = f35_local1 + 1
		end
		if f35_local7.status == GAMEBATTLES.MLG_GAME_STATUS.NO_SHOW then
			f35_local2 = true
		end
	end
	return f35_local0, f35_local1, f35_local2
end

GAMEBATTLES.GetFirstActiveMatch = function ( f34_arg0 )
	local f34_local0 = MLG[0xDA05B9AD7B4EBEE]( f34_arg0 )
	for f34_local1 = 0, f34_local0 - 1, 1 do
		local f34_local4 = MLG[0x31A4660A614F6A8]( f34_arg0, f34_local1 )
		local f34_local5, f34_local6 = GAMEBATTLES.GetMatchProgressInfo( f34_local4 )
		if not f34_local6 and not GAMEBATTLES.IsMatchExpired( f34_arg0, f34_local4 ) then
			return f34_local4
		end
	end
	return nil
end

GAMEBATTLES.GetLastCompletedMatch = function ( f33_arg0 )
	for f33_local0 = MLG[0xDA05B9AD7B4EBEE]( f33_arg0 ) - 1, 0, -1 do
		local f33_local3 = MLG[0x31A4660A614F6A8]( f33_arg0, f33_local0 )
		local f33_local4, f33_local5 = GAMEBATTLES.GetMatchProgressInfo( f33_local3 )
		if f33_local5 then
			return f33_local3
		end
	end
	return nil
end

GAMEBATTLES.GetMatchByMatchID = function ( f32_arg0, f32_arg1 )
	local f32_local0 = MLG[0xDA05B9AD7B4EBEE]( f32_arg0 )
	for f32_local1 = 0, f32_local0 - 1, 1 do
		local f32_local4 = MLG[0x31A4660A614F6A8]( f32_arg0, f32_local1 )
		if f32_local4.matchId == f32_arg1 then
			return f32_local4
		end
	end
	return nil
end

GAMEBATTLES.GetCurrentMatch = function ( f31_arg0 )
	if MLG[0xD38F25930B89003]( f31_arg0 ) ~= GAMEBATTLES.MLG_SCHEDULE_STATE.AVAILABLE then
		return nil
	else
		local f31_local0 = MLG[0xF0559CB8E654A67]( f31_arg0 )
		if f31_local0 < 0 then
			return nil
		else
			return MLG[0x31A4660A614F6A8]( f31_arg0, f31_local0 )
		end
	end
end

GAMEBATTLES.IsCurrentMatchCompleted = function ( f30_arg0 )
	local f30_local0 = GAMEBATTLES.GetCurrentMatch( f30_arg0 )
	if f30_local0 ~= nil then
		local f30_local1, f30_local2 = GAMEBATTLES.GetMatchProgressInfo( f30_local0 )
		return f30_local2
	else
		return false
	end
end

GAMEBATTLES.IsMatchExpired = function ( f29_arg0, f29_arg1 )
	if not (GAMEBATTLES.GetSecondsUntilNoShow( f29_arg1 ) <= 0) then
		return false
	elseif GAMEBATTLES.HasJoinedMatch( f29_arg0 ) then
		return false
	end
	for f29_local3, f29_local4 in ipairs( f29_arg1.games ) do
		if f29_local4.status ~= GAMEBATTLES.MLG_GAME_STATUS.UNPLAYED then
			return false
		end
	end
	return true
end

GAMEBATTLES.ShowMatchForfeitPopup = function ( f28_arg0, f28_arg1, f28_arg2, f28_arg3 )
	local f28_local0
	if f28_arg3 == 1 then
		f28_local0 = 2
	else
		f28_local0 = 1
	end
	LUI.FlowManager.RequestPopupMenu( f28_arg0, "GameBattlesMatchForfeit", false, f28_arg1, false, {
		currentDateTime = Engine[0xEF7B624854C33E9](),
		forfeitTeamName = f28_arg2.teams[f28_local0].teamName,
		forfeitTeamId = f28_arg2.teams[f28_local0].teamId,
		winningTeamName = f28_arg2.teams[f28_arg3].teamName,
		winningTeamId = f28_arg2.teams[f28_arg3].teamId,
		matchID = f28_arg2.matchId
	} )
end

GAMEBATTLES.GetClientCharacterData = function ( f27_arg0, f27_arg1, f27_arg2, f27_arg3 )
	local f27_local0 = {}
	local f27_local1 = {}
	local f27_local2 = {}
	local f27_local3 = {}
	local f27_local4 = GAMEBATTLES.shouldShowAllCharacters
	if 0 < f27_arg3 then
		for f27_local5 = 0, f27_arg3 - 1, 1 do
			local f27_local8 = f27_arg1:GetDataSourceAtIndex( f27_local5, f27_arg0 )
			if not (not f27_local8 or f27_local8.isPlaceHolderPlayer:GetValue( f27_arg0 )) or f27_local4 then
				local f27_local9 = f27_local8.memberIndex:GetValue( f27_arg0 )
				if f27_local4 then
					if f27_arg2 == 1 and not f27_local5 then
						f27_local9 = f27_local5
					else
						f27_local9 = GAMEBATTLES.MAX_LOBBY_CHARACTERS_POSITIONS / 2 + f27_local5
					end
				end
				local f27_local10
				if f27_arg2 == 1 then
					f27_local10 = "s4_default"
				else
					f27_local10 = false
				end
				local f27_local11, f27_local12 = OPERATOR.GetWeaponClassDefaultOperatorSkin( f27_arg0, f27_local10 )
				local f27_local13 = WEAPON.GetWeaponModelNameFromRef( WEAPON.DefaultPrimary, {
					includeStickers = true,
					includeCamos = true,
					includeAttachments = true
				} )
				local f27_local14 = WEAPON.GetWeaponModelNameFromRef( WEAPON.DefaultSecondary, {
					includeStickers = true,
					includeCamos = true,
					includeAttachments = true
				} )
				table.insert( f27_local1, f27_local12 )
				table.insert( f27_local2, f27_local11 )
				table.insert( f27_local3, f27_local13 )
				table.insert( f27_local3, f27_local14 )
				table.insert( f27_local0, {
					memberIndex = f27_local9,
					primaryWeaponModel = f27_local13,
					secondaryWeaponModel = f27_local14,
					bodyModel = f27_local12,
					headModel = f27_local11
				} )
			end
		end
	end
	return f27_local0, f27_local1, f27_local2, f27_local3
end

GAMEBATTLES.RequestClientCharacterData = function ( f26_arg0, f26_arg1, f26_arg2 )
	if f26_arg0 then
		FrontEndScene.RequestBodyModels( f26_arg0 )
	end
	if f26_arg1 then
		FrontEndScene.RequestHeadModels( f26_arg1 )
	end
	if f26_arg2 then
		FrontEndScene.RequestWeaponWorldModels( f26_arg2 )
	end
end

GAMEBATTLES.UpdateClientCharacters = function ( f25_arg0, f25_arg1, f25_arg2, f25_arg3 )
	for f25_local11, f25_local12 in ipairs( f25_arg1 ) do
		for f25_local3, f25_local4 in ipairs( f25_local12 ) do
			local f25_local6 = f25_local4.memberIndex + 1
			local f25_local7 = f25_arg3[f25_local6]
			local f25_local8 = f25_local4.bodyModel
			local f25_local9 = f25_local4.headModel
			local f25_local10 = f25_local4.primaryWeaponModel
			OPERATOR.UpdateClientCharacter( f25_local7, f25_arg0, f25_local8, f25_local9, Lobby.GetWalkAnimationForIndex( f25_local8, f25_local9, f25_local6, f25_local10 ), f25_arg2, f25_local10, f25_local4.secondaryWeaponModel, true, nil )
			ClientCharacter[0x9456E659F16F0A4]( f25_local7, true )
		end
	end
end

GAMEBATTLES.HasJoinedMatch = function ( f24_arg0 )
	local f24_local0 = MLG[0x51346E186BC3F5D]( f24_arg0 )
	local f24_local1
	if f24_local0 ~= GAMEBATTLES.MLG_MATCH_JOIN_STATE.HOST and f24_local0 ~= GAMEBATTLES.MLG_MATCH_JOIN_STATE.CLIENT then
		f24_local1 = false
	else
		f24_local1 = true
	end
	return f24_local1
end

GAMEBATTLES.IsMatchAvailable = function ( f23_arg0 )
	return MLG[0xD38F25930B89003]( f23_arg0 ) == GAMEBATTLES.MLG_SCHEDULE_STATE.AVAILABLE
end

GAMEBATTLES.GetSecondsUntilNoShow = function ( f22_arg0 )
	local f22_local0 = nil
	if f22_arg0 then
		f22_local0 = Engine[0x81B9C166599CE22]( Engine[0x250B0A331992E67]( f22_arg0.matchTime, GAMEBATTLES.GetNoshowTime() ) )
	end
	return f22_local0
end

GAMEBATTLES.IsMatchStarted = function ( f21_arg0 )
	local f21_local0 = false
	if f21_arg0 then
		local f21_local1, f21_local2 = GAMEBATTLES.GetMatchProgressInfo( f21_arg0 )
		f21_local0 = f21_local1
	end
	return f21_local0
end

GAMEBATTLES.IsMatchInProgress = function ( f20_arg0 )
	local f20_local0 = LUI.DataSourceInGlobalModel.new( "frontEnd.mlg.gameInProgress" )
	if f20_local0:GetValue( f20_arg0 ) then
		return true
	else
		return false
	end
end

GAMEBATTLES.IsInNoShowInterval = function ( f19_arg0 )
	local f19_local0 = false
	if f19_arg0 then
		if Engine[0x81B9C166599CE22]( f19_arg0.matchTime ) > 0 or 0 >= GAMEBATTLES.GetSecondsUntilNoShow( f19_arg0 ) then
			f19_local0 = false
		else
			f19_local0 = true
		end
	end
	return f19_local0
end

GAMEBATTLES.IsInIntermissionInterval = function ( f18_arg0 )
	if f18_arg0 then
		local f18_local0, f18_local1 = GAMEBATTLES.GetMatchProgressInfo( f18_arg0 )
		local f18_local2, f18_local3, f18_local4 = GAMEBATTLES.GetMatchVictoryInfo( f18_arg0 )
		local f18_local5 = f18_local2 + f18_local3
		local f18_local6
		if f18_local0 then
			f18_local6 = f18_local0
		elseif f18_local1 or 0 >= f18_local5 then
			f18_local6 = false
		else
			f18_local6 = true
		end
		return f18_local6
	else
		return false
	end
end

GAMEBATTLES.IsWhitelistedForGameBattles = function ( f17_arg0 )
	return MLG[0xD8D9BD1161555F0]( f17_arg0 )
end

GAMEBATTLES.AreAllPlayersReady = function ( f16_arg0 )
	local f16_local0 = LUI.DataSourceInGlobalModel.new( "frontEnd.lobby.areAllPlayersCommitReady" )
	local f16_local1 = f16_local0:GetValue( f16_arg0 )
	local f16_local2
	if not f16_local1 then
		f16_local2 = f16_local1
	else
		f16_local2 = false
	end
	return f16_local2
end

GAMEBATTLES.HandleInputTypeSelected = function ( f15_arg0, f15_arg1, f15_arg2 )
	local f15_local0 = Engine[0x7B17D94988FD5D0]( "gpadEnabled", f15_arg2 )
	local f15_local1
	if f15_local0 then
		f15_local1 = GAMEBATTLES.MLG_INPUT_TYPE_PRESET.GPad
		if not f15_local1 then
		
		else
			if f15_arg1 == GAMEBATTLES.MLG_INPUT_TYPE_PRESET.KBM_GPad then
				return true
			elseif f15_arg1 == f15_local1 then
				Dvar[0x8EA06EEDB58D872]( "#x3869e72a585f0eeac", true )
				Dvar[0x8EA06EEDB58D872]( "#x3f00bcea6b7c1de38", false )
				return true
			elseif OPTIONS.DualInputConnected( f15_arg2 ) then
				Dvar[0x8EA06EEDB58D872]( "#x3869e72a585f0eeac", true )
				Dvar[0x8EA06EEDB58D872]( "#x3f00bcea6b7c1de38", false )
				Engine[0x901AC6AB7A798A3]( f15_arg2, not f15_local0 )
				return true
			else
				LUI.FlowManager.RequestPopupMenu( f15_arg0, "MessagePopup", true, f15_arg2, false, {
					messageText = Engine[0xED84C33EC5F01EA]( "MLG_GAMEBATTLES/POPUP_PLUG_INPUT" )
				} )
				return false
			end
		end
	end
	f15_local1 = GAMEBATTLES.MLG_INPUT_TYPE_PRESET.KBM
end

GAMEBATTLES.LeaveGameBattleMatchLobby = function ( f14_arg0 )
	MLG[0xEC2246B73FE5C0F]( f14_arg0 )
end

GAMEBATTLES.LeaveGameBattlesMenu = function ( f13_arg0 )
	if not LUI.FlowManager.IsInStack( "GameBattlesMatchLobby" ) then
		return 
	else
		local f13_local0 = LUI.FlowManager.GetScopedData( "GameBattlesMatchLobby" )
		f13_local0.matchLobby:LeaveMenu( f13_arg0 )
	end
end

GAMEBATTLES.SetLastSeenResultsMatchId = function ( f12_arg0, f12_arg1 )
	if f12_arg1 then
		local f12_local0 = PlayerData[0x8B73907B55C4D71]( f12_arg0, CoD.StatsGroup.NonGame )
		f12_local0.gamebattlesResultsMatchId:set( f12_arg1 )
	end
end

GAMEBATTLES.GetLastSeenResultsMatchId = function ( f11_arg0 )
	local f11_local0 = PlayerData[0x8B73907B55C4D71]( f11_arg0, CoD.StatsGroup.NonGame )
	f11_local0 = f11_local0.gamebattlesResultsMatchId:get()
	local f11_local1
	if not f11_local0 then
		f11_local1 = f11_local0
	else
		f11_local1 = 0
	end
	return f11_local1
end

GAMEBATTLES.SetLastResultsRound = function ( f10_arg0, f10_arg1 )
	if f10_arg1 then
		local f10_local0 = PlayerData[0x8B73907B55C4D71]( f10_arg0, CoD.StatsGroup.NonGame )
		f10_local0.gamebattlesResultsRound:set( f10_arg1 )
	end
end

GAMEBATTLES.GetLastResultsRound = function ( f9_arg0 )
	local f9_local0 = PlayerData[0x8B73907B55C4D71]( f9_arg0, CoD.StatsGroup.NonGame )
	f9_local0 = f9_local0.gamebattlesResultsRound:get()
	local f9_local1
	if not f9_local0 then
		f9_local1 = f9_local0
	else
		f9_local1 = 0
	end
	return f9_local1
end

GAMEBATTLES.ExecutionDebounce = function ( f6_arg0, f6_arg1, f6_arg2, f6_arg3 )
	if f6_arg0[f6_arg1] then
		f6_arg0[f6_arg1].onComplete = function ()
			
		end
		
		f6_arg0[f6_arg1] = nil
	end
	f6_arg0[f6_arg1] = f6_arg0:Wait( f6_arg2 )
	f6_arg0[f6_arg1].onComplete = function ()
		f6_arg0()
		f6_arg0[f6_arg0] = nil
	end
	
end

GAMEBATTLES.ShowFenceToRefreshSchedule = function ()
	GAMEBATTLES.shouldShowFenceToRefreshSchedule = true
end

GAMEBATTLES.WaitForConditionToExecute = function ( f2_arg0, f2_arg1, f2_arg2, f2_arg3, f2_arg4, f2_arg5, f2_arg6 )
	local f2_local0 = Engine[0x6991337AE950F99]()
	local f2_local1 = function ()
		if f2_arg0 then
			f2_arg0()
		end
	end
	
	local f2_local2 = nil
	local f2_local3 = function ()
		if f2_arg0 < Engine[0x6991337AE950F99]() - f2_arg0 then
			if f2_arg0 then
				f2_arg0()
			end
			f2_arg0()
		elseif f2_arg0() then
			f2_arg0()
			f2_arg0()
		else
			local f3_local0 = f2_arg0:Wait( f2_arg0 )
			f3_local0.onComplete = f2_arg0
		end
	end
	
	f2_local3()
end

GAMEBATTLES.RemoveSubscriptions = function ( f1_arg0 )
	local f1_local0 = Engine[0xEE6F69FEA944B13]()
	local f1_local1 = LUI.DataSourceInGlobalModel.new( "frontEnd.lobby.areAllPlayersCommitReady" )
	local f1_local2 = LUI.DataSourceInGlobalModel.new( "frontEnd.mlg.isLocalCommitReady" )
	f1_local0:UnsubscribeFromModel( f1_local1:GetModel( f1_arg0 ) )
	f1_local0:UnsubscribeFromModel( f1_local2:GetModel( f1_arg0 ) )
	f1_local0:registerEventHandler( "gamebattles_timer_stop", nil )
	f1_local0:registerEventHandler( "input_method_changed", nil )
	f1_local0:registerEventHandler( "gamebattles_invite_accepted", nil )
	f1_local0:registerEventHandler( "update_gamebattles_timer", nil )
	if f1_local0.gamebattlesTimer then
		f1_local0.gamebattlesTimer:closeTree()
		f1_local0.gamebattlesTimer = nil
	end
end

