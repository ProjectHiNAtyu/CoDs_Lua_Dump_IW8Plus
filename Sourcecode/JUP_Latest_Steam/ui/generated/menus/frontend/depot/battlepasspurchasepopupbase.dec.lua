-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:02
module( ..., package.seeall )
local f0_local0 = 4
local f0_local1 = "bp_blades_black_cell"
local f0_local2 = "bp_blades_blackcell_one_blade"
local f0_local3 = "bp_blades_battlepass_blackcell_two_blades"
local f0_local4 = "bp_blades_battlepass_blackcell_three_blades"
local f0_local5 = "bp_blades_battlepass"
local f0_local6 = "bp_blades_battlepass_bundle"
if CONDITIONS.IsSony() then
	local f0_local7 = 25
else
	local f0_local7 = 20
end
local f0_local8 = function ()
	local f40_local0 = LUI.FlowManager.GetMenuByName( "BundlePurchasePopupContainer" )
	return f40_local0.menu
end

local f0_local9 = function ( f39_arg0 )
	f39_arg0._showingPurchasePopup = false
	ACTIONS.LeaveMenu( f0_local0() )
	for f39_local3, f39_local4 in pairs( f39_arg0._purchaseData ) do
		if f39_local4.container then
			f39_local4.container:SetHandleMouseMove( true )
		end
	end
end

local f0_local10 = function ( f38_arg0, f38_arg1, f38_arg2, f38_arg3 )
	f38_arg0._targetItemCost = tonumber( BATTLEPASS.GetItemCost( f38_arg3 ) )
	f38_arg0._battlePassPurchaseRef = f38_arg3
	if f38_arg2.GetPurchaseAction then
		if BATTLEPASS.IsTierSkipGiftActive( f38_arg2._controllerIndex ) then
			f38_arg2.shouldAwardFreeTierGift = true
			f38_arg2.tierGiftBattlePassPurchaseRef = f38_arg3
		end
		local f38_local0 = f38_arg2:GetPurchaseAction( f38_arg3 )
		f38_local0( f38_arg0, f38_arg1 )
	end
end

local f0_local11 = function ( f37_arg0 )
	local f37_local0 = nil
	local f37_local1 = #f37_arg0._purchaseData
	local f37_local2 = f37_arg0._purchaseData[f37_arg0._currentFocusIndex]
	local f37_local3 = f37_arg0._purchaseData[f37_arg0._currentFocusIndex].isFirstParty
	if f37_arg0._seasonToUse < SEASON.GetCurrentSeason() then
		if f37_local3 then
			local f37_local4 = f0_local0
			if not f37_local4 then
				f37_local0 = f37_local4
			end
		end
		f37_local0 = f37_local2.bink
	elseif f37_local3 then
		if f37_local1 == 1 then
			f37_local0 = f0_local0
		elseif f37_local1 == 2 then
			f37_local0 = f0_local0
		else
			f37_local0 = f0_local0
		end
	else
		f37_local0 = f37_local2.bink
	end
	local f37_local4 = Engine[0xFCF332AA8AC9B0F]
	local f37_local5
	if not String.IsNilOrEmpty( f37_local0 ) and not f37_local0 then
		f37_local5 = f37_local0
	else
		f37_local5 = f0_local0
	end
	f37_local4( f37_local5, VideoPlaybackFlags.LOOP )
end

local f0_local12 = function ( f36_arg0, f36_arg1, f36_arg2 )
	if f36_arg0._purchaseData[f36_arg2] then
		ACTIONS.AnimateSequence( f36_arg0, 0x0 .. f36_arg0._purchaseData[f36_arg2].typePrefix .. "of" .. #f36_arg0._purchaseData )
	end
	if f36_arg2 ~= f36_arg0._currentFocusIndex then
		if f36_arg0._currentFocusIndex then
			local f36_local0 = Engine[0xC4146BA76D0F982]
			local f36_local1
			if 0 < f36_arg0._currentFocusIndex - f36_arg2 then
				f36_local1 = SOUND_SETS.battlePass.bpBladeLeft
				if not f36_local1 then
				
				else
					f36_local0( f36_local1 )
				end
			end
			f36_local1 = SOUND_SETS.battlePass.bpBladeRight
		end
		f36_arg0._currentFocusIndex = f36_arg2
		f0_local0( f36_arg0 )
		for f36_local0 = 1, #f36_arg0._purchaseData, 1 do
			local f36_local3 = f36_arg0._purchaseData[f36_local0].blade
			local f36_local4 = f36_local3
			f36_local3 = f36_local3.processEvent
			local f36_local5 = {}
			local f36_local6
			if f36_local0 == f36_arg0._currentFocusIndex then
				f36_local6 = "expand_blade"
			else
				f36_local6 = "collapse_blade"
			end
			f36_local5.name = f36_local6
			f36_local5.controllerIndex = f36_arg1
			f36_local3( f36_local4, f36_local5 )
		end
		if f36_arg0._purchaseData[f36_arg2].isFirstParty then
			f36_local0 = f36_arg0.CodPointsBannerLayout:GetWidget()
			f36_local0:Show( false )
		else
			local f36_local0 = f36_arg0.CodPointsBannerLayout:GetWidget()
			f36_local0:Show( true )
			f36_local0:SetMouseFocusBlocker( false )
		end
	end
end

local f0_local13 = function ( f35_arg0, f35_arg1 )
	local f35_local0 = f35_arg0._currentFocusIndex
	local f35_local1 = f35_arg0._currentFocusIndex
	if CONDITIONS.ButtonLeft( f35_arg0, f35_arg1 ) or CONDITIONS.IsMouseWheelEvent( f35_arg1 ) and CONDITIONS.ButtonUp( f35_arg0, f35_arg1 ) then
		if f35_local1 <= #f35_arg0._purchaseData and 1 < f35_local1 then
			f35_local1 = f35_local1 - 1
		end
	elseif (CONDITIONS.ButtonRight( f35_arg0, f35_arg1 ) or CONDITIONS.IsMouseWheelEvent( f35_arg1 ) and CONDITIONS.ButtonDown( f35_arg0, f35_arg1 )) and 1 <= f35_local1 and f35_local1 < #f35_arg0._purchaseData then
		f35_local1 = f35_local1 + 1
	end
	if f35_local0 ~= f35_local1 then
		f35_arg0:UpdateSelectedBlade( f35_arg1.controller, f35_local1 )
	end
end

local f0_local14 = function ( f34_arg0, f34_arg1, f34_arg2 )
	BATTLEPASS.SendBattlePassLeaveMenuDlogEvent( f34_arg0 )
	if Engine[0x836C8AD984F14F6]() then
		InGameStore.ShowStoreIcon( false )
	end
	if f34_arg0._isFromAAR then
		BATTLEMAP.OpenBattleMap( f34_arg0._controllerIndex )
	end
	if f34_arg1 then
		ACTIONS.LeaveMenu( f34_arg1 )
	else
		ACTIONS.LeaveMenu( f34_arg0 )
	end
end

local f0_local15 = function ( f33_arg0, f33_arg1 )
	local f33_local0 = f0_local0()
	f33_local0:ProcessPurchaseSuccess()
	f33_local0 = DataSources.frontEnd.MP.commerce.premiumCurrency:GetValue( f33_arg0._controllerIndex ) or 0
	if f33_arg0._isOpenedFromStore then
		local f33_local1 = "store"
	else
		local f33_local1 = "battlpass menu"
	end
	local f33_local1
	if f33_arg0._isOpenedFromBundleUpsell then
		local f33_local2 = LUI.FlowManager.GetMenuNameAtIndex( -1 )
		if not f33_local2 then
			f33_local1 = f33_local2
		else
			f33_local1 = ""
		end
	end
	local f33_local2
	if f33_arg0._shouldUseUpsellDlog then
		f33_local2 = "dlog_event_bp_purchase_upsell"
	else
		f33_local2 = "dlog_event_bp_purchase"
	end
	Engine[0x15D98DF5F61904B]( f33_arg0._controllerIndex, f33_local2, {
		tokens_spent = 0,
		tokens_earned = 0,
		last_bp_unlock = nil,
		last_ui_screen = nil,
		blackcell_player_b = STORE.UI.DoesPlayerOwnBlackCellBundleForSeason( f33_arg0._controllerIndex, f33_arg0._seasonToUse ),
		old_cp_balance = f33_arg0._oldCPBalance,
		new_cp_balance = f33_local0,
		purchase_source = f33_local1,
		cp_spent = f33_local0 - f33_arg0._oldCPBalance
	} )
	f0_local0( f33_arg0 )
	local f33_local3 = BATTLEMAP.GetBaseMenuScopedData()
	if f33_local3 then
		f33_local3.state = BATTLEMAP.BattlePassStates.PURCHASE_PASS
		f33_local3.isFromPurchase = true
		f33_local3.previousFocusedSectorIndex = 1
		if f33_arg1.bundle and f33_arg1.bundle[0xC57E42946F6E08C] == BATTLEMAP.GetBlackCellBundleGroup() then
			BATTLEPASS.BuildUnownedBlackCellLootIDs( f33_arg0._controllerIndex, true )
			f33_local3.state = BATTLEMAP.BattlePassStates.PURCHASE_BLACK_CELL
			f33_local3.previousFocusedSectorIndex = BATTLEMAP.BLACK_CELL + 1
			f33_local3.tokensPurchased = f33_arg0._firstPartyTokenAmount
		elseif f33_arg0._bundleSKUBeingPurchased then
			local f33_local4 = f33_arg0._bundleSKUBeingPurchased and BATTLEPASS.GetItemRefBySkuID( f33_arg0._bundleSKUBeingPurchased ) or nil
			if not String.IsNilOrEmpty( f33_local4 ) then
				local f33_local5
				if f33_local4 then
					f33_local5 = BATTLEPASS.GetItemType( f33_local4 )
					if not f33_local5 then
					
					elseif f33_local5 == BATTLEPASS.ITEM_TYPES.BUNDLE then
						f33_local3.tokensPurchased = f33_arg0._bundleTokenAmount
					end
				end
				f33_local5 = nil
			end
		end
	end
	if f33_arg0._isOpenedFromStore then
		BATTLEMAP.RestoreFocusToBattlePassTab( f33_arg0._controllerIndex )
		f0_local0( f33_arg0, nil, true )
	elseif f33_arg0._isOpenedFromBundleUpsell then
		BATTLEMAP.OpenBattleMap( f33_arg0._controllerIndex )
	else
		f0_local0( f33_arg0, nil, true )
	end
end

local f0_local16 = function ( f32_arg0, f32_arg1 )
	
end

local f0_local17 = function ( f30_arg0, f30_arg1 )
	local f30_local0 = f0_local0()
	if f30_arg1.transactionResult == f30_local0.BundlePurchasePopup.PURCHASE_STATUS.CANCELLING then
		f30_local0:ProcessPurchaseCancellation()
	else
		f30_local0:ProcessPurchaseFailure()
	end
	local f30_local1 = f30_arg0:Wait( 3000 )
	f30_local1.onComplete = function ()
		f30_arg0( f30_arg0 )
	end
	
end

local f0_local18 = function ( f29_arg0 )
	f0_local0( f29_arg0 )
end

local f0_local19 = function ( f28_arg0, f28_arg1, f28_arg2 )
	BATTLEPASS.RegisterPurchaseCallbacks( f28_arg0, f28_arg1, {
		[BATTLEPASS.PurchaseCallbackKeys.SUCCESS] = f0_local0,
		[BATTLEPASS.PurchaseCallbackKeys.UPDATED] = f0_local0,
		[BATTLEPASS.PurchaseCallbackKeys.FAILURE] = f0_local0
	} )
	f28_arg0._bundleSKUBeingPurchased = f28_arg2[0x6B65B4278C6C417]
	BATTLEPASS.Purchase( f28_arg1, tonumber( f28_arg2[0x6B65B4278C6C417] ), 1, f28_arg0._seasonToUse )
end

local f0_local20 = function ( f27_arg0, f27_arg1, f27_arg2 )
	local f27_local0
	if tonumber( f27_arg2[0xB0EBE833626682B] ) ~= LOOT.CurrencyIDs.COD_POINTS or tonumber( f27_arg2[0x7384DAB3F540BAA] ) > Commerce[0xFCE51EA6B7B00CC]( f27_arg1, LOOT.CurrencyIDs.COD_POINTS ) then
		f27_local0 = false
	else
		f27_local0 = true
	end
	return f27_local0
end

local f0_local21 = function ( f26_arg0, f26_arg1, f26_arg2 )
	if not f0_local0( f26_arg0, f26_arg1, f26_arg2 ) then
		STORE.EnterStore( f26_arg1, f26_arg0.id, f26_arg0.id, {
			showBalance = true,
			currencyID = LOOT.CurrencyIDs.COD_POINTS,
			currencyAmount = f26_arg2[0x7384DAB3F540BAA]
		}, "PurchaseCODPointsPopup", true )
	else
		f26_arg0._showingPurchasePopup = true
		for f26_local3, f26_local4 in pairs( f26_arg0._purchaseData ) do
			if f26_local4.container then
				f26_local4.container:SetHandleMouseMove( false )
			end
		end
		if not CONDITIONS.IsMenuInStack( "BundlePurchasePopupContainer" ) then
			f26_local0 = nil
			if f26_arg2[0xF4F13D3AC438B16] == BATTLEPASS.ITEM_TYPES.BUNDLE then
				f26_local0 = Engine[0xED84C33EC5F01EA]( 0x8A77C776CD02C3F, f26_arg0._seasonToUse )
			else
				f26_local0 = Engine[0xED84C33EC5F01EA]( 0x6F14D32D0B5B4D2, f26_arg0._seasonToUse )
			end
			LUI.FlowManager.RequestPopupMenu( nil, "BundlePurchasePopupContainer", true, f26_arg1, false, {
				bundleData = f26_arg2,
				bladesMenu = f26_arg0,
				bundleNameOverride = f26_local0,
				imageOverride = RegisterMaterial( "iw9_battlepass_billboard_season_" .. string.format( "%02d", f26_arg0._seasonToUse ) )
			}, nil, false, true )
		end
	end
end

local f0_local22 = function ( f24_arg0, f24_arg1, f24_arg2 )
	if f24_arg2.isFPPurchase then
		if f24_arg0._disableBlackCellPurchaseButton then
			
		else
			
		end
		local f24_local0 = LUI.FlowManager.GetScopedData( f24_arg0 )
		if f24_local0 then
			f24_local0.startedFPFlow = true
			f24_local0.bundleData = f24_arg2.data
		end
		if not CONDITIONS.IsMenuInStack( "BundlePurchasePopupContainer" ) then
			LUI.FlowManager.RequestPopupMenu( nil, "BundlePurchasePopupContainer", true, f24_arg1, false, {
				bladesMenu = f24_arg0
			}, nil, false, true )
			local f24_local1 = f0_local0()
			f24_local1.BundlePurchasePopup.BundleImage:setImage( RegisterMaterial( STORE.Bundles.GetTitleImage( f24_arg2.data ) ) )
			f24_local1.BundlePurchasePopup.BundleName:setText( f24_arg2.title )
			f24_local1.BundlePurchasePopup.BundlePrice:UpdatePrice( f24_arg2.data )
			f24_local1:SetAnimationSequence( 0xDD9D1ED490B9525 )
		end
		STORE.UI.PurchaseBundle( f24_arg1, f24_arg2.data, function ()
			LUI.FlowManager.RequestLeaveMenuByName( "BundlePurchasePopupContainer", true, true, f24_arg0 )
		end )
		if not f24_arg0._purchaseHandlerAdded then
			STORE.Events.AddPurchaseHandler( f24_arg0, f24_arg1, f0_local0, f0_local0 )
			f24_arg0._purchaseHandlerAdded = true
		end
	else
		STORE.Events.RemovePurchaseHandler( f24_arg0 )
		f0_local0( f24_arg0, f24_arg1, f24_arg2.data )
		f24_arg0._purchaseHandlerAdded = false
	end
end

local f0_local23 = function ( f23_arg0, f23_arg1 )
	local f23_local0 = 1
	local f23_local1 = false
	for f23_local5, f23_local6 in ipairs( f23_arg0._purchaseData ) do
		if f23_local6.typePrefix == BATTLEPASS.ITEM_TYPES.BUNDLE then
			f23_local1 = true
		end
	end
	for f23_local5, f23_local6 in ipairs( f23_arg0._purchaseData ) do
		if f23_local6.refFunction then
			if f23_local6.isFirstParty then
				f23_local6.blade:SetupBlade( f23_arg1, f23_arg0, f23_local6.refFunction( f23_arg0, f23_arg1 ), f23_local6.tokenAmount, f23_arg0._isSeasonRecap, f23_arg0._seasonToUse, f23_local1, f0_local0, f23_arg0._disableBlackCellPurchaseButton )
			elseif f23_local6.tokenAmount then
				f23_local6.blade:SetupBlade( f23_arg1, f23_arg0, f23_local6.refFunction(), f23_local6.tokenAmount, f23_arg0._isSeasonRecap, f23_arg0._seasonToUse, f0_local0 )
			else
				f23_local6.blade:SetupBlade( f23_arg1, f23_arg0, f23_local6.refFunction(), f23_arg0._isSeasonRecap, f23_arg0._seasonToUse, f0_local0 )
			end
		end
		f23_local6.blade.index = f23_local5
		f23_local6.blade:SetButtonDisabled( false )
		f23_local6.blade:SetVisible( true )
	end
end

local f0_local24 = function ( f22_arg0 )
	return STORE.UI.GetVaultEditionBundle( f22_arg0 )
end

local f0_local25 = function ( f21_arg0, f21_arg1 )
	return STORE.UI.GetBlackCellBundleForSeason( f21_arg1, f21_arg0._seasonToUse )
end

local f0_local26 = function ( f14_arg0, f14_arg1 )
	f14_arg0.UpdateSelectedBlade = f0_local0
	f14_arg0.ProcessPurchase = f0_local0
	f14_arg0.PurchaseCancelled = f0_local0
	f14_arg0.FinalizePurchase = f0_local0
	f14_arg0._mouseOverIndex = 1
	f14_arg0._oldCPBalance = DataSources.frontEnd.MP.commerce.premiumCurrency:GetValue( f14_arg1 ) or 0
	f14_arg0:SetHandleMouse( true )
	local f14_local0 = BATTLEPASS.IsOwned( f14_arg1, f14_arg0._seasonToUse )
	f14_arg0._purchaseData = {}
	if not f14_local0 then
		table.insert( f14_arg0._purchaseData, 1, {
			typePrefix = "Battlepass",
			name = "battlepass",
			bink = f0_local0,
			blade = f14_arg0.StandardBlade,
			refFunction = BATTLEPASS.GetPurchaseRef,
			container = f14_arg0.StandardBlade,
			seasonToUse = f14_arg0._seasonToUse
		} )
		if Dvar[0x9E5BE3B4BBA4E0E]( 0x39AB6410DA91795 ) then
			f14_arg0._bundleTokenAmount = BATTLEPASS.GetBundleTokenAmount( BATTLEPASS.GetBattlepassIDBundleForRef( BATTLEPASS.GetPurchaseBundleRef() ) )
			table.insert( f14_arg0._purchaseData, 1, {
				typePrefix = "Bundle",
				name = "bundle",
				bink = f0_local0,
				blade = f14_arg0.BundleBlade,
				refFunction = BATTLEPASS.GetPurchaseBundleRef,
				container = f14_arg0.BundleBlade,
				tokenAmount = f14_arg0._bundleTokenAmount,
				seasonToUse = f14_arg0._seasonToUse
			} )
		end
	end
	local f14_local1 = STORE.UI.IsBlackCellBundleAvailable( f14_arg1, f14_arg0._seasonToUse )
	if f14_local1 then
		f14_local1 = not STORE.UI.DoesPlayerOwnBlackCellBundleForSeason( f14_arg1, f14_arg0._seasonToUse )
	end
	if f14_local1 then
		local f14_local2 = f0_local0( f14_arg0, f14_arg1 )
		f14_arg0._firstPartyTokenAmount = BATTLEPASS.GetStoreBundleTokenAmount( f14_local2 )
		table.insert( f14_arg0._purchaseData, 1, {
			typePrefix = "Blackcell",
			isFirstParty = true,
			name = "blackcell",
			blade = f14_arg0.FirstPartyBlade,
			refFunction = f0_local0,
			container = f14_arg0.FirstPartyBlade,
			tokenAmount = f14_arg0._firstPartyTokenAmount,
			seasonToUse = f14_arg0._seasonToUse
		} )
		f14_arg0._disableBlackCellPurchaseButton = not STORE.Bundles.IsAvailable( f14_arg1, f14_local2 )
	end
	if #f14_arg0._purchaseData == 1 and f14_arg0._purchaseData[1].name == "blackcell" then
		f14_arg0.SelectBpTitle:setText( Engine[0xED84C33EC5F01EA]( 0xEE803014F9F2CAC ), 0 )
	end
	if 0 < #f14_arg0._purchaseData then
		f0_local0( f14_arg0, f14_arg1 )
		f14_arg0:UpdateSelectedBlade( f14_arg1, 1 )
	end
	if f14_arg0._buttonToFocus then
		for f14_local5, f14_local6 in ipairs( f14_arg0._purchaseData ) do
			if f14_local6.name == f14_arg0._buttonToFocus then
				f14_arg0:UpdateSelectedBlade( f14_arg1, f14_local5 )
				break
			end
		end
		f14_arg0._buttonToFocus = nil
	end
	f14_arg0:AddGamepadEventCallback( "button_left", function ( f20_arg0, f20_arg1 )
		f14_arg0( f20_arg0, f20_arg1 )
	end )
	f14_arg0:AddGamepadEventCallback( "button_right", function ( f19_arg0, f19_arg1 )
		f14_arg0( f19_arg0, f19_arg1 )
	end )
	f14_arg0:AddGamepadEventCallback( "button_primary", function ( f18_arg0, f18_arg1 )
		if LUI.IsLastInputKeyboardMouse( f18_arg1.controller ) then
			local f18_local0 = f18_arg0._currentFocusIndex
			local f18_local1 = f18_arg0._purchaseData[f18_arg0._currentFocusIndex].container
			if f18_local1:IsPositionInside( f18_arg1.x, f18_arg1.y ) then
				f18_local1._purchaseCallback( f18_arg0, f18_arg1.controller, f18_local1._bundleData )
				Engine[0xC4146BA76D0F982]( CoD.SFX.MouseClick )
			else
				local f18_local2 = f18_arg0._mouseOverIndex
				local f18_local3 = f18_arg0._currentFocusIndex
				Engine[0xC4146BA76D0F982]( REG10 and SOUND_SETS.battlePass.bpBladeLeft or SOUND_SETS.battlePass.bpBladeRight )
				f18_arg0:UpdateSelectedBlade( f18_arg1.controller, f18_arg0._mouseOverIndex )
			end
			return true
		else
			
		end
	end )
	f14_arg0:AddGamepadEventCallback( "button_down", function ( f17_arg0, f17_arg1 )
		f14_arg0( f17_arg0, f17_arg1 )
		return true
	end )
	f14_arg0:AddGamepadEventCallback( "button_up", function ( f16_arg0, f16_arg1 )
		f14_arg0( f16_arg0, f16_arg1 )
		return true
	end )
	if LUI.FlowManager.IsInStack( "BattlePassUpsellPopupMenu" ) then
		LUI.FlowManager.RequestLeaveMenuByName( "BattlePassUpsellPopupMenu" )
	end
	f14_arg0:registerEventHandler( "enable_purchase_button", function ( element, event )
		f14_arg0._disableBlackCellPurchaseButton = not event.enableButton
	end )
end

local f0_local27 = function ( f13_arg0 )
	local f13_local0
	if f13_arg0._storeStatus ~= BATTLEPASS.DATA_STATES.READY or f13_arg0._achievementEngineFenceStatus ~= BATTLEPASS.DATA_STATES.READY then
		f13_local0 = false
	else
		f13_local0 = true
	end
	return f13_local0
end

local f0_local28 = function ( f12_arg0 )
	local f12_local0
	if f12_arg0._storeStatus ~= BATTLEPASS.DATA_STATES.FAILURE and f12_arg0._achievementEngineFenceStatus ~= BATTLEPASS.DATA_STATES.FAILURE then
		f12_local0 = false
	else
		f12_local0 = true
	end
	return f12_local0
end

local f0_local29 = function ( f11_arg0, f11_arg1 )
	if f0_local0( f11_arg0 ) then
		ACTIONS.AnimateSequence( f11_arg0, 0xA81F3741FA4E9E0 )
		f0_local0( f11_arg0, f11_arg1 )
	elseif f0_local0( f11_arg0 ) then
		LUI.FlowManager.RequestErrorPopup( f11_arg1, Engine[0xED84C33EC5F01EA]( 0xD09E09A43DE9B80 ), Engine[0xED84C33EC5F01EA]( 0x2D1270EC2170BC1 ) )
		ACTIONS.LeaveMenu( f11_arg0 )
	end
end

local f0_local30 = function ( f8_arg0, f8_arg1 )
	f8_arg0._storeStatus = BATTLEPASS.DATA_STATES.WAITING
	STORE.Popups.AttachWaitForInitStore( f8_arg0, f8_arg1, {
		useCache = false,
		showEmptyStoreDialog = true,
		onFetchSuccess = function ( f10_arg0 )
			f10_arg0._storeStatus = BATTLEPASS.DATA_STATES.READY
			f8_arg0( f10_arg0, f8_arg0 )
		end,
		onFetchError = function ( f9_arg0, f9_arg1 )
			if Engine[0x836C8AD984F14F6]() then
				InGameStore.ShowEmptyStoreDialog( f8_arg0 )
			end
			f9_arg0._storeStatus = BATTLEPASS.DATA_STATES.FAILURE
			f8_arg0( f9_arg0, f8_arg0 )
		end
	} )
end

local f0_local31 = function ( f6_arg0, f6_arg1 )
	f6_arg0._achievementEngineFenceStatus = BATTLEPASS.DATA_STATES.WAITING
	LUI.DeferredFence.Attach( f6_arg0, f6_arg1, "ACHIEVEMENTENGINE", LUI.DeferredFence.Criticality.LOW, LUI.DeferredFence.BackOutMethod.NONE, function ( f7_arg0, f7_arg1 )
		if f7_arg0._achievementEngineFenceStatus ~= BATTLEPASS.DATA_STATES.WAITING or f7_arg1.fenceState ~= LUI.Fence.FenceObjectState.PASSING and f7_arg1.fenceState ~= LUI.Fence.FenceObjectState.FAILED then
			return 
		elseif f7_arg1.fenceState == LUI.Fence.FenceObjectState.PASSING then
			f7_arg0._achievementEngineFenceStatus = BATTLEPASS.DATA_STATES.READY
		else
			f7_arg0._achievementEngineFenceStatus = BATTLEPASS.DATA_STATES.FAILURE
		end
		f6_arg0( f7_arg0, f6_arg0 )
	end )
end

local f0_local32 = function ( f3_arg0, f3_arg1, f3_arg2 )
	f3_arg0._isOpenedFromStore = f3_arg2.fromStore
	f3_arg0._isOpenedFromMap = f3_arg2.fromMapPopup
	f3_arg0._isFromAAR = f3_arg2.isFromAAR
	local f3_local0 = f3_arg2.fromBundleUpsell
	if f3_local0 then
		f3_local0 = Dvar[0x9E5BE3B4BBA4E0E]( 0x56C85C777240B6E )
	end
	f3_arg0._isOpenedFromBundleUpsell = f3_local0
	f3_arg0._shouldUseUpsellDlog = f3_arg2.fromBundleUpsell
	f3_arg0._isSeasonRecap = f3_arg2.isSeasonRecap and f3_arg2.isSeasonRecap or false
	f3_arg0.FirstPartyBlade:SetVisible( false )
	f3_arg0.FirstPartyBlade:SetButtonDisabled( true )
	f3_arg0.BundleBlade:SetVisible( false )
	f3_arg0.BundleBlade:SetButtonDisabled( true )
	f3_arg0.StandardBlade:SetVisible( false )
	f3_arg0.StandardBlade:SetButtonDisabled( true )
	f3_local0 = f3_arg0.CodPointsBannerLayout:GetWidget()
	f3_local0:Show( false )
	f3_local0 = f3_arg2.seasonToUse
	if not f3_local0 then
		f3_local0 = SEASON.GetCurrentSeason()
	end
	f3_arg0._seasonToUse = f3_local0
	f3_local0 = URI.State
	local f3_local1
	if f3_local0 then
		f3_local1 = f3_local0
	else
		f3_local1 = f3_local0.request
		if f3_local1 then
			f3_local1 = f3_local0.request.query
			if f3_local1 then
				f3_local1 = f3_local0.request.query.buttontofocus
			end
		end
	end
	f3_arg0._buttonToFocus = f3_local1
	Engine[0x3DACD106DDC0D71]()
	f3_arg0._enterTime = CoD.GetUTC()
	f3_arg0._controllerIndex = f3_arg1
	f3_arg0.MenuTitle:SetTitle( " " )
	if f3_arg0.MenuTitle.DisableGlobalWidgets then
		f3_arg0.MenuTitle:DisableGlobalWidgets()
	end
	f3_arg0:AddGamepadEventCallback( "button_secondary", function ( f5_arg0, f5_arg1 )
		if f5_arg0._showingPurchasePopup then
			return 
		else
			f3_arg0( f5_arg0 )
		end
	end )
	f0_local0( f3_arg0, f3_arg1 )
	f0_local0( f3_arg0, f3_arg1 )
	f3_arg0:registerEventHandler( "menu_close", function ()
		Engine[0x3DACD106DDC0D71]()
	end )
end

local f0_local33 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function BattlePassPurchasePopupBase( f1_arg0, f1_arg1 )
	local f1_local0 = LUI
	local f1_local1 = f1_local0.UIVerticalNavigatorMenu.new()
	f1_local1.id = "BattlePassPurchasePopupBase"
	local f1_local2
	if f1_arg1 then
		f1_local2 = f1_arg1
	else
		f1_local2 = f1_arg1.controllerIndex
	end
	f1_local2 = f1_local0.ValidateControllerIndex( f1_local1, f1_local2 )
	local f1_local3 = f1_local1
	f0_local0( f1_local1, f1_local2, f1_arg1 )
	return f1_local1
end

MenuBuilder.registerType( 0xF016BC3E64FA13C, BattlePassPurchasePopupBase )
LockTable( _M )
