-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:04
module( ..., package.seeall )
local f0_local0 = 1250
local f0_local1 = 12
local f0_local2 = "AttachmentIcon"
local f0_local3 = function ( f16_arg0, f16_arg1, f16_arg2, f16_arg3 )
	local f16_local0 = f16_arg1:getParent()
	if f16_local0 ~= f16_arg2 then
		f16_arg2[f16_arg1.id] = f16_arg1
		if f16_local0 then
			f16_local0:RemoveElement( f16_arg1 )
		end
		f16_arg2:addElement( f16_arg1 )
	end
end

local f0_local4 = function ( f15_arg0 )
	if not LUI.StringIsNilOrEmpty( f15_arg0.desc ) and 1 < string.len( f15_arg0.desc ) then
		return f15_arg0.desc
	end
	local f15_local0 = ""
	local f15_local1 = ATTACHMENT.GetBundleByRef( f15_arg0.attachmentRef )
	if f15_local1 and not String.IsNilOrEmpty( f15_local1[0xCC44970C8397929] ) then
		f15_local0 = "\n" .. Engine[0xED84C33EC5F01EA]( f15_local1[0xCC44970C8397929] or 0x0 )
	end
	return f15_local0
end

local f0_local5 = function ( f14_arg0, f14_arg1, f14_arg2 )
	if f14_arg0.AftermarketParts then
		if f14_arg0.AftermarketParts.AftermarketParts then
			local f14_local0, f14_local1, f14_local2, f14_local3 = f14_arg0.AftermarketParts.AftermarketParts:getLocalRect()
			LAYOUT.SetWidth( f14_arg0.AftermarketParts, f14_local0 + LAYOUT.GetTextWidth( f14_arg0.AftermarketParts.AftermarketParts ) )
		end
		ACTIONS.AnimateSequence( f14_arg0, "isAMP" )
	end
end

local f0_local6 = function ( f13_arg0, f13_arg1, f13_arg2, f13_arg3 )
	if f13_arg0.UnlockCriteriaWidget then
		f13_arg0.UnlockCriteriaWidget._weaponRef = f13_arg1._weaponRef
		local f13_local0 = PROGRESSION.GetLootUnlockWeaponLevel( f13_arg3.weaponRef, f13_arg3.lootID )
		local f13_local1 = {
			attachmentRef = f13_arg3.attachmentRef,
			isUnlocked = f13_arg3.isUnlocked,
			overrideWeaponUnlock = 0 and f13_arg3.weaponRef or nil
		}
		local f13_local2
		if 0 < f13_local0 and not f13_local0 then
			f13_local2 = f13_local0
		else
			f13_local2 = nil
		end
		f13_local1.overrideUnlockLevel = f13_local2
		ITEM_UTILS.SetCurrentItemID( f13_arg2, f13_arg3.lootID, f13_local1 )
		if f13_arg3.lootID == nil or f13_arg3.lootID == 0 then
			f13_arg0.UnlockCriteriaWidget.ItemName:setText( f13_arg3.name )
			f13_arg0.UnlockCriteriaWidget.nameForced = true
		else
			f13_arg0.UnlockCriteriaWidget.nameForced = false
		end
	end
	local f13_local0 = f13_arg0._weaponAttributes == nil
	local f13_local1 = f13_arg3.name and Engine[0xEB2A2834B76AEA4]( f13_arg3.name ) or ""
	if f13_arg0.Title then
		f13_arg0.Title:setText( f13_local1 )
	end
	local f13_local2 = f0_local0( f13_arg3 )
	if f13_arg0.Desc then
		f13_arg0.Desc:setText( f13_local2 )
	end
	local f13_local3 = f13_arg3.isUnlocked
	local f13_local4 = f13_arg3.weaponRef
	local f13_local5 = f13_arg3.showFullDetails
	if f13_arg3.category == ATTACHMENT.receiverCategory then
		f13_local4 = WEAPON.GetWeaponRefByRec( f13_arg3.attachmentRef )
	end
	local f13_local6 = ACTIONS.AnimateSequence
	local f13_local7 = f13_arg0
	local f13_local8
	if f13_local5 then
		f13_local8 = "ShowBranding"
	else
		f13_local8 = "HideBranding"
	end
	f13_local6( f13_local7, f13_local8 )
	f13_local6 = f13_arg0.StatsWithDetails
	f13_local7 = f13_local6
	f13_local6 = f13_local6.SetVisible
	if f13_local5 then
		f13_local8 = f13_local5
	else
		f13_local8 = f13_local3
	end
	f13_local6( f13_local7, f13_local8 )
	f13_arg0.WeaponLevel:SetVisible( f13_local5 )
	if f13_arg0.WeaponLevelProgress then
		f13_arg0.WeaponLevelProgress:SetVisible( f13_local5 )
	end
	if not f13_arg0._weaponAttributes then
		f13_arg0._weaponAttributes = f13_arg3.statsDetails.weaponAttributes
		f13_arg1._weaponAttributes = f13_arg3.statsDetails.weaponAttributes
	end
	if not f13_arg0._defaultAttachmentData then
		f13_arg0._defaultAttachmentData = f13_arg3.statsDetails.defaultAttachmentData
		f13_arg1._defaultAttachmentData = f13_arg3.statsDetails.defaultAttachmentData
	end
	if not f13_local5 then
		f13_arg0.BlockedText:setText( "" )
	else
		f13_local6 = f13_arg3.statsDetails
		local f13_local9 = GL_HACK.GetWeaponMPRef( f13_local4 )
		f13_arg0.StatsWithDetails:Setup( f13_arg2, f13_local6.ammoData )
		f13_local7 = f13_local6.weaponAttributes
		if f13_local0 then
			if f13_local7 then
				f13_arg0.StatsWithDetails.WeaponAttributes:Setup( f13_local7, true, false, nil, f13_local6.modifiedAttributeSet, f13_arg1._noAttachmentWeaponAttributes )
			end
		else
			f13_arg0.StatsWithDetails.WeaponAttributes:Update( f13_local7 )
		end
		f13_local8 = f13_arg3.brandingMaterialName
		if not String.IsNilOrEmpty( f13_local8 ) then
			f13_arg0.Branding:setImage( RegisterMaterial( f13_local8 ) )
			f13_arg0.Branding:SetVisible( true )
			if f13_arg0.Manufacturer then
				f13_arg0.Manufacturer:SetVisible( true )
				local f13_local10 = f13_arg0.Manufacturer:GetAnchorsAndPosition()
				f13_arg0.Branding:SetLeft( f13_local10.left + LAYOUT.GetTextWidth( f13_arg0.Manufacturer ) + 6 )
				local f13_local11 = f13_arg0.Branding:GetAnchorsAndPosition()
				f13_arg0.Branding:SetRight( f13_local11.left + GUNSMITH.GetBrandingSmallMaterialWidth( f13_arg3.brandDataRef ) )
			end
		else
			f13_arg0.Branding:SetVisible( false )
			if f13_arg0.Manufacturer then
				f13_arg0.Manufacturer:SetVisible( false )
			end
		end
		f13_arg0.WeaponLevel:setText( Engine[0xEB2A2834B76AEA4]( Engine[0xED84C33EC5F01EA]( 0x137A1B25F4CFC21, PROGRESSION.GetWeaponDisplayLevel( f13_arg2, f13_local4 ), PROGRESSION.GetMaxWeaponDisplayLevel( f13_local4 ) ) ) )
		if f13_arg0.WeaponLevelProgress then
			f13_arg0.WeaponLevelProgress:Setup( f13_arg2, f13_local4 )
		end
		if f13_arg3.isUnlocked and f13_arg3.isBlocked and f13_arg3.blockedBy then
			f13_arg0.BlockedText:setText( f13_arg3.blockedBy )
		else
			f13_arg0.BlockedText:setText( "" )
		end
	end
	f13_arg0.ModifiersList:SetupMods( f13_arg3.modifiersValues )
	f13_arg0.ModifiersList:SetVisible( f13_arg3.showModifiers )
	if not String.IsNilOrEmpty( f13_arg3.reticlePreviewImageName ) and f13_arg1.id == LOADOUT.GetAttachmentSelectMenuRef() and f13_arg0.ReticlePreview then
		ACTIONS.AnimateSequence( f13_arg0, "ShowReticlePreview" )
		f13_arg0.ReticlePreview:SetPreviewImage( f13_arg3.reticlePreviewImageName )
	else
		ACTIONS.AnimateSequence( f13_arg0, "HideReticlePreview" )
	end
	f13_arg0._optionalMessageWidgets = {}
	if hasChallenge and f13_local3 then
		ACTIONS.AnimateSequence( f13_arg0.UnlockRequirements, "Challenge" )
	elseif LAYOUT.GetElementHeight( f13_arg0.UnlockRequirements.UnlockCriteria ) < LAYOUT.GetTextHeight( f13_arg0.UnlockRequirements.UnlockCriteria, f13_arg2 ) then
		ACTIONS.AnimateSequence( f13_arg0.UnlockRequirements, "UnlockTwoLines" )
		f13_arg0.UnlockRequirements.UnlockCriteria:SetMaxVisibleLines( 2 )
	else
		ACTIONS.AnimateSequence( f13_arg0.UnlockRequirements, "Unlock" )
		f13_arg0.UnlockRequirements.UnlockCriteria:SetMaxVisibleLines( 1 )
	end
	if f13_arg0.WinChallengeUnlockItem then
		f13_local7 = Challenge.GetWinChallengeIDFromLootID( f13_arg0._controllerIndex, f13_arg3.lootID )
		if f13_local7 then
			f13_arg0.WinChallengeUnlockItem:SetChallenge( f13_local7 )
		end
	end
	if f13_arg3.showChooseAppearance then
		table.insert( f13_arg0._optionalMessageWidgets, f13_arg0.BlueprintTag )
	end
	if f13_arg3.blockedCategoryWarningText then
		table.insert( f13_arg0._optionalMessageWidgets, f13_arg0.BlockWarning )
		f13_arg0.BlockWarning:setText( f13_arg3.blockedCategoryWarningText )
	end
	if CONDITIONS.IsSplitscreen() and CONDITIONS.InGame() then
		ACTIONS.AnimateSequence( f13_arg0, "Splitscreen" )
	else
		ACTIONS.AnimateSequence( f13_arg0, "StandardLayout" )
		if not f13_local3 then
			ACTIONS.AnimateSequence( f13_arg0, "LockedModifiersLayout" )
		end
		if f13_arg0.LockedText and not f13_local3 then
			if f13_arg3.hasSecondaryChallenge then
				f13_arg0.WeaponChallengeUnlock:SetChallenges( f13_arg3.gunsmithAttach.challengeID, f13_arg1._controllerIndex, false )
				ACTIONS.AnimateSequence( f13_arg0, "ChallengeLockedLayout" )
			else
				f13_local7 = f13_arg3.unlockCriteria
				if not String.IsNilOrEmpty( f13_local7 ) then
					f13_arg0.LockedText:setText( f13_local7 )
				end
				if f13_arg3.hasProgressChallenge then
					f13_arg0.WeaponChallengeUnlock:SetChallenges( f13_arg3.gunsmithAttach.challengeID, f13_arg1._controllerIndex, true )
					ACTIONS.AnimateSequence( f13_arg0, "ChallengeLockedLayout" )
				else
					ACTIONS.AnimateSequence( f13_arg0, "LockedTextLayout" )
				end
			end
		end
	end
	f13_local7 = true
	if not String.IsNilOrEmpty( f13_arg3.primaryProject ) and f13_arg0.ProjectIcon then
		f13_arg0.ProjectIcon:SetVisible( true )
		f13_arg0.ProjectIcon:setImage( RegisterMaterial( f13_arg3.primaryProject ) )
	else
		if f13_arg0.ProjectIcon then
			f13_arg0.ProjectIcon:SetVisible( false )
		end
		f13_local7 = false
	end
	if f13_arg3.isAMP and f13_arg0.UnlockCriteriaWidget then
		f0_local0( f13_arg0, f13_arg1, f13_arg3 )
	end
	if IsLanguageFrench() then
		ACTIONS.AnimateSequence( f13_arg0, "FR" )
	end
	if IsLanguageArabic() then
		ACTIONS.AnimateSequence( f13_arg0, "AR" )
	end
end

local f0_local7 = function ( f12_arg0, f12_arg1, f12_arg2, f12_arg3 )
	f12_arg0.StatsWithDetails.WeaponAttributes:Update( ATTACHMENT.UpdateWeaponAttributesWithAttachmentStats( f12_arg2._weaponAttributes, f12_arg3, f12_arg0._defaultAttachmentData ) )
end

local f0_local8 = function ( f11_arg0, f11_arg1, f11_arg2, f11_arg3 )
	if not IsLanguageArabic() then
		local f11_local0 = LAYOUT.GetTextWidth( f11_arg1, f11_arg0 )
		local f11_local1 = 6
		local f11_local2 = f11_arg2
		local f11_local3 = f11_arg2.SetLeft
		local f11_local4 = f11_arg1:GetAnchorsAndPosition()
		f11_local3( f11_local2, f11_local4.left + f11_local0 + f11_local1 )
		f11_local2 = f11_arg2
		f11_local3 = f11_arg2.SetRight
		f11_local4 = f11_arg2:GetAnchorsAndPosition()
		f11_local3( f11_local2, f11_local4.left + f11_arg2:getWidth() )
		f11_local3 = LAYOUT.GetTextWidth( f11_arg2, f11_arg0 )
		f11_local4 = f11_arg3
		local f11_local5 = f11_arg3.SetLeft
		local f11_local6 = f11_arg2:GetAnchorsAndPosition()
		f11_local5( f11_local4, f11_local6.right + f11_local1 )
		f11_local4 = f11_arg3
		f11_local5 = f11_arg3.SetRight
		f11_local6 = f11_arg3:GetAnchorsAndPosition()
		f11_local5( f11_local4, f11_local6.left + f11_arg3:getWidth() )
	end
end

local f0_local9 = function ( f10_arg0, f10_arg1, f10_arg2 )
	if f10_arg2 and f10_arg2[1] then
		f10_arg0.HTuningLabel:setText( Engine[0xED84C33EC5F01EA]( f10_arg2[1].sliderLabel ) )
		f10_arg0.HTuningUnit:setText( Engine[0xED84C33EC5F01EA]( f10_arg2[1].sliderLabelUnits ) )
		f0_local0( f10_arg1, f10_arg0.HTuningLabel, f10_arg0.HTuningValue, f10_arg0.HTuningUnit )
	end
	if f10_arg2 and f10_arg2[2] then
		f10_arg0.VTuningLabel:setText( Engine[0xED84C33EC5F01EA]( f10_arg2[2].sliderLabel ) )
		f10_arg0.VTuningUnit:setText( Engine[0xED84C33EC5F01EA]( f10_arg2[2].sliderLabelUnits ) )
		f0_local0( f10_arg1, f10_arg0.VTuningLabel, f10_arg0.VTuningValue, f10_arg0.VTuningUnit )
	end
end

local f0_local10 = function ( f9_arg0 )
	return "%.2f"
end

local f0_local11 = function ( f8_arg0, f8_arg1, f8_arg2 )
	f8_arg1:setText( string.format( f8_arg0.GetTuningValueFormatString( f8_arg2 ), f8_arg2 ) )
end

local f0_local12 = function ( f7_arg0, f7_arg1 )
	if f7_arg0.HTuningValue then
		f7_arg0:SetTuningValue( f7_arg0.HTuningValue, f7_arg1 )
	end
end

local f0_local13 = function ( f6_arg0, f6_arg1 )
	if f6_arg0.VTuningValue then
		f6_arg0:SetTuningValue( f6_arg0.VTuningValue, f6_arg1 )
	end
end

local f0_local14 = function ( f5_arg0, f5_arg1 )
	ACTIONS.AnimateSequence( f5_arg0, "TuningLayout" )
	ACTIONS.AnimateSequence( f5_arg0.StatsWithDetails, "TuningLayout" )
	ACTIONS.AnimateSequence( f5_arg0.StatsWithDetails.WeaponAttributes, "TuningLayout" )
end

local f0_local15 = function ( f4_arg0, f4_arg1, f4_arg2 )
	f4_arg0.Setup = f0_local0
	f4_arg0.SetupTuningInfo = f0_local0
	f4_arg0.SetTuningValue = f0_local0
	f4_arg0.SetHTuningValue = f0_local0
	f4_arg0.SetVTuningValue = f0_local0
	f4_arg0.ActivateTuningLayout = f0_local0
	f4_arg0.GetTuningValueFormatString = f0_local0
	f4_arg0.UpdateWeaponAttributes = f0_local0
	if f4_arg0[0xA31296C0C1B6029] then
		f0_local0( f4_arg0, f4_arg0[0xA31296C0C1B6029], f4_arg0[0x81E80226602FFC] )
	end
	if f4_arg0[0x5EAEF67427CA780] then
		f0_local0( f4_arg0, f4_arg0[0x5EAEF67427CA780], f4_arg0[0x81E80226602FFC] )
	end
	if f4_arg0.UnlockCriteriaWidget then
		f4_arg0.UnlockCriteriaWidget:SetItemNameWidth( f0_local0 )
	end
	if CONDITIONS.IsMobileOrMobileSim() then
		f4_arg0.StatsWithDetails = f4_arg0.StatsExpander.StatsWithDetails
	end
	f4_arg0._optionalMessageWidgets = {}
	f4_arg0._prevOptionalMessageWidgets = nil
	local self = LUI.UIVerticalStackedLayout.new()
	local f4_local1 = self
	local f4_local2 = self.SetAnchorsAndPosition
	local f4_local3 = 0
	local f4_local4 = 0
	local f4_local5 = 0
	local f4_local6 = 1
	local f4_local7 = 28
	local f4_local8 = -28
	local f4_local9
	if CONDITIONS.IsGLGunsmithEnabled() then
		f4_local9 = 550
	else
		f4_local9 = 575
	end
	f4_local2( f4_local1, f4_local3, f4_local4, f4_local5, f4_local6, f4_local7, f4_local8, f4_local9, 585 )
	self:SetSpacing( f0_local0 )
	f4_arg0.OptionalMessages = self
	f4_arg0:addElement( f4_arg0.OptionalMessages )
	f4_local2 = MenuBuilder.BuildRegisteredType( "UnlockRequirements", {
		controllerIndex = f4_arg1
	} )
	f4_local2.id = "UnlockRequirements"
	f4_local2:SetAnchorsAndPosition( 0, 0, 0, 1, -28, 0, 0, 130 )
	f4_arg0.UnlockRequirements = f4_local2
	local f4_local10 = LUI.UIText.new()
	f4_local10.id = "ChooseAppearance"
	f4_local10:SetRGB( SWATCHES[0x4DF62CF810D16C2][0xCC44970C8397929] )
	f4_local10:SetAlpha( 0, 0 )
	f4_local10:setText( Engine[0xED84C33EC5F01EA]( 0xFBD051082C0D540 ), 0 )
	f4_local10:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
	f4_local10:SetWordWrap( true )
	f4_local10:SetAlignment( LUI.Alignment.Left )
	f4_local10:SetTintFontIcons( true )
	f4_local10:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 356, 0, 24 )
	f4_arg0.ChooseAppearance = f4_local10
	f4_local1 = nil
	f4_local1 = MenuBuilder.BuildRegisteredType( "BlueprintTag", {
		controllerIndex = f4_arg1
	} )
	f4_local1.id = "BlueprintTag"
	f4_local1:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 300, 0, 30 )
	f4_arg0.BlueprintTag = f4_local1
	f4_arg0.BlueprintTag:SetBlueprintText( Engine[0xED84C33EC5F01EA]( 0x1580DB40A0528B1 ) )
	f4_local3 = LUI.UIText.new()
	f4_local3.id = "BlockWarning"
	f4_local3:SetRGB( SWATCHES[0x1F5A9ABAC207F9D][0x800A3F1B47556E], 0 )
	f4_local3:SetAlpha( 0, 0 )
	f4_local3:setText( Engine[0xED84C33EC5F01EA]( 0xA40C8E247024F5E ), 0 )
	f4_local3:SetFont( FONTS.GetFont( FONTS.PrimaryRegular.File ) )
	f4_local3:SetWordWrap( true )
	f4_local3:SetAlignment( LUI.Alignment.Left )
	f4_local3:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 356, 0, 20 )
	f4_arg0.BlockWarning = f4_local3
end

local f0_local16 = function ( f3_arg0, f3_arg1, f3_arg2 )
	ITEM_UTILS.SetCurrentItemID( f3_arg1, 0 )
end

local f0_local17 = function ( f2_arg0, f2_arg1, f2_arg2 )
	f2_arg0.PostLoadShared = f0_local0
end

function GunsmithDetailsBase( f1_arg0, f1_arg1 )
	local f1_local0 = LUI
	local f1_local1 = f1_local0.UIElement.new()
	f1_local1:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 450, 0, 650 )
	f1_local1.id = "GunsmithDetailsBase"
	local f1_local2
	if f1_arg1 then
		f1_local2 = f1_arg1
	else
		f1_local2 = f1_arg1.controllerIndex
	end
	f1_local2 = f1_local0.ValidateControllerIndex( f1_local1, f1_local2 )
	f0_local0( f1_local1, f1_local2, f1_arg1 )
	f0_local0( f1_local1, f1_local2, f1_arg1 )
	return f1_local1
end

MenuBuilder.registerType( 0xCC60D2739448DEB, GunsmithDetailsBase )
LockTable( _M )
