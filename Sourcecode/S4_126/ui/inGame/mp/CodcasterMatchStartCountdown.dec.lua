-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:43
module( ..., package.seeall )
require( "ui.widgets.GenericRadialProgressBar" )
local f0_local0 = {
	{
		name = "Visible",
		refresh = true,
		refreshAnimations = true,
		visibilityEnum = LUI.Visibility.Visible,
		animations = {
			nil,
			"Countdown"
		},
		stateHandler = function ( f7_arg0, f7_arg1, f7_arg2 )
			f7_arg0.CountdownText:setText( tostring(), math.max( 0, f7_arg2.dataSources.countdownTime:GetValue( f7_arg1 ) ) )
			f7_arg0.Progress:SetProgress( 100 )
			f7_arg0.Progress:UpdateFill( 0, CODCASTER.MATCH_START_COUNTDOWN_ANIM_PROGRESS )
		end,
		condition = function ( f6_arg0, f6_arg1, f6_arg2 )
			local f6_local0 = f6_arg2.dataSources
			local f6_local1 = f6_local0.countdownTime:GetValue( f6_arg1 )
			local f6_local2 = f6_local0.isServerTimeout:GetValue( f6_arg1 )
			local f6_local3
			if f6_local1 > CODCASTER.SHOW_START_MATCH_COUNTDOWN_AT or 0 >= f6_local1 then
				f6_local3 = false
			else
				f6_local3 = true
			end
			local f6_local4
			if f6_local3 then
				f6_local4 = f6_local3
			else
				f6_local4 = not f6_local2
			end
			return f6_local4
		end
	},
	{
		name = "Hidden",
		visibilityEnum = LUI.Visibility.Hidden,
		condition = function ( f5_arg0, f5_arg1, f5_arg2 )
			return true
		end
	}
}
local f0_local1 = function ( f4_arg0, f4_arg1, f4_arg2 )
	CODCASTER.SetupVisualStateHandler( f4_arg0, f4_arg1, f0_local0, {
		dataSources = {
			countdownTime = DataSources.inGame.MP.match.countdownTime,
			isServerTimeout = DataSources.inGame.MP.match.isServerTimeout
		}
	} )
end

function CodcasterMatchStartCountdown( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 500 * _1080p, 0, 200 * _1080p )
	self.id = "CodcasterMatchStartCountdown"
	self._animationSets = self._animationSets or {}
	self._sequences = self._sequences or {}
	self._sequenceLengths = self._sequenceLengths or {}
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	f1_local1 = LUI.ValidateControllerIndex( self, f1_local1 )
	local f1_local2 = self
	local Backing = nil
	
	Backing = LUI.UIImage.new()
	Backing.id = "Backing"
	Backing:setImage( RegisterMaterial( "v_esports_ui_elmnt_codcaster_status_effect_backing" ), 0 )
	Backing:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -58, _1080p * 58, _1080p * -40, _1080p * 75 )
	self:addElement( Backing )
	self.Backing = Backing
	
	local Progress = nil
	
	Progress = MenuBuilder.BuildRegisteredType( "GenericRadialProgressBar", {
		Progress_maskMaterial = "dpad_circle_mask",
		controllerIndex = f1_local1
	} )
	Progress.id = "Progress"
	Progress.Backer:setImage( RegisterMaterial( "v_esports_ui_elmnt_codcaster_status_effect_fill" ), 0 )
	Progress.Progress:SetRGBFromInt( 16777215, 0 )
	Progress.Progress:setImage( RegisterMaterial( "v_esports_ui_elmnt_codcaster_status_effect_segment" ), 0 )
	Progress:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -58, _1080p * 58, _1080p * -40, _1080p * 75 )
	self:addElement( Progress )
	self.Progress = Progress
	
	local CountdownText = nil
	
	CountdownText = LUI.UIText.new()
	CountdownText.id = "CountdownText"
	CountdownText:setText( "", 0 )
	CountdownText:SetFont( FONTS.GetFont( FONTS.Abolition.File ) )
	CountdownText:SetFontSize( 80 * _PT )
	CountdownText:SetMinFontSize( 60 * _PT )
	CountdownText:SetWordWrap( false )
	CountdownText:SetAlignment( LUI.Alignment.Center )
	CountdownText:SetVerticalAlignment( LUI.Alignment.Center )
	CountdownText:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -97, _1080p * 97, _1080p * -79, _1080p * 115 )
	self:addElement( CountdownText )
	self.CountdownText = CountdownText
	
	local StartingTextBacking = nil
	
	StartingTextBacking = LUI.UIImage.new()
	StartingTextBacking.id = "StartingTextBacking"
	StartingTextBacking:SetRGBFromInt( 0, 0 )
	StartingTextBacking:SetAlpha( 0.4, 0 )
	StartingTextBacking:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -69, _1080p * 69, _1080p * -85, _1080p * -49 )
	self:addElement( StartingTextBacking )
	self.StartingTextBacking = StartingTextBacking
	
	local StartingText = nil
	
	StartingText = LUI.UIText.new()
	StartingText.id = "StartingText"
	StartingText:setText( Engine[0xED84C33EC5F01EA]( "CODCASTER/STARTING_MATCH_TEXT" ), 0 )
	StartingText:setCaseStyle( LUI.CaseStyle.Uppercase )
	StartingText:SetFont( FONTS.GetFont( FONTS.Abolition.File ) )
	StartingText:SetFontSize( 26 * _PT )
	StartingText:SetMinFontSize( 24 * _PT )
	StartingText:SetWordWrap( false )
	StartingText:SetAlignment( LUI.Alignment.Center )
	StartingText:SetVerticalAlignment( LUI.Alignment.Center )
	StartingText:SetAnchorsAndPosition( 0.5, 0.5, 0.5, 0.5, _1080p * -65, _1080p * 65, _1080p * -85, _1080p * -49 )
	self:addElement( StartingText )
	self.StartingText = StartingText
	
	self._sequences.DefaultSequence = function ()
		
	end
	
	self._sequenceLengths.DefaultSequence = 0
	local f1_local8 = nil
	CountdownText:RegisterAnimationSequence( "Countdown", {
		{
			value = 1,
			duration = 0,
			property = TWEEN_PROPERTY.Scale
		},
		{
			value = 0,
			duration = 210,
			property = TWEEN_PROPERTY.Scale
		}
	} )
	self._sequences.Countdown = function ()
		menu:AnimateSequence( "Countdown" )
	end
	
	self._sequenceLengths.Countdown = 210
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "CodcasterMatchStartCountdown", CodcasterMatchStartCountdown )
LockTable( _M )
