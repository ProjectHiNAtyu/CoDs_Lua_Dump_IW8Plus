-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 12-11-2025 23:01
LUI.AspectRatioFadeFrameLayer = LUI.Class( LUI.UIElement )
LUI.AspectRatioFadeFrameLayer.DEFAULT_FADESCREEN_PERCENTAGE = 1.1
LUI.AspectRatioFadeFrameLayer.init = function ( f9_arg0, f9_arg1 )
	LUI.UIElement.init( f9_arg0 )
	f9_arg0.id = "AspectRatioFadeFrameLayer"
	local f9_local0
	if not f9_arg1 then
		f9_local0 = f9_arg1
	else
		f9_local0 = Engine[0x45B054C920178E9]()
	end
	f9_arg0._controllerIndex = f9_local0
	f9_arg0:addEventHandler( "onVideoChange", function ( f10_arg0, f10_arg1 )
		if CoD.CurrentAspectRatioCompare() == LUI.COMPARE.higher and f10_arg0:ShouldBeVisible() then
			local f10_local0 = f10_arg0:GetCurrentScreenFadePercent()
			if f10_arg0.aspectRatioFade then
				f10_arg0.aspectRatioFade:setCustomScreenPercent( f10_local0 )
			else
				f10_arg0.aspectRatioFade = MenuBuilder.BuildRegisteredType( "AspectRatioFadeFrame", {
					controllerIndex = f10_arg0._controllerIndex,
					customScreenPercent = f10_local0
				} )
				f10_arg0:addElement( f10_arg0.aspectRatioFade )
			end
		elseif f10_arg0.aspectRatioFade then
			f10_arg0.aspectRatioFade:closeTree()
			f10_arg0.aspectRatioFade = nil
		end
	end )
end

LUI.AspectRatioFadeFrameLayer.Setup = function ( f8_arg0 )
	local f8_local0 = LUI.AspectRatioFadeFrameLayer.GetInstance( f8_arg0._controllerIndex )
	if f8_local0 == nil then
		return 
	end
	f8_local0._currentMenu = f8_arg0
	if f8_local0.aspectRatioFade then
		f8_local0.aspectRatioFade:setCustomScreenPercent( f8_local0:GetCurrentScreenFadePercent() )
	end
end

LUI.AspectRatioFadeFrameLayer.UpdateAspectRatioFadeFrame = function ( f7_arg0 )
	if LUI.AspectRatioFadeFrameLayer.GetInstance( f7_arg0._controllerIndex ) == nil then
		return 
	end
	local f7_local0 = f7_arg0.fadeFrameCustomScreenPercent
	if not f7_local0 then
		f7_local0 = LUI.AspectRatioFadeFrameLayer.DEFAULT_FADESCREEN_PERCENTAGE
	end
	f7_arg0.fadeFrameCustomScreenPercent = f7_local0
	if f7_arg0:getParent() then
		LUI.AspectRatioFadeFrameLayer.Setup( f7_arg0 )
	else
		f7_arg0:addEventHandler( "menu_create", LUI.AspectRatioFadeFrameLayer.Setup )
	end
end

LUI.AspectRatioFadeFrameLayer.GetInstance = function ( f6_arg0 )
	if Engine[0xFB1B6E36ABE59B8]() or CONDITIONS.IsEdgeToEdgeDisplay() then
		return 
	end
	local f6_local0 = nil
	if f6_arg0 ~= nil then
		f6_local0 = LUI.UIRoot.GetRootForControllerIndex( f6_arg0 )
	else
		f6_local0 = Engine[0xEE6F69FEA944B13]()
	end
	assert( f6_local0 )
	local f6_local1 = f6_local0.fadeFrameLayer
	assert( f6_local1 )
	return f6_local1
end

LUI.AspectRatioFadeFrameLayer.ShouldBeVisible = function ( f5_arg0 )
	return not f5_arg0:IsFadeFrameDisabledForMenu()
end

LUI.AspectRatioFadeFrameLayer.GetCurrentScreenFadePercent = function ( f4_arg0 )
	local f4_local0 = f4_arg0._currentMenu
	local f4_local1
	if f4_local0 then
		f4_local1 = f4_local0.fadeFrameCustomScreenPercent
		if not f4_local1 then
		
		else
			return f4_local1
		end
	end
	f4_local1 = LUI.AspectRatioFadeFrameLayer.DEFAULT_FADESCREEN_PERCENTAGE
end

LUI.AspectRatioFadeFrameLayer.IsFadeFrameDisabledForMenu = function ( f3_arg0 )
	local f3_local0 = CONDITIONS.InGame()
	local f3_local1 = f3_arg0._currentMenu
	if f3_local1 then
		if CONDITIONS.InGame() then
			f3_local0 = f3_local1.fadeFrameDisabled ~= false
			local f3_local2 = Engine[0xEE6F69FEA944B13]()
			local f3_local3 = f3_local2.flowManager
			if f3_local3 then
				f3_local3 = f3_local2.flowManager:IsStackEmpty()
			end
			local f3_local4 = f3_local2.loadingScreenManager
			if f3_local4 then
				f3_local4 = f3_local2.loadingScreenManager:GetLoadingScreen()
			end
			if f3_local3 and not f3_local4 then
				f3_local0 = true
			elseif f3_local3 and f3_local4 then
				f3_local0 = false
			end
		else
			f3_local0 = f3_local1.fadeFrameDisabled
		end
	end
	if f3_arg0.cdniIsInInstallStage then
		f3_local0 = true
	end
	return f3_local0
end

LUI.AspectRatioFadeFrameLayer.InitLayer = function ( f2_arg0 )
	f2_arg0.cdniIsInInstallStage = CDNI[0xE5E728E3949799D]()
	if CoD.CurrentAspectRatioCompare() == LUI.COMPARE.higher then
		if not f2_arg0.aspectRatioFade then
			f2_arg0.aspectRatioFade = MenuBuilder.BuildRegisteredType( "AspectRatioFadeFrame", {
				controllerIndex = f2_arg0._controllerIndex,
				customScreenPercent = f2_arg0:GetCurrentScreenFadePercent()
			} )
			f2_arg0:addElement( f2_arg0.aspectRatioFade )
		end
		f2_arg0.aspectRatioFade:SetAlpha( 1 )
	end
end

LUI.AspectRatioFadeFrameLayer.ClearLayer = function ( f1_arg0, f1_arg1 )
	if f1_arg0.aspectRatioFade then
		f1_arg0.aspectRatioFade:SetAlpha( 0 )
	end
end

