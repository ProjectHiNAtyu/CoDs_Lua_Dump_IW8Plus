-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:51
BR_ARMORY_KIOSK = BR_ARMORY_KIOSK or {}
BR_ARMORY_KIOSK.OPEN_MENU_VALUE = {
	FREE = 2,
	STACKED_DISCOUNT = 4,
	BLACK_MARKET = 8,
	REGULAR = 1,
	PERK_DISCOUNT = 3,
	RESET = 0
}
BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE = {
	ALREADY_RESPAWNING = 14,
	NO_TOKEN = 11,
	ONE_ACTIVE_PER_TEAM = 23,
	FU_IN_USE = 6,
	NO_MORE_RESPAWN = 9,
	SUCCESS = 1,
	LOC_SEL = 16,
	GENERIC_IN_USE = 28,
	DUPE_VU = 20,
	VEHICLE_MAX_HEALTH = 21,
	VEHICLE_ONE_PURCHASE = 22,
	NO_RES_TARGET = 12,
	EQUIP_NO_ROOM = 7,
	DUPE_FU = 5,
	JUGG_CANT_BUY = 24,
	FORCE_EXIT = 2,
	ALREADY_RESPAWNED = 15,
	ALREADY_PURCHASED = 26,
	AMMO_NO_ROOM = 8,
	MAX_TROPHY_AMMO = 19,
	BAD_RES_TARGET = 13,
	NOT_OWNED = 25,
	ONE_PURCHASE = 17,
	RESET = 0,
	INVALID_LOC = 18,
	NO_MONEY = 3,
	DUPE_KS = 4,
	JUGG_TEAM_MAX = 27,
	DUPE_TOKEN = 10
}
BR_ARMORY_KIOSK.GULAG_CLOSED_VAL = 0
BR_ARMORY_KIOSK.PURCHASE_RESPONSE_DATA = {
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.RESET] = {},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.SUCCESS] = {},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.FORCE_EXIT] = {},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.NO_MONEY] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_NO_MONEY"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.DUPE_KS] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_DUPE_KS"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.DUPE_FU] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_DUPE_FU"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.FU_IN_USE] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_FU_IN_USE"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.EQUIP_NO_ROOM] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_EQUIP_NO_ROOM"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.AMMO_NO_ROOM] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_AMMO_NO_ROOM"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.NO_MORE_RESPAWN] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_NO_MORE_RESPAWN"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.DUPE_TOKEN] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_DUPE_TOKEN"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.NO_TOKEN] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_NO_TOKEN"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.NO_RES_TARGET] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_NO_REZ_TARGET"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.BAD_RES_TARGET] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_BAD_REZ_TARGET"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.ALREADY_RESPAWNING] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_ALREADY_RESPAWNING"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.ALREADY_RESPAWNED] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_ALREADY_RESPAWNED"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.LOC_SEL] = {},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.ONE_PURCHASE] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_ONE_PURCHASE"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.INVALID_LOC] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_INVALID_LOC"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.MAX_TROPHY_AMMO] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_MAX_TROPHY_AMMO"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.DUPE_VU] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_DUPE_VU"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.VEHICLE_MAX_HEALTH] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_VEHICLE_MAX_HEALTH"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.VEHICLE_ONE_PURCHASE] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_VEHICLE_ONE_PURCHASE"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.ONE_ACTIVE_PER_TEAM] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_ONE_ACTIVE_PER_TEAM"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.JUGG_CANT_BUY] = {
		errorString = "MP_BR_INGAME/PLUNDER_BOX_ERROR_JUGG_CANT_BUY"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.NOT_OWNED] = {
		errorString = "BR_PAYLOAD/NO_CHECKPOINTS_OWNED"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.ALREADY_PURCHASED] = {
		errorString = "BR_PAYLOAD/ALREADY_PURCHASED"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.JUGG_TEAM_MAX] = {
		errorString = "KILLSTREAKS/JUGG_TEAM_MAX_REACHED"
	},
	[BR_ARMORY_KIOSK.PURCHASE_RESPONSE_VALUE.GENERIC_IN_USE] = {
		errorString = "MP_BR_INGAME/GENERIC_IN_USE"
	}
}
BR_ARMORY_KIOSK.sounds = {
	MENU_CLOSE = "ui_buy_crate_close_window",
	MENU_OPEN = "ui_buy_crate_open_window",
	PURCHASE_DENY = "ui_select_purchase_deny",
	PURCHASE_CONFIRM = "ui_select_purchase_confirm"
}
BR_ARMORY_KIOSK.tabData = {
	{
		menuName = "BRKillstreakPurchase",
		tabNum = 1,
		name = Engine.CBBHFCGDIC( "LUA_MENU/TITLE_ESSENTIALS" )
	},
	{
		menuName = "BRKillstreakPurchase",
		tabNum = 2,
		isRedeployTab = true,
		name = Engine.CBBHFCGDIC( "LUA_MENU/REDEPLOY" )
	},
	{
		menuName = "BRKillstreakPurchase",
		tabNum = 3,
		name = Engine.CBBHFCGDIC( "LUA_MENU/FIELD_UPGRADES" )
	},
	{
		menuName = "BRKillstreakPurchase",
		tabNum = 4,
		name = Engine.CBBHFCGDIC( "LUA_MENU/KILLSTREAKS" )
	},
	{
		menuName = "BRKillstreakPurchase",
		tabNum = 5,
		name = Engine.CBBHFCGDIC( "LUA_MENU/VEHICLES" )
	}
}
BR_ARMORY_KIOSK.itemTypes = {
	SPECIAL = "special",
	KILLSTREAK = "killstreak",
	TOKEN = "respawn_token",
	VEHICLE = "vehicle",
	REVIVE = "teamrevive",
	FIELD_UPGRADE = "fieldupgrade"
}
BR_ARMORY_KIOSK.DEFAULT_TRANSLATED_DATA_TABLE = {
	file = nil,
	ref = CSV.brKioskPurchases.cols.ref,
	name = CSV.brKioskPurchases.cols.title,
	desc = CSV.brKioskPurchases.cols.desc,
	icon = CSV.brKioskPurchases.cols.icon
}
BR_ARMORY_KIOSK.itemData = {
	[BR_ARMORY_KIOSK.itemTypes.KILLSTREAK] = {
		purchaseNotify = "br_item_purchase",
		translatedDataTable = {
			file = CSV.streaks.file,
			ref = CSV.streaks.cols.ref,
			name = CSV.streaks.cols.name,
			desc = CSV.streaks.cols.desc,
			icon = CSV.streaks.cols.icon
		}
	},
	[BR_ARMORY_KIOSK.itemTypes.FIELD_UPGRADE] = {
		purchaseNotify = "br_item_purchase",
		translatedDataTable = {
			file = CSV.supers.file,
			ref = CSV.supers.cols.ref,
			name = CSV.supers.cols.uiName,
			desc = CSV.supers.cols.uiDesc,
			icon = CSV.supers.cols.uiImageSmall
		}
	},
	[BR_ARMORY_KIOSK.itemTypes.SPECIAL] = {
		purchaseNotify = "br_item_purchase",
		translatedDataTable = BR_ARMORY_KIOSK.DEFAULT_TRANSLATED_DATA_TABLE
	},
	[BR_ARMORY_KIOSK.itemTypes.REVIVE] = {
		purchaseNotify = "br_team_revive",
		translatedDataTable = BR_ARMORY_KIOSK.DEFAULT_TRANSLATED_DATA_TABLE
	},
	[BR_ARMORY_KIOSK.itemTypes.VEHICLE] = {
		purchaseNotify = "br_item_purchase",
		translatedDataTable = {
			file = CSV.vehicles.file,
			ref = CSV.vehicles.cols.scrRef,
			name = CSV.vehicles.cols.name,
			desc = CSV.vehicles.cols.desc,
			icon = CSV.vehicles.cols.image
		}
	}
}
BR_ARMORY_KIOSK.filePathType = {
	PAYLOADBUYSTATION = 4,
	BLACKMARKET = 8,
	ZOMCONCOMP_NOCIRCLE = 3,
	TRUCKWARBUYSTATION = 0,
	ZOMCONCOMP = 2,
	TERBUYSTATION = 6,
	PAYLOADUPGRADE = 5,
	FFPRICECHANGE = 7,
	TRUCKUPGRADE = 1
}
BR_ARMORY_KIOSK.filePath = {
	[BR_ARMORY_KIOSK.filePathType.TRUCKWARBUYSTATION] = "mp/brKioskPurchases_truckwarbuystation.csv",
	[BR_ARMORY_KIOSK.filePathType.TRUCKUPGRADE] = "mp/brKioskPurchases_truckupgrade.csv",
	[BR_ARMORY_KIOSK.filePathType.ZOMCONCOMP] = "mp/brKioskPurchases_zomconcomp.csv",
	[BR_ARMORY_KIOSK.filePathType.ZOMCONCOMP_NOCIRCLE] = "mp/brKioskPurchases_zomconcomp_nocircle.csv",
	[BR_ARMORY_KIOSK.filePathType.PAYLOADBUYSTATION] = "mp/brKioskPurchases_payloadbuystation.csv",
	[BR_ARMORY_KIOSK.filePathType.PAYLOADUPGRADE] = "mp/brKioskPurchases_payloadupgrade.csv",
	[BR_ARMORY_KIOSK.filePathType.TERBUYSTATION] = "mp/brkioskpurchases_terbuystation.csv",
	[BR_ARMORY_KIOSK.filePathType.FFPRICECHANGE] = "mp/brkioskpurchases_ffPriceChange.csv",
	[BR_ARMORY_KIOSK.filePathType.BLACKMARKET] = "mp/brkioskpurchases_blackmarket.csv"
}
BR_ARMORY_KIOSK.ignoreTabs = {
	[BR_ARMORY_KIOSK.filePathType.TRUCKWARBUYSTATION] = false,
	[BR_ARMORY_KIOSK.filePathType.TRUCKUPGRADE] = false,
	[BR_ARMORY_KIOSK.filePathType.ZOMCONCOMP] = false,
	[BR_ARMORY_KIOSK.filePathType.ZOMCONCOMP_NOCIRCLE] = true,
	[BR_ARMORY_KIOSK.filePathType.PAYLOADBUYSTATION] = false,
	[BR_ARMORY_KIOSK.filePathType.PAYLOADUPGRADE] = false,
	[BR_ARMORY_KIOSK.filePathType.TERBUYSTATION] = false,
	[BR_ARMORY_KIOSK.filePathType.FFPRICECHANGE] = false,
	[BR_ARMORY_KIOSK.filePathType.BLACKMARKET] = false
}
BR_ARMORY_KIOSK.OVERRIDE_FILE_COLS_REF = 0
BR_ARMORY_KIOSK.DEFAULT_KIOSK_ITEMS_FILENAME = "mp/brKioskPurchases.csv"
BR_ARMORY_KIOSK.FREE_DISCOUNT_AMOUNT = 100
BR_ARMORY_KIOSK.TAB_NUM_TO_USE_FOR_EQUIPMENT_ITEMS = 1
BR_ARMORY_KIOSK.TAB_NUM_TO_USE_FOR_SQUAD_ITEMS = 2
BR_ARMORY_KIOSK.ShouldIgnoreAllTabs = function ( f19_arg0 )
	local f19_local0 = DataSources.inGame.player.BRData.purchaseFileOverride:GetValue( f19_arg0 )
	if f19_local0 ~= -1 then
		return BR_ARMORY_KIOSK.ignoreTabs[f19_local0]
	else
		return false
	end
end

local f0_local0 = function ( f18_arg0, f18_arg1 )
	if f18_arg0 then
		for f18_local3, f18_local4 in pairs( f18_arg0 ) do
			if f18_local4 == f18_arg1 then
				return true
			end
		end
	end
	return false
end

MenuBuilder.registerType( "BRKioskPurchaseErrorPopup", function ( f17_arg0, f17_arg1 )
	local f17_local0 = MenuBuilder.BuildRegisteredType( "PopupOK", f17_arg1 )
	f17_local0.id = "BRKioskPurchaseErrorPopup"
	return f17_local0
end )
BR_ARMORY_KIOSK.InitKioskDvarData = function ()
	BR_ARMORY_KIOSK.disabledItemRefs = MP.ParseCommaStringDvar( "br_kiosk_disabled_items" )
	BR_ARMORY_KIOSK.removeItemRefs = MP.ParseCommaStringDvar( "br_kiosk_removed_items" )
	BR_ARMORY_KIOSK.ignoredTabNums = MP.ParseCommaStringDvar( "br_kiosk_ignored_tab_nums" )
	BR_ARMORY_KIOSK.salesDiscount = Dvar.CFHDGABACF( "br_kiosk_sales_discount" )
	if BR_ARMORY_KIOSK.salesDiscount == nil then
		BR_ARMORY_KIOSK.salesDiscount = 0
	end
	BR_ARMORY_KIOSK.salesDiscountItemRefs = MP.ParseCommaStringDvar( "br_kiosk_sales_discount_items" )
	if BR_ARMORY_KIOSK.ignoredTabNums then
		local f16_local0 = {}
		for f16_local4, f16_local5 in pairs( BR_ARMORY_KIOSK.ignoredTabNums ) do
			f16_local0[tonumber( f16_local5 )] = true
		end
		BR_ARMORY_KIOSK.ignoredTabNums = f16_local0
	end
	local f16_local0 = Dvar.DHEEJCCJBH( "br_kiosk_items_filename" )
	local f16_local1
	if f16_local0 then
		f16_local1 = f16_local0
	else
		f16_local1 = f16_local0 ~= ""
	end
	local f16_local2 = CSV.brKioskPurchases
	local f16_local3
	if not f16_local1 then
		f16_local3 = BR_ARMORY_KIOSK.DEFAULT_KIOSK_ITEMS_FILENAME
		if not f16_local3 then
		
		else
			f16_local2.file = f16_local3
			BR_ARMORY_KIOSK.DEFAULT_TRANSLATED_DATA_TABLE.file = CSV.brKioskPurchases.file
		end
	end
	f16_local3 = f16_local0
end

BR_ARMORY_KIOSK.GetPlayerHasRedeployToken = function ( f15_arg0 )
	local f15_local0
	if not CONDITIONS.IsBRInflation() and not CONDITIONS.IsBRBodycountGameType() then
		f15_local0 = not CONDITIONS.IsBRMendotaGameType()
	else
		f15_local0 = false
	end
	if f15_local0 then
		return DataSources.inGame.player.BRData.PlayerStatusHasRespawnToken:GetValue( f15_arg0 ) == true
	else
		return false
	end
end

BR_ARMORY_KIOSK.GetTabItemsForTabNum = function ( f13_arg0, f13_arg1, f13_arg2 )
	local f13_local0 = {}
	local f13_local1 = CSV.brKioskPurchases
	local f13_local2 = f13_local1.file
	local f13_local3 = DataSources.inGame.player.BRData.purchaseFileOverride:GetValue( f13_arg0 )
	local f13_local4 = f13_local3 ~= -1
	if f13_local4 then
		f13_local2 = BR_ARMORY_KIOSK.filePath[f13_local3]
	end
	local f13_local5 = StringTable.BFHCAIIDA( f13_local2 )
	local f13_local6 = DataSources.inGame.player.BRData.squadIndex:GetValue( f13_arg0 )
	if f13_local6 then
		if f13_local6 <= 1 then
			f13_local6 = ""
		end
	else
		f13_local6 = ""
	end
	local f13_local7 = DataSources.inGame.player.BRData["plunderAmount" .. f13_local6].GetValue( f13_local7["plunderAmount" .. f13_local6], f13_arg0 )
	local f13_local8 = DataSources.inGame.player.BRData.gulag.state:GetValue( f13_arg0 )
	local f13_local9
	if f13_local8 then
		f13_local9 = f13_local8
	else
		f13_local9 = f13_local8 == BR_ARMORY_KIOSK.GULAG_CLOSED_VAL
	end
	local f13_local10 = Dvar.IBEGCHEFE( "scr_br_respawn_token_gulag" )
	local f13_local11 = false
	if f13_local10 ~= nil then
		f13_local11 = f13_local10
	end
	local f13_local12 = Game.BFEEGCHICA( f13_arg0, "ui_armored_truck_status" )
	if not f13_local12 then
		f13_local12 = 0
	end
	local f13_local13 = BitwiseOperators.band( f13_local12, 1 )
	local f13_local14 = BitwiseOperators.band( BitwiseOperators.rshift( f13_local12, 1 ), 1 )
	local f13_local15 = BitwiseOperators.band( BitwiseOperators.rshift( f13_local12, 2 ), 1 )
	local f13_local16 = BitwiseOperators.band( BitwiseOperators.rshift( f13_local12, 3 ), 1 )
	local f13_local17 = BitwiseOperators.band( BitwiseOperators.rshift( f13_local12, 4 ), 1 )
	local f13_local18 = BitwiseOperators.band( BitwiseOperators.rshift( f13_local12, 5 ), 1 )
	local f13_local19 = Dvar.IBEGCHEFE( "scr_br_respawn_token" )
	local f13_local20 = false
	if redeploymentDvar ~= nil then
		f13_local20 = f13_local19
	end
	if not f13_local20 then
		if f13_local11 then
			f13_local20 = f13_local11
		else
			f13_local20 = f13_local9
		end
	end
	for f13_local21 = 0, f13_local5 - 1, 1 do
		local f13_local24 = {}
		local f13_local25 = nil
		if f13_local4 then
			f13_local25 = StringTable.CBGJCDIHCE( f13_local2, f13_local21, BR_ARMORY_KIOSK.OVERRIDE_FILE_COLS_REF )
		else
			f13_local25 = StringTable.CBGJCDIHCE( f13_local1.file, f13_local21, f13_local1.cols.ref )
		end
		local f13_local26 = StringTable.BJJBBCJGEJ( f13_local1.file, f13_local1.cols.ref, f13_local25 )
		local f13_local27 = false
		if not f13_local4 then
			f13_local27 = StringTable.CBGJCDIHCE( f13_local1.file, f13_local26, f13_local1.cols.overrideFileOnly ) == "1"
		end
		if (f13_local25 == "contribute_heroes" or f13_local25 == "contribute_villains" or f13_local25 == "br_defusekit" or f13_local25 == "br_bomb") and not CONDITIONS.AreHvvKioskItemsEnabled() then
			f13_local27 = true
		end
		local f13_local28 = StringTable.CBGJCDIHCE( f13_local1.file, f13_local26, f13_local1.cols.tabNum )
		if not f13_local27 and f13_local28 and f13_local28 ~= "" and tonumber( f13_local28 ) == f13_arg1 then
			f13_local24.index = StringTable.CBGJCDIHCE( f13_local1.file, f13_local26, f13_local1.cols.index )
			f13_local24.ref = StringTable.CBGJCDIHCE( f13_local1.file, f13_local26, f13_local1.cols.ref )
			f13_local24.slotLabel = StringTable.CBGJCDIHCE( f13_local1.file, f13_local26, f13_local1.cols.slotLabel )
			f13_local24.cost = tonumber( StringTable.CBGJCDIHCE( f13_local1.file, f13_local26, f13_local1.cols.cost ) )
			if f13_local24.ref == "supply_drop" then
				local f13_local29 = Dvar.CFHDGABACF( "scr_br_kiosk_supdropcost" )
				if f13_local29 then
					f13_local24.cost = f13_local29
				end
			end
			if f13_local24.ref == "specialist_perk" then
				local f13_local29 = Dvar.CFHDGABACF( "scr_br_kiosk_specialistcost" )
				if f13_local29 then
					f13_local24.cost = f13_local29
				end
			end
			f13_local24.displayCost = f13_local24.cost * BRLOOT.PLUNDER_QUANTITY_SCALING_FACTOR
			f13_local24.controllerIndex = f13_arg0
			if Dvar.CFHDGABACF( "br_use_circle_percent_discount" ) == 1 and f13_local24.ref == "supply_drop" then
				local f13_local29 = DataSources.inGame.player.BRData.brCircleNum:GetValue( f13_arg0 ) - 1
				if 1 <= f13_local29 then
					local f13_local30 = tonumber( StringTable.CBGJCDIHCE( f13_local1.file, f13_local26, f13_local1.cols.circleDiscount ) )
					if f13_local30 then
						f13_local30 = f13_local30 * f13_local29
						f13_local24.cost = BR_ARMORY_KIOSK.ApplySalesDiscount( f13_local24.cost, f13_local30 )
						if f13_local24.discount then
							f13_local24.discount = f13_local24.discount + f13_local30
						else
							f13_local24.discount = f13_local30
							f13_local24.originalDisplayCost = f13_local24.displayCost
						end
						f13_local24.discount = LUI.clamp( f13_local24.discount, 0, 100 )
						f13_local24.displayCost = f13_local24.cost * BRLOOT.PLUNDER_QUANTITY_SCALING_FACTOR
					end
				end
			end
			f13_local24.canAfford = f13_local24.cost <= f13_local7
			f13_local24.purchaseAllowed = true
			local f13_local29 = "ui_br_kiosk_ban_" .. f13_local25
			if Engine.CJAECDGCFH( f13_local29 ) then
				local f13_local30 = 0
				if f13_local29 == "ui_br_kiosk_ban_supply_drop" then
					f13_local30 = DataSources.inGame.player.BRData.kioskData.banSupplyDrop:GetValue( f13_arg0 )
				else
					local f13_local31 = Game.BFEEGCHICA( f13_arg0, f13_local29 )
					if not f13_local31 then
						f13_local30 = f13_local31
					else
						f13_local30 = 0
					end
				end
				f13_local24.purchaseAllowed = f13_local30 == 0
			end
			if f13_local24.ref == "vehicle_repair" then
				local f13_local30 = Dvar.CFHDGABACF( "scr_br_kiosk_truckwar_repair_cost" )
				if f13_local30 then
					f13_local24.cost = f13_local30
				end
				if f13_local18 == 1 then
					f13_local24.purchaseAllowed = false
				end
			end
			if f13_local24.ref == "vehicle_replace" then
				local f13_local30 = Dvar.CFHDGABACF( "scr_br_kiosk_truckwar_replace_cost" )
				if f13_local30 then
					f13_local24.cost = f13_local30
				end
			end
			if f13_local24.ref == "vehicle_upgrade_armor" then
				local f13_local30 = Dvar.CFHDGABACF( "scr_br_kiosk_truckwar_armor_cost" )
				if f13_local30 then
					f13_local24.cost = f13_local30
				end
				if f13_local14 == 1 then
					f13_local24.purchaseAllowed = false
				end
			end
			if f13_local24.ref == "vehicle_refill_trophy" then
				local f13_local30 = Dvar.CFHDGABACF( "scr_br_kiosk_truckwar_refill_trophy_cost" )
				if f13_local30 then
					f13_local24.cost = f13_local30
				end
				if f13_local15 == 1 then
					if f13_local17 == 1 then
						f13_local24.purchaseAllowed = false
					end
				else
					f13_local24.purchaseAllowed = false
				end
			end
			if f13_local24.ref == "vehicle_upgrade_trophy" then
				local f13_local30 = Dvar.CFHDGABACF( "scr_br_kiosk_truckwar_trophy_cost" )
				if f13_local30 then
					f13_local24.cost = f13_local30
				end
				if f13_local15 == 1 then
					f13_local24.purchaseAllowed = false
				end
			end
			if f13_local24.ref == "vehicle_upgrade_uav" then
				local f13_local30 = Dvar.CFHDGABACF( "scr_br_kiosk_truckwar_uav_cost" )
				if f13_local30 then
					f13_local24.cost = f13_local30
				end
				if f13_local13 == 1 then
					f13_local24.purchaseAllowed = false
				end
			end
			if f13_local24.ref == "vehicle_upgrade_barrel" then
				local f13_local30 = Dvar.CFHDGABACF( "scr_br_kiosk_truckwar_barrel_cost" )
				if f13_local30 then
					f13_local24.cost = f13_local30
				end
				if f13_local16 == 1 then
					f13_local24.purchaseAllowed = false
				end
			end
			local f13_local30 = BR_ARMORY_KIOSK.GetBestDiscount( f13_arg0, f13_local24.index, f13_local24.ref, f13_arg2, f13_local1, f13_local26 )
			if 0 < f13_local30 then
				f13_local24.discount = f13_local30
				f13_local24.originalCost = f13_local24.cost
				f13_local24.cost = BR_ARMORY_KIOSK.ApplySalesDiscount( f13_local24.originalCost, f13_local24.discount )
				f13_local24.originalDisplayCost = f13_local24.displayCost
				local f13_local31
				if f13_local24.discount == BR_ARMORY_KIOSK.FREE_DISCOUNT_AMOUNT then
					f13_local31 = "MP_BR_INGAME/KIOSK_FREE_LABEL"
				else
					f13_local31 = f13_local24.cost * BRLOOT.PLUNDER_QUANTITY_SCALING_FACTOR
				end
				f13_local24.displayCost = f13_local31
				f13_local24.canAfford = f13_local24.cost <= f13_local7
			end
			if f13_local20 and (f13_local24.ref == BR_ARMORY_KIOSK.itemTypes.TOKEN or f13_local24.ref == BR_ARMORY_KIOSK.itemTypes.REVIVE) then
				f13_local24.purchaseAllowed = false
			end
			if f13_local24.purchaseAllowed then
				f13_local24.purchaseAllowed = not f0_local0( BR_ARMORY_KIOSK.disabledItemRefs, f13_local24.ref )
			end
			local f13_local31 = false
			f13_local31 = f0_local0( BR_ARMORY_KIOSK.removeItemRefs, f13_local24.ref )
			local f13_local32 = StringTable.CBGJCDIHCE( f13_local1.file, f13_local26, f13_local1.cols.type )
			f13_local24.itemType = f13_local32
			local f13_local33 = BR_ARMORY_KIOSK.itemData[f13_local32]
			if f13_local33 then
				if f13_local33.purchaseNotify then
					f13_local24.purchaseNotify = f13_local33.purchaseNotify
				end
				if f13_local33.translatedDataTable then
					f13_local24.desc = StringTable.DIFCHIGDFB( f13_local33.translatedDataTable.file, f13_local33.translatedDataTable.ref, f13_local24.ref, f13_local33.translatedDataTable.desc )
					if f13_local32 == BR_ARMORY_KIOSK.itemTypes.REVIVE and not f13_local31 then
						local f13_local34 = ""
						for f13_local35 = 0, MP.BRTeamMaxSize - 1, 1 do
							local f13_local38 = DataSources.inGame.player.BRData.teamList:GetDataSourceAtIndex( f13_local35, f13_arg0 )
							if f13_local38 and f13_local38.gamerTag and f13_local38.clientNum then
								local f13_local39 = f13_local38.gamerTag:GetValue( f13_arg0 )
								if not f13_local39 then
									f13_local39 = f13_local34
								end
								if f13_local39 and f13_local39 ~= f13_local34 then
									local f13_local40 = LUI.DeepCopy( f13_local24 )
									f13_local40.name = f13_local39
									f13_local40.teamListIndex = f13_local35
									f13_local40.isEliminated = false
									f13_local40.clientNum = f13_local38.clientNum:GetValue( f13_arg0 )
									f13_local40.isZombie = f13_local38.isZombie:GetValue( f13_arg0 )
									if f13_local40.clientNum then
										f13_local40.squadIndex = Game.DEFDIHBJEH( f13_local40.clientNum )
										f13_local40.isEliminated = MP.BRIsSquadMemberEliminated( f13_arg0, f13_local40.squadIndex )
									end
									f13_local40.isInGulag = f13_local38.isInGulag:GetValue( f13_arg0 )
									f13_local40.isDead = f13_local38.isDead:GetValue( f13_arg0 )
									local f13_local41
									if not f13_local40.isEliminated or not f13_local40.isDead then
										f13_local41 = f13_local40.isZombie
										if f13_local41 then
										
										else
											if not f13_local41 then
												f13_local40.purchaseAllowed = false
											end
											table.insert( f13_local0, f13_local40 )
										end
									end
									f13_local41 = not f13_local40.isInGulag
								end
							end
						end
					else
						f13_local24.name = StringTable.DIFCHIGDFB( f13_local33.translatedDataTable.file, f13_local33.translatedDataTable.ref, f13_local24.ref, f13_local33.translatedDataTable.name )
						f13_local24.icon = StringTable.DIFCHIGDFB( f13_local33.translatedDataTable.file, f13_local33.translatedDataTable.ref, f13_local24.ref, f13_local33.translatedDataTable.icon )
					end
				end
			end
			if f13_local32 ~= BR_ARMORY_KIOSK.itemTypes.REVIVE and not f13_local31 then
				table.insert( f13_local0, f13_local24 )
			end
		end
	end
	if f13_arg1 == BR_ARMORY_KIOSK.TAB_NUM_TO_USE_FOR_SQUAD_ITEMS then
		table.sort( f13_local0, function ( f14_arg0, f14_arg1 )
			local f14_local0 = f14_arg0.isDead
			if f14_local0 then
				f14_local0 = not f14_arg1.IsDead
			end
			return f14_local0
		end )
	end
	return f13_local0
end

BR_ARMORY_KIOSK.GetRefFromUniqueId = function ( f12_arg0 )
	local f12_local0 = CSV.brKioskPurchases
	for f12_local1 = 0, rowCount - 1, 1 do
		if StringTable.CBGJCDIHCE( f12_local0.file, f12_local1, f12_local0.cols.index ) == f12_arg0 then
			return StringTable.CBGJCDIHCE( f12_local0.file, f12_local1, f12_local0.cols.ref )
		end
	end
	return ""
end

BR_ARMORY_KIOSK.GetBestDiscount = function ( f11_arg0, f11_arg1, f11_arg2, f11_arg3, f11_arg4, f11_arg5 )
	local f11_local0 = BR_ARMORY_KIOSK.GetScriptedDiscount( f11_arg0, f11_arg1, f11_arg2 )
	local f11_local1 = 0
	if f11_arg3.isFireSale then
		f11_local1 = tonumber( StringTable.CBGJCDIHCE( f11_arg4.file, f11_arg5, f11_arg4.cols.fireSaleDiscount ) )
	end
	local f11_local2 = 0
	if f11_arg3.isPerkDiscount then
		f11_local2 = tonumber( StringTable.CBGJCDIHCE( f11_arg4.file, f11_arg5, f11_arg4.cols.perkDiscount ) )
	end
	local f11_local3 = 0
	if 0 < BR_ARMORY_KIOSK.salesDiscount and (BR_ARMORY_KIOSK.salesDiscountItemRefs == nil or f0_local0( BR_ARMORY_KIOSK.salesDiscountItemRefs, f11_arg2 )) then
		f11_local3 = BR_ARMORY_KIOSK.salesDiscount
	end
	return BR_ARMORY_KIOSK.GetBestDiscountFromArray( {
		f11_local1,
		f11_local2,
		f11_local3,
		f11_local0
	} )
end

BR_ARMORY_KIOSK.GetBestDiscountFromArray = function ( f10_arg0 )
	local f10_local0 = 0
	for f10_local4, f10_local5 in ipairs( f10_arg0 ) do
		if f10_local0 < f10_local5 then
			f10_local0 = f10_local5
		end
	end
	return f10_local0
end

BR_ARMORY_KIOSK.GetScriptedDiscount = function ( f9_arg0, f9_arg1, f9_arg2 )
	return BR_ARMORY_KIOSK.GetBestDiscountFromArray( {
		BR_ARMORY_KIOSK.GetHvvItemDiscount( f9_arg0, f9_arg1, f9_arg2 ),
		BR_ARMORY_KIOSK.GetHvvBundleDiscount( f9_arg0, f9_arg1 ),
		[1] = BR_ARMORY_KIOSK.GetHvvLastCallBundleDiscount( f9_arg0, f9_arg1 )
	} )
end

BR_ARMORY_KIOSK.GetHvvItemDiscount = function ( f8_arg0, f8_arg1, f8_arg2 )
	if not CONDITIONS.AreHvvDiscountsEnabled() then
		return 0
	elseif tonumber( f8_arg1 ) ~= DataSources.inGame.player.BRData.kioskData.scriptedDiscountIdA:GetValue( f8_arg0 ) then
		return 0
	end
	local f8_local0 = CSV.brHvvDiscounts
	local f8_local1 = StringTable.BFHCAIIDA( f8_local0.file )
	for f8_local2 = 0, f8_local1 - 1, 1 do
		if StringTable.CBGJCDIHCE( f8_local0.file, f8_local2, f8_local0.cols.ref ) == f8_arg2 then
			return tonumber( StringTable.CBGJCDIHCE( f8_local0.file, f8_local2, f8_local0.cols.discount ) )
		end
	end
	return 0
end

BR_ARMORY_KIOSK.GetHvvBundleDiscount = function ( f7_arg0, f7_arg1 )
	local f7_local0 = 50
	if tonumber( f7_arg1 ) ~= DataSources.inGame.player.BRData.kioskData.scriptedDiscountIdB:GetValue( f7_arg0 ) then
		return 0
	else
		return f7_local0
	end
end

BR_ARMORY_KIOSK.GetHvvLastCallBundleDiscount = function ( f6_arg0, f6_arg1 )
	local f6_local0 = 75
	if tonumber( f6_arg1 ) ~= DataSources.inGame.player.BRData.kioskData.scriptedDiscountIdC:GetValue( f6_arg0 ) then
		return 0
	else
		return f6_local0
	end
end

BR_ARMORY_KIOSK.GetTeamReviveCost = function ()
	local f5_local0 = CSV.brKioskPurchases
	if BR_ARMORY_KIOSK.cachedTeamReviveCost == nil then
		BR_ARMORY_KIOSK.cachedTeamReviveCost = tonumber( StringTable.DIFCHIGDFB( f5_local0.file, f5_local0.cols.ref, BR_ARMORY_KIOSK.itemTypes.REVIVE, f5_local0.cols.cost ) )
	end
	local f5_local1 = BR_ARMORY_KIOSK.cachedTeamReviveCost
	local f5_local2 = 0
	if 0 < BR_ARMORY_KIOSK.salesDiscount and (BR_ARMORY_KIOSK.salesDiscountItemRefs == nil or f0_local0( BR_ARMORY_KIOSK.salesDiscountItemRefs, BR_ARMORY_KIOSK.itemTypes.REVIVE )) then
		f5_local2 = BR_ARMORY_KIOSK.salesDiscount
	end
	if 0 < f5_local2 then
		f5_local1 = BR_ARMORY_KIOSK.ApplySalesDiscount( f5_local1, f5_local2 )
	end
	return f5_local1
end

BR_ARMORY_KIOSK.ApplySalesDiscount = function ( f4_arg0, f4_arg1 )
	if f4_arg1 == 0 then
		return f4_arg0
	else
		return math.ceil( f4_arg0 * (100 - f4_arg1) * 0.01 - 0.5 )
	end
end

BR_ARMORY_KIOSK.RequestCloseMenu = function ()
	LUI.FlowManager.RequestCloseAllMenus()
	LUI.FlowManager.RequestResumeMovement()
end

BR_ARMORY_KIOSK.TryCloseMenuOnPurchase = function ( f2_arg0 )
	if CONDITIONS.ShouldBuystationCloseMenuOnPurchase( f2_arg0 ) then
		BR_ARMORY_KIOSK.RequestCloseMenu()
	end
end

BR_ARMORY_KIOSK.PurchaseFunc = function ( f1_arg0 )
	if f1_arg0.itemType == BR_ARMORY_KIOSK.itemTypes.REVIVE and f1_arg0.squadIndex then
		Engine.EBHIFJCGBH( f1_arg0.purchaseNotify, f1_arg0.squadIndex )
	else
		Engine.EBHIFJCGBH( f1_arg0.purchaseNotify, f1_arg0.index )
	end
end

