-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 13-07-2025 21:51
module( ..., package.seeall )
local f0_local0 = 1
local f0_local1 = 4
local f0_local2 = 3
local f0_local3 = 1
local f0_local4 = "specialty_null"
local f0_local5 = nil
if CONDITIONS.IsBRGameType( self ) then
	f0_local5 = {
		nil,
		"ui_score_streak_cost",
		"ui_score_streak_cost",
		"ui_score_streak_cost"
	}
else
	f0_local5 = {
		nil,
		"ui_score_streak_three_cost",
		"ui_score_streak_two_cost",
		"ui_score_streak_cost"
	}
end
local f0_local6 = 4
local f0_local7 = function ()
	local f24_local0 = f0_local0
	if CONDITIONS.IsBRGameType( self ) then
		f24_local0 = f0_local0
	end
	return f24_local0
end

local f0_local8 = function ( f23_arg0 )
	return f0_local0() - f23_arg0
end

local f0_local9 = function ( f14_arg0 )
	local f14_local0 = {}
	local f14_local1 = {}
	local f14_local2 = DataSources.inGame.MP.streakList.streakIndex1
	local f14_local3, f14_local4 = nil
	if not CONDITIONS.IsBRGameType( self ) then
		f14_local3 = DataSources.inGame.MP.streakList.streakIndex2
		f14_local4 = DataSources.inGame.MP.streakList.streakIndex3
	end
	local f14_local5 = function ( f21_arg0, f21_arg1 )
		return function ( f22_arg0 )
			local f22_local0 = Game.BFEEGCHICA( f22_arg0, "ui_score_streak" )
			local f22_local1 = f21_arg0:GetCountValue( f22_arg0 )
			local f22_local2 = f21_arg0( f21_arg0 )
			local f22_local3 = 0
			if 0 < f22_local1 and 0 <= f22_local2 then
				local f22_local4 = f21_arg0:GetDataSourceAtIndex( f22_local2, f22_arg0 )
				f22_local3 = f22_local4.cost:GetValue( f22_arg0 )
			end
			return f22_local3 - f22_local0
		end
		
	end
	
	local f14_local6 = function ( f20_arg0 )
		local f20_local0 = 0
		if f14_arg0:GetValue( f20_arg0 ) ~= 0 then
			f20_local0 = f20_local0 + 1
		end
		if not CONDITIONS.IsBRGameType( self ) then
			if f14_arg0:GetValue( f20_arg0 ) ~= 0 then
				f20_local0 = f20_local0 + 1
			end
			if f14_arg0:GetValue( f20_arg0 ) ~= 0 then
				f20_local0 = f20_local0 + 1
			end
		end
		return f20_local0
	end
	
	local f14_local7 = function ( f18_arg0 )
		return function ( f19_arg0, f19_arg1 )
			return f19_arg0 == f18_arg0
		end
		
	end
	
	local f14_local8 = function ( f16_arg0 )
		return function ( f17_arg0 )
			local f17_local0 = f16_arg0:GetCountValue( f17_arg0 )
			local f17_local1 = f16_arg0( f16_arg0 )
			local f17_local2 = 0
			local f17_local3 = 0
			if 0 < f17_local0 and 0 <= f17_local1 then
				local f17_local4 = f16_arg0:GetDataSourceAtIndex( f17_local1, f17_arg0 )
				f17_local2 = f17_local4.cost:GetValue( f17_arg0 )
				if f17_local1 + 1 < f16_arg0() then
					local f17_local5 = f16_arg0:GetDataSourceAtIndex( f17_local1 + 1, f17_arg0 )
					f17_local5 = f17_local5.cost:GetValue( f17_arg0 )
					if not f17_local5 then
						f17_local3 = f17_local5
					else
						f17_local3 = 0
					end
				end
				f17_local3 = 0
			end
			return f17_local2 - f17_local3
		end
		
	end
	
	local f14_local9 = LUI.DataSourceInControllerModel.new( "cg.player.streaks" )
	local f14_local10 = nil
	if CONDITIONS.IsBRGameType( self ) then
		f14_local10 = {
			f14_local2
		}
	else
		f14_local10 = {
			f14_local2,
			f14_local3,
			f14_local4
		}
	end
	local f14_local11 = LUI.AggregateDataSource.new( f14_local9, f14_local10, "count", f14_local6 )
	local f14_local12 = LUI.DataSourceFromOmnvar.new( "ui_score_streak_selected_slot" )
	f14_local0 = LUI.DataSourceFromList.new( f14_local11 )
	f14_local0.MakeDataSourceAtIndex = function ( f15_arg0, f15_arg1, f15_arg2 )
		f15_arg1 = f15_arg1 + 1
		local f15_local0 = f14_arg0[f15_arg1]
		local f15_local1 = LUI.DataSourceFromOmnvar.new( "ui_score_streak" )
		local f15_local2 = DataSources.inGame.MP.streakList["streakIndex" .. f15_arg1]
		local f15_local3 = DataSources.inGame.MP.streakList["streakName" .. f15_arg1]
		local f15_local4 = DataSources.inGame.MP.streakList["streakIcon" .. f15_arg1]
		local f15_local5 = LUI.DataSourceFromOmnvar.new( f15_local0 )
		return {
			index = f15_local2,
			isActive = LUI.DataSourceFromOmnvar.new( "ui_score_streak_available_" .. f15_arg1 ),
			isSlotSelected = f14_arg0:Filter( "isSlotSelected_" .. f15_arg1, f14_arg0( f15_arg1 ) ),
			name = f15_local3,
			icon = f15_local4,
			currentScore = f15_local1,
			cost = f15_local5,
			relativeCost = LUI.AggregateDataSource.new( f15_local1, {
				f15_local5,
				f14_arg0
			}, "relativeCost_" .. f15_arg1, f14_arg0( f15_arg1 ) ),
			remainingPoints = LUI.AggregateDataSource.new( f15_local1, {
				f15_local5,
				f15_local1,
				f14_arg0
			}, "remainingPoints_" .. f15_arg1, f14_arg0( f15_arg1, f15_local1 ) ),
			isSpecialist = DataSources.inGame.MP.streakList.isSpecialist,
			isUsingScorestreaks = LUI.DataSourceInControllerModel.new( "cg.player.streaks." .. f15_arg1 .. ".isUsingScorestreaks", PERK.IsPointmanActive( f15_arg2 ) ),
			visiblePointsIndex = LUI.DataSourceInControllerModel.new( "cg.player.streaks.visiblePointsIndex", 0 )
		}
	end
	
	f14_local1.isSlotSelected = f14_local12:Filter( "isSlotSelected_0", f14_local7( 0 ) )
	f14_local1.isActive = LUI.DataSourceFromOmnvar.new( "ui_score_streak_available_0" )
	f14_local1.index = DataSources.inGame.MP.streakList.streakIndex0
	f14_local1.name = DataSources.inGame.MP.streakList.streakName0
	f14_local1.icon = DataSources.inGame.MP.streakList.streakIcon0
	f14_local1.remainingPoints = f14_local9
	f14_local1.relativeCost = f14_local9
	f14_local1.currentScore = f14_local9
	f14_local1.isUsingScorestreaks = f14_local9
	f14_local1.visiblePointsIndex = f14_local9
	f14_local1.isSpecialist = DataSources.inGame.MP.streakList.isSpecialist
	return f14_local11:GetValue( f14_arg0 ), f14_local0, f14_local1
end

local f0_local10 = function ( f12_arg0, f12_arg1 )
	return function ()
		for f13_local8, f13_local9 in ipairs( f12_arg0 ) do
			f13_local9.navigation = {}
			local f13_local4 = f13_local8 % #f12_arg0
			for f13_local7 = 1, #f12_arg0, 1 do
				local f13_local3 = f13_local7
				f13_local4 = f13_local4 % #f12_arg0 + 1
				local f13_local5 = f12_arg0[f13_local4]:GetDataSource( f12_arg0 )
				local f13_local6
				if f13_local5 then
					f13_local6 = f13_local5.isActive:GetValue( f12_arg0 )
					if not f13_local6 then
					
					elseif f13_local6 == 1 then
						f13_local9.navigation.up = f12_arg0[f13_local4]
					end
				end
				f13_local6 = 0
			end
		end
	end
	
end

local f0_local11 = function ( f10_arg0 )
	return function ()
		for f11_local3, f11_local4 in ipairs( f10_arg0 ) do
			f11_local4:processEvent( {
				name = "lose_focus"
			} )
		end
	end
	
end

local f0_local12 = function ( f8_arg0 )
	return function ( f9_arg0 )
		f8_arg0._selectedStreak = f9_arg0.streakIndex
	end
	
end

local f0_local13 = function ( f7_arg0, f7_arg1, f7_arg2 )
	local f7_local0 = f7_arg0:GetDataSource( f7_arg1 )
	local f7_local1
	if f7_local0 then
		f7_local1 = f7_local0.icon:GetValue( f7_arg1 )
		if not f7_local1 then
		
		else
			local f7_local2
			if f7_local1 == nil or f7_local1 == "" or f7_local1 == f0_local0 then
				f7_local2 = false
			else
				f7_local2 = true
			end
			if f7_local2 and not DataSources.inGame.MP.isLastStand:GetValue( f7_arg1 ) then
				if f7_arg2 then
					f7_arg0:SetAlpha( 1 )
				end
			elseif f7_arg2 then
				f7_arg0:SetAlpha( 0 )
			end
		end
	end
	f7_local1 = nil
end

function PostLoadFunc( f2_arg0, f2_arg1, f2_arg2 )
	assert( f2_arg0.Streak1 )
	assert( f2_arg0.GimmeStreak )
	local f2_local0 = CONDITIONS.IsBRGameType( f2_arg0 )
	f2_arg0.Streak1.streakIndex = 1
	if not f2_local0 then
		assert( f2_arg0.Streak2 )
		assert( f2_arg0.Streak3 )
		f2_arg0.Streak2.streakIndex = 2
		f2_arg0.Streak3.streakIndex = 3
	end
	f2_arg0.GimmeStreak.streakIndex = 0
	f2_arg0.GimmeStreak.isGimmeStreak = true
	f2_arg0.Streak1.costOmnvar = f0_local0[f0_local0( f2_arg0.Streak1.streakIndex - 1 )]
	if not f2_local0 then
		f2_arg0.Streak2.costOmnvar = f0_local0[f0_local0( f2_arg0.Streak2.streakIndex - 1 )]
		f2_arg0.Streak3.costOmnvar = f0_local0[f0_local0( f2_arg0.Streak3.streakIndex - 1 )]
	end
	local f2_local1, f2_local2, f2_local3 = f0_local0( f2_arg1 )
	f2_arg0.streaks = f2_local2
	f2_arg0.gimmeStreak = f2_local3
	local f2_local4 = {}
	for f2_local5 = 1, f2_local1, 1 do
		table.insert( f2_local4, f2_arg0["Streak" .. f2_local5] )
	end
	table.insert( f2_local4, f2_arg0.GimmeStreak )
	for f2_local8, f2_local9 in ipairs( f2_local4 ) do
		f2_local9.UpdateKillstreakNavigation = f0_local0( f2_arg1, f2_local4 )
		f2_local9.UnfocusKillstreaks = f0_local0( f2_local4 )
		f2_local9.SelectKillstreak = f0_local0( f2_arg0 )
	end
	f2_local5 = 4
	if f2_local0 then
		f2_local5 = 2
	end
	for f2_local6 = 1, f2_local5, 1 do
		if f2_local6 == f2_local5 then
			f2_arg0.GimmeStreak:SetDataSource( f2_local3, f2_arg1 )
			f2_arg0:SubscribeToModel( f2_local3.isActive:GetModel( f2_arg1 ), function ()
				f2_arg0( f2_arg0.GimmeStreak, f2_arg0, true )
			end )
		else
			local f2_local10 = f2_local2:GetDataSourceAtIndex( f2_local6 - 1, f2_arg1 )
			f2_arg0["Streak" .. f2_local6]:SetDataSource( f2_local10, f2_arg1 )
			f2_arg0:SubscribeToModel( f2_local10.icon:GetModel( f2_arg1 ), function ()
				f2_arg0( f2_arg0["Streak" .. f2_arg0], f2_arg0 )
			end )
		end
	end
	f2_arg0:SubscribeToModel( DataSources.inGame.player.affectedByEMP:GetModel( f2_arg1 ), function ( f4_arg0 )
		if DataModel.JJEHAEBDF( f4_arg0 ) then
			MP.StartEMPGlitch( f2_arg0 )
		else
			MP.StopEMPGlitch( f2_arg0 )
		end
	end )
	if not CONDITIONS.IsMagmaGameMode() then
		f2_local8 = LUI.DataSourceFromOmnvar.new( "ui_specialist_bonus_active" )
		f2_arg0:SubscribeToModel( f2_local8:GetModel( f2_arg1 ), function ( f3_arg0 )
			if DataModel.JJEHAEBDF( f3_arg0 ) then
				f2_arg0.Streak1.MinPipShine:SetRGBFromTable( SWATCHES.splashNotifications.splashAlternativecColor2, 0 )
				f2_arg0.Streak2.MinPipShine:SetRGBFromTable( SWATCHES.splashNotifications.splashAlternativecColor2, 0 )
				f2_arg0.Streak3.MinPipShine:SetRGBFromTable( SWATCHES.splashNotifications.splashAlternativecColor2, 0 )
			else
				f2_arg0.Streak1.MinPipShine:SetRGBFromTable( SWATCHES.HUD.HUDMain, 0 )
				f2_arg0.Streak2.MinPipShine:SetRGBFromTable( SWATCHES.HUD.HUDMain, 0 )
				f2_arg0.Streak3.MinPipShine:SetRGBFromTable( SWATCHES.HUD.HUDMain, 0 )
			end
		end )
	end
end

function StreakListRealism( menu, controller )
	local self = LUI.UIElement.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 20 * _1080p, 0, 80 * _1080p )
	self.id = "StreakListRealism"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine.DDJFBBJAIG() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1 )
	local f1_local2 = self
	local GimmeStreak = nil
	
	GimmeStreak = MenuBuilder.BuildRegisteredType( "StreakRealism", {
		controllerIndex = f1_local1
	} )
	GimmeStreak.id = "GimmeStreak"
	GimmeStreak:SetAlpha( 0, 0 )
	GimmeStreak:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 20, 0, _1080p * 20 )
	self:addElement( GimmeStreak )
	self.GimmeStreak = GimmeStreak
	
	local f1_local4 = nil
	if not CONDITIONS.IsBRGameType( self ) then
		f1_local4 = MenuBuilder.BuildRegisteredType( "StreakRealism", {
			controllerIndex = f1_local1
		} )
		f1_local4.id = "Streak3"
		f1_local4:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 20, _1080p * 20, _1080p * 40 )
		self:addElement( f1_local4 )
		self.Streak3 = f1_local4
	end
	local f1_local5 = nil
	if not CONDITIONS.IsBRGameType( self ) then
		f1_local5 = MenuBuilder.BuildRegisteredType( "StreakRealism", {
			controllerIndex = f1_local1
		} )
		f1_local5.id = "Streak2"
		f1_local5:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 20, _1080p * 40, _1080p * 60 )
		self:addElement( f1_local5 )
		self.Streak2 = f1_local5
	end
	local Streak1 = nil
	
	Streak1 = MenuBuilder.BuildRegisteredType( "StreakRealism", {
		controllerIndex = f1_local1
	} )
	Streak1.id = "Streak1"
	Streak1:SetAnchorsAndPosition( 0, 1, 0, 1, 0, _1080p * 20, _1080p * 60, _1080p * 80 )
	self:addElement( Streak1 )
	self.Streak1 = Streak1
	
	PostLoadFunc( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "StreakListRealism", StreakListRealism )
LockTable( _M )
