-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 04-10-2025 21:42
module( ..., package.seeall )
local f0_local0 = function ( f13_arg0, f13_arg1, f13_arg2 )
	local f13_local0 = nil
	if CONDITIONS.IsBRGameType( f13_arg0 ) then
		f13_local0 = {
			entityNum = f13_arg2,
			snapToScreenEdges = BRLOOT.CARD_SNAP_TO_SCREEN_EDGES,
			worldOffsetX = BRLOOT.CARD_X_OFFSET,
			worldOffsetY = BRLOOT.CARD_Y_OFFSET,
			worldOffsetZ = BRLOOT.CARD_Z_OFFSET,
			minScale = BRLOOT.CARD_MIN_SCALE,
			maxScale = BRLOOT.CARD_MAX_SCALE,
			perspectiveScaleLerpDistance = Dvar[0xEDCFC612B39E0C0]( "#x321be0cb769b9d526" ),
			perspectiveScalingEnabled = BRLOOT.CARD_IS_PERSPECTIVE_SCALE_ENABLED
		}
	else
		f13_local0 = {
			entityNum = f13_arg2,
			snapToScreenEdges = LOOT.CARD_SNAP_TO_SCREEN_EDGES,
			worldOffsetX = LOOT.CARD_X_OFFSET,
			worldOffsetY = LOOT.CARD_Y_OFFSET,
			worldOffsetZ = LOOT.CARD_Z_OFFSET,
			minScale = LOOT.CARD_MIN_SCALE,
			maxScale = LOOT.CARD_MAX_SCALE,
			perspectiveScaleLerpDistance = Dvar[0xEDCFC612B39E0C0]( "#x321be0cb769b9d526" ),
			perspectiveScalingEnabled = LOOT.CARD_IS_PERSPECTIVE_SCALE_ENABLED
		}
	end
	f13_arg0.lootCard.id = "lootCard_targetEntity_" .. f13_arg2
	f13_arg0.lootCard:SetupAnchoredElement( f13_local0 )
	f13_arg0.lootCard:UpdateLootCard( f13_arg1 )
end

local f0_local1 = function ( f8_arg0, f8_arg1 )
	local f8_local0 = 500
	local f8_local1 = 500
	local f8_local2 = 500
	f8_arg0._requiresHoldingModel = DataSources.inGame.HUD.hints.interactiveObject.button.requiresHolding:GetModel( f8_arg1 )
	f8_arg0.InteractButton.Prompt.KBMProgress:SetProgress( 0 )
	local f8_local3 = DataSources.inGame.player.useReloadProfile:GetModel( f8_arg1 )
	local f8_local4 = DataSources.inGame.HUD.hints.interactiveObject.button.targetEntity:GetModel( f8_arg1 )
	local f8_local5 = DataSources.inGame.HUD.hints.interactiveObject.progress:GetModel( f8_arg1 )
	local f8_local6 = DataSources.inGame.HUD.hints.interactiveObject.progress.duration:GetModel( f8_arg1 )
	local f8_local7 = DataSources.inGame.HUD.hints.interactiveObject.progress.hideBar:GetModel( f8_arg1 )
	local f8_local8 = DataSources.inGame.HUD.hints.interactiveObject.progress.entity:GetModel( f8_arg1 )
	local f8_local9 = LUI.DataSourceInControllerModel.new( "cg.HUD.hints.interactiveObject.interactionComplete" )
	local f8_local10 = f8_local9:GetModel( f8_arg1 )
	DataModel[0x83C9B5DE1D9371]( f8_local10, false )
	local f8_local11 = function ()
		local f11_local0 = DataSources.inGame.player.useReloadProfile:GetValue( f8_arg0 ) or -1
		local f11_local1 = DataModel[0x614D394F6F9A18D]( f8_arg0 ) or -1
		if not CONDITIONS.IsGamepadEnabled() or f11_local0 == 0 or f11_local0 == 3 or 250 < f11_local1 then
			if DataModel[0x614D394F6F9A18D]( f8_arg0 ) and HUDUtils.IsPromptAttachedToTargetEntity( f8_arg0, f8_arg0 ) then
				DataModel[0x83C9B5DE1D9371]( f8_arg0, false )
				if f8_arg0._currentState then
					
				else
					
				end
				if not DataModel[0x614D394F6F9A18D]( f8_arg0 ) and f11_local1 ~= 0 then
					f8_arg0._currentState = "Completed"
					if Engine[0x4F2A2C997DB66C9]() == 0 then
						f8_arg0._currentState = nil
					else
						ACTIONS.AnimateSequence( f8_arg0.InteractButton.Prompt, "Completed" )
						local f11_local2 = f8_arg0:Wait( f8_arg0 )
						f11_local2.onComplete = function ()
							f11_local0._currentState = nil
						end
						
					end
				end
			else
				local f11_local3 = DataModel[0x614D394F6F9A18D]( f8_arg0 )
				if DataModel[0x614D394F6F9A18D]( f8_arg0 ) == GameScriptConstants.EntityNumNone then
					f8_arg0.InteractButton.Prompt.KBMProgress:SetProgress( 0 )
				end
			end
		end
	end
	
	f8_arg0:SubscribeToModel( f8_local10, f8_local11 )
	f8_arg0:SubscribeToModel( f8_local8, f8_local11 )
	f8_arg0:SubscribeToModel( f8_local5, f8_local11 )
	f8_arg0:SubscribeToModel( f8_local3, f8_local11 )
	local f8_local12 = f8_arg0.InteractButton.Prompt.ProgressBar
	local f8_local13 = f8_arg0.InteractButton.Prompt.KBMProgress
	local f8_local14 = function ()
		if f8_arg0._currentState then
			
		else
			
		end
		local f9_local0 = DataModel[0x614D394F6F9A18D]( f8_arg0 )
		local f9_local1 = DataModel[0x614D394F6F9A18D]( f8_arg0 ) or -1
		if not f9_local0 and f9_local1 ~= 0 then
			local f9_local2 = DataModel[0x614D394F6F9A18D]( f8_arg0 )
			local f9_local3 = DataSources.inGame.player.useReloadProfile:GetValue( f8_arg0 ) or -1
			if f9_local2 ~= GameScriptConstants.EntityNumNone and (not CONDITIONS.IsGamepadEnabled() or f9_local3 == 0 or f9_local3 == 3 or 250 < f9_local1) then
				local f9_local4 = DataModel[0x614D394F6F9A18D]( f8_arg0 )
				if f9_local4 == 1 then
					f9_local4 = 0
					f8_arg0.progressStarted = false
				elseif 0 < f9_local4 then
					f8_arg0.progressStarted = true
					f8_arg0._requiresHolding = false
					ACTIONS.AnimateSequence( f8_arg0.InteractButton.Prompt.InteractiveObjectButtonIcon, "DontHold" )
				end
				if Engine[0x4F2A2C997DB66C9]() == 0 then
					f8_arg0:SetProgress( f9_local4 )
				else
					f8_arg0:SetProgress( f9_local4 )
					f8_arg0:SetAlpha( 1 )
				end
			else
				f8_arg0:SetProgress( 0 )
				f8_arg0:SetProgress( 0 )
				f8_arg0:SetAlpha( 0 )
				if DataModel[0x614D394F6F9A18D]( f8_arg0 ) then
					f8_arg0.progressStarted = false
				end
				if f8_arg0.progressStarted then
					f8_arg0.progressStarted = false
					f8_arg0._currentState = "NotCompleted"
					ACTIONS.AnimateSequence( f8_arg0.InteractButton.Prompt, "NotCompleted" )
					local f9_local5 = f8_arg0:Wait( f8_arg0 )
					f9_local5.onComplete = function ()
						f9_local0._currentState = nil
					end
					
				end
			end
		end
	end
	
	f8_arg0:SubscribeToModel( f8_local4, f8_local14 )
	f8_arg0:SubscribeToModel( f8_local8, f8_local14 )
	f8_arg0:SubscribeToModel( f8_local5, f8_local14 )
	f8_arg0:SubscribeToModel( f8_local3, f8_local14 )
end

local f0_local2 = function ( f2_arg0, f2_arg1, f2_arg2 )
	local f2_local0 = DataSources.inGame.HUD.hints.interactiveObject.lootCard
	local f2_local1 = f2_local0.targetEntity:GetModel( f2_arg1 )
	local f2_local2 = f2_local0.targetEntityOverride:GetModel( f2_arg1 )
	local f2_local3 = f2_local0.shouldShow:GetModel( f2_arg1 )
	local lootCard = nil
	if CONDITIONS.IsBRGameType( f2_arg0 ) then
		lootCard = MenuBuilder.BuildRegisteredType( "BRInteractiveLootCard", {
			controllerIndex = f2_arg1
		} )
	else
		lootCard = MenuBuilder.BuildRegisteredType( "PickupLootCard", {
			controllerIndex = f2_arg1
		} )
	end
	DataModel[0x83C9B5DE1D9371]( f2_local2, BRLOOT.INVALID_TARGET_ENTITY )
	f0_local0( lootCard, f2_arg1 )
	lootCard:SetDataSource( f2_local0, f2_arg1 )
	f2_arg0:addElement( lootCard )
	f2_arg0.lootCard = lootCard
	
	f2_arg0:SubscribeToModel( f2_local1, function ( f7_arg0 )
		local f7_local0 = DataModel[0x614D394F6F9A18D]( f7_arg0 )
		if f7_local0 and BRLOOT.ShouldShowLootCard( f2_arg0 ) then
			f2_arg0( f2_arg0, f2_arg0, f7_local0 )
		end
	end )
	f2_arg0:SubscribeToModel( f2_local2, function ( f6_arg0 )
		local f6_local0 = DataModel[0x614D394F6F9A18D]( f6_arg0 )
		if f6_local0 and f6_local0 ~= BRLOOT.INVALID_TARGET_ENTITY then
			f2_arg0.lootCard:UpdateLootCard( f2_arg0 )
		end
	end )
	f2_arg0:SubscribeToModel( DataSources.inGame.HUD.hints.interactiveObject.button.dismiss:GetModel( f2_arg1 ), function ( f5_arg0 )
		if DataModel[0x614D394F6F9A18D]( f5_arg0 ) then
			DataModel[0x83C9B5DE1D9371]( f2_arg0, BRLOOT.INVALID_TARGET_ENTITY )
		end
		f2_arg0.lootCard:UpdateLootCard( f2_arg0 )
	end )
	f2_arg0:SubscribeToModel( f2_local3, function ( f4_arg0 )
		f2_arg0.lootCard:UpdateLootCard( f2_arg0 )
	end )
	f2_arg0:SubscribeToModel( DataSources.inGame.player.inADS:GetModel( f2_arg1 ), function ( f3_arg0 )
		local f3_local0 = DataModel[0x614D394F6F9A18D]( f3_arg0 )
		local f3_local1 = 250
		if f3_local0 then
			f2_arg0:SetAlpha( 0, f3_local1, LUI.EASING.outCubic )
		else
			f2_arg0:SetAlpha( 1, f3_local1, LUI.EASING.outCubic )
		end
	end )
end

function BRLootCards( menu, controller )
	local self = LUI.UIVerticalStackedLayout.new()
	self:SetAnchorsAndPosition( 0, 1, 0, 1, 0, 1920 * _1080p, 0, 1080 * _1080p )
	self.id = "BRLootCards"
	local f1_local1
	if controller then
		f1_local1 = controller
	else
		f1_local1 = controller.controllerIndex
	end
	if not f1_local1 and not Engine[0x12586A3F4FB490E]() then
		f1_local1 = self:getRootController()
	end
	assert( f1_local1, "Missing controllerIndex!" )
	local f1_local2 = self
	f0_local0( self, f1_local1, controller )
	return self
end

MenuBuilder.registerType( "BRLootCards", BRLootCards )
LockTable( _M )
