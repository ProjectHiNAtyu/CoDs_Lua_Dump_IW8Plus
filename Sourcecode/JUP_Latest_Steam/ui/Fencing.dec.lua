-- Generated by CoDLuaDecompiler
-- Version: 2.4.2
-- Date: 30-11-2025 17:02
LUI.Fence = LUI.Class()
LUI.Fence.fenceTypes = {}
LUI.Fence.STATE = {
	block = 1,
	pass = 0,
	fail = 2
}
LUI.Fence.FenceObjectState = {
	PASSING = 4,
	FAILED = 8,
	IDLE = 1,
	ACTIVE = 2
}
LUI.Fence.Register = function ( f57_arg0, f57_arg1 )
	LUI.Fence.fenceTypes[f57_arg0] = f57_arg1
end

LUI.Fence.Instantiate = function ( f56_arg0, f56_arg1, f56_arg2, f56_arg3 )
	local f56_local0 = LUI.Fence.fenceTypes[f56_arg0]
	if f56_local0 then
		local f56_local1 = f56_local0.new( f56_arg1, f56_arg2, f56_arg3 )
		f56_local1._name = f56_arg0
		return f56_local1
	else
		
	end
end

LUI.Fence.init = function ( f55_arg0 )
	f55_arg0._state = LUI.Fence.STATE.block
end

LUI.Fence.Start = function ( f54_arg0 )
	
end

LUI.Fence.Frame = function ( f53_arg0 )
	
end

LUI.Fence.Stop = function ( f52_arg0 )
	
end

LUI.Fence.State = function ( f51_arg0 )
	return f51_arg0._state
end

LUI.Fence.StateString = function ( f50_arg0 )
	local f50_local0 = f50_arg0:State()
	if f50_local0 == LUI.Fence.STATE.pass then
		return "PASSING"
	elseif f50_local0 == LUI.Fence.STATE.block then
		return "BLOCKED"
	elseif f50_local0 == LUI.Fence.STATE.fail then
		return "FAILED"
	else
		return "UNKNOWN"
	end
end

LUI.Fence.Name = function ( f49_arg0 )
	return f49_arg0._name and f49_arg0._name or ""
end

LUI.Fence.AreFencesPassed = function ( f48_arg0, f48_arg1 )
	for f48_local3, f48_local4 in ipairs( f48_arg1 ) do
		if Fences[0x6C6D08978B8C65]( f48_arg0, f48_local4 ) ~= LUI.Fence.FenceObjectState.PASSING then
			return false
		end
	end
	return true
end

local f0_local0 = {}
local f0_local1 = false
LUI.Fence.HideNonCriticalPopupsForMenu = function ( f47_arg0 )
	f0_local0[f47_arg0] = true
end

LUI.Fence.ShouldForceHideNonCriticalPopups = function ( f46_arg0 )
	f0_local0 = f46_arg0
end

LUI.Fence.HideNonCriticalPopups = function ()
	if Dvar[0x9E5BE3B4BBA4E0E]( 0x182690EC133A482 ) then
		return false
	end
	local f45_local0 = f0_local0
	if not f45_local0 then
		f45_local0 = LUI.FlowManager.IsAnyInStack( Table.GetKeys( f0_local0 ) )
	end
	return f45_local0
end

LUI.FenceGroup = LUI.Class()
LUI.FenceGroup.STATE = {
	block = 1,
	pass = 0,
	fail = 2,
	abort = 3
}
LUI.FenceGroup.init = function ( f44_arg0, f44_arg1, f44_arg2, f44_arg3 )
	f44_arg0._fences = {}
	f44_arg0._state = nil
	for f44_local3, f44_local4 in ipairs( f44_arg1 ) do
		local f44_local5 = LUI.Fence.Instantiate( f44_local4, f44_arg0, f44_arg2, f44_arg3 )
		if f44_local5 then
			table.insert( f44_arg0._fences, f44_local5 )
		end
	end
	f44_arg0._activeFenceIndex = 0
	f44_arg0._timings = {}
	f44_arg0._timingsReported = 0
end

LUI.FenceGroup.Reset = function ( f43_arg0 )
	f43_arg0:ChangeActiveFence( 0 )
	f43_arg0._state = nil
end

LUI.FenceGroup.ChangeActiveFence = function ( f42_arg0, f42_arg1, f42_arg2 )
	local f42_local0 = f42_arg0._fences
	local f42_local1 = f42_local0[f42_arg0._activeFenceIndex]
	if f42_local1 ~= nil then
		f42_local1:Stop()
	end
	f42_arg0._activeFenceIndex = f42_arg1
	if f42_arg1 == nil then
		return 
	end
	local f42_local2 = f42_local0[f42_arg1]
	if f42_local2 ~= nil then
		f42_local2:Start( f42_arg0._gameModeKey )
	end
end

local f0_local2 = function ( f41_arg0, f41_arg1 )
	local f41_local0 = debug.traceback()
	if not f41_arg1 then
		f41_arg1 = "none"
	end
	return string.format( "menu: '%s', fence: '%s', stack: %s", f41_arg0, f41_arg1, f41_local0 )
end

LUI.FenceGroup.RecordFenceTiming = function ( f40_arg0, f40_arg1, f40_arg2 )
	local f40_local0 = Engine[0x8ABF895EEE0C7BA]()
	local f40_local1 = f40_arg0._timings
	local f40_local2 = f40_local1[#f40_local1]
	local f40_local3 = false
	local f40_local4 = false
	if f40_local2 then
		local f40_local5 = f40_local2.fenceNames
		f40_local4 = f40_arg1 == f40_local5[#f40_local5]
		f40_local3 = f40_arg2 == f40_local2.fenceState
	end
	if f40_local3 or f40_local4 then
		f40_local2.endTime = f40_local0
	end
	if f40_local3 and not f40_local4 then
		table.insert( f40_local2.fenceNames, f40_arg1 )
	end
	if f40_local3 then
		return 
	else
		table.insert( f40_local1, {
			fenceNames = {
				f40_arg1
			},
			startTime = f40_local0,
			endTime = f40_local0,
			fenceState = f40_arg2
		} )
	end
end

LUI.FenceGroup.Frame = function ( f39_arg0, f39_arg1, f39_arg2 )
	if not f39_arg0._activeFenceIndex then
		if Engine[0x2DA54CF5D6B7F02]() and Dvar[0x9E5BE3B4BBA4E0E]( 0xBB19B52AF1FA303 ) then
			local f39_local0 = debug.traceback()
			Engine[0x15D98DF5F61904B]( 0, "dlog_event_loot_equip", {
				modified = false,
				cac_session_id = "TESTING NIL ACTIVE FENCE INDEX",
				previous_screen_id = tostring( 0 ),
				time_spent_ms = tonumber( 0 ),
				alt_data = f39_arg0._activeFenceIndexSetToNilInfo,
				new_item_ids = f0_local0( f39_arg2 )
			} )
		end
		if Dvar[0x9E5BE3B4BBA4E0E]( 0x173273CE28960A5 ) then
			return 
		end
	end
	if f39_arg0._busy then
		return 
	end
	f39_arg0._busy = true
	f39_arg0._gameModeKey = f39_arg1
	if f39_arg0._activeFenceIndex < 1 then
		f39_arg0:RecordFenceTiming( "start", LUI.Fence.STATE.pass )
		f39_arg0:ChangeActiveFence( 1 )
	end
	local f39_local0 = f39_arg0._state
	local f39_local1 = LUI.FenceGroup.STATE.pass
	for f39_local5, f39_local6 in ipairs( f39_arg0._fences ) do
		if f39_local6:State() == LUI.Fence.STATE.fail then
			f39_local1 = LUI.FenceGroup.STATE.fail
			break
		elseif f39_arg0._activeFenceIndex <= f39_local5 then
			break
		end
	end
	if f39_local1 ~= LUI.FenceGroup.STATE.fail then
		for f39_local5, f39_local6 in ipairs( f39_arg0._fences ) do
			local f39_local9 = f39_local6:Name()
			Engine[0xD75F5E555D60E1]( "FrameUpdate for fence " .. f39_local9 )
			local f39_local7 = f39_local6:State()
			if f39_local7 ~= LUI.Fence.STATE.fail then
				f39_local6:UpdateState()
				f39_local6:Frame()
				f39_local7 = f39_local6:State()
			end
			local f39_local8 = false
			if f39_local7 == LUI.Fence.STATE.pass then
				if f39_local5 == f39_arg0._activeFenceIndex then
					f39_arg0:RecordFenceTiming( f39_local9, f39_local7 )
					f39_arg0:ChangeActiveFence( f39_local5 + 1 )
				end
			elseif f39_local7 == LUI.Fence.STATE.block then
				f39_local1 = LUI.FenceGroup.STATE.block
				f39_arg0:RecordFenceTiming( f39_local9, f39_local7 )
				if f39_local5 < f39_arg0._activeFenceIndex then
					f39_arg0:ChangeActiveFence( f39_local5 )
				end
				f39_local8 = true
			elseif f39_local7 == LUI.Fence.STATE.fail then
				f39_arg0:RecordFenceTiming( f39_local9, f39_local7 )
				if f39_local5 == f39_arg0._activeFenceIndex then
					f39_arg0:ChangeActiveFence( nil )
					if Engine[0x2DA54CF5D6B7F02]() and Dvar[0x9E5BE3B4BBA4E0E]( 0xBB19B52AF1FA303 ) then
						f39_arg0._activeFenceIndexSetToNilInfo = f0_local0( f39_arg2, f39_local9 )
					end
				end
				f39_local1 = LUI.FenceGroup.STATE.fail
				f39_local8 = true
			end
			Engine[0x4D47DEF7D5ED4B9]()
			if f39_local8 then
				break
			end
		end
	end
	if f39_local1 ~= f39_arg0._state then
		f39_arg0._state = f39_local1
		if f39_arg0._state == LUI.FenceGroup.STATE.pass then
			f39_arg0:OnPass()
		elseif f39_arg0._state == LUI.FenceGroup.STATE.block then
			f39_arg0:OnBlock()
		elseif f39_arg0._state == LUI.FenceGroup.STATE.fail then
			f39_arg0:BackOut()
			f39_arg0:Fail()
		end
	end
	f39_arg0._busy = false
end

LUI.FenceGroup.Abort = function ( f38_arg0, f38_arg1 )
	local f38_local0 = f38_arg0._fences[f38_arg0._activeFenceIndex]
	if f38_local0 then
		f38_arg0._fences[f38_arg0._activeFenceIndex]:Stop()
		f38_arg0:OnAbort()
	end
	f38_arg0._state = LUI.FenceGroup.STATE.abort
	f38_arg0._activeFenceIndex = nil
	if Engine[0x2DA54CF5D6B7F02]() and Dvar[0x9E5BE3B4BBA4E0E]( 0xBB19B52AF1FA303 ) then
		local f38_local1
		if f38_local0 then
			f38_local1 = f38_local0
		else
			f38_local1 = f38_local0:Name()
		end
		f38_arg0._activeFenceIndexSetToNilInfo = f0_local0( f38_arg1, f38_local1 )
	end
end

LUI.FenceGroup.BackOut = function ( f37_arg0 )
	URI.Manager.SendSignal( URI.ExecutionSignal.Stop )
	for f37_local0 = #f37_arg0._fences, 1, -1 do
		local f37_local3 = f37_arg0._fences[f37_local0]
		if f37_local3.OnBackOut then
			f37_local3:OnBackOut()
		end
	end
end

LUI.FenceGroup.Fail = function ( f36_arg0 )
	URI.Manager.SendSignal( URI.ExecutionSignal.Stop )
	f36_arg0:OnFail()
	for f36_local0 = 1, #f36_arg0._fences, 1 do
		local f36_local3 = f36_arg0._fences[#f36_arg0._fences - f36_local0 + 1]
		if f36_local3.PostFail then
			f36_local3:PostFail()
		end
	end
end

LUI.FenceGroup.OnPass = function ( f35_arg0 )
	
end

LUI.FenceGroup.OnBlock = function ( f34_arg0 )
	
end

LUI.FenceGroup.OnFail = function ( f33_arg0 )
	
end

LUI.FenceGroup.OnAbort = function ( f32_arg0 )
	
end

LUI.FenceGroup.Passes = function ( f31_arg0 )
	return f31_arg0._state == LUI.FenceGroup.STATE.pass
end

LUI.FenceGroup.DumpFenceState = function ( f30_arg0, f30_arg1 )
	if not CONDITIONS.ShouldDumpLUIFenceStateWhenFenced() then
		return 
	end
	for f30_local3, f30_local4 in ipairs( f30_arg0._fences ) do
		goto basicblock_4:
	end
end

LUI.FenceGroup.ReportTimings = function ( f29_arg0, f29_arg1 )
	local f29_local0 = f29_arg0._timings
	local f29_local1 = {}
	local f29_local2 = #f29_arg0._fences
	for f29_local6, f29_local7 in ipairs( f29_local0 ) do
		table.insert( f29_local1, {
			fence_names = table.concat( f29_local7.fenceNames, "," ),
			start_time = f29_local7.startTime,
			end_time = f29_local7.endTime,
			fence_state = f29_local7.fenceState
		} )
	end
	Engine[0xF37CA69C25332C0]( f29_arg1, f29_local2, f29_arg0._timingsReported, f29_local1 )
	f29_local3 = f29_local0[#f29_local0]
	f29_arg0._timings = {}
	f29_arg0._timingsReported = f29_arg0._timingsReported + 1
	f29_arg0:RecordFenceTiming( "none", LUI.Fence.STATE.pass )
end

LUI.DeferredFence = LUI.Class()
LUI.DeferredFence.Criticality = {
	LOW = 0,
	VITAL = 4,
	MODERATE = 2,
	MAJOR = 3,
	MINOR = 1
}
LUI.DeferredFence.BackOutMethod = {
	LEAVE_MENU = 0,
	LEAVE_TAB = 1,
	NONE = 4294967295
}
local f0_local3 = LUI.DeferredFence.Criticality.LOW
local f0_local4 = LUI.DeferredFence.Criticality.VITAL
local f0_local5 = LUI.DeferredFence.BackOutMethod.NONE
local f0_local6 = LUI.DeferredFence.BackOutMethod.LEAVE_TAB
local f0_local7 = 5000
local f0_local8 = {}
local f0_local9 = {
	[LUI.DeferredFence.Criticality.MAJOR] = true,
	[LUI.DeferredFence.Criticality.VITAL] = true
}
local f0_local10 = {
	[LUI.DeferredFence.BackOutMethod.LEAVE_MENU] = function ( f28_arg0, f28_arg1 )
		LUI.FlowManager.RequestLeaveMenu( f28_arg0, false, false )
	end,
	[LUI.DeferredFence.BackOutMethod.LEAVE_TAB] = function ( f27_arg0, f27_arg1 )
		local f27_local0
		if f27_arg0 then
			f27_local0 = f27_arg0
		else
			f27_local0 = f27_arg0:GetCurrentMenu()
		end
		if f27_local0 then
			local f27_local1 = f27_local0.MainMenuTabs or f27_local0.MPTabsMenu
			if f27_local1 and f27_local1.Tabs then
				f27_local1.Tabs:FocusTab( f27_arg1, f27_local1.Tabs:GetNextEnabledTab( f27_arg1, 1, true ), FocusType.MenuFlow )
			end
		end
	end
}
local f0_local11 = {
	[LUI.DeferredFence.Criticality.LOW] = function ( f26_arg0, f26_arg1, f26_arg2, f26_arg3, f26_arg4 )
		return f26_arg4( f26_arg1, f26_arg2 )
	end,
	[LUI.DeferredFence.Criticality.MINOR] = function ( f25_arg0, f25_arg1, f25_arg2, f25_arg3, f25_arg4 )
		if Fences[0x6C6D08978B8C65]( f25_arg2.controllerIndex, f25_arg0 ) == LUI.Fence.FenceObjectState.FAILED then
			local f25_local0 = LUI.ToastManager.StandardEmphasisToast
			local f25_local1 = Engine[0xED84C33EC5F01EA]( 0x30C0162BD2B61EF )
			local f25_local2 = Fences[0xA7D80C060789546]( f25_arg2.controllerIndex, f25_arg0 )
			if not f25_local2 then
				f25_local2 = Engine[0xED84C33EC5F01EA]( 0xC635395703468B3 )
			end
			LUI.ToastManager.CreateToast( f25_arg2.controllerIndex, f25_local0( f25_local1, f25_local2, LUI.ToastManager.ToastNotificationType.Warnings, nil, false, LUI.ToastManager.ToastVisualEffect.Error ) )
		end
		return f25_arg4( f25_arg1, f25_arg2 )
	end,
	[LUI.DeferredFence.Criticality.MODERATE] = function ( f23_arg0, f23_arg1, f23_arg2, f23_arg3, f23_arg4 )
		if Fences[0x6C6D08978B8C65]( f23_arg2.controllerIndex, f23_arg0 ) == LUI.Fence.FenceObjectState.FAILED then
			LUI.FlowManager.RequestPopupMenu( nil, "DeferredFenceFailedPopup", false, f23_arg2.controllerIndex, false, {
				controllerIndex = f23_arg2.controllerIndex,
				message = Fences[0xA7D80C060789546]( f23_arg2.controllerIndex, f23_arg0 ) or "",
				criticality = LUI.DeferredFence.Criticality.MODERATE,
				buttons = {
					{
						label = Engine[0xED84C33EC5F01EA]( 0x5C33DA8F6CE65B0 ),
						action = function ( f24_arg0, f24_arg1 )
							LUI.FlowManager.RequestLeaveMenu( f24_arg0, true )
						end
					}
				}
			}, nil, false, false )
		end
		return f23_arg4( f23_arg1, f23_arg2 )
	end,
	[LUI.DeferredFence.Criticality.MAJOR] = function ( f20_arg0, f20_arg1, f20_arg2, f20_arg3, f20_arg4 )
		local f20_local0 = Fences[0x6C6D08978B8C65]( f20_arg2.controllerIndex, f20_arg0 )
		if f20_local0 == LUI.Fence.FenceObjectState.IDLE or f20_local0 == LUI.Fence.FenceObjectState.ACTIVE then
			LUI.FlowManager.RequestPopupMenu( nil, "DeferredFenceInProgressPopup", false, f20_arg2.controllerIndex, false, {
				controllerIndex = f20_arg2.controllerIndex,
				criticality = LUI.DeferredFence.Criticality.MAJOR,
				fenceName = f20_arg0,
				onCancel = function ( f22_arg0, f22_arg1 )
					LUI.FlowManager.RequestLeaveMenu( f22_arg0, true, false )
					f20_arg0[f20_arg0]( f20_arg0, f22_arg1.controller )
				end
			}, nil, false, false )
		elseif f20_local0 == LUI.Fence.FenceObjectState.PASSING then
			LUI.FlowManager.RequestLeaveMenuByName( "DeferredFenceInProgressPopup", false, false )
		elseif f20_local0 == LUI.Fence.FenceObjectState.FAILED then
			LUI.FlowManager.RequestLeaveMenuByName( "DeferredFenceInProgressPopup", false, false )
			LUI.FlowManager.RequestPopupMenu( nil, "DeferredFenceFailedPopup", false, f20_arg2.controllerIndex, false, {
				controllerIndex = f20_arg2.controllerIndex,
				message = Fences[0xA7D80C060789546]( f20_arg2.controllerIndex, f20_arg0 ) or "",
				criticality = LUI.DeferredFence.Criticality.MAJOR,
				buttons = {
					{
						label = Engine[0xED84C33EC5F01EA]( 0x5C33DA8F6CE65B0 ),
						action = function ( f21_arg0, f21_arg1 )
							LUI.FlowManager.RequestLeaveMenu( f21_arg0, true )
						end
					}
				}
			}, nil, false, false )
		end
		return f20_arg4( f20_arg1, f20_arg2 )
	end,
	[LUI.DeferredFence.Criticality.VITAL] = function ( f17_arg0, f17_arg1, f17_arg2, f17_arg3, f17_arg4 )
		local f17_local0 = Fences[0x6C6D08978B8C65]( f17_arg2.controllerIndex, f17_arg0 )
		if f17_local0 == LUI.Fence.FenceObjectState.IDLE or f17_local0 == LUI.Fence.FenceObjectState.ACTIVE then
			LUI.FlowManager.RequestPopupMenu( nil, "DeferredFenceInProgressPopup", false, f17_arg2.controllerIndex, false, {
				controllerIndex = f17_arg2.controllerIndex,
				criticality = LUI.DeferredFence.Criticality.VITAL,
				fenceName = f17_arg0,
				onCancel = function ( f19_arg0, f19_arg1 )
					LUI.FlowManager.RequestLeaveMenu( f19_arg0, true, false )
					f17_arg0[f17_arg0]( f17_arg0, f19_arg1.controller )
				end
			}, nil, false, false )
		elseif f17_local0 == LUI.Fence.FenceObjectState.PASSING then
			LUI.FlowManager.RequestLeaveMenuByName( "DeferredFenceInProgressPopup", false, false )
		elseif f17_local0 == LUI.Fence.FenceObjectState.FAILED then
			LUI.FlowManager.RequestLeaveMenuByName( "DeferredFenceInProgressPopup", false, false )
			LUI.FlowManager.RequestPopupMenu( nil, "DeferredFenceFailedPopup", false, f17_arg2.controllerIndex, false, {
				noCloseButton = true,
				controllerIndex = f17_arg2.controllerIndex,
				message = Fences[0xA7D80C060789546]( f17_arg2.controllerIndex, f17_arg0 ) or "",
				criticality = LUI.DeferredFence.Criticality.VITAL,
				buttons = {
					{
						label = Engine[0xED84C33EC5F01EA]( 0x3956F54E845F7DE ),
						action = function ( f18_arg0, f18_arg1 )
							LUI.FlowManager.RequestLeaveMenu( f18_arg0, true )
							f17_arg0[f17_arg0]( f17_arg0, f18_arg1 )
						end
					}
				}
			}, nil, false, false )
		end
		return f17_arg4( f17_arg1, f17_arg2 )
	end
}
local f0_local12 = function ( f16_arg0 )
	for f16_local3, f16_local4 in pairs( LUI.DeferredFence.BackOutMethod ) do
		if f16_local4 == f16_arg0 then
			return f16_local3
		end
	end
	return tostring( f16_arg0 )
end

local f0_local13 = function ( f15_arg0, f15_arg1 )
	if f15_arg1 == LUI.DeferredFence.BackOutMethod.NONE then
		
	elseif f15_arg1 == LUI.DeferredFence.BackOutMethod.LEAVE_MENU then
		
	elseif f15_arg1 == LUI.DeferredFence.BackOutMethod.LEAVE_TAB then
		if f15_arg0 then
			local f15_local0 = f15_arg0
		else
			local f15_local0 = f15_arg0:GetCurrentMenu()
		end
	end
end

local f0_local14 = function ( f14_arg0, f14_arg1, f14_arg2, f14_arg3, f14_arg4, f14_arg5, f14_arg6 )
	local f14_local0 = {}
	for f14_local4, f14_local5 in pairs( LUI.DeferredFence.Criticality ) do
		f14_local0[f14_local5] = f14_local4
	end
	f14_local1 = {}
	for f14_local5, f14_local6 in pairs( LUI.DeferredFence.BackOutMethod ) do
		f14_local1[f14_local6] = f14_local5
	end
	if f0_local0[f14_arg3] then
		f0_local0( f14_arg0, f14_arg4 )
	end
end

LUI.DeferredFence.IsFenceComplete = function ( f13_arg0 )
	local f13_local0
	if f13_arg0 ~= LUI.Fence.FenceObjectState.PASSING and f13_arg0 ~= LUI.Fence.FenceObjectState.FAILED then
		f13_local0 = false
	else
		f13_local0 = true
	end
	return f13_local0
end

LUI.DeferredFence.DetachAll = function ( f12_arg0 )
	for f12_local0 = #f0_local0, 1, -1 do
		if f0_local0[f12_local0].element == f12_arg0 then
			table.remove( f0_local0, f12_local0 )
		end
	end
end

LUI.Fence.DidFencesFail = function ( f11_arg0, f11_arg1 )
	for f11_local3, f11_local4 in ipairs( f11_arg1 ) do
		if Fences[0x6C6D08978B8C65]( f11_arg0, f11_local4 ) == LUI.Fence.FenceObjectState.FAILED then
			return true
		end
	end
	return false
end

LUI.DeferredFence.AttachMultiple = function ( f9_arg0, f9_arg1, f9_arg2, f9_arg3, f9_arg4, f9_arg5, f9_arg6 )
	local f9_local0 = function ( f10_arg0, f10_arg1 )
		if not f9_arg0._onFencesCompleteCalled then
			if LUI.Fence.DidFencesFail( f9_arg0, f9_arg0 ) then
				f10_arg1.fenceState = LUI.Fence.FenceObjectState.FAILED
				f9_arg0._onFencesCompleteCalled = true
				f9_arg0( f10_arg0, f10_arg1 )
			elseif LUI.Fence.AreFencesPassed( f9_arg0, f9_arg0 ) then
				f10_arg1.fenceState = LUI.Fence.FenceObjectState.PASSING
				f9_arg0._onFencesCompleteCalled = true
				f9_arg0( f10_arg0, f10_arg1 )
			end
		end
	end
	
	local f9_local1 = {}
	for f9_local5, f9_local6 in ipairs( f9_arg2 ) do
		f9_local1[f9_local6] = LUI.DeferredFence.Attach( f9_arg0, f9_arg1, f9_local6, f9_arg3, f9_arg4, f9_local0, f9_arg6 )
	end
	return f9_local1
end

LUI.DeferredFence.Attach = function ( f7_arg0, f7_arg1, f7_arg2, f7_arg3, f7_arg4, f7_arg5, f7_arg6 )
	f0_local0( f7_arg0, f7_arg1, f7_arg2, f7_arg3, f7_arg4, f7_arg5, f7_arg6 )
	local f7_local0 = "fence_" .. string.lower( f7_arg2 ) .. "_changed"
	local f7_local1 = function ( f8_arg0, f8_arg1 )
		local f8_local0 = {
			criticality = f7_arg0,
			fenceName = f7_arg0,
			element = f8_arg0,
			event = f8_arg1,
			backOutMethod = f7_arg0,
			onFenceStateChanged = f7_arg0
		}
		for f8_local4, f8_local5 in ipairs( f7_arg0 ) do
			if f8_local5.onFenceStateChanged == f8_local0.onFenceStateChanged then
				table.remove( f7_arg0, f8_local4 )
			end
		end
		table.insert( f7_arg0, f8_local0 )
	end
	
	local f7_local2 = Fences[0x6C6D08978B8C65]( f7_arg1, f7_arg2 )
	f7_arg0:deregisterEventHandler( f7_local0 )
	f7_arg0:registerAndCallEventHandler( f7_local0, f7_local1, {
		controllerIndex = f7_arg1,
		fenceState = f7_local2
	} )
	if f7_arg6 or f7_local2 == LUI.Fence.FenceObjectState.PASSING or f7_local2 == LUI.Fence.FenceObjectState.ACTIVE then
		return f7_local2
	else
		return Fences[0x5D874D3BFE6FCB3]( f7_arg1, f7_arg2 )
	end
end

LUI.DeferredFence.DeferredFenceUpdate = function ()
	if f0_local0 and 0 < #f0_local0 then
		table.sort( f0_local0, function ( f6_arg0, f6_arg1 )
			if f6_arg1.criticality < f6_arg0.criticality then
				return true
			else
				
			end
		end )
		if 0 < #f0_local0 then
			
		else
			
		end
	end
end

MenuBuilder.registerType( "DeferredFenceInProgressPopup", function ( f2_arg0, f2_arg1 )
	local f2_local0 = Engine[0xED84C33EC5F01EA]( 0x58B683665736D48 )
	f2_arg1.hideDarkener = true
	f2_arg1.disableIntro = false
	f2_arg1.message = f2_local0
	f2_arg1.onStatusUpdateCallback = function ( f4_arg0 )
		local f4_local0 = Fences[0x7E779F6CED13F21]( f4_arg0, f2_arg0.fenceName )
		if not f4_local0 then
			f4_local0 = ""
		end
		return f4_local0
	end
	
	f2_arg1.onMessageUpdateCallback = function ( f3_arg0 )
		local f3_local0 = Fences[0x16D16AAE1F86E41]( f3_arg0, f2_arg0.fenceName )
		if not f3_local0 then
			f3_local0 = f2_arg0
		end
		return f3_local0
	end
	
	local f2_local1 = MenuBuilder.BuildRegisteredType( "FenceDialogPopup", f2_arg1 )
	f2_local1.id = "DeferredFenceInProgressPopup"
	return f2_local1
end )
MenuBuilder.registerType( "DeferredFenceFailedPopup", function ( f1_arg0, f1_arg1 )
	f1_arg1.title = Engine[0xED84C33EC5F01EA]( 0x2620520B89194C2 )
	local f1_local0 = MenuBuilder.BuildRegisteredType( "PopupMessageAndButtons", f1_arg1 )
	f1_local0.id = "DeferredFenceFailedPopup"
	return f1_local0
end )
